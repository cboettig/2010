<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>Lab Notebook</title>
 <link href="/2010/atom.xml" rel="self"/>
 <link href="/"/>
 <updated>2015-02-25T23:07:52+00:00</updated>
 <id>http://www.carlboettiger.info/2010</id>
 <author>
   <name>Carl Boettiger</name>
   <email>cboettig@gmail.com</email>
 </author>

 
 <entry>
   <title>Comparative evolution: Is the data informative?</title>
	 <link href="/2010/12/31/comparative-phylogenetics-is-the-data-informative.html"/>
   <updated>2010-12-31T21:22:07+00:00</updated>
   <id>/12/31/comparative-phylogenetics-is-the-data-informative</id>
   <content type="html">&lt;p&gt;Working on my SICB talk, going a little further into the example of fitting the lambda model on the Anoles data to illustrate the ways in which we may lack sufficient data for the question.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;The dataset may not contain adequate signal of the parameter / phenomenon in question&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The dataset may not be adequately large&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Anoles data set (23 taxa):&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5244/5309932027_a43349ff6a_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;This first image shows the distribution of lambda values estimated from many datasets all simulated under a lambda = 0.6.  (Replotted from earlier entry)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5086/5310521188_dc5b23cf56_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;A larger (simulated &amp;gt; 300 taxa) tree has can infer lambda with somewhat greater accuracy, though still rather sizable variance. (reran this simulation from earlier entry code that didn’t store the .Rdat file)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5045/5310150538_6a1b4fa16c_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;How informative the data are depends on the question.  Using the original 23 taxa tree we find it is plenty big enough to reliably recover the estimate of sigma, even though many of those estimates come from models that have rather mismatched lambda.  This suggests that sigma is nearly a sufficient statistic, while lambda is not.  That it can fit even when lambda is mismatched further suggests that the tree itself isn’t informing that estimate much – simply matching the variance in the data is most important.  This apparent lack of phylogenetic signal, however, says everything about how small the tree is, not how well or not well Brownian motion fits the data.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Stochastic limits to evolutionary branching</title>
	 <link href="/2010/12/30/stochastic-limits-to-evolutionary-branching.html"/>
   <updated>2010-12-30T22:12:47+00:00</updated>
   <id>/12/30/stochastic-limits-to-evolutionary-branching</id>
   <content type="html">&lt;p&gt;My last post was a bit pessimistic, sometimes I can still miss the forest for the trees.  Hidden in those figures, the main point has been staring me in the face.  So let’s try this again.&lt;/p&gt;
&lt;p&gt;Stochastic limits to evolutionary branching is the story of two dueling timescales.  The first timescale is that of the evolutionary process: the frequency of steps (mutation rate, $ $) and the size of the steps (mutation kernel standard deviation $ _{}$), on top of which we add the selection gradient, created by the ecology. The second timescale is that of ecological coexistence, which in low noise situations should be much longer, and hence irrelevant.&lt;/p&gt;
&lt;p&gt;While the approach to the branching point depends on the width of the resource kernel and is independent of the competition kernel.  At the branching point, how much narrower the competition kernel is compared to the resource kernel (in units of the mutational step size) determines how stable the coexistence of the early dimorphism is – the second timescale.  In most adaptive dynamics simulations this second timescale is irrelevant, being much longer than the former timescale, at least by assumption.  However, this need not be the case.&lt;/p&gt;
&lt;p&gt;When this timescale (influenced by most parameters: population size, mutation size relative to competition kernel; resource kernel matters more weakly[ref] should add the equations for approximating the coexistence time to illustrate this[/ref])  becomes on the same order as the evolutionary timescale of waiting until the next mutation (determined by the mutation rate and population size) suddenly it impacts the waiting time until branching.&lt;/p&gt;
&lt;p&gt;This can be characterized by the number of times a dimorphism establishes but then fails.  Similarly, weak coexistence impacts the number of times the dimorphism survives long enough for the mutation to arrive and establish, only to again collapse.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5244/5303963185_198812d83d_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5042/5304557466_ffa94d5ce1_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Figures illustrate outside the regime where coexistence times matter, where dimorphism never collapses after establishing.  In harsher parameter regime, the dimorphism collapses hundreds of times before enough mutations can accumulate in rapid succession (or a rare large mutation occurs) to create a dimorphism of substantially different traits so as to coexist.&lt;/p&gt;
&lt;p&gt;Respective codes for each figure to show parameter values:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; all[[2]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 1e-3, sigma_c2 = .1, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30)
 all[[3]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.03, mu = 5e-4, sigma_c2 = .3, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics/commit/e85f36cd1bdafb998468ec7ceb74c72e4c73876d#diff-0&quot;&gt;full code&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;In the first example, a mutation at least two standard deviations out (prob &amp;lt;5%) from the expected value is sufficient to get a standard deviation away from the competition kernel (i.e.  60% competition).  Step-size limited mutations should have very similar failures for the first and second plots, using lots of little steps each with high failure rate.  Mutation-rate limited processes use one big jump, and show a high disparity between the failures in the first case and failures in the second.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5241/5306903526_94d5ee93a5_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Figures like the above show that when coexistence is hard (sigma_c  approaches sigma_k = 1) failure rates can be very high.  As the rates are very similar, this case appears to be clearly step-size limited, proceeding through many mutations with low probability of success of coexisting.&lt;/p&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics/commit/2b25473689f6b4e9ba739a4373a3e457da9589c0&quot;&gt;code &amp;amp; data&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&quot;further-exploration-illustrating-this-second-mode-mutation-limited&quot;&gt;Further Exploration: Illustrating this second mode (mutation-limited)&lt;/h2&gt;
&lt;p&gt;Trying some examples now to see if I can create mutation-rate limited example by running the above at sigma_mu=.5 rather than .3 when varying mutation rate over 1e-4 to 1e-3.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5127/5309279143_425ca848da_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5207/5309867078_17fe14c0db_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The low mutation rates appear to time out instead (time until phase, left figure).  The higher mutations actually show slightly fewer attempts after establishment, but not a strong signal.  Trying now with larger mutation steps.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5041/5310364434_dc2f8b9ecd_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Still shows no indication of rate limited mutation.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Open Notebook Science Abstract</title>
	 <link href="/2010/12/30/open-notebook-science-abstract.html"/>
   <updated>2010-12-30T17:54:37+00:00</updated>
   <id>/12/30/open-notebook-science-abstract</id>
   <content type="html">&lt;p&gt;In addition to my primary research categories, I make some entries in my lab notebook  to document and reflect on my experiment in open notebook science.  This includes my notes on tools I try out for open and collaborative science, including uses of social media, cloud computing, and scientific databases and repositories.&lt;/p&gt;
&lt;p&gt;This serves as a cover-page for the open science entries in my notebook, displaying the most recent entries, articles, figures and code through rss feeds.&lt;/p&gt;
&lt;h2 id=&quot;recent-notebook-entries&quot;&gt;&lt;a href=&quot;http://www.carlboettiger.info/archives/category/ons-thoughts&quot;&gt;Recent Notebook Entries&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;[rssinpage rssfeed=‘http://www.carlboettiger.info/archives/category/ons-thoughts/feed’ rssformat=‘x: Y’ rssitems=“10” rssdateformat=‘j F Y’ rsstimezone=‘America/Los_Angeles’]&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://openwetware.org/wiki/Category:ONS&quot;&gt;Entries from before 20-Oct-2010&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;recently-added-articles&quot;&gt;&lt;a href=&quot;http://www.mendeley.com/groups/530031/future-of-science/&quot;&gt;Recently Added Articles&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I maintain a collection of literature on articles that discuss the future of science, peer review, open access, open data, web tools and science 2.0 ideas on Mendeley called “Future of Science,” whose rss feed appears below.&lt;/p&gt;
&lt;p&gt;[rssinpage rssfeed=‘http://www.mendeley.com/groups/530031/future-of-science/feed/rss’ rssformat=‘x: Y’ rssitems=“5” rssdateformat=‘j F Y’ rsstimezone=‘America/Los_Angeles’]&lt;/p&gt;
&lt;h2 id=&quot;recent-figures&quot;&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/tags/ons/&quot;&gt;Recent Figures&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“ons” &lt;code&gt;tag_mode=&amp;quot;all&amp;quot;&lt;/code&gt;]&lt;/p&gt;
&lt;h2 id=&quot;code-updates&quot;&gt;&lt;a href=&quot;https://github.com/cboettig/socialR&quot;&gt;Code Updates&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I’m developing an R package called “socialR”, which I use to interact with my notebook, github code library, flickr image database and twitter  notification system from within R.  These are the updates from the commit log, &lt;a href=&quot;http://www.carlboettiger.info/archives/565&quot;&gt;see this entry&lt;/a&gt;for details.&lt;/p&gt;
&lt;p&gt;[cetsEmbedRSS id=https://github.com/cboettig/socialR/commits/master.atom itemcount=5 itemauthor=0 itemdate=1 itemcontent=0]&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parameter exploration in adaptive dynamics branching</title>
	 <link href="/2010/12/30/parameter-exploration-in-adaptive-dynamics-branching.html"/>
   <updated>2010-12-30T16:52:09+00:00</updated>
   <id>/12/30/parameter-exploration-in-adaptive-dynamics-branching</id>
   <content type="html">&lt;p&gt;Ran a series of simulations overnight to explore aspects of time-to-branching at different phases of the branching process.  Still using only 16 replicates per data point, though increased maximum time for a run another order of magnitude to avoid timing out runs influencing the dataset for the slow-rate parameters.  Still seems to suggest a regime beyond which branching becomes completely improbable.  Not clear that the transition is a sharp as the Arrhenius approximation might suggest.&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“2010dec30slideshow”]&lt;/p&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics/commit/20124cd7ce45f26f0cd40ad4896ea5358d655c63#diff-1&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics/blob/2b25473689f6b4e9ba739a4373a3e457da9589c0/demos/waiting_times.Rdat&quot;&gt;data&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“adaptivedynamics”]&lt;/p&gt;
&lt;p&gt;I have found the interpretation of the larger scale simulations exploring the impact of the various parameters upon the branching times in different phases somewhat less clear than I had hoped.&lt;/p&gt;
&lt;p&gt;The analytical approximation gives the suggestion of a sharp transition between a regime where branching is “easy”, where the expected coexistence times are longer than the expected waiting time to the next mutation, and “hard”, where they are shorter. The mathematics reduce to an expression similar to the Arrhenius law, where there is a sharp transition between the probability of being in one state to being in the other depending on the noise level.&lt;/p&gt;
&lt;p&gt;I have been trying to get explore this through the simulations and figuring out the best way to visually represent this. I have been using the contour plots you suggested to illustrate the coexistence times on the PIP, which is quite nice. Unfortunately the analytic approximations don’t seem to agree quantitatively outside a somewhat limited parameter range, more limited than I expected.&lt;/p&gt;
&lt;p&gt;I have also been exploring the time required to reach each of our four phases of the branching process as a function of the various parameters. In this I hoped to see the sharp transition predicted by the approximation, but figuring out the best way to both explore and visualize this through the parameter space. Hard to distinguish this from simply getting exponentially longer.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>adaptive-dynamics Simulations</title>
	 <link href="/2010/12/29/adaptive-dynamics-simulations.html"/>
   <updated>2010-12-29T16:29:25+00:00</updated>
   <id>/12/29/adaptive-dynamics-simulations</id>
   <content type="html">&lt;p&gt;Setting up some adaptive dynamics simulations to complete the parameter-space search.  Currently the demo library contains two files, providing the coexistence-only tests and the full evolutionary simulation.  This picks up from Aug 30/Sept 1 on coexistence times and &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/08/12&quot;&gt;Aug 12/13 entries&lt;/a&gt;on waiting times until branching (while still on OWW).&lt;/p&gt;
&lt;h2 id=&quot;coexistence-times&quot;&gt;coexistence times&lt;/h2&gt;
&lt;p&gt;coexist_times.R creates contour plots of the coexistence time under demographic noise expected at a particular position of the pairwise invasibility plot (PIP).  I also attempt to calculate these using an analytic approximation derived through the Arrhenius law trick to the SDE approximation.&lt;/p&gt;
&lt;p&gt;ensemble_coexistence() runs just the coexistence simulation from&lt;/p&gt;
&lt;p&gt;coexist_analytics() attempts to create the same graph analytically.&lt;/p&gt;
&lt;p&gt;Unfortunately the analytic approximation seems insufficient:&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode =“tag” tags=“contour_analytics_vs_simulation”]&lt;/p&gt;
&lt;h2 id=&quot;phases-of-the-branching-process&quot;&gt;Phases of the branching Process&lt;/h2&gt;
&lt;p&gt;ensemble_sim() runs the full simulation with mutations.  Returns an ad_ensemble object with three elements: $data, $pars, and $reps.  $data is a list element for each replicate.  For each replicate, it records 4 time-points:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;First time two coexisting branches are established&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Last (most recent) time two coexisting branches were established&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Time to finish phase 2: (satisfies invade_pair() test: trimorphic, third type can coexist (positive invasion), is above threshold and two coexisting types already stored in pair&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Time to Finish line (a threshold separation): traits separated by more than critical threshold&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;For each of these it returns the trait values of the identified coexisting dimorphism as well (x,y).  This x,y data is plotted for all replicates in four butterfly plots (for each time interval) by plot_butterfly.  Time data is coded in the shading. (just call plot_butterfly on the ad_ensemble object).&lt;/p&gt;
&lt;p&gt;In addition to these four (t, x, y) triplets, each replicate reports two counts:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;Number of times the dimporphism is lost in phase 2&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Number of times the dimorphism is lost in phase 1&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These are histogrammed by plot_failures(object).  Finally, plot_waitingtimes(object) just histograms the distribution of waiting times  across replicates for each of the four phases outlined above.  Figures from today’s version of &lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics/blob/6af69eec9e7b8087d0ed5b52d8af8cdbfa008d40/demos/waiting_times.R&quot;&gt;waiting_times.R&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“waiting_times”]&lt;/p&gt;
&lt;h2 id=&quot;illustrating-key-phenomena&quot;&gt;Illustrating Key Phenomena&lt;/h2&gt;
&lt;p&gt;The motivation for these two lines of investigation go back to simulations from &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/05/04&quot;&gt;May 3-4 entries&lt;/a&gt; which begin to show distinction between different mechanisms of branching.  The hint comes between processes that appear limited by phase 1 an those limited by phase 2.  This can be illustrated by the time required or the number of attempts necessary (failure rate histograms).&lt;/p&gt;
&lt;p&gt;Running simulation sets now varying the range of sigma_mu, sigma_c2, and mu to illustrate the sharpness of the transitions between noise-limited and not limited branching dynamics, and how the difference in times and attempts between phases changes with these parameters.  i.e.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5202/5304975278_6840299016_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;computing-notes&quot;&gt;Computing Notes:&lt;/h3&gt;
&lt;p&gt;Setup AdaptiveDynamics repository on zero.  An outdated rsa_id key in /.ssh was causing me not to be able to commit from&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>DoE renewal and a year in review</title>
	 <link href="/2010/12/24/doe-renewal-and-a-year-in-review.html"/>
   <updated>2010-12-24T03:24:40+00:00</updated>
   <id>/12/24/doe-renewal-and-a-year-in-review</id>
   <content type="html">&lt;p&gt;This time of year I have to file my renewal for my DOE Fellowship, including a statement of accomplishments and a summary of the computational aspects of my work.  Seemed like a good idea to jot these down in my notebook as well:&lt;/p&gt;
&lt;h3 id=&quot;synopsis-of-accomplishments-over-the-year&quot;&gt;synopsis of accomplishments over the year:&lt;/h3&gt;
&lt;p&gt;In January I passed my qualifying exam, advancing to candidacy where my dissertation remains my only requirement.  In March I attended the phylogenetics workshop in Bodega Bay, an internationally known week-long training program.  I also attended the CSGF conference in June, and gave talks at both the Evolution conference and the integrative phylogenetics conference, iEvoBio, in July, both key events in my field.&lt;/p&gt;
&lt;p&gt;From the beginning of June until the start of September, I stepped outside my research in phylogenetic models to focus on stochastic population dynamics.  While the details of this project are described in my practicum evaluation, the mathematical and computational tools I learned in the process have found surprisingly apt applications in my phylogenetics research, where they have helped me solve a key problem in my thesis.  Since this breakthrough, I have been focused on writing up two manuscripts which have been made possible by this step forward.&lt;/p&gt;
&lt;p&gt;As my computational needs surpass what is readily available through my lab servers, I have learned to leverage Amazon’s cloud computing for rapid deployment of large-scale simulations and analyses. Overall, this has been a productive year, translating what I’ve learned in my POS classes into practical research experience and making some important steps in my thesis.  I look forward to the next year of synthesizing and writing up these results and continuing to build on the methods and tools I’ve learned and developed.&lt;/p&gt;
&lt;h4 id=&quot;describe-concisely-what-you-regard-as-the-most-interesting-and-innovative-aspects-of-your-current-research-with-special-emphasis-on-computational-science.&quot;&gt;describe concisely what you regard as the most interesting and innovative aspects of your current research, with special emphasis on computational science.&lt;/h4&gt;
&lt;p&gt;My research combines the recent explosion of data available through gene sequencing and subsequent readily available phylogenetic information with the power of high-performance computational approaches to “replay the tape” of evolution to better understand the origins and maintenance of biodiversity.&lt;/p&gt;
&lt;p&gt;Genetic data paved the way to phylogenetic inference, the mapping of ancestor-descendant relationships between the species living today.  These phylogenies become my periscope into the past.  In the absence of fossils, I can simulate different evolutionary models of selection on various traits retracing the phylogenetic tree to discover which models are most consistent with the patterns in species we observe today. By running the stochastic simulation repeatedly, I can create not only one possible outcome, but the parameter space of all possible outcomes and their associated probabilities.  This planet has run the experiment of evolution only once, but using this computationally intensive approach I can run that process over and over again under different assumptions, allowing me to explore evolutionary questions that can be answered no other way.&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;my-own-reflections-and-list&quot;&gt;My own reflections and list&lt;/h3&gt;
&lt;p&gt;Hmm, the research summary with computational emphasis is kinda vague, but aiming for a non-specialist audience.  Hard to differentiate between the aspects that really leverage HPC and those that can be adequately run at the desktop level.  Is that really the best statement of my accomplishments?  I might try a different format for myself:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Formulated and explored implications of my phylogenetic Monte Carlo approach.  Formulated throughout the Spring quarter, been writing and rewriting the manuscript most of this past Fall.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Derived and implemented the heterogeneous alpha/sigma model (in a few busy days and a long train ride in July, waiting to write up after PMC is done)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Used said model and phylogenetic Monte Carlo to demonstrate clear release-of-constraint in the Labrid data&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Exploring better early warning signal models and detection methods.  Settled on linearized models of the canonical form of two bifurcation types, identifying warning signals directly by a similar Monte Carlo test to the phylogenetics example.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Explored stochastic population dynamics in structured populations via the ELPA tribolium model.  Negative feedbacks mean no large-amplification demographic noise, but cycles do break down the linear noise approximation.  (a few weeks in May and June)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rebuilt the Adaptive Dynamics code to illustrate how time to branching and coexistence times vary in parameter space (auto-generation of the butterfly plots, mostly two weeks in April)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Began my open lab notebook (starting in January on OWW, migrated to Wordpress in Sept), public code hosting (initially google code, moved to github in March), Mendeley database (Oct ’09), Flickr only this Oct, and social media for science (Twitter only since July, though have used FF since the beginning of the year).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Started AWS/cloud computing.  Still coding in C but using R more, parallelization in R’s snowfall.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this spirit, Mendeley provides some easy data on what I’ve been reading:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5286/5287843580_481f529fc1_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Interesting if not too surprising that my most popular authors are all advisors of mine, except Losos.  (Also it’s really obvious where I twice deleted my Mendeley database and needed their help support to recover my data… in only a few days).&lt;/p&gt;
&lt;p&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing, Cloud Computing, and #scio11</title>
	 <link href="/2010/12/23/writing-cloud-computing-and-scio11.html"/>
   <updated>2010-12-23T19:08:58+00:00</updated>
   <id>/12/23/writing-cloud-computing-and-scio11</id>
   <content type="html">&lt;p&gt;Working on a few things in today’s lab notebook entry.  Some more notes on exploring cloud computing tools, sketching out some ideas for my #scio11 science online panel discussion on open notebook science, and otherwise working on my phylogenetics mansucript.&lt;/p&gt;
&lt;h3 id=&quot;cloud-computing&quot;&gt;Cloud Computing&lt;/h3&gt;
&lt;p&gt;An interesting package was &lt;a href=&quot;https://stat.ethz.ch/pipermail/r-sig-hpc/2010-December/000877.html&quot;&gt;announced over the r-sig-hpc&lt;/a&gt; list today, creating an arbitrarily large Hadoop cluster out of Amazon EC2 instances directly from the R command line. JD Long has been very responsive to my naive questions on setting it up, so I was able to quickly activate an Elastic Map Reduce account via Amazon Web Services and run the example code. It installs an instance of R on each cluster at the time of launch, so it takes a moment to initialize and I’m not sure if it can handle calls in the parallel code that call other libraries (unless perhaps these are explicitly loaded in the parallel function?) The code essentially provides a parallel (elastic map reduce) version of lapply, running the instances on different machines (EC2 instances) and then sewing the answers back together.&lt;/p&gt;
&lt;p&gt;As the interface is delightfully simple, could possibly be useful even to run single amazon instances. Simply set credentials, initialize a cluster of specified size and instance type, and then call the parallel lapply:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;setCredentials(&amp;quot;yourKey&amp;quot;, &amp;quot;yourSecretKey&amp;quot;, setEnvironmentVariables=TRUE)
myCluster &amp;lt;- createCluster(numInstances=5)
emrlapply(...)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Look forward to learning more about the package, EMR, and testing it out. Code available through &lt;a href=&quot;http://code.google.com/p/segue/&quot;&gt;Google code hosting&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;science-online-2011&quot;&gt;Science Online 2011&lt;/h3&gt;
&lt;p&gt;Getting ready for Science Online Conference. Finalizing room share with Mark Hahnel and touching base with Jean-Claude Bradley and Tony Williams about our panel on Open Notebook Science. Jean-Claude describes that we’ll have a short introduction before launching into the panel discussion. His introduction will focus on how and why they can convert ONS data to web services (like ChemSpider, which Tony represents). Provide a nice parallel to what I’m trying to do integrating this notebook into web services. Using this notebook space to brainstorm a bit what I can contribute/would like to cover in the session.&lt;/p&gt;
&lt;p&gt;Think my intro will try to highlight these three things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Open Notebook Science for Theorists&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As theorists, it should be easier for us to keep electronic lab notebooks than for empiricists. We can blithely ignore all those discussions about having a laptops or ipads to write at the bench or gloves-on or gloves-off keyboards. We have a machine within easy reach. Most of the computational work is done on the computer already, where software solutions can track progress and changes automatically. and yet… it isn’t.&lt;/p&gt;
&lt;p&gt;Perhaps the primary problem is that we’re not taught to keep lab notebooks in the first place. It might help if students in the sciences were taught software development practices like version managing, but we’re not. Capturing the abstract parts of theory is even harder. I don’t really know what the workflow of other theorists in my field looks like, even for people I work with closely. I guess that’s part of my desire to create an open notebook.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Open Notebook Science from the perspective of a student&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I started practicing open notebook science as a third year graduate student without input for or against the idea from my advisor or anyone else at my institution. I suppose there are a variety of stages or positions from which someone might first start an open lab notebook, and a variety of ways to do it. Each face a rather different set of challenges, and perhaps I can offer something of the student perspective.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Integration of web services relevant to theory and computing&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Integrating databases such as flickr/github/mendeley, now also Amazon web services; hopefully the databases like dryad eventually.  I’m interested to learn about the more mature models of integrating with external databases and how to make the most of this.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The social dimension&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I’ve described my efforts as a “social lab notebook.” That’s a little ambitious for something that no one else reads, let alone comments. But it’s a design principle of sorts.  I’m interested in how to do this effectively, and what potential it has to make better, faster, and farther reaching science.&lt;/p&gt;
&lt;h3 id=&quot;writing&quot;&gt;Writing&lt;/h3&gt;
&lt;p&gt;Also continuing my phylogenetics writing today, working on explaining the models.  (current version of &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/53df70adad4e5c39e3a6caa7ed5684c6c036d32e#diff-0&quot;&gt;manuscript .tex file&lt;/a&gt; in github Phylogenetics repository).&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Sun: Visualizing my coding over the past year</title>
	 <link href="/2010/12/20/sun-visualizing-my-coding-over-the-past-year.html"/>
   <updated>2010-12-20T00:05:10+00:00</updated>
   <id>/12/20/sun-visualizing-my-coding-over-the-past-year</id>
   <content type="html">&lt;p&gt;Not really working today, as holidays approach, but came across the Gource toolkit for creating video visualization from git development (inspired by the &lt;a href=&quot;http://vimeo.com/17919684&quot;&gt;Mendeley’s example&lt;/a&gt;). So in the spirit of year-in-review reflections, here’s my development from the past year (just for the phylogenetic statistics work).&lt;/p&gt;
&lt;p&gt;Quality is a little too poor to read file names, more entertaining than practical. Other user icons appear in December corresponding with my move to running the code from Amazon cloud. The lower cluster includes the demos directory, the upper the R code, so gives some indication of extensions to methods vs testing applications. Captures my bursty code development, though perhaps not as well as the &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/graphs/impact&quot;&gt;github graphs&lt;/a&gt;.&lt;/p&gt;
&lt;h5 id=&quot;notes-for-making-the-video&quot;&gt;Notes for making the video&lt;/h5&gt;
&lt;p&gt;A couple steps. First just running gource (in ubuntu universe repositories) on the repository directory launches the video, used gtk-recordMyDesktop to capture the film (no luck with piping to ffmpeg). Then truncated, changed format, uploaded to youtube. Truncation and format conversion are simple bash commands:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Shorten film 
 ffmpeg -sameq -ss 0 -t 900 -i testvideo.ogv gource.ogv
# convert to avi
 mencoder gource.ogv -nosound -ovc xvid -xvidencopts pass=1 -o gource.avi&lt;/code&gt;&lt;/pre&gt;
</content>
 </entry>
 
 <entry>
   <title>Thurs: writing section on comparing to AIC</title>
	 <link href="/2010/12/16/thurs-writing-section-on-comparing-to-aic.html"/>
   <updated>2010-12-16T22:50:53+00:00</updated>
   <id>/12/16/thurs-writing-section-on-comparing-to-aic</id>
   <content type="html">&lt;p&gt;Phylogenetics writing still continues.&lt;/p&gt;
&lt;p&gt;AIC Error rates&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5285/5268276442_c11b2e35ee_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Choosing by  having &amp;lt; 5% probability of rejecting the simpler model when it is true.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5241/5267683944_357ccec396_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Choosing the equal-likelihood division:&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Weds: Example sets & more EC2</title>
	 <link href="/2010/12/15/weds-example-sets-more-ec2.html"/>
   <updated>2010-12-15T16:24:46+00:00</updated>
   <id>/12/15/weds-example-sets-more-ec2</id>
   <content type="html">&lt;p&gt;A bit delayed from having to rerun analyses on EC2 (still learning…)  More to run today (lambda trials for Anoles – should really recode this in C!).&lt;/p&gt;
&lt;p&gt;Trying to decide if its best to start off with the power curves and work backwards or build up from the basics.  Probably doesn’t matter too much which.  Also figuring out which examples to present first:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5242/5263820373_02efaa1914_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5090/5264430268_9412864b00_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5203/5264430326_20b913b142_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5126/5263820365_928bfd6ab9_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5121/5263820413_5b046c77be_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Where the painted trees are the following:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5085/5267465400_1a6680e7a1_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;ec2-updates&quot;&gt;EC2 Updates&lt;/h3&gt;
&lt;p&gt;Deleted older ami.  Updating the current ami with personal configurations.  Current ami-c14b1b84 may become the public ami (needs a little extending still, at least libgsl0-dev), but will work from newer ami with secure info already in place to save startup time.  Surprisingly, launching by commandline actually looks more cumbersome than the GUI.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ec2-run-instances &amp;lt;AMI-#&amp;gt; -t &amp;lt;TYPE&amp;gt;
ec2-describe-instances &amp;lt;Instance ID&amp;gt;
ssh -i &amp;lt;KEY&amp;gt; &amp;lt;Public Address&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Where types indicate the size of the instance.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5289/5264139125_9a973b9d2e_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;http://aws.amazon.com/ec2/instance-types/&quot;&gt;more detailed descriptions here&lt;/a&gt;).  You need to use the output of the first line to get the instance id number, whose output includes the the public address.  You’ll also need to open the ports on the (default) security group if you haven’t done so.  See example in &lt;a href=&quot;http://docs.amazonwebservices.com/AWSEC2/2007-08-29/GettingStartedGuide/running-an-instance.html&quot;&gt;EC2 guide.&lt;/a&gt; Suppose a script could be wrapped around this to run and log into the instance…&lt;/p&gt;
&lt;p&gt;What’s with the compute units?  A way of comparing processor power, a faster processor may be worth multiple units.  (basically is comparison to single core 2007 1Ghz xeon processor…)&lt;/p&gt;
&lt;p&gt;Still need a solution to bring instances down when they finish (well, still need more automated cleanup/copying data out too…) so I’m not paying for extra cycles while I’m asleep and my jobs have already finished.  Deepak suggested looking into Amazon’s SNS (notifications) and SQS (queues), but haven’t figured these out.  Twitter works as a pretty good notification system for mobile-accessible simulation updates.  Can’t use the ssh client (at least not without first ssh-ing to a local machine).   &lt;a href=&quot;http://www.9apps.net/decaf-ec2-client/&quot;&gt;Not free, but may need to try EC2 Android app.&lt;/a&gt; Tried accessing the web console in the mobile browser , a bit slow and cumbersome and doesn’t list my current instances… curious.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tues: evolution thoughts while writing...</title>
	 <link href="/2010/12/14/tues-phylogenetics-thoughts-while-writing.html"/>
   <updated>2010-12-14T17:06:57+00:00</updated>
   <id>/12/14/tues-phylogenetics-thoughts-while-writing</id>
   <content type="html">&lt;p&gt;Again spending most of the day writing. (Maybe) processing some ideas in writing by writing in my notebook as I make my edits.&lt;/p&gt;
&lt;h5 id=&quot;ideas-im-trying-to-get-across-in-todays-edits&quot;&gt;Ideas I’m trying to get across in today’s edits&lt;/h5&gt;
&lt;p&gt;Parameter estimation is more demanding of the data than model choice.  Knowing if a value is different from zero is easier than knowing what it is.&lt;/p&gt;
&lt;h3 id=&quot;code-updates-to-do&quot;&gt;Code updates to-do&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Need to add S3 wrapper functions for ouch so both can call montecarlotest() in the pmc package. OUCH test currently uses the older power_between_models() test in phyloniche package.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Check that plot.pow() can turn off the null distribution and the data line&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Delete old amazon image&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Add libgsl0-dev to amazon image&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Add pageup recursive history search to amazon image&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Complete and secure a basic setup as the public image&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Setup a private image with security configurations to avoid repeating all the steps below.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;amazon-notes&quot;&gt;Amazon Notes&lt;/h3&gt;
&lt;p&gt;Running on cluster steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Copy over .flickrrc and hpc-autotweets, move latter  to /usr/local/bin&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;configure git: copy .ssh/id_rsa and id_rsa.pub to ec2 .ssh&lt;/p&gt;
&lt;p&gt;git config –global user.name cboettig git config –global user.email cboettig@gmail.com&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Then initiate and pull repository:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git init .
git pull git@github....
git remote add origin git@github....&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Can push back git push now.  last step means don’t have to add git@github…  after the push command.  Does mean git pull won’t run, need git pull origin master.&lt;/p&gt;
&lt;p&gt;Also update the local dev copy to avoid conflicts&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git pull origin master&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Install and run package!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Troubleshooting: git add needs a force to add .Rdat over the .gitignore list.  Also, in-script pushes aren’t working since they need the password.  Somehow the gitup() file doesn’t write the actual data – due to function warpper?  Have to save externally.&lt;/p&gt;
&lt;h3 id=&quot;misc-notes&quot;&gt;MISC Notes&lt;/h3&gt;
&lt;p&gt;Fantastic Mendeley group on all &lt;a href=&quot;http://www.mendeley.com/groups/734351/treebase/&quot;&gt;the papers in TreeBASE&lt;/a&gt;, well curated: from Rod Page&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;My initial goal is to clean up this list, add missing DOIs and PubMed identifiers, fix incorrect metadata, etc. Once we have PubMed ids we can retrieve sequences for individual TreeBASE studies, as well as NCBI taxids. Sequences may include geo-coordinates (for sequences or associated specimens), so we can build maps and query TreeBASE geographically. NCBI taxids (which TreeBASE already has for some taxa) enable queries using the taxonomic hierarchy. All obvious stuff, but hard to do unless the bibliographic data is in better shape.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Also thinking about how to promote a community discussion on the issues I’m trying to raise in this paper and a smaller unit of publishing.  The r-sig-phylo mailing list has provided some excellent discussions of technical pitfalls before.&lt;/p&gt;
&lt;p&gt;Should paper focus on interesting and clear or on comprehensive and technical? Can other channels accomplish the former?&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Back to Writing</title>
	 <link href="/2010/12/13/back-to-writing.html"/>
   <updated>2010-12-13T10:56:09+00:00</updated>
   <id>/12/13/back-to-writing</id>
   <content type="html">
</content>
 </entry>
 
 <entry>
   <title>Citations</title>
	 <link href="/2010/12/11/citations.html"/>
   <updated>2010-12-11T07:06:22+00:00</updated>
   <id>/12/11/citations</id>
   <content type="html">&lt;p&gt;This evening I’m testing extensions to find a better way to include citations in my entries. Thus far I’ve use Mendeley’s convenient copy-paste citation tool to paste the whole citation in, which I suppose could work reasonably smoothly with the nice &lt;a href=&quot;http://&quot;&gt;footnotes plugin&lt;/a&gt; I recently adopted. However, this still requires a couple more steps than I need to cite in my LaTeX text editor or in OpenOffice.&lt;/p&gt;
&lt;p&gt;Using the &lt;a href=&quot;http://wordpress.org/extend/plugins/papercite&quot;&gt;papercite plugin&lt;/a&gt;, I can add citations to posts in much the same way that I add them to my latex documents, using the citation key created Mendeley when it makes my bibtex file. The plugin allows footnote style citations as well as directly embedding the full citation, and supports a few common formats. It does have some limitations: it requires manually syncing a copy of bibtex file to my host server; though it can use a url with bibsonomy or citeulike. I can’t hide the “show bibtex” option or the bibtex citation key, and it doesn’t make the footnote symbols into links. Rather nice that it includes the url link, though would prefer it did so by linking the title text rather than creating an icon.&lt;/p&gt;
&lt;h2 id=&quot;going-further&quot;&gt;Going further&lt;/h2&gt;
&lt;p&gt;Started thinking about this after reading a nice &lt;a href=&quot;http://blogs.plos.org/mfenner/2010/12/05/blogging-beyond-the-pdf/&quot;&gt;piece by Martin Fenner&lt;/a&gt; on some advantages of Wordpress over pdfs. I’m interested in more general solutions that would work in any text-edit space, allowing citations in comment boxes, etc. I’m also exploring these ideas in &lt;a href=&quot;http://friendfeed.com/science-2-0/deef8494/how-do-you-manage-citations-when-writing-on-web&quot;&gt;a FF discussion group&lt;/a&gt;. The other key question I think is what the citation should link back to, in a way that the link can be tracked. Thoughts?&lt;/p&gt;
&lt;h2 id=&quot;examples-using-papercite&quot;&gt;Examples using papercite&lt;/h2&gt;
&lt;p&gt;Setup:&lt;/p&gt;
&lt;blockquote&gt;

&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Create a folder in &lt;code&gt;wp-content/papercite-data&lt;/code&gt;, with two subfolders: &lt;code&gt;bib&lt;/code&gt; (this will contain the bibtex files) and &lt;code&gt;pdf&lt;/code&gt; (this will contain the PDF file).&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;ol start=&quot;2&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Copy your bibtex files into the &lt;code&gt;bib&lt;/code&gt; folder, and your pdf files into the &lt;code&gt;pdf&lt;/code&gt; folder. To match a bibtex entry with a PDF file, the PDF file should have be named &lt;strong&gt;KEY&lt;/strong&gt;&lt;code&gt;.pdf&lt;/code&gt; where &lt;strong&gt;KEY&lt;/strong&gt; is the bibtex key in lowercase, where &lt;code&gt;:&lt;/code&gt; and &lt;code&gt;/&lt;/code&gt; have been replaced by &lt;code&gt;-&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;[bibtex file=library.bib key=Clark2007]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Citing an individual file from the full bibliography file: [bibtex file=library.bib key=Clark2007]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[bibshow file=Publications.bib]
This sentence cites the work in [bibcite key=Boettiger2010]
[/bibshow]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;[bibshow file=Publications.bib] This sentence cites the work in [bibcite key=Boettiger2010], and puts the citation information when it encounters the close of bibshow code. [/bibshow]&lt;/p&gt;
&lt;h4 id=&quot;including-a-complete-bibtex-bibliography&quot;&gt;Including a complete bibtex bibliography&lt;/h4&gt;
&lt;p&gt;(Using my publications list. Don’t try this with very large bib files: it will run out of memory!)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[bibtex file=Publications.bib]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;[bibtex file=Publications.bib]&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;Create a folder in &lt;code&gt;wp-content/papercite-data&lt;/code&gt;, with two subfolders: &lt;code&gt;bib&lt;/code&gt; (this will contain the bibtex files) and &lt;code&gt;pdf&lt;/code&gt; (this will contain the PDF file).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Copy your bibtex files into the &lt;code&gt;bib&lt;/code&gt; folder, and your pdf files into the &lt;code&gt;pdf&lt;/code&gt; folder. To match a bibtex entry with a PDF file, the PDF file should have be named &lt;strong&gt;KEY&lt;/strong&gt;&lt;code&gt;.pdf&lt;/code&gt; where &lt;strong&gt;KEY&lt;/strong&gt; is the bibtex key in lowercase, where &lt;code&gt;:&lt;/code&gt; and &lt;code&gt;/&lt;/code&gt; have been replaced by &lt;code&gt;-&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</content>
 </entry>
 
 <entry>
   <title>socialR: Reproducible Research & Notebook integration with R</title>
	 <link href="/2010/12/11/socialr-an-r-package-to-track-the-status-of-computations-with-social-network-tools.html"/>
   <updated>2010-12-11T03:44:54+00:00</updated>
   <id>/12/11/socialr-an-r-package-to-track-the-status-of-computations-with-social-network-tools</id>
   <content type="html">&lt;p&gt;I’ve created an R package that uses social media tools for reproducible research.  The goal of the package is this: whenever I run a code, output figures are automatically added to my figure repository (Flickr), linked to the timestamped version of the code that produced them in the code repository.  Figures should be tagged by project and be embedded selectively or automatically into this lab notebook.  The basic workflow of the notebook looks like this:[ref]Diagram of my notebook as presented at Science Online, 2011, see other slides in my &lt;a href=&quot;http://www.carlboettiger.info/archives/792&quot;&gt;entry on this&lt;/a&gt;.[/ref]&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5259/5471680767_34c350314e_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;To do this, I use a few simple R functions that I wrap around  the system command-line programs git, flickr_upload, and hpc-autotweets to enable monitoring of my simulations through social media. The package has it’s own &lt;a href=&quot;https://github.com/cboettig/socialR&quot;&gt;git repository here&lt;/a&gt;.  This is a rather custom development to make for rapid deployment on my own machines, and depends largely on Linux tools external to R, so it may not be easily deployed by others.  See my earlier post, &lt;a href=&quot;http://www.carlboettiger.info/archives/375&quot;&gt;Making R Twitter&lt;/a&gt;, for examples and back story.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4112/5196584707_663796eb6e_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;basic-features&quot;&gt;Basic Features&lt;/h2&gt;
&lt;p&gt;All of these tasks are run by wrapping any plot command with my command “social_plot()”&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Push the running code version to Github.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Grab the git hashtag to reference this version of the code.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Push figures to Flickr as they complete.  Tags images appropriately and provide link to the code (version-stable, on Github) that produces them in the description.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Tweet notification of a figure upload, parameter values, links to code, and timestamp.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Tweet when an error occurs.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;setup-install&quot;&gt;Setup / Install&lt;/h2&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;Create a flickr account (need not be unique for the computer).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create a twitter account (preferably separate one for the machine).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Install &lt;a href=&quot;http://search.cpan.org/~cpb/Flickr-Upload/flickr_upload&quot;&gt;flickr_upload&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;; sudo apt-get install libflickr-upload-perl&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Install &lt;a href=&quot;https://github.com/joshthecoder/tweepy/blob/master/INSTALL&quot;&gt;tweepy&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;easy_install tweepy&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;(See link for more detailed instructions)&lt;/p&gt;
&lt;ol start=&quot;5&quot; type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://search.cpan.org/~cpb/Flickr-Upload/flickr_upload#___top&quot;&gt;Configure flickr_upload credentials&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://jeffmiller.github.com/2010/05/31/twitter-from-the-command-line-in-python-using-oauth&quot;&gt;Configure OAuth for tweepy&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;future-modifications&quot;&gt;Future modifications&lt;/h2&gt;
&lt;p&gt;Current program relies entirely on external command-line tools. Probably no easy solution to make this package self-contained and cross platform.  Still, a good bit of functionality can be added:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Add option to include the git log message.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Smart/more informative git commit messages&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Add option/default to use truncated git commit ID numbers&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Make Flickr discription actually link directly to code.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Make twitter statements include urls/actual links (to code, files)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Identify machine credentials?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Documentation still needed&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Should verify if the git version is current&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Grab a DOI for the object (i.e. using EZID from UC3?)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning signals manuscript</title>
	 <link href="/2010/12/10/warning-signals-manuscript.html"/>
   <updated>2010-12-10T21:10:38+00:00</updated>
   <id>/12/10/warning-signals-manuscript</id>
   <content type="html">&lt;p&gt;Meeting with Alan today to discuss outline.  Came up with basic break-down of paragraphs:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;Intro/Abstract&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Scope: Previous work, scope simple example existence of warning signal/CSD is clear.  Identifiability/Power not clear. Mention the issue of Replicates&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Nonlinearity not observed with infinite data&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;reasons detection fails: Identifiability issue &amp;amp; Power issue.  Example signal that exists but inadequate power to detect?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Eigenvalue story&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Probability of data vs Probability of a statistic&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Simulation example&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Summarize results&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;More knowledge of system help choose the right nonlinear model corresponding to the system.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Conclusions&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;(Linear/nonlinear estimation analogous to parameterized estimation of tails of distribution vs non-par)&lt;/p&gt;
&lt;p&gt;Theoretical mathematics question: Existence Statistical Question: Identifiable, Power&lt;/p&gt;
&lt;h2 id=&quot;continued-progress&quot;&gt;Continued progress&lt;/h2&gt;
&lt;p&gt;Setting up more exploratory simulations and writing.  Simulation speed is quite limiting at the moment.  May need to move likelihood calculations into C.&lt;/p&gt;
&lt;h2 id=&quot;other-notes&quot;&gt;OTher Notes&lt;/h2&gt;
&lt;p&gt;Some discussion of plans for a workshop on NSF data sharing.  Alan raises several good points:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Theoretical ecology policy should include a policy on code&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;How about large data-sets separate from publications, i.e. NEON?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Dave Schimmel NEON – Open Data&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Exploring Power in Warning Signals</title>
	 <link href="/2010/12/09/exploring-power-in-warning-signals.html"/>
   <updated>2010-12-09T23:03:40+00:00</updated>
   <id>/12/09/exploring-power-in-warning-signals</id>
   <content type="html">&lt;p&gt;Started trying to get the power curves for sample-size and rate of change.  Currently focusing on the transcritical bifurcation model.  This first pass uses just 100 replicates, which appears to be not nearly enough.  Need some troubleshooting on handling to get power curves out.  Scroll through, the set has 65 different images:&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“stochpowercurvesslides”]&lt;/p&gt;
&lt;p&gt;(code ids in image discription, compare to structured-popultions git log.  )&lt;/p&gt;
&lt;p&gt;Includes plots of the timeseries, giving a visual clue of how dramatic the warning signal is under each case.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Practice SICB Presentation</title>
	 <link href="/2010/12/08/practice-sicb-presentation.html"/>
   <updated>2010-12-08T22:21:34+00:00</updated>
   <id>/12/08/practice-sicb-presentation</id>
   <content type="html">&lt;p&gt;Gave my practice talk for Society for Integrative and Comparative Biology in Wainwright lab this afternoon, after (not quite) finishing the presentation.  Trying to figure out the best way to introduce these ideas to a broad audience (same challenge as with the manuscript).&lt;/p&gt;
&lt;p&gt;Talk storyboard:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5126/5246517453_acd44df8df_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Looking at &lt;a href=&quot;http://www.sicb.org/meetings/2011/schedule/results.php3?search=sday+%3D+%272011-01-04%27+AND+%28abstracts2011.sessionnumber+NOT+LIKE+%27S%25%27%29+AND+%28abstracts2011.sessionnumber+NOT+LIKE+%27P%25%27%29%29&quot;&gt;other talks in my session&lt;/a&gt;: Macroevolution I - Methods and Character Evolution, looks like a reasonably sophisticated group.&lt;/p&gt;
&lt;h3 id=&quot;good-feedback-from-the-wainwright-lab&quot;&gt;Good feedback from the Wainwright Lab:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Emphasize:  Currently we worry that we don’t have the right models.  Should worry that we don’t have the power to know if we have the right models.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Avoid the first person plural!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Focus on slow and careful explanation of phylogenetic signal and lambda&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;More time on step by step creation of graphs / phylogenetic Monte Carlo&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Repeat theme more, emphasize importance of qualifying power.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The power curves figure is probably the most exciting concept&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Keep the message positive: the future is in big trees&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Mention software package in passing, PMC&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Under-emphasize AIC.  Can say in passing: “We know it doesn’t work for phylogenies, and we can see it in these examples.  It’s not appropriate.”&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Mapping out SICB Presentation: Is your phylogeny informative?</title>
	 <link href="/2010/12/07/mapping-out-sicb-presentation-is-your-phylogeny-informative.html"/>
   <updated>2010-12-07T22:42:08+00:00</updated>
   <id>/12/07/mapping-out-sicb-presentation-is-your-phylogeny-informative</id>
   <content type="html">&lt;p&gt;Assembling material/outline for my SICB presentation in January, will be giving a practice talk in the Wainwright lab on Wednesday. 15 minute presentation with 5 minutes for questions.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Designing presentation in “storyboard” format in Inkscape.  Will figure out if I convert to slides or not.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Simulations under the Anoles dataset to show posterior distributions of lambda.  Exploring the connection between the likelihood of a parameter under each model to that of the distributions of the likelihood ratio.  Clearly more valuable to look at likelihood of the whole data than that of a (not necessarily good) summary statistic (model parameter that isn’t a sufficient statistic).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;To that effect, I’ve added the ability to estimate likelihood of a parameter under the alternative model, rather than just bootstrapping parameters directly.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Have also begun developing socialR package to handle the social reporting functions more smoothly.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;See github and flickr logs for today for more details.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>follow up from Fri discussions: Revisiting post-predictive evaluation</title>
	 <link href="/2010/12/06/follow-up-from-fri-discussions-revisiting-post-predictive-evaluation.html"/>
   <updated>2010-12-06T21:24:00+00:00</updated>
   <id>/12/06/follow-up-from-fri-discussions-revisiting-post-predictive-evaluation</id>
   <content type="html">&lt;p&gt;A few weeks ago, a seminar prompted me to take a closer look at a particular post-predictive evaluation technique applied reasonably often in our recent literature,&lt;a href=&quot;http://www.carlboettiger.info/archives/299&quot;&gt;see earlier entry&lt;/a&gt;.  I think by phrasing the approach more concisely and precisely it will be clear what the difficulty is.&lt;/p&gt;
&lt;p&gt;As usual, we consider some data $ X$ and a set of $ N$ models specified by parameters, $ _1, _2, _N$, then we can express the likelihood of the model as the probability of the data under the given model and parameter values:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ L(\vec \theta_i) = P(\vec X|\vec \theta_i) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;From this object we could take a Bayesian approach, but we will simply maximize the likelihood through appropriate choice of $ theta_i$ for each model $ i $.  Now we might compare these models by an information criterion applied to the likelihood estimates, or more completely by the Monte Carlo approach I’ve been working on in these pages.  Instead of these standard approaches though, we look in this entry at this post-predictive evaluation idea.&lt;/p&gt;
&lt;p&gt;Post-predictive evaluation does the following.  Imagine we can compute some statistic on the data[ref] I drop the explicit vector notation for simplicity[/ref], &lt;span class=&quot;math&quot;&gt;\[ \mu = f(X)\]&lt;/span&gt;.  We may imagine this statistic as a scalar (such as the mean), though this is not strictly necessary.  Having fit our models to maximize &lt;span class=&quot;math&quot;&gt;\[ P(X|\theta) \]&lt;/span&gt;, we could compare the probabilities of observing this statistic under the model, &lt;span class=&quot;math&quot;&gt;\[ P(f(X) | \theta) \]&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Now it is patently obvious that maximizing $ P(X|) $ will generally be different than maximizing $ P(f(X) | )$, so that the most likely model need not be the best performing under the statistic.  Does that give us any reason to suspect that having fit the models by maximum likelihood, the one with the maximum probability of recovering this statistic is the best? [ref] Maximizing goes for the mode of  $ P(f(X)|)$, we might also compare the observed $ f(X)$ to the expected value, $ E(P(f(X)|) ) $ (mean instead of mode).  [/ref]&lt;/p&gt;
&lt;p&gt;Certainly not.  There is no reason why recovering this particular statistic should be considered more important than recovering the entire data, nor any reason to believe that performance in one is a good proxy for performance in the other.  Trivial counter-examples of models who recover the statistic well but do not match the data are easy.  As are overfit models that do well on both.  [ref] Note that in a likelihood approach, overfitting doesn’t have the same notion as as it does in least-squares or other regression fitting, since it must explicitly specify the probability.  That means that the expectation need not do well even when the model is very overfit.  [/ref]&lt;/p&gt;
&lt;p&gt;Despite this, it is a very interesting question to turn on its head.  I was somewhat disappointed a few weeks ago when in doing the calculation for a simple example I realized that maximizing $ P(f(x) | )$ gave almost the same parameter estimates for $ P(X | )$.  It was only in sitting in Monte Carlo discussion Friday with Bruce Rannala, Brian Moore and a few students that I realized the significance of this calculation.  Where $ f(x) =N$ number of species represented, a large disparity between these would indicate that the phylogeny was quite informative.  For the quantities to be very similar indicates that the information comes almost entirely simply from the number of data points.  This is quite worrying in a paradigm where we spend great effort making sure the phylogeny is estimated accurately and less effort making sure it is sampled completely.&lt;/p&gt;
&lt;h2 id=&quot;where-to&quot;&gt;Where to?&lt;/h2&gt;
&lt;p&gt;I think it worth developing both of these lines of thought a little further:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The “Rabosky question:”  $ P(f(X) | ) P(X | )$&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The “Rannala question:” $ P(f(X) | ) P(X | )$&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the second case, $ f(X) $ is almost a (set of) sufficient statistic(s) for X, in which case it would not matter what we use, but we should treat them the same way (i.e. penalizing model complexity appropriately, in either information criteria, Monte Carlo, Bayesian approach).  To do Bayesian inference on the set of statistics $ f(X) $ is the basis of Approximate Bayesian Computing, ABC.  In the first case, $ f(X)$ is nowhere near a sufficient statistic, and we should not prefer models matching this statistic as a guarantee that those models have higher likelihood.&lt;/p&gt;
&lt;p&gt;Will try and return to these ideas once I’ve wrapped up the manuscript and presentation on “are phylogenies informative” and “are warning signals informative?”&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Identifying Warning Signals</title>
	 <link href="/2010/12/04/identifying-warning-signals.html"/>
   <updated>2010-12-04T22:41:08+00:00</updated>
   <id>/12/04/identifying-warning-signals</id>
   <content type="html">&lt;p&gt;Updated methods for the Monte Carlo estimate of the distributions of likelihood ratios completed on Wednesday this week, modulo some troubleshooting of code.  Now exploring the parameter range in which warning signals can be identified with accurate power.  Individual power tests provide a good start, but remains to generate power curves for each bifurcation type by magnitude of the loss of stability, length/duration of the timeseries and the sampling frequency.&lt;/p&gt;
&lt;p&gt;So far have only applied to the transcritical bifurcation, and without data simulated from the individual-based model.&lt;/p&gt;
&lt;p&gt;While estimating the actual  rate at which stability is being lost seems like it may be rather uncertain exercise, it appears that the method has rather adequate power to detect a loss of stability in cases where it may not be immediately apparent by visual inspection of the data:&lt;/p&gt;
&lt;p&gt;Here the parameter r changes from 50 to 41 over t=(0,10), N=500 and the weakening stability is clearly detected:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5042/5231440891_7317570f4c_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5050/5232032422_93a7cbfb34_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/structured-populations/commit/dafe6c29f0343cc67165ac2fa32f9dfec4dc4b8b&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;While very weak warning signals face intrinsic limitations to detection with finite data.  Here r changes from 1 to .9 over t=(0,1), N=500:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5163/5227625894_e2650e302d_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/structured-populations/blob/45bb7cd409a6311f173e8e2b94bb55460417ee14/warningsignals/demos/lin_bifur_models.R&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Of course comparison needs a reduction of dimensionality, as r and T=max(t) both reflect timescales.&lt;/p&gt;
&lt;p&gt;Coming up:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Saddle Node Bifurcation example&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Power Curves for N, range of R (mT)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Thoughts on the New Policies for Data Archiving at NSF and in Common Journals</title>
	 <link href="/2010/12/03/nsf-and-journal-data-archiving.html"/>
   <updated>2010-12-03T19:08:53+00:00</updated>
   <id>/12/03/nsf-and-journal-data-archiving</id>
   <content type="html">&lt;p&gt;This post is a work in progress, a scratch pad for me to start assembling what I’ve been learning about and resources pertaining to the new policies emerging from NSF and journals relevant to ecology and evolution.  Hoping to highlight not only the policies, but the issues, opportunities, and concerns around them.&lt;/p&gt;
&lt;p&gt;I am hoping to help organize a workshop to discuss these issues in my department this Winter.  The Davis Open Science group, is planning a series of these workshops, hoping to work with departments, the libraries and the UC Davis Office of Research and its &lt;a href=&quot;http://www.research.ucdavis.edu/home.cfm?id=OVC,10,1622,2065&quot;&gt;Responsible Conduct of Research&lt;/a&gt; program (in compliance with NIH/NSF ethics requirements), as well as resident faculty and editors.  Suggestions on what you would like to see in such a workshop much appreciated.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The Association of Research Libraries has just released a &lt;a href=&quot;http://www.arl.org/rtl/eresearch/escien/nsf/index.shtml&quot;&gt;nice guide on the new polices&lt;/a&gt; as well.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;what-are-the-new-nsf-policies&quot;&gt;What are the new NSF policies?&lt;/h2&gt;
&lt;p&gt;Each discipline has (or will have, &lt;a href=&quot;http://researchremix.wordpress.com/2010/11/15/nsf-where&quot;&gt;see notes and refs  by Heather Piwowar&lt;/a&gt; it’s own guidelines, but the basic gist is perhaps best summarized in excerpt from &lt;a href=&quot;http://www.nsf.gov/pubs/policydocs/pappguide/nsf11001/gpg_2.jsp#dmp&quot;&gt;this NSF statement&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;This supplement should describe how the proposal will conform to NSF policy on the dissemination and sharing of research results (see AAG Chapter VI.D.4 ), and may include:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;The types of data, samples, physical collections, software, curriculum materials, and other materials to be produced in the course of the project;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the standards to be used for data and metadata format and content (where existing standards are absent or deemed inadequate, this should be documented along with any proposed solutions or remedies);&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;policies for access and sharing including provisions for appropriate protection of privacy, confidentiality, security, intellectual property, or other rights or requirements;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;policies and provisions for re-use, re-distribution, and the production of derivatives; and&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;plans for archiving data, samples, and other research products, and for preservation of access to them.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Data management requirements and plans specific to the Directorate, Office, Division, Program, or other NSF unit, relevant to a proposal are available at: &lt;a href=&quot;http://www.nsf.gov/bfa/dias/policy/dmp.jsp&quot; class=&quot;uri&quot;&gt;http://www.nsf.gov/bfa/dias/policy/dmp.jsp&lt;/a&gt;. If guidance specific to the program is not available, then the requirements established in this section apply. [….] The Data Management Plan will be reviewed as an integral part of the proposal, coming under Intellectual Merit or Broader Impacts or both, as appropriate for the scientific community of relevance.&lt;/p&gt;
&lt;h2 id=&quot;what-are-the-new-requirements-being-set-by-journals&quot;&gt;What are the new requirements being set by journals?&lt;/h2&gt;
&lt;p&gt;The American Naturalist&lt;/p&gt;
&lt;p&gt;&lt;em&gt;This journal requires, as a condition for publication, that data supporting the results in the paper should be archived in an appropriate public archive, such as GenBank, TreeBASE, Dryad, or the Knowledge Network for Biocomplexity. Data are important products of the scientific enterprise, and they should be preserved and usable for decades in the future. Authors may elect to have the data publicly available at time of publication, or, if the technology of the archive allows, may opt to embargo access to the data for a period up to a year after publication. Exceptions may be granted at the discretion of the editor, especially for sensitive information such as human subject data or the location of endangered species.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Whitlock, M.C. et al. &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20073990&quot;&gt;Data archiving&lt;/a&gt;. The American Naturalist 175, 145-6(2010).&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Evolution&lt;/em&gt; has a similar policy, outlined in:&lt;/p&gt;
&lt;p&gt;Fairbairn, D.J. &lt;a href=&quot;http://doi.wiley.com/10.1111/j.1558-5646.2010.01182.x&quot;&gt;the Advent of Mandatory Data Archiving&lt;/a&gt;. Evolution (2010) (preprint)&lt;/p&gt;
&lt;p&gt;Journals with policy in place (links and editions coming)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;The American Naturalist&lt;/strong&gt; (see Whitlock, 2010; above)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Evolution&lt;/strong&gt; (see Fairbarin, 2010; above)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Journal of Evolutionary Biology&lt;/strong&gt; (as mentioned in Whitlock)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Molecular Ecology&lt;/strong&gt; (as mentioned in Whitlock)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Heredity&lt;/strong&gt; (as mentioned in Whitlock)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ESA journals: &lt;strong&gt;Ecology&lt;/strong&gt;, &lt;strong&gt;Ecological&lt;/strong&gt; &lt;strong&gt;Monographs&lt;/strong&gt;, &lt;strong&gt;Ecological&lt;/strong&gt; &lt;strong&gt;Applications&lt;/strong&gt;, and ** Frontiers**.  Currently have a position in Dryad board and a soft data deposition requirement.  Also maintains the Ecological Archive. (pers. comm.)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;what-are-the-available-archives&quot;&gt;What are the available archives?&lt;/h2&gt;
&lt;p&gt;There’s a variety of potential archives.  Identifying the best archive for the type of data involved may be complicated.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://esapubs.org/archive/default.htm&quot;&gt;ESA’s Ecological Archive&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://datadryad.org/&quot;&gt;Dryad&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.treebase.org/treebase-web/home.html&quot;&gt;TreeBASE&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.ncbi.nlm.nih.gov/genbank/&quot;&gt;GenBank&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://knb.ecoinformatics.org/index.jsp&quot;&gt;Knowledge Network for Biocomplexity&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;funding-models-concerns&quot;&gt;Funding Models &amp;amp; Concerns&lt;/h2&gt;
&lt;p&gt;Cost is a key concern: good archiving takes resources, and does little good if repositories aren’t maintained or persistent.  While the repositories are supported by their own grants (for the moment), it seems the repositories will generally charge the  journals where the publication accompanying the data will be submitted.  The journals may in turn charge the authors, who will have to write these costs into their NSF grants?&lt;/p&gt;
&lt;p&gt;Like the policies themselves, these details are still being actively worked out [ref] Todd Vision, associate director of informatics at NESCENT which oversees the Dryad project currently, discusses this in &lt;a href=&quot;http://ff.im/uGFbn&quot;&gt;this FF forum&lt;/a&gt;.  [/ref].&lt;/p&gt;
&lt;p&gt;Good references on funding models include these papers by Beagerie and others:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://bit.ly/fPX0Nm&quot;&gt;Dryad cost model potential&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.jisc.ac.uk/media/documents/publications/keepingresearchdatasafe0408.pdf&quot;&gt;a cost model for universities in the UK&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;why-archive-whats-the-added-value-of-repositories&quot;&gt;Why Archive?  What’s the added value of Repositories?&lt;/h2&gt;
&lt;p&gt;Dryad has a good explanation of &lt;a href=&quot;http://blog.datadryad.org/2010/12/02/what-happens-after-you-submit-your-data-to-dryad/&quot;&gt;what happens when data is deposited&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The need for data archiving in ecology and evolutionary biology has been persuasively argued in articles in a variety of our journals for some time.    See:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Moore, A.J. et al. &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20149022&quot;&gt;The need for archiving data in evolutionary biology.&lt;/a&gt;Journal of evolutionary biology 23, 659-60(2010).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Piwowar, H. a, Day, R.S. &amp;amp; Fridsma, D.B. &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/17375194&quot;&gt;Sharing detailed research data is associated with increased citation rate&lt;/a&gt;. PloS one 2, e308(2007).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;impact-of-sharing-and-citing-data&quot;&gt;Impact of Sharing and Citing Data&lt;/h2&gt;
&lt;p&gt;In addition to funding, primary concerns involve how data will be shared and cited.  Done well, researchers are appropriately accredited and rewarded when there data is re-used, making research faster, supported by larger data sets, more reproducible, and carrying a broader impact.  A set of articles highlights many of these issues:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;﻿﻿﻿Thorisson, G.A. &lt;a href=&quot;http://dx.doi.org/10.1038/nbt1109-984b&quot;&gt;Accreditation and attribution in data sharing&lt;/a&gt;. Nature Biotechnology 27, 984-985(2009).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sieber, J.E. &amp;amp; Trumbo, B.E. &lt;a href=&quot;http://www.springerlink.com/index/10.1007/BF02628694&quot;&gt;(Not) giving credit where credit is due: Citation of data sets&lt;/a&gt;. Science and Engineering Ethics 1, 11-20(1995).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Stodden, V. &lt;a href=&quot;http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=4720221&quot;&gt;The Legal Framework for Reproducible Scientific Research: Licensing and Copyright&lt;/a&gt;. Computing in Science &amp;amp; Engineering 11, 35-40(2009).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Gleditsch, N.P. &amp;amp; Strand, H. &lt;a href=&quot;http://www.prio.no/Research-and-Publications/Publication/?oid=55406&quot;&gt;Posting your data: will you be scooped or will you be famous?&lt;/a&gt;International Studies Perspectives 4, 89-97(2003).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;﻿Vision, T.J. &lt;a href=&quot;http://caliber.ucpress.net/doi/abs/10.1525/bio.2010.60.5.2&quot;&gt;Open Data and the Social Contract of Scientific Publishing&lt;/a&gt;. BioScience 60, 330-331(2010).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;﻿Costello, M.J. &lt;a href=&quot;http://caliber.ucpress.net/doi/abs/10.1525/bio.2009.59.5.9&quot;&gt;Motivating Online Publication of Data.&lt;/a&gt; BioScience 59, 418-427(2009).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Data citation is closely tied to the discussion of data licenses, such as CC licenses that allow conditional reuse, vs content in the public domain that can be used unconditionally. It seems data is not generally viewed by the law as a creative work but as fact, and thus not under the jurisdiction of intellectual property and copyright licenses. Acknowledging this, repositories such as Dryad identify data as Creative Commons zero, which is essentially an intentional decision to put data into the public domain. See &lt;a href=&quot;http://friendfeed.com/opensci-info/3dfde7f6/where-do-you-point-to-for-explanation-of-why-data&quot;&gt;more discussion&lt;/a&gt; of when this applies and when data can be cc-by, etc, and &lt;a href=&quot;http://sciencecommons.org/weblog/archives/2009/11/19/remembering-babel-open-data-sharing-integration/&quot;&gt;Wilbanks’ explanation&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;following-the-developments-sources&quot;&gt;Following the Developments; Sources&lt;/h2&gt;
&lt;p&gt;The Data Citation collection on Mendeley provides an actively maintained collection of articles discussing practices for depositing, citing, incentives, and tools for data management and publication.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/544621/data-citation/&quot;&gt;Visit the group list&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/544621/data-citation/feed/rss&quot;&gt;Follow the RSS&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Discussion continues on a few FF forum threads have helped assemble this information:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://friendfeed.com/science-2-0/8b143647/who-pays-for-archiving-costs-to-comply-with-new&quot;&gt;1&lt;/a&gt; &lt;a href=&quot;http://friendfeed.com/science-2-0/98efbfa5/where-best-place-to-start-learn-about-new-nsf&quot;&gt;2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Dryad maintains an &lt;a href=&quot;http://datadryad.org/pages/jdap&quot;&gt;excellent list&lt;/a&gt; of the growing number of Ecology and Evolution partner journals that mandate archiving &lt;em&gt; &lt;/em&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>CPB : David Collar</title>
	 <link href="/2010/12/01/cpb-seminar-david-collar.html"/>
   <updated>2010-12-01T00:58:28+00:00</updated>
   <id>/12/01/cpb-seminar-david-collar</id>
   <content type="html">&lt;p&gt;Identifying ecological constraint on morph and function using phylogenies. &lt;/p&gt;
&lt;p&gt;2007 CPB grad, losos post doc, now postdoc w Rita.&lt;/p&gt;
&lt;p&gt;Indep origin of ‘bass’ cranial morph.  Also unique patterns-  stonefish.  Phylo comparative methods to address why and how.  Three types of factors on morphology:  ecological, time!, intrinsic (genetic, behavior) constraints. &lt;/p&gt;
&lt;p&gt;Outline:&lt;/p&gt;
&lt;p&gt;I. determinants of morph diversification.&lt;/p&gt;
&lt;ol start=&quot;2&quot; type=&quot;I&quot;&gt;
&lt;li&gt;&lt;p&gt;Complex traits.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Diversification rate vary by habitat?  (Dragon lizards- diverse morph, diverse habitat).  Reconstruct history of habitat use (4 types), (assign discrete traits) then stoch character maps to reconstruct  (paint) tree.  Looks at PC trait by habitat before correcting.  Now adds trait model:   &lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;  &lt;/p&gt;
&lt;p&gt;Then use painted trees (500) for character evo models: Brownie.  (Explains w example sim).  4 rate, also looks at several 3 and 2 &amp;amp; 1 rate models.  Compare by AIC choose 4 rate for first three PC.&lt;/p&gt;
&lt;p&gt;So which have faster rates? Ground dwelling.  Bc less constrained than climber morphs?&lt;/p&gt;
&lt;p&gt;II.  Complex biomechanics in fish suction feeding.   &lt;/p&gt;
&lt;p&gt;(Videos of suction feeding) “in the first attak the bluegill aims poorly, probably bc there is a sheet of laaser light shining in its face.”  Hehe. &lt;/p&gt;
&lt;p&gt;Looks at force of flow at mouth, but also reach of flow-  a tradeoff!  Smaller gape, stronger lever/muscle, increase protrusion/ram speed.  Gape has tradeoff in reach and force, other traits don’t.  Can compensate?  Centrachids ex. &lt;/p&gt;
&lt;p&gt;Phylo indep contrasts on performance &amp;amp; diet.  &lt;span class=&quot;citation&quot; data-cites=&quot;cboettig&quot;&gt;@cboettig&lt;/span&gt;:  Did you do any model choice (phylo signal) first? &lt;/p&gt;
&lt;p&gt;So does this mitigate a trade-off?  Compare to simple system (simulated where only gape size determines force – strong tradeoff).   Yes, complexity mitigates, may promote morph, funct &amp;amp; eco diversity! &lt;/p&gt;
&lt;p&gt;  Also uses posterior dist of trees.   &lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tues: Fitting the limiting OU models to each bifurcation</title>
	 <link href="/2010/11/30/tues-fitting-the-limiting-ou-models-to-each-bifurcation.html"/>
   <updated>2010-11-30T22:56:03+00:00</updated>
   <id>/11/30/tues-fitting-the-limiting-ou-models-to-each-bifurcation</id>
   <content type="html">&lt;p&gt;Yesterday I derived the linearized SDEs for the saddle node bifurcation :&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = 2\sqrt{r(t)} (\sqrt{r(t)} + \theta -X) dt + \sigma \sqrt{\sqrt{r(t)}+\theta} dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the transcritical bifurcation&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = r(t) (K - X) dt + \sqrt{K} dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Now to implement them for fitting by likelihood using generic $ r(t) $.  I go back to the warning() model implemented in sde_likelihood.R code.  We can just solve the odes directly:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;
    moments &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;function(t,y,p){ 
        sqrtR &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;sqrt&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;R&lt;/span&gt;(t,pars)) 
        yd1 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;*sqrtR*(sqrtR+pars[&lt;span class=&quot;st&quot;&gt;&amp;#39;theta&amp;#39;&lt;/span&gt;] -&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;y[&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;]) 
        yd2 &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;-&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;*sqrtR*y[&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;] +&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;p[&lt;span class=&quot;st&quot;&gt;&amp;quot;sigma&amp;quot;&lt;/span&gt;]^&lt;span class=&quot;dv&quot;&gt;2&lt;/span&gt;*(sqrtR+pars[&lt;span class=&quot;st&quot;&gt;&amp;#39;theta&amp;#39;&lt;/span&gt;])
        &lt;span class=&quot;kw&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;yd1=&lt;/span&gt;yd1, &lt;span class=&quot;dt&quot;&gt;yd2=&lt;/span&gt;yd2))
    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;See full code in likelihood_bifur_models.R, note the somewhat verbose apply calls simply handle a vector of initial conditions so the likelihood of the whole timeseries can be evaluated in a single function call.&lt;/p&gt;
&lt;p&gt;Of course we can numerically integrate first, for the easier LTC mean: &lt;span class=&quot;math&quot;&gt;\[
x\left( t\right) ={e}^{-\int \alpha\left( t\right) dt}\,\left( {e}^{\int \alpha\left( t\right) dt}\,\theta+c\right)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and variance: &lt;span class=&quot;math&quot;&gt;\[
x\left( t\right) ={e}^{-\int \alpha\left( t\right) dt}\,\left( {\sigma}^{2}\,\int {e}^{\int \alpha\left( t\right) dt}dt+c\right)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and just finish off the generic integral numerically, though it is unclear whether that will actually be faster than the numerical ode. For now I’ll start with the ode solve approach.&lt;/p&gt;
&lt;h3 id=&quot;writing-up-class-constructs-for-these-linearized-models&quot;&gt;Writing up Class constructs for these Linearized models&lt;/h3&gt;
&lt;p&gt;All right, back from a few hours of coding and now have a nice lil &lt;a href=&quot;https://github.com/cboettig/structured-populations/commit/91619e47e1cbdd65d5a1a5ae44bbaa7dcdc4ea0e#diff-0&quot;&gt;library for Gaussian Processes&lt;/a&gt;.  This should be much more efficient then writing out nearly identical functions for probability density, random sampling, likelihood and mle estimation.  Just specify the Gaussian process such as either of the above (&lt;a href=&quot;https://github.com/cboettig/structured-populations/commit/91619e47e1cbdd65d5a1a5ae44bbaa7dcdc4ea0e#diff-1&quot;&gt;see code&lt;/a&gt;), and voila:&lt;/p&gt;
&lt;h4 id=&quot;linearized-transcritical-bifurcation-example&quot;&gt;Linearized Transcritical Bifurcation example&lt;/h4&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;source&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;../R/likelihood_bifur_models.R&amp;quot;&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;source&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;../R/gaussian_process.R&amp;quot;&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;er&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;gaussmodel &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;setLTC
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;er&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;pars &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;Ro=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;m=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;theta=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;sigma=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;X &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;simulate.gauss&lt;/span&gt;(gaussmodel, pars, &lt;span class=&quot;dt&quot;&gt;N=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;500&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;T=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;start &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;Ro=&lt;/span&gt;.&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;m=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;theta=&lt;/span&gt;.&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;sigma=&lt;/span&gt;.&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;M &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;update.gauss&lt;/span&gt;(gaussmodel, start, X)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;M$par
       Ro         m     theta     sigma 
 &lt;span class=&quot;fl&quot;&gt;2.788049&lt;/span&gt; -&lt;span class=&quot;fl&quot;&gt;0.280440&lt;/span&gt;  &lt;span class=&quot;fl&quot;&gt;1.296090&lt;/span&gt;  &lt;span class=&quot;fl&quot;&gt;1.002597&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which returns a nice convergence.&lt;/p&gt;
&lt;h4 id=&quot;linearized-saddle-node-bifurcation-example&quot;&gt;Linearized Saddle Node Bifurcation example&lt;/h4&gt;
&lt;p&gt;This model has more trouble with the default maxit, needs more to converge. Also needs to avoid negative R values since it takes the square root (these produce the warnings).&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;source&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;../R/likelihood_bifur_models.R&amp;quot;&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;source&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;quot;../R/gaussian_process.R&amp;quot;&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;er&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;co&quot;&gt;#gaussmodel &amp;lt;- setLTC&lt;/span&gt;
&lt;span class=&quot;er&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;gaussmodel &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;setLSN
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;
&lt;span class=&quot;er&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;pars &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;Ro=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;m=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;theta=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;sigma=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;X &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;simulate.gauss&lt;/span&gt;(gaussmodel, pars, &lt;span class=&quot;dt&quot;&gt;N=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;500&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;T=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;start &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;Ro=&lt;/span&gt;.&lt;span class=&quot;dv&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;m=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;theta=&lt;/span&gt;.&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;sigma=&lt;/span&gt;.&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;)
&amp;gt;&lt;span class=&quot;st&quot;&gt;  &lt;/span&gt;M &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;update.gauss&lt;/span&gt;(gaussmodel, start, X, &lt;span class=&quot;dt&quot;&gt;control=&lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;list&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;maxit=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1000&lt;/span&gt;))
&amp;gt;&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;M$optim_output
$par
        Ro          m      theta      sigma 
&lt;span class=&quot;fl&quot;&gt;2.04075853&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.01060771&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;0.57580070&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;1.02352678&lt;/span&gt; 

$value
[&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;] -&lt;span class=&quot;fl&quot;&gt;86.25758&lt;/span&gt;

$counts
function gradient 
     &lt;span class=&quot;dv&quot;&gt;641&lt;/span&gt;       &lt;span class=&quot;ot&quot;&gt;NA&lt;/span&gt; 

$convergence
[&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;] &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;

$message
&lt;span class=&quot;ot&quot;&gt;NULL&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/cboettig/structured-populations/commit/91619e47e1cbdd65d5a1a5ae44bbaa7dcdc4ea0e#diff-2&quot;&gt;Full example code.&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;real-time-series-and-proper-model-choice&quot;&gt;“Real” time-series and proper model-choice&lt;/h3&gt;
&lt;p&gt;With this machinery in place, can now test against some real timeseries (simulated from the ecological birth-death models, not directly from the linearized SDE), and also do model choice on the changing parameter.&lt;/p&gt;
&lt;p&gt;For speed and efficiency the likelihood function will probably need to moved into C, takes a few minutes for a single maximum-likelihood fit.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Further treatment of the limiting models</title>
	 <link href="/2010/11/29/further-treatment-of-the-limiting-models.html"/>
   <updated>2010-11-29T19:01:29+00:00</updated>
   <id>/11/29/further-treatment-of-the-limiting-models</id>
   <content type="html">&lt;p&gt;Have spent the last three days building and testing the infrastructure to fit the canonical form of a saddle-node (fold) bifurcation by likelihood. Actually I don’t use the canonical form straight up: $ dx/dt = x^2 +r$ cannot be fit directly in this manner, since it needs a couple scale transformations on the variables to get the units right (a multiple for the unit scale and an additive factor for the zero point), and more importantly, isn’t a stochastic model so cannot assign probabilities to the outcomes. Allowing for these, the model becomes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = r - (X-\theta)^2 dt + \sqrt{ \beta (r + (X-\theta)^2)}dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where several other possible formulations of the noise could be possible, and yes, it makes a significant difference. Other than the noise formulation, or even including it, the data really only contains information about this curve around the equilibrium point, so there is little reason why this fit could do better (and good reason why numerically it will be not just slower but harder/less accurate) than the linear fits we began with (the OU models):&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = \alpha (\theta -X) dt + \sigma dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We can fit this model and then estimate the corresponding quadratic by setting this equal to its linearization (equations in yesterday’s entry.) The only real reason to use the quadratic is once we allow r to vary. Then this model captures the change in $ x$ as r changes, since $ x =  + $, &lt;a href=&quot;http://www.carlboettiger.info/archives/108&quot;&gt;see the earlier discussion on this&lt;/a&gt;.  We could simply fit a linear model in which the fixed point moves in this manner:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = 2\sqrt{r} (\sqrt{r} + \theta -X) dt + \sigma dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where we’ve used the fact that the derivative at the equilibrium is $ $ in the OU model or $ 2$ in the saddle-node (SN) model, where it is assumed that $ r $ is changing linearly. We might also modify the noise term in the linear model to reflect the changing noise level due to this changing equilibrium, $ $.   We then still have a a three-parameter linear model, but explicitly in terms of the bifurcation parameter r (in which we isolate the time dependence):&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = 2\sqrt{r(t)} (\sqrt{r(t)} + \theta -X) dt + \sigma \sqrt{\sqrt{r(t)}+\theta} dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Now with a parameterization of $ r(t)$ we can at least numerically solve for the probability distribution.  We are still rather limited if we want to say that r is changing without parameterizing this change.&lt;/p&gt;
&lt;h3 id=&quot;analytic-treatment-for-transcritical-bifurcation&quot;&gt;Analytic treatment for transcritical Bifurcation&lt;/h3&gt;
&lt;p&gt;The transcritical bifurcation captures most of the properties of interest of the saddle-node bifurcation with a potentially simpler model set.  Simpler mostly because that the critical points don’t move, the only exchange stability.  Similar in the sense that it also shows critical slowing down (eigenvalue of the stable point going through zero from negative to positive), and it ends poorly for the species it describes.  Taking the simple logistic model&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dx/dt = r x (1-x/K) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and taking the linear term as the birth rate and the quadratic term as the death rate (a simple convenience), we have a demographic noise model.  As before, we probably only have information around the critical point, and cannot do better than to fit the linearization around the equilibrium rather than the full non-linear equation (another quadratic, which we could do with the numerical integration for the moments just as we did for the saddle-node).&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = r(t) (K - X) dt + \sqrt{K} dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Which just another form of the an OU model with time dependent coefficients as we had before.  Perhaps a simpler test case to check the ability to detect a non-stationary coefficient.&lt;/p&gt;
&lt;h3 id=&quot;so-what-have-we-learned&quot;&gt;So what have we learned?&lt;/h3&gt;
&lt;p&gt;We can do estimation for these higher-order models without closed form solutions, but it doesn’t often pay.  The warning signal approach is based around the linearization, which is almost but not quite the same for these different bifurcations.  We’ve derived those linearizations for comparison.  It remains to attempt fitting to these simpler models, something we already have implemented from earlier, before we had the particular parameterizations for these rates of change (and thus were allowing them to be estimated independently).&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Challenges in estimating phylogenetic signal</title>
	 <link href="/2010/11/29/challenges-in-estimating-phylogenetic-signal.html"/>
   <updated>2010-11-29T07:21:00+00:00</updated>
   <id>/11/29/challenges-in-estimating-phylogenetic-signal</id>
   <content type="html">&lt;p&gt;Uncertainty in estimate of lambda illustrated by simulating 1000 data sets on the Geopsiza tree under a model with lambda = 0.62.  Shows the high uncertainty in estimating lambda at all, despite the power in the estimate at this value.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5284/5219389687_265d4e8b5c_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/6295eb867ca011816972d0260b66db896e7c48a5#diff-0&quot;&gt;Code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Will fill this out further later. Will be interesting to compare at different base values of lambda used for the simulation.&lt;br /&gt;Have updated the codbase to provide bootstraps of parameters as part of the monte carlo output. Requires another generic function introduction: getParameters (in addition to getLikelihood), will probably make optional to keep method simple and general. See the &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/0b3a5f6ea0a8ae955e97fbdfabaf73302c104962#diff-1&quot;&gt;PMC package code&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;inference-in-larger-trees&quot;&gt;Inference in larger trees&lt;/h3&gt;
&lt;p&gt;Two days later… Dec 1st: I run roughly the same strength of phylogenetic signal but with a much larger (simulated) tree, with 354 tips. Here the estimate is at least centered around the true value and contains none of the zero estimates of the geospiza tree.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5203/5225272183_99f25c7fd0_o.png&quot; /&gt;
&lt;/figure&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihoods for quadratic models cont</title>
	 <link href="/2010/11/28/likelihoods-for-quadratic-models-cont.html"/>
   <updated>2010-11-28T21:14:09+00:00</updated>
   <id>/11/28/likelihoods-for-quadratic-models-cont</id>
   <content type="html">&lt;p&gt;Considering the fits of the quadratic models from yesterday.&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“quadraticfitslides” tag_mode=“all”]&lt;/p&gt;
&lt;h3 id=&quot;analysis-of-fits&quot;&gt;Analysis of fits&lt;/h3&gt;
&lt;p&gt;Of course these fits rely entirely on mapping the location of the stable point and the slope through that point, something they still cannot do all that well. In this parameterization the the stable intercept is &lt;span class=&quot;math&quot;&gt;\[ \hat x = \sqrt{r}+\theta \]&lt;/span&gt; and slope at intercept is &lt;span class=&quot;math&quot;&gt;\[ \frac{\partial f(\hat x)}{\partial x} = -2\sqrt{r} \]&lt;/span&gt; This creates a numerical optimization problem, since there is high importance on getting the mean right, and less on the variance, the routine tends to fix the combination of r and theta to get the mean right, and then cannot change r to get the slope correct without getting penalized for the loss of likelihood in changing the mean.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5290/5214829217_0afe62cbd1_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;comparing-to-estimating-linearization-provokes-a-tweak-of-the-model&quot;&gt;Comparing to estimating linearization provokes a tweak of the model&lt;/h3&gt;
&lt;p&gt;For this reason would be easier to estimate the OU model directly, and apply the transformation into the equivalent quadratic model.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \theta_{ou} = \sqrt{r}+\theta_{sn} \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ \alpha_{ou}  = 2\sqrt{r} \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ \theta_{sn} = \theta_{ou}- \alpha_{ou}/2 \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ r = \alpha_{ou}^2/4 \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the variance is slightly more complicated: &lt;span class=&quot;math&quot;&gt;\[
\frac{ \beta \left(r - (\hat{x}-\theta_{sn})^2 \right)}{2 (\hat x - \theta_{sn} )}  = \frac{\sigma^2_{ou}}{2\alpha} \]
\]&lt;/span&gt; =  &lt;span class=&quot;math&quot;&gt;\[
\[ \beta = \frac{\sigma^2_{ou}\sqrt{r} }{\alpha \left(r - (\hat{x}-\theta_{sn})^2 \right)}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Note that the denominator goes to zero – the SN model as framed above as pure birth has no noise at the equilibrium. Let’s alter this in the simulation, phrased as a birth-death model, perhaps just reversing the sign on the quadratic term, we get a more meaningful:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[
\beta = \frac{\sigma^2_{ou}\sqrt{r} }{\alpha \left(r + (\hat{x}-\theta_{sn})^2 \right)} \]
\[ \beta = \frac{\sigma^2_{ou} }{2 \alpha\sqrt{r} }
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This implies much larger noise of course, and does seem to provide better estimates. On the right repeated with smaller noise values (see beta parameter estimates).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5282/5215141381_5b4897c13e_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5241/5215195079_5ea8c1f2d2_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Note that less noise also means less accurate estimate farther out. The Nelder-Meade algorithm is now happy with the convergence:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; out$optim_output$convergence
[1] 0&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;so-how-does-this-compare-to-estimating-by-ou&quot;&gt;So how does this compare to estimating by OU?&lt;/h4&gt;
&lt;p&gt;We estimate the OU model and then infer the quadratic model using the equations derived above:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5170/5215272745_50f3492dca_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/structured-populations/commit/61439ad03cf7d623c8bf94b74d950a81dc56602f&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;So despite the numerical challenges in estimating the quadratic directly, when it can converge it can do quite well; better than the linear fit. This new noise model does much better at handling the case of starting at the far side of the equilibrium, as theta surface is now monotonic since noise doesn’t vanish at the unstable equilibrium:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4112/5215303415_f785c52d8d_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5163/5216262847_640f1be758_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;On the right we see that the transformed linear model can still well outperform the quadratic due to the degeneracy we discussed earlier in choosing r and theta (right). In general it may be best to use the linear fitting routine as an initial condition if not as a replacement for the quadratic model.&lt;/p&gt;
&lt;h3 id=&quot;model-generality&quot;&gt;Model generality&lt;/h3&gt;
&lt;p&gt;The nice thing about the quadratic formulation (despite having to numerically integrate an ode system instead of use an analytical solution for the conditional probability) is the natural representation of the changing r version in this model.&lt;/p&gt;
&lt;p&gt;This doesn’t allow different rates of the bifurcation with change in &lt;em&gt;r&lt;/em&gt;. This would require a coefficient to the quadratic, &lt;span class=&quot;math&quot;&gt;\[ f(x) = r - a(x-\theta)^2 \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ \hat x = \sqrt{r/a}+\theta \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ \partial f(\hat x) = -2\sqrt{a r} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and would be an identifiability issue.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Implementing Likelihoods for quadratic models</title>
	 <link href="/2010/11/27/implementing-likelihoods-for-quadratic-models.html"/>
   <updated>2010-11-27T11:09:06+00:00</updated>
   <id>/11/27/implementing-likelihoods-for-quadratic-models</id>
   <content type="html">&lt;p&gt;Working from the quadratic model for the saddle node bifurcation rather than the linear (OU) model. Recall that the dynamics are:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[dX = \left( r - (x-\theta)^2\right)dt + \beta \sqrt{X} dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the linear noise approximation gives a linear Fokker Planck equation such that the probability distribution is Gaussian with moments ((corrected from yesterday to scale noise, basically as pure-birth Poisson process))&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{d \hat{x}}{dt} &amp;amp;= r - (\hat{x}-\theta)^2 \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ \frac{d \sigma^2}{dt} &amp;amp;= -2 (\hat x - \theta )\sigma^2 + \beta \left(r - (\hat{x}-\theta)^2 \right)   \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So we can evaluate the probability density of being at $ x_t$ at time &lt;em&gt;t&lt;/em&gt; given that we started at &lt;em&gt;x_0&lt;/em&gt; at time 0 by integrating the above equations (numerically, in this case, as we lack a closed form solution for the above).&lt;/p&gt;
&lt;p&gt;Being able to calculate this probability we can easily calculate likelihood of the timeseries under the model. We code this in R (&lt;a href=&quot;https://github.com/cboettig/structured-populations/commit/59a712f2ca7527ccd33ecd272729d29df7cac3d7#diff-0&quot;&gt;likelihood_bifur_models.R&lt;/a&gt;) and write a quick example script (also in repo as &lt;a href=&quot;https://github.com/cboettig/structured-populations/commit/59a712f2ca7527ccd33ecd272729d29df7cac3d7#diff-1&quot;&gt;bifur_likelihood_ex.R&lt;/a&gt;):&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;
pars =&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;r=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;theta=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;beta=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;)
m &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;init_sdemodel&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;pars =&lt;/span&gt;pars, &lt;span class=&quot;dt&quot;&gt;Xo =&lt;/span&gt; &lt;span class=&quot;fl&quot;&gt;6.2&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;model=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;SN&amp;quot;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;N=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;200&lt;/span&gt;)
X &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;simulate.SN&lt;/span&gt;(m)
&lt;span class=&quot;co&quot;&gt;# Set initial guess&lt;/span&gt;
m$pars &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;dt&quot;&gt;r=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;11&lt;/span&gt;,&lt;span class=&quot;dt&quot;&gt;theta=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;dt&quot;&gt;beta=&lt;/span&gt;&lt;span class=&quot;dv&quot;&gt;1&lt;/span&gt;)
out &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;update.SN&lt;/span&gt;(m, X, &lt;span class=&quot;dt&quot;&gt;method=&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;SANN&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Exploring different fitting, seems to be a challenge. For instance, finds wrong optimum sometimes – perhaps due to a bug somewhere (see more examples in flickr stream): &lt;img src=&quot;http://farm5.staticflickr.com/4083/5213027405_7927655f38_o.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;As likelihood surface (shown here for theta) appears challenging:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5161/5213358725_a5071f4571_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;and numerical errors make it worse:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4087/5213376911_7ba94180e2_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5081/5215261656_f8c9f04b2e_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Never the less, the fit does okay when the initial condition for theta starts nearer the better well (right). See flickr library for more examples and git for code. Still not obvious why the unstable equilibrium is quite such a likelihood peak, but anyway…&lt;/p&gt;
&lt;p&gt;Success of fits varies quite a bit, depending on data, initial guesses for parameters, etc. Note that for many of these the optimization fails to converge (more reasons discussed below).&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“quadraticfitslides” tag_mode=“all”]&lt;/p&gt;
&lt;h3 id=&quot;improving-automated-recording-in-figures&quot;&gt;Improving automated recording in figures&lt;/h3&gt;
&lt;p&gt;Have added a git commit message to the reporting, so that flickr images are automatically tagged with a commit stamp referring to the script which produced them:&lt;/p&gt;
&lt;pre class=&quot;sourceCode r&quot;&gt;&lt;code class=&quot;sourceCode r&quot;&gt;
gitcom &amp;lt;-&lt;span class=&quot;st&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kw&quot;&gt;system&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;git commit -a -m &amp;quot;autocommit&amp;quot;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;dt&quot;&gt;intern=&lt;/span&gt;&lt;span class=&quot;ot&quot;&gt;TRUE&lt;/span&gt;)
&lt;span class=&quot;co&quot;&gt;# only first line of git commit commandline return will be printed in flickr discription&lt;/span&gt;
&lt;span class=&quot;kw&quot;&gt;system&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;flickr_upload --tag=&amp;quot;stochpop bifurcation&amp;quot;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;st&quot;&gt;&amp;#39;--description=&amp;quot;&amp;#39;&lt;/span&gt;, gitcom, &lt;span class=&quot;st&quot;&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;,  &lt;span class=&quot;st&quot;&gt;&amp;#39; saddle_node_fit.png&amp;#39;&lt;/span&gt;))
&lt;span class=&quot;kw&quot;&gt;system&lt;/span&gt;(&lt;span class=&quot;kw&quot;&gt;paste&lt;/span&gt;(&lt;span class=&quot;st&quot;&gt;&amp;#39;hpc-autotweets &amp;quot;&amp;#39;&lt;/span&gt;, gitcom, &lt;span class=&quot;st&quot;&gt;&amp;#39; done&amp;quot;&amp;#39;&lt;/span&gt;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Would be nice to eventually make this a link. Also still good to print the most interesting parameters directly on the figure (or in the description if that isn’t appropriate) so that one doesn’t have to reference the code. Wonder if I can dump a larger text output into a single continuous string for the description.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tweets from an Ecology Field class </title>
	 <link href="/2010/11/25/tweets-from-an-ecology-field-class.html"/>
   <updated>2010-11-25T02:06:15+00:00</updated>
   <id>/11/25/tweets-from-an-ecology-field-class</id>
   <content type="html">&lt;p&gt;I just spoke with Professor Mau Stanton, a leading researcher in our field and an &lt;a href=&quot;http://www.ucdavis.edu/spotlight/0305/natural.html&quot;&gt;award-winning teacher&lt;/a&gt;, about the potential for using twitter in her field ecology course.  Though never having used any social media before, Mau has both clear and clever idea of how she wants to apply it in this 15-student field class.&lt;/p&gt;
&lt;p&gt;The challenge:  Students don’t seem to read email as much any more, and are often not at a computer.  Most have cell phones with txt messaging but not smart phones.  Students are often away from computers, traveling between classes or actually in the field collecting data.   Faced with such an environment, Mau has several goals:&lt;/p&gt;
&lt;h3 id=&quot;instant-notification-system&quot;&gt;Instant notification system&lt;/h3&gt;
&lt;p&gt;The first goal is to have a system in place that could send urgent updates to all students which they could receive anywhere.  Announcements like last-minute trip cancellation, or “incoming storm warning – bring rain gear!”  that students could receive on their cell phone as they run between classes.&lt;/p&gt;
&lt;p&gt;(If these are the only messages students want to receive as txts, then they will need to be sent from a dedicated eve180 announce account. Otherwise other messages such as answers to questions or article links will be sent as well. Of course to get answers via cell from Mau or others while in the field they’ll want the whole dialog available anyway.)&lt;/p&gt;
&lt;h3 id=&quot;sharing-resources&quot;&gt;Sharing resources&lt;/h3&gt;
&lt;p&gt;Mau’s next goal is to be able to share journal articles and stories in the media that may be relevant but not required reading for the class. Students may also start to share resources they find with the list, perhaps under a hashtag like #eve180read.&lt;/p&gt;
&lt;h3 id=&quot;ask-and-answer-questions&quot;&gt;Ask and answer questions&lt;/h3&gt;
&lt;p&gt;Students will be able to ask questions of the instructors, particularly while in the field using their mobile phone. Instructors and possibly other students could answer these questions. “Should I count this seedling if its &amp;lt; 1cm?” “Can someone identify this leaf from this photo?”&lt;/p&gt;
&lt;h2 id=&quot;setup&quot;&gt;Setup&lt;/h2&gt;
&lt;p&gt;Each student creates a twitter account, chooses to follow &lt;span class=&quot;citation&quot; data-cites=&quot;MauStanton&quot;&gt;@MauStanton&lt;/span&gt;. Students activate mobile phone connection to their account and enable SMS messages from selected followers, and add &lt;span class=&quot;citation&quot; data-cites=&quot;MauStanton&quot;&gt;@MauStanton&lt;/span&gt; to this.&lt;/p&gt;
&lt;p&gt;Students will now receive updates via text message on their phone. Students can ask questions to the instructor using &lt;span class=&quot;citation&quot; data-cites=&quot;MauStanton&quot;&gt;@MauStanton&lt;/span&gt; in their tweet. Other students will be able to see the reply. May help if questions and answers are tagged, i.e. #eve180qa.&lt;/p&gt;
&lt;p&gt;If all students and instructors use a dedicated account for eve180 and follow everyone in the class, the volume of dialogue may be low enough that mentions@ and hashtags # aren’t necessary.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning signals: Likelihoods Straight-up</title>
	 <link href="/2010/11/24/warning-signals-likelihoods-straight-up.html"/>
   <updated>2010-11-24T21:44:57+00:00</updated>
   <id>/11/24/warning-signals-likelihoods-straight-up</id>
   <content type="html">&lt;p&gt;Meeting with Alan this morning.  I haven’t solved likelihood of power spectra (previous couple entries in Stoch. Pop / warning signals), though after meeting with Sebastian (11/9) probably the best method works from the correlation function.  Define a new stochastic process Y &lt;span class=&quot;math&quot;&gt;\[ Y_1 = X_1 X_2 + X_2 X_3 + X_3 X_4 + \ldots \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ Y_2 = X_1 X_3 + X_2 X_4 + \ldots \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ Y_3 = \ldots \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Argue that $ Y$ is stationary when $ X $ is stationary.  Then apply a central-limit theorem to error estimate in Y given error estimate in X, noting higher Y have much greater error due to be computed from fewer points (uncertainty near the peak of the Lorentzian (low frequency, long wavelength) or tail of the correlation function. A lot of work for a rainy day.&lt;/p&gt;
&lt;h2 id=&quot;back-to-the-previous-tack&quot;&gt;Back to the Previous tack&lt;/h2&gt;
&lt;p&gt;Meanwhile, focus on estimating the likelihood of the set of models directly.  Rather than rely on the OU model with linear moving mean, etc, will write down the probability for the quadratic model.&lt;/p&gt;
&lt;p&gt;Canonical form of the &lt;a href=&quot;http://en.wikipedia.org/wiki/Saddle-node_bifurcation&quot;&gt;saddle-node bifurcation&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \frac{dx}{dt} = x^2+r \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Modifying this slightly for our purposes: I’ve introduced an extra parameter to allow for the bifurcation to occur at $ x = $ instead of at zero, and swapped the sign  so that the stable point is to the right of the unstable:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \frac{dx}{dt} = -(x-\theta)^2+r \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Such that bifurcation occurs when $ r$ becomes negative.  Phrasing this as the appropriate SDE for demographic noise:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[dX = \left( r - (x-\theta)^2\right)dt + \beta \sqrt{X} dB_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Which is a nonlinear model without an analytic solution with which we can calculate the probability density to evaluate the likelihood of the timeseries.  However, we can back up a few steps and go back through the linear noise approximation to the birth death model, where we have &lt;span class=&quot;math&quot;&gt;\[ \frac{d \hat{x}}{dt} = r - (\hat{x}-\theta)^2 \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[  \frac{d \sigma^2}{dt} = -2 (\hat x - \theta )\sigma^2 + \beta  \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;From which we need to construct the conditional probability of observing the system at state $ x_t$ given in started at state $ x_0$ at time t. &lt;span class=&quot;math&quot;&gt;\[ P(x_t | x_0) = N(\mu(x_t | x_0), \sigma(x_t | x_0)  \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;For the OU process, &lt;span class=&quot;math&quot;&gt;\[ \mu(x_0) = (x_0 - \theta) e^{-\alpha t} + \theta \]&lt;/span&gt; [ (x_t, x_0) =  ( 1-e^{-t} ) $$&lt;/p&gt;
&lt;p&gt;Meanwhile the above ODEs for our quadratic model don’t have good closed form solutions, but the ODE system can simply be solved numerically.&lt;/p&gt;
&lt;p&gt;(using a simplified notation to query wxmaxima) &lt;span class=&quot;math&quot;&gt;\[ -\frac{log\left( -\frac{-x\left( t\right) +\sqrt{r}+a}{x\left( t\right) +\sqrt{r}-a}\right) }{2\,\sqrt{r}}=t+c \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ \sigma^2\left( t\right) =e^{2\int x\left( t\right) dt-2at}\left( b\int e^{2 a t - 2\int x \left( t \right) dt} dt+c\right)  \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Comment on bifurcation classes.  &lt;a href=&quot;http://en.wikipedia.org/wiki/Transcritical_bifurcation&quot;&gt;Transcritical bifurcations&lt;/a&gt;, which involve an exchange of stability: still driven by the $ r$ parameter changing sign: &lt;span class=&quot;math&quot;&gt;\[
\frac{dx}{dt} = x^2 + rx
\]&lt;/span&gt; for which the logistic equation is a good example:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[
\frac{dx}{dt} = r x \left(1-\frac{x}{K}\right)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Perhaps this provides a nice simpler example worth focusing on, can probably give complete analytic treatment. The explicit demographic model requires a parameterization of this in terms of birth and death rates. The Levins model provides one reasonable interpretation (actually has a few biological interpretations, including the dispersal model it was introduced as, and as the SIR model of epidemiology):&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[
\frac{dx}{dt} = c x \left(1-\frac{x}{K}\right) - e x
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where the bifurcation occurs at $ c &amp;lt; e$ rather than &lt;span class=&quot;math&quot;&gt;\(r &amp;lt; 0\)&lt;/span&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Power in simple tests</title>
	 <link href="/2010/11/22/power-in-simple-tests.html"/>
   <updated>2010-11-22T08:00:33+00:00</updated>
   <id>/11/22/power-in-simple-tests</id>
   <content type="html">&lt;p&gt;Exploring power in simple tree models. With the smaller tree from the _geospiza _dataset, (14 tips, left) is less than yesterday’s in the &lt;em&gt;bimaculus Anoles&lt;/em&gt; (with 23 tips, right)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4086/5196757723_3c7540af8e_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4151/5197061110_d98d0e4ebe_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/2e5c5d2b5c412550c75689d426bcdeb9a3274445#diff-1&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Also wrote the &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/2e5c5d2b5c412550c75689d426bcdeb9a3274445#diff-0&quot;&gt;OUCH-based wrapper function&lt;/a&gt;to fit tree transformation parameters.  Unfortunately it currently transforms from ape to ouch format repeatedly (in order to use ape’s tree transforms, need to write native ouch-format transforms), so it may not be any faster.&lt;/p&gt;
&lt;p&gt;Ok, all for tonight, continue from here tomorrow.&lt;/p&gt;
&lt;h3 id=&quot;large-simulated-trees&quot;&gt;Large, Simulated Trees&lt;/h3&gt;
&lt;p&gt;Interested in comparing these power curves to much larger trees.  Note already above that the 14 taxa &lt;em&gt;geospiza&lt;/em&gt; tree never gets above a power of 0.80, meaning that even in the most dramatic example of no phylogenetic signal will not be detected 20% of the time.  This asymmetric comparison isn’t strictly necessary, we could ask about the power in the reverse test.&lt;/p&gt;
&lt;p&gt;The larger simulated trees are much slower, machine chugging away at them now. Really needs a more thorough optimization or ouch port for tree transforms._** ****Two**__** days later..**_ The power curve on the much larger trees completed (on zero).  Has basically perfect power (at 95% confidence) any lambda up to 0.95:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4127/5205838636_73b41eba30_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Complete distributions for each of the data points shown here:&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“largetreepowerlambda” tag_mode=“all”]&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/blob/e1e48e7bcb197ce0faed287a6835be9808805f93/pmc/demos/simtree_example.R&quot;&gt;Code in simtree_example.R&lt;/a&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Two questions</title>
	 <link href="/2010/11/21/two-questions.html"/>
   <updated>2010-11-21T21:53:44+00:00</updated>
   <id>/11/21/two-questions</id>
   <content type="html">&lt;p&gt;I’ve been thinking about a few elements of the Monte Carlo approach that seem to be particularly subtle in interpretation. Thought I’d write them out here as a separate examples to help think through them.  Thoughts?&lt;/p&gt;
&lt;h3 id=&quot;question-1&quot;&gt;Question 1&lt;/h3&gt;
&lt;p&gt;Should the Monte Carlo simulations use the maximum likelihood  test and null model estimated from the data (as in  McLachlan 1987, Goldman 1993, Huelsenbeck 1996) or draw from the distribution of model parameters for each simulation?&lt;/p&gt;
&lt;p&gt;Sometimes this estimate is very uncertain, which is only subtly displayed in the Monte Carlo comparison.  While the summary statistics don’t catch it, the graph shows a huge range of likelihood ratios produced when simulating under the test model.  Consider the figure below comparing the pure BM model to one with reduced phylogenetic signal (lambda model).  Some of the simulations correspond to cases where the MLE estimates a very distinctly different value of lambda (near zero, say), and the model is easy to tell from BM (equivalent to lambda=1).  This gives the high likelihood ratios seen on the far right.  However, other simulations are very hard to tell apart because they are estimating values of lambda that are very close to unity already.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5281/5191048330_4dcb0f36c5_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/cb1161cd2c091aa0e037434ec03df14fc91e3360#diff-2&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;The danger is this: that the MLE returns a value of lambda near unity, and the lack of power is attributed to the fact that the data appears nearly Brownian, when in fact considerable lack of power may remain on this data set even if the estimate were near zero.  It is in this kind of example that the  complete power curves are particularly crucial.  As an example, here’s the power curve on lambda for the anoles data:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4151/5197061110_d98d0e4ebe_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/d0ec8f66fdeaa93b97590215d14825dc448396fd#diff-0&quot;&gt;c0de&lt;/a&gt;) The individual distribution at each point can be seen&lt;a href=&quot;http://www.flickr.com/photos/cboettig/tags/powercurve4/&quot;&gt;in this series:&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“powercurve4”]&lt;/p&gt;
&lt;h3 id=&quot;question-2&quot;&gt;question 2&lt;/h3&gt;
&lt;p&gt;Is the better model the one with the smallest type I error in rejecting the other (integrating under the tail away from the observed likelihood ratio) or the model under which the observed likelihood ratio is most probable?&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4112/5195799728_97244df623_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/6d76ce8a000ededec08f6bf7459d48da02e1f545#diff-1&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;The above example (OU.3 v OU.11, see near end of code file) doesn’t quite capture this, since the better p value rejects the null and the higher probability at the observed ratio corresponds to the test distribution, so the methods agree, just.  It’s not obvious which one makes the better argument.  It is easy to imagine in a borderline case such as this that it could have gone either way though, with the probability being slightly higher or the tail slightly longer.&lt;/p&gt;
&lt;p&gt;A related curiosity: would it be useful to estimate a metric of distance between the distributions (maybe Kulback-Leibler divergence, restoring a modern information theoretic feel to it) then the power estimate (although that has a tighter interpretation as Type II error probability)?&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Making R twitter?</title>
	 <link href="/2010/11/21/following-my-computer-simulations-on-twitter.html"/>
   <updated>2010-11-21T21:28:20+00:00</updated>
   <id>/11/21/following-my-computer-simulations-on-twitter</id>
   <content type="html">&lt;p&gt;I’m running quite a few of my analyses on my remote server, a 16 core, 32 GB ram, Ubuntu server with Tesla GPU, named “zero” (we’re creative folks).  It’s easy to start lots of simulations (from ssh), harder to track when they are finished and verify results.  No longer – “zero” now uses social media to share what she’s up to.  Find her on twitter: &lt;span class=&quot;citation&quot; data-cites=&quot;tweeting_cpu&quot;&gt;@tweeting_cpu&lt;/span&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4089/5195954426_a378881339_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4125/5197185652_e11112045a_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;social-computation&quot;&gt;Social Computation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Provides automated updating of simulation status and error messages&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Integrates into my workflow, can follow the computer from my own twitter account&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sends figures to flickr with tags and descriptions&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sends figures to my social network software so I can see them in real-time.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Uses mentions (&lt;span class=&quot;citation&quot; data-cites=&quot;cboettig&quot;&gt;@cboettig&lt;/span&gt;) to trigger on-screen notification&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Uses hashtags to track progress of different simulations running at the same time.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Creates a search-able log of simulations with timestamps&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Can embed the log using RSS or other features standard to twitter.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;All communication can be completely private, shared with a chosen network, or shared with the world (open science).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4112/5196584707_663796eb6e_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;the-setup&quot;&gt;The Setup&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;A Twitter account: &lt;span class=&quot;citation&quot; data-cites=&quot;tweeting_cpu&quot;&gt;[@tweeting_cpu]&lt;/span&gt;(http://twitter.com/#%21/tweeting_cpu)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://jeffmiller.github.com/2010/05/31/twitter-from-the-command-line-in-python-using-oauth&quot;&gt;Command-line twitter client&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Flickr account (can be shared with the user)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://search.cpan.org/~cpb/Flickr-Upload/flickr_upload&quot;&gt;Command-line flickr uploader&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;While I have given the computer it’s own twitter account, I have it post to my own flickr account since I’ve already been using that as my results repository and it is a pro account.  Having a separate flickr account for tweeting_cpu does give me a social object I can follow via flickr however.&lt;/p&gt;
&lt;p&gt;Note that there are many other command-line twitter programs which no longer work since twitter adopted OAuth, including the &lt;a href=&quot;http://cran.r-project.org/web/packages/twitteR/index.html&quot;&gt;twitteR&lt;/a&gt; R package on CRAN, but this python script is perfect. Both commandline apps require a little configuration file with authentication details, but are well documented and easy to set up.&lt;/p&gt;
&lt;p&gt;With this setup, I can add social instructions inside my R code using the system() call:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;system(&amp;#39; flickr_upload --tag=&amp;quot;phylogenetics&amp;quot; ou3_v_ou11.png &amp;#39;)
system(&amp;#39;hpc-autotweets &amp;quot;Simulation complete, results here: http://bit.ly/aacEr1&amp;quot; &amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The image is filed with appropriate metadata in the flickr collection which manages all my simulation results.  Now I can follow my computer.  I can also embed my computer’s latest tweets into my notebook using the rss feed:&lt;/p&gt;
&lt;p&gt;Next: exploring how this can help me keep a tighter link between the code that produced the images and the images themselves. Currently rely mostly on timestamps and context, would be great if it could make sure the code was committed to git before running, and grabbing the commit id to add to the metadata.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Sat: evolution -- porting tree transformations to OUCH?</title>
	 <link href="/2010/11/20/sat-phylogenetics-porting-tree-transformations-to-ouch.html"/>
   <updated>2010-11-20T23:36:09+00:00</updated>
   <id>/11/20/sat-phylogenetics-porting-tree-transformations-to-ouch</id>
   <content type="html">&lt;p&gt;The overnight runs yesterday &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/cb1161cd2c091aa0e037434ec03df14fc91e3360#diff-0&quot;&gt;using the geiger models bm and lambda on the (transformed) Anoles dataset&lt;/a&gt; don’t seem to converge, spooling jobs that continue running even when R exits – probably that same problem in ape somewhere that was fixed by writing the tree out to Nexus and re-reading it, a very strange and subtle bug. &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/f5c8f113acefc59ef9844bdabdaf328cd33e335f#diff-0&quot;&gt;Will try this and restart the runs.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ordered as: bm_v_lambda_origdata.png, delta_v_lambda.png, bm_v_lambda.png (data simulated under OU), each with 100 replicates.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4083/5193446182_f5aa56cb94_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4084/5193446238_81ca844831_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4152/5192848581_cc8905b6e2_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Clearly difficult to distinguish in the first two cases, as expected given the parameter values under this transformation.  The third case is under simulated data with an alpha of 2, but the data estimates a lambda very near unity (0.98), so again this isn’t surprising.  Re-estimating by simulating new data under the same model, we fit a lambda of 0.55, now AIC at least favors the lambda model and we repeat the Monte Carlo and get more conclusive difference between models, as expected:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5241/5193472578_7221ac3ed3_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Thus while we can distinguish between models of different lambda reasonably well under the Monte Carlo framework, we cannot initially estimate reasonably parameterized models of lambda.  Even the power curve seems not to give an indication that the initial estimate of lambda by maximum likelihood is not to be trusted.  Will have to think about this relatively obvious source of uncertainty, maybe better to just draw from the distribution of lambda values appropriately in the monte carlo, rather than generating all simulations from the MLE estimate.&lt;/p&gt;
&lt;h3 id=&quot;geospiza-data-examples&quot;&gt;Geospiza data examples&lt;/h3&gt;
&lt;p&gt;Going back to Geiger geospiza dataset on wing length, just ran 2000 replicates on Monte Carlo of lambda vs delta model:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4154/5193328928_f5f14e8fb7_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;slow-code-new-tact&quot;&gt;Slow code, New tact&lt;/h3&gt;
&lt;p&gt;Meanwhile still frustrated with the speed of Geiger for these applications.  In particular, solving the Brownian rate parameter problem is the solution to a linear equation, and shouldn’t need nonlinear optimization.  OUCH implements a linear solver for brown() function.  Would be possible to wrap a search for a tree transformation around this, optimizing the sigma for each trial version of the optimization, rather than treating this as a non-linear optimization of two parameters simultaneously.&lt;/p&gt;
&lt;p&gt;Note that this is already done for the mean of the Brownian model even in Geiger, where it is taken as the Phylogenetic mean from the tree, so only sigma (which geiger sometimes calls beta, or is beta equal sigma sqaured??) is fitted.&lt;/p&gt;
&lt;p&gt;Using the gsl library I’ve written my own likelihood calculations for BM and OU models, &lt;a href=&quot;https://github.com/cboettig/wrightscape/blob/a3cebb06b8e0e28fe43fbb22e6bd9f0c499271e3/src/linearsoln.c&quot;&gt;linearsoln.c&lt;/a&gt;, should probably re-implement into wrightscape(?)&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Fri: extending Geiger to Monte Carlo method</title>
	 <link href="/2010/11/19/fri-extending-geiger-to-monte-carlo-method.html"/>
   <updated>2010-11-19T19:51:34+00:00</updated>
   <id>/11/19/fri-extending-geiger-to-monte-carlo-method</id>
   <content type="html">&lt;p&gt;Completing my extension of geiger into object oriented design whereby I can easily apply the Monte Carlo approach to test fits using function calls to model fits such as update() and simulate(). A quick convenient example: AIC would prefer (though not by munch) the delta transform model over the Brownian motion model; a conclusion not supported by the Monte Carlo test, which suggests there is not enough power to choose between these models:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4132/5190435896_03fa7c4229_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The density kernel estimation does make it appear that some values are smaller than zero though. Recall all estimates are from the replicates directly, so this doesn’t introduce any errors in the numbers reported, only the visualization; still it is annoying. Also note this is just with 100 replicates, not 2000, since I wanted a quick example and geiger is much slower than ouch.&lt;/p&gt;
&lt;p&gt;Will see if I can generate enough interesting examples out of the Anoles data or if it would be good to include some simulated data (and maybe some simulated trees with different structures). Simulating under OU, fitting lambda and bm models. Alpha = 1 and Alpha = 2&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1030/5190485606_3d3aa1e779_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4149/5190522064_ee22fa88fe_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/tree/1222147f8abe83a54c698bb2178d3fc6e35ca744&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Ah, the strange likelihood ratios under the test simulation are possibly the result of a bug in the simulation script, need to rescale tree to estimate the phylogenetic mean. Confirmed this works with ape’s rTraitCont simulation which can simulate BM (and transformed tree versions of course) and OU) &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/cb1161cd2c091aa0e037434ec03df14fc91e3360#diff-1&quot;&gt;See code changes&lt;/a&gt;. Still, surprisingly wide distribution of likelihoods under simulations of the lambda model.&lt;/p&gt;
&lt;p&gt;Consider the Geiger geospiza data for example, which shows the same wide uncertainty in simulating (n=2000 now) under the test model:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5281/5191048330_4dcb0f36c5_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/cb1161cd2c091aa0e037434ec03df14fc91e3360#diff-2&quot;&gt;(code)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Beginning to wonder if it’s worth bothering to explain how this works in the context of type I and type II error, vs just measuring the divergence between the two distributions. The important thing is realizing that its the likelihood ratio that it’s key to look at, and to look at under both distributions. a rather subtle thing.&lt;/p&gt;
&lt;p&gt;Also looks like it may be worth porting tree transforms into OUCH just for the purposes of doing this analysis at higher speed for the fits. Should profile the code first though to make sure.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Thurs: evolution likelihood</title>
	 <link href="/2010/11/18/thurs-phylogenetics-likelihood.html"/>
   <updated>2010-11-18T20:05:16+00:00</updated>
   <id>/11/18/thurs-phylogenetics-likelihood</id>
   <content type="html">&lt;p&gt;Back to writing for today.  Working on discussion of non-nested models. Looking at the reverse comparison, can get the reverse p value.  The case of OU.3 vs the OU.4 model doesn’t show either test to be significant at the 95%  confidence level,but the case of OU.3 vs OU.15 (lets every species in the top two clades be unique) does:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4125/5187988176_dbfbc0db0a_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The reverse p value easily rejects this silly OU.15 model, though AIC vastly prefers it. Perhaps this would be a better example to start with then the OU.4 case?  Doesn’t have the same convergence issues as the all-diff (OU.23) model, and has a clearer conclusion than the OU.4 choice…&lt;/p&gt;
&lt;p&gt;This raises an interesting question though: should a model be preferred because it is rejected in one test and not rejected in the reverse test (at some chosen confidence level), or should it be chosen as the one having the higher likelihood?  For instance, these two choices can theoretically disagree:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1301/5187916996_3709f31a34_o.jpg&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The curve to the left has a higher probability for the observed LR, but a lower p-value when treated as the null.&lt;/p&gt;
&lt;p&gt;Looking into a clearer opening example such as the OU.15 tree.  Wrote a palette function for the tree (in&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/e257293ae40e2deb91d7ca0eef4ccc203ff16427&quot;&gt;likelihoodratio_mansucript_examples.R&lt;/a&gt;)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4087/5188312038_1fa1fe0c98_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Gives decent example of AIC making the wrong choice, Monte Carlo making a clear different choice, accepting the simpler model with strong degree of information (power).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1035/5187693695_ec3a4f229d_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Unfortunately in this example OU.3 is not nested within this particular painting, even though the ratio is always positive.  Making a nested model tends in most examples of over-parameterized models fit neither very well, i.e. this OU.10 model:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4148/5188275222_8fdfd1d49b_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;see code commit github: ef36d62.  Hmm, maybe start with some simpler nested-model comparisons.&lt;/p&gt;
&lt;p&gt;A clear nested case: OU.1 vs OU.3:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1283/5188364198_66f1d7f0e0_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;some-simpler-geiger-examples&quot;&gt;Some Simpler Geiger Examples&lt;/h3&gt;
&lt;p&gt;Currently cannot run on Gieger fits aren’t fit objects.  A little wrapper function can get around most of this.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;fitContinuous_object &amp;lt;- function(tree, data, model=&amp;quot;BM&amp;quot;, ...){
    fit &amp;lt;- fitContinuous(tree, data, model=model, ...)
    class(fit) &amp;lt;- &amp;quot;fitContinuous&amp;quot;
    fit$model &amp;lt;- model
    fit$tree &amp;lt;- tree
    fit$data &amp;lt;- data
    fit$root &amp;lt;- phylogMean(fit[[1]]$beta*vcv.phylo(tree), data)
    fit
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The next problem is the lack of available methods for simulation in Gieger.&lt;/p&gt;
&lt;p&gt;I’m afraid that it is ridiculous that sim.char in Geiger ignores the root state under the Brownian motion simulation.  Of course it can just be added to the data of the simulation, but no one will do that, or worse, not even realize that the function is ignoring the specification of the root state.&lt;/p&gt;
&lt;p&gt;Equally ridiculous is that geiger doesn’t return this estimate of the root state found by fitContinuous, even though it’s estimated from the data and contributes to the fit. It isn’t estimated by the optim function, however, because it can be found independently by estimating from the data directly, as I do in the function above.&lt;/p&gt;
&lt;p&gt;Probably faster to extend ouch to optimize over tree transformations.  Also avoid the computational drag of Gieger coding. Anyway, just about done, a reasonably object-oriented geiger now. Simulation needs to be extended to perform the tree transformations when required still. See github code.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Weds</title>
	 <link href="/2010/11/18/weds.html"/>
   <updated>2010-11-18T08:06:45+00:00</updated>
   <id>/11/18/weds</id>
   <content type="html">&lt;p&gt;Great discussion in Monte Carlo Seminar with Rannala on the two rate estimation papers.  See in-text notes, but focus on  mechanisms of speciation and extinction as intrinsic (lineage specific) or extrinsic (perhaps spatially specific or global).&lt;/p&gt;
&lt;p&gt;Calculation of the likelihood function for the rates seems straight forward.  Start by imaging the pure-birth model, simply allow branch lengths as draws from the exponential distribution of parameter lambda.  Allowing extinction: probability a lineage speciates (as before) and then survives to present day.  In a density dependent model perhaps this second probability can be easily modified by the expected number of species (really needs to be the distribution, but that’s straight forward).  Bruce suggests this calculation hasn’t been done.  It certainly doesn’t seem to appear in  use in the literature.  Believe the structure of the data needed is the same as the birth-death.  For pure-birth, the data is just the branch lengths.  Now the data is the branch length plus the time until present:&lt;/p&gt;
&lt;p&gt;Looking at a given branch, the probability that it has descendants in the pure birth-death process is given by the classic branching process results, i.e. Galton-Watson process from Feller (wish I had epub versions of all my textbooks right now…)  Note we want the time-dependent solution, not just the escape probability at $ T = $,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ P(t, T) = \frac{\lambda-\mu}{\lambda - \mu e^{-(\lambda-\mu)(T-t)}} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The probability of zero lineages at time $ t$ is then the complement of this.  The probability of $ i &amp;gt; 0 $ lineages at time $ t$ is:&lt;/p&gt;
&lt;p&gt;[latex] P(0,t) (1-u_t)u_t^{i-1} \&lt;/p&gt;
&lt;p&gt;u =  [/latex]&lt;/p&gt;
&lt;p&gt;Why is this true? Going through Kendall 1948 papers which just reference a footnote:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;*(Added in proof.) Dr Bartlett has pointed out to me that the result (27) is stated by N. Arley in Acta Math (1945) 76 298-9&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;hmm… calculations for another day.&lt;/p&gt;
&lt;p&gt;﻿﻿&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tues seminar</title>
	 <link href="/2010/11/16/tues-seminar.html"/>
   <updated>2010-11-16T17:47:39+00:00</updated>
   <id>/11/16/tues-seminar</id>
   <content type="html">&lt;p&gt;Sarah Dalrymple seminar.  Rick Karban’s excellent intro: “unlike the rest of these seminars, Sarah will tell us something new.”   “Sarah’s really out there.”  Also mentions TAC and art teaching.&lt;/p&gt;
&lt;p&gt;Ants, Jeff pine &amp;amp; fire Fire suppression dramatic impacts.  Prescribed under story burns work!   ie Angora fire in Tahoe, 2007.  Discover rings of unburned  soil around base of tree, reducing damage…  undescribed!&lt;/p&gt;
&lt;p&gt;More common in recently burned ( 30 yrs.  What makes the rings?  Many possible: stem melt, wind, litter fall?  Evidence for less fall, but not absence of needles…&lt;/p&gt;
&lt;p&gt;Ants!  60% have an ant nest in the clearing (&lt;em&gt;formica sybilla&lt;/em&gt;).  Association of ants &amp;amp; clearings only in burned areas.&lt;/p&gt;
&lt;p&gt;Needle addition experiments.  Needles move farthest when nest in clearing.  Clearings w ants excluded similar motion to no nest but no exclosure.&lt;/p&gt;
&lt;p&gt;Why should ants make clearings?  (Other ant sp. do this in fields-  &lt;em&gt;pogonomyrmex sp&lt;/em&gt;).  Better foraging rate?  Detect, recruit, transport?  Time to detect bait; and recruit workers 2-3x faster (given nest).  No evidence of better transport time (caterpillar bate).&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>evolution today:  Discussion groups, writing, etc</title>
	 <link href="/2010/11/15/phylogenetics-today-discussion-groups-writing-etc.html"/>
   <updated>2010-11-15T22:37:52+00:00</updated>
   <id>/11/15/phylogenetics-today-discussion-groups-writing-etc</id>
   <content type="html">&lt;p&gt;Interesting discussion of &lt;a href=&quot;http://www.mendeley.com/research/genome-evolution-and-adaptation-in-a-longterm-experiment-with-escherichia-coli?utm_source=desktop&amp;amp;utm_medium=0.9.8.1&amp;amp;utm_campaign=open_catalog&amp;amp;userDocumentId={98edad94-30b4-4e6e-a905-243c3391c835}&quot;&gt;a Lenski paper&lt;/a&gt; in Wainwright’s 270.&lt;/p&gt;
&lt;p&gt;Barrick, J.E. et al. Genome evolution and adaptation in a long-term experiment with Escherichia coli. Nature 461, 1243-7(2009).&lt;/p&gt;
&lt;p&gt;Seems to focus on surprise of continuing linear rate of increase in beneficial mutations, though statistics don’t seem to confirm.  Curious about uncertainty in assay of fitness estimates (seem to go down at times, but surely not fixing deleterious mutations).  General difficulties in setup of exponential growth with applications of classic constant population size, but maybe we’re all missing something.  Curious if the evolution isn’t driven entirely by jettisoning unnecessary protein production, genes, etc to speed up replication time.&lt;/p&gt;
&lt;h3 id=&quot;articles-reading&quot;&gt;Articles &amp;amp; Reading&lt;/h3&gt;
&lt;p&gt;Surprised this morning to come across an article about parthenogenesis in a &lt;a href=&quot;http://www.charlotteobserver.com/2010/11/15/1839395/these-super-snakes-dont-need-a.html&quot;&gt;newspaper&lt;/a&gt; (from the twitter network).&lt;/p&gt;
&lt;p&gt;Didn’t know that was possible, had to dig around in the literature a bit more for &lt;a href=&quot;http://rsbl.royalsocietypublishing.org/content/early/2010/10/21/rsbl.2010.0793.abstract&quot;&gt;the article&lt;/a&gt;.  Apparently this has been shown not only in almost every vertebrate lineage (as this paper on &lt;a href=&quot;http://rsbl.royalsocietypublishing.org/content/3/4/425.full&quot;&gt;parthenogenesis in sharks mentions&lt;/a&gt;) except mammals.  Yes, a colleague pointed out it has been found in chickens, turkeys, pigeons, and zebra finch.  Wow.&lt;/p&gt;
&lt;h3 id=&quot;likelihood-ratio-paper&quot;&gt;Likelihood ratio paper:&lt;/h3&gt;
&lt;p&gt;Figuring out if it’s worth discussing the connection between the concepts of power and information in this paper.  For instance, could include Kulback-Liebler mutual information between the distributions of likelihood ratios generated under each model, rather than frame the discussion in terms of the null and test hypotheses and 95% confidence level, etc.  May at least add the computation into the software package.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://upload.wikimedia.org/math/b/9/4/b9494fe37085e28fb04643bce8600f90.png&quot; alt=&quot;D_{}(P|Q) = _{-}^p(x)  ; dx, !&quot; /&gt;&lt;figcaption&gt;D_{}(P|Q) = _{-}^p(x)  ; dx, !&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Adding the two remaining examples (rejecting the null, BM v OU.3) and inadequate power (BM v OU.1),&lt;/p&gt;
&lt;p&gt;Figures:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4091/5180123414_d18351bdd9_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1044/5180123460_d7c672f08b_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Hope to finish through the discussion of power curves today.&lt;/p&gt;
&lt;h4 id=&quot;ons-thoughts&quot;&gt;ONS Thoughts&lt;/h4&gt;
&lt;p&gt;Interesting discussion continues about data sharing and NSF’s impending policies, particularly see references on &lt;a href=&quot;http://blog.datadryad.org/2010/11/15/nsf-policy-on-dissemination-and-sharing-of-research-results/&quot;&gt;DataDryad blog&lt;/a&gt;.  Applied for and added my (Thompson-Reuters) Researcher ID to my contact info in the footer.&lt;/p&gt;
&lt;p&gt;Noam asks me today –  why is it that we reward only publications, as if the data was the easy step; and then refuse to share data, as if publication was the easy step? Neither are true but we believe both?&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Thursday: Post-predictive verification exploration; writing and figures</title>
	 <link href="/2010/11/11/thursday-post-predictive-verification-exploration-writing-and-figures.html"/>
   <updated>2010-11-11T20:47:51+00:00</updated>
   <id>/11/11/thursday-post-predictive-verification-exploration-writing-and-figures</id>
   <content type="html">&lt;h3 id=&quot;on-post-predictive-verification&quot;&gt;On Post-predictive Verification&lt;/h3&gt;
&lt;p&gt;Considering the kind of post-predictive verification I was discussing with Dan on Tuesday.  Let’s start with the simple birth-death branching process.  Starting from the master equation, the linearity gives us an accurate model as a Gaussian process where the systematic van Kampen expansion gives us the Fokker Planck equation whose solution is completely specified by its first two moments:&lt;/p&gt;
&lt;p&gt;[latex]  = (- ) N \&lt;/p&gt;
&lt;p&gt; = (- ) ^2 ++ &lt;/p&gt;
&lt;p&gt;Excellent.  So the probability of N species after time t is given by a Gaussian with mean $ N_0 e^{(-)t} $ and variance&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \frac{\lambda+\mu}{\lambda-\mu} \left(e^{\alpha t} - 1\right) + N_0 e^{\alpha t}/\alpha - \gamma \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So we’re interested in the likelihood, i.e. the probability of $ P(| N) $, for simplicity let $ = 0$ for the moment.  The expected value is just $ N = N_0 e^{t} $ so that $ = (N/N_0)/t $.  Meanwhile, the maximum likelihood estimator for $$ is the maximum of the above expression.  We can calculate this analytically in closed form,(help from wxmaxima).&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \hat \lambda = \log\left( \frac{\sqrt{4 N_o^4-8 N_0^3N+ 4N_0^2N^2+1}}{2N_0^2}-\frac{1}{2N_0^2} +1\right)/t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Which can be rewritten in terms of $ N/N_0$.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1209/5167729654_d29bb5ff64_o.jpg&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.static.flickr.com/1209/5167729654_a08dc430e0_m.jpg&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Observe that this maximum likelihood value is strictly less than the expected value, i.e. solving in case $ N_0 = 1$  (need to clean chalkboard!)&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \frac{\log\left( \frac{\sqrt{4\,{N}^{2}-8\,N+5}}{2}+\frac{1}{2}\right) }{t} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Also note though that the expected and maximum likelihood estimates agree in the reasonable limit $ N N_0$.  The analytics are presumably closed form but far less tractable with $ $ 0$. Will need to explore the extent of this possible disagreement further later…  Also have some exploratory code on this in rabosky_test.R in github.&lt;/p&gt;
&lt;h3 id=&quot;generalizing-the-codebase&quot;&gt;Generalizing the Codebase&lt;/h3&gt;
&lt;p&gt;Currently have focused on models fitted through the OUCH software.  The format of the power_between_models function in &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/blob/ca68cfe595cc947eecd5c46beeabb2df190123ed/R/powertest.R&quot;&gt;powertest.R&lt;/a&gt; fails to generalize immediately only because ouch fits are proper fit objects that have methods like simulate and update already associated with them, and store their likelihood value in the S4 class format under object@loglik.  If the fits from geiger, etc, were modified to recognize the standard general methods, they’d work just as well in this routine.  Should certainly look into generalizing them, as it would be interesting to start applying the Monte Carlo approach to more methods.&lt;/p&gt;
&lt;h3 id=&quot;back-to-likelihood-paper&quot;&gt;Back to Likelihood paper…&lt;/h3&gt;
&lt;p&gt;Wondering if it is worth including the all-unique example.  Also should include BM vs OU.1 (has OUCH’s funny habit of the extra penalty on OU.1,  as it doesn’t estimate the root state), BM vs OU.3 (formerly OU.LP).  Adding to the manuscript simulation collection.&lt;/p&gt;
&lt;p&gt;Quick look at AIC fraction of wrong answers in the simulations under each of the following model comparisons:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4064/5168082538_060238f873_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4131/5167481715_39f6e2dc03_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4068/5167481729_d2da8faf51_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; png(&amp;quot;bm_v_ou1.png&amp;quot;)
&amp;gt; plot(bm_v_ou1, test_dist=F, shade_p=F, shade_power=F, show_aic=T, shade_aic=T, main=&amp;quot;BM v OU.1&amp;quot;)
[1] &amp;quot;AIC prefers null model&amp;quot;
[1] &amp;quot;p =  0.981 , power =  0.077&amp;quot;
&amp;gt; dev.off()
&amp;gt; png(&amp;quot;bm_v_ou3.png&amp;quot;)
&amp;gt; plot(bm_v_ouLP, test_dist=F, shade_p=F, shade_power=F, show_aic=T, shade_aic=T, main=&amp;quot;BM v OU.3&amp;quot;)
[1] &amp;quot;AIC prefers test model&amp;quot;
[1] &amp;quot;p =  0.031 , power =  0.928&amp;quot;
&amp;gt; dev.off()
&amp;gt; png(&amp;quot;ou3_v_ou4.png&amp;quot;)
&amp;gt; plot(ouLP_v_ouLP4, test_dist=F, shade_p=F, shade_power=F, show_aic=T, shade_aic=T, main=&amp;quot;OU.3 v OU.4&amp;quot;)
[1] &amp;quot;AIC prefers test model&amp;quot;
[1] &amp;quot;p =  0.257 , power =  0.427&amp;quot;
&amp;gt; dev.off()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And a look at the power in each of these cases&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1343/5167508873_26b333477a_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1316/5167508825_3ea5e92fa9_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1330/5167508851_c21aaf354f_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The vastly over-parameterized all-diff model has convergence issues, not surprisingly…  Will probably focus on these three comparisons, moving into the power curve discussion.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>evolution statistics </title>
	 <link href="/2010/11/11/phylogenetics-statistics.html"/>
   <updated>2010-11-11T08:13:49+00:00</updated>
   <id>/11/11/phylogenetics-statistics</id>
   <content type="html">&lt;p&gt;Exploring the best way for representing the Monte Carlo Likelihood approach visually, including comparison power and comparison to AIC.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4008/5165037082_109b409aa4_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Blue line is AIC, dotted red line is real data.  Red line to the right of blue line indicates test model is rejecting the null model by AIC score.  Solid distribution are likelihood ratios simulated under null, dotted are simulated under test.&lt;/p&gt;
&lt;p&gt;The p-value is the integral of the null distribution lying right of the observed likelihood ratio in the real data:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;plot(pow, main=&amp;quot;&amp;quot;, legend=FALSE, type=&amp;quot;density&amp;quot;, test_dist=F, shade_power=F, shade_p=T, show_aic=FALSE, show_data=T)&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4106/5166322930_27f6448297_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;As the dotted red line (real data) falls to the right of the solid blue line of difference in AIC penalties, the AIC score prefers the test model.  The fraction of the null distribution falling to the right of the AIC line indicates how often the AIC score will be wrong when comparing these two models.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;plot(pow, main=&amp;quot;&amp;quot;, legend=FALSE, type=&amp;quot;density&amp;quot;, test_dist=F, shade_power=F, shade_p=F, show_aic=T, show_data=T, shade=F, shade_aic=T)&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4065/5165720991_cbc3a64df6_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The power to distinguish between models is represented as the area under the test curve that falls to the right of a point that is in the (say) 5%  tail of the null distribution, indicated by the shading:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; plot(pow, main=&amp;quot;&amp;quot;, legend=FALSE, type=&amp;quot;density&amp;quot;, test_dist=T, shade_power=T, shade_p=F, show_aic=FALSE, show_data=F)&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1326/5165721021_f410c57b24_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(Reproduce figures by setting &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/commit/7f1cdf9db9e2a8980ae55f06213e9b31c74bcc45&quot;&gt;code to match this commit&lt;/a&gt;.)&lt;/p&gt;
&lt;h3 id=&quot;reading-seminar&quot;&gt;Reading Seminar&lt;/h3&gt;
&lt;p&gt;Rannala Monte Carlo today, discussing: Ané, C. et al. Bayesian estimation of concordance among gene trees. Molecular biology and evolution 24, 412-26(2007). http://www.ncbi.nlm.nih.gov/pubmed/17095535&lt;/p&gt;
&lt;p&gt;Estimate concordance in gene trees by organizing under Dirchlet process.   Interesting more flexible but less mechanistic interpretation than the species tree coalescent approaches we’ve been reading.  Started off with a great tangential discussion on yesterday’s seminar.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tuesday - SDEs then back to phylogenetics</title>
	 <link href="/2010/11/10/tuesday-sdes-then-back-to-phylogenetics.html"/>
   <updated>2010-11-10T19:17:00+00:00</updated>
   <id>/11/10/tuesday-sdes-then-back-to-phylogenetics</id>
   <content type="html">&lt;p&gt;Nice meeting with Sebastian this morning, reviewed my spectral approach problem (see anything in Stochastic Population Dynamics / warning signals in the past week) and the multivariate &lt;a href=&quot;http://www.carlboettiger.info/archives/151&quot;&gt;SDE problem Peter posed&lt;/a&gt;Oct 30th. No solutions yet but some ideas to get started.&lt;/p&gt;
&lt;p&gt;With regards the SDE problem, note that it reduces to:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX_1 = B_2 d B_1 \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and note also that if this were &lt;span class=&quot;math&quot;&gt;\[ dX_1 = B_1 d B_1 \]&lt;/span&gt;  this would be a classic exercise in intro SDEs we can look up in Oksendal,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \int_0^t B_s dB_s = \frac{1}{2}B_t^2 - \frac{1}{2}t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Which can be shown either from the definition or from the Ito formula applied to the map $ g(x) = x^2 $, see beginning of Ch. 4 in my Oksendal.  Will have to try this out on my problem later.&lt;/p&gt;
&lt;p&gt;A couple notes on the spectral analysis.  First should be some interesting-to-a-mathematician claims about convergence of these integrals on $  $, and some central-limit like result on finite time domain. Second, make sure I simulate sample paths vs simulating just the distribution accurately.  Third, take an approach from the correlation function, clear that variance is largest at the low frequencies where there’s less data, and this at least can be treated analytically by considering the new stochastic process $ X_t X_s $ and arguing for stationarity and solving the correlation function.  Anyway, exercises to return to after I get more writing done.&lt;/p&gt;
&lt;h3 id=&quot;phylogenetics-figures-power-examples&quot;&gt;Phylogenetics Figures, Power examples&lt;/h3&gt;
&lt;p&gt;Working on revising this stuff today.&lt;/p&gt;
&lt;h3 id=&quot;rabosky-seminar&quot;&gt;Rabosky Seminar&lt;/h3&gt;
&lt;p&gt;(Live notes) Rabosky evolutionary radiation define as any descendant process. Spectrum: species diversity, phenotypic diversity. Why radiations differ. Focus on species richness.&lt;/p&gt;
&lt;p&gt;Part I: anoles differences Species richness vs island area (losos&amp;amp; schluter, nature 2000). Note radiations occurred within islands. Is clade age or rate diff responsible? (Assumes diversity is still increasing! ) or 3: ecological limits to richness (equib model!) Looks like a linear decrease in rate through time.&lt;/p&gt;
&lt;p&gt;First step - ancestral assignment of island. Also see maddison evolution 2006 bsse model. Rates of transition linked to state.  4 b rates, 4 d rates, 12 island transition rates. Times 2 for diff on big isl vs small isl.&lt;/p&gt;
&lt;p&gt;Fitted model prediction of richness. Exp growth predict much smaller.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;citation&quot; data-cites=&quot;me&quot;&gt;@me&lt;/span&gt; thats obv ahead of time. Uncertainty is greater w higher rate, so underestimates it. Would happen even if you simulate from the exp models.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;citation&quot; data-cites=&quot;me&quot;&gt;@me&lt;/span&gt;: we need different speciation rate models.&lt;/p&gt;
&lt;p&gt;Part II: tree of life Stim Age v diversity. Often no trend I.e. ferns, angiosperms, act. Fishes, mammals, squamates … wow! Only holds for beetles. Resolution only to families Peter points out.  &lt;span class=&quot;citation&quot; data-cites=&quot;me&quot;&gt;@me&lt;/span&gt; battery dying.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;citation&quot; data-cites=&quot;me&quot;&gt;@me&lt;/span&gt; Added after seminar:&lt;/p&gt;
&lt;p&gt;Continues to compare the three models (const rate, variable rate, niche filling) in manner as before and favors niche filling.&lt;/p&gt;
&lt;p&gt;Stimulating discussion with Dan afterwards on statistical inferences based on posterior comparison of model prediction to parameters.  I believe this looks very convincing but can be deeply misleading.  Will try and write up some example of this tomorrow/soon.&lt;/p&gt;
&lt;h3 id=&quot;misc&quot;&gt;Misc&lt;/h3&gt;
&lt;p&gt;Switched photofeed to operate based on tags instead of sets (since these can be set by flickr_upload command line).&lt;/p&gt;
&lt;p&gt;Scheduling Mendeley visit for next week&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Monday and some phylogenetics</title>
	 <link href="/2010/11/08/monday-and-some-phylogenetics.html"/>
   <updated>2010-11-08T22:33:42+00:00</updated>
   <id>/11/08/monday-and-some-phylogenetics</id>
   <content type="html">&lt;p&gt;Working on paper revisions.  Added a separate demo file just for generating the figures and analysis used in the manuscript, called &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/blob/f9a315db7fde5f1b7d355c3efeec394c8bb053be/demos/likelihoodratio_manuscript_examples.R&quot;&gt;likelihood_manuscript.R&lt;/a&gt; Need to clean and reorganize the package files and demos.&lt;/p&gt;
&lt;p&gt;Added full species names and islands to the tip labels of the tree.  Adjusting which example paintings/regimes to include, currently focusing on the original OU.LP model (now calling it OU.3 following Brian’s recommendation for simplicity), OU.4, (originally OU.LP4) and OU.23 (originally all_diff or OU.AD).  Paintings below.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1045/5161357905_862592bae3_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;See &lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics/blob/f9a315db7fde5f1b7d355c3efeec394c8bb053be/demos/likelihoodratio_manuscript_examples.R&quot;&gt;first plot for the code&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also queued some more runs of the pairwise comparisons.  Modifying the distribution plots to show comparison to AIC and be clearer and more intuitive; more tomorrow.&lt;/p&gt;
&lt;h3 id=&quot;diversification-rates&quot;&gt;Diversification Rates&lt;/h3&gt;
&lt;p&gt;Looking into the extensions of the Monte Carlo likelihood into speciation/extinction rate calculations.  Need to first refresh myself on the likelihood calculations for the branching models.  Revisiting the literature:&lt;/p&gt;
&lt;p&gt;﻿1. Nee, S., May, R.M. &amp;amp; Harvey, P.H. The reconstructed evolutionary process. Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences 344, 305-311(1994). 2. Nee, S. et al. Extinction rates can be estimated from molecular phylogenies. Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences 344, 77-82(1994). 3. Kendall, D.G. On the Generalized “Birth-and-Death” Process. Annals of Mathematical Statistics 19, 1-15(1948).&lt;/p&gt;
&lt;p&gt;and some of the gieger/laser packages.&lt;/p&gt;
&lt;h3 id=&quot;sundry-logistics&quot;&gt;Sundry Logistics&lt;/h3&gt;
&lt;p&gt;Wainwright discussion group – see &lt;a href=&quot;http://bit.ly/csyU5j&quot;&gt;paper&lt;/a&gt; and Friday’s entry.&lt;/p&gt;
&lt;p&gt;GTC Guest speaker Scott Dawson on his own research path and “teaching biologists to teach.”&lt;/p&gt;
&lt;p&gt;Note to self: I should really hit all my commits to github; flickr etc and hit the publish post on the day I do the work and not the morning after; so as not to confuse myself with the timestamps!&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Welcome to my Lab Notebook</title>
	 <link href="/2010/11/08/welcome-to-my-lab-notebook.html"/>
   <updated>2010-11-08T02:50:02+00:00</updated>
   <id>/11/08/welcome-to-my-lab-notebook</id>
   <content type="html">&lt;h2 id=&quot;disclaimer-not-a-blog&quot;&gt;Disclaimer: Not a Blog&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/twid/3013680713/in/faves-cboettig/&quot;&gt;&lt;img src=&quot;http://farm4.staticflickr.com/3053/3013680713_cfcebbd403_t.jpg&quot; alt=&quot;floatright&quot; /&gt;&lt;/a&gt;Welcome to my open lab notebook. This is the active, permanent record of all my scientific research, standing in place of the traditional bound lab notebook. It is a record of ideas, and intuitions; results and mistakes. Please bear in mind that the notebook is primarily a tool for me to do science, not communicate it. I write my entries with the hope that they are intelligible to my future self; and maybe intelligible to my collaborators and experts in my field. This is not a research blog, where each entry can be read alone and understood by a general audience in an edited and polished form. ((Okay, with the exception of those items posted in my Open Notebook Science category, which is more like a blog.  These entries still include me experimenting with  methods, tools and ideas, but are written with more of an audience in mind.))&lt;/p&gt;
&lt;h2 id=&quot;philosophy-why-an-open-notebook&quot;&gt;Philosophy: Why an open notebook?&lt;/h2&gt;
&lt;p&gt;So you’ve probably noticed this lab notebook is openly accessible, you can read it online without passwords or permissions. And if you’ve read the disclaimer at the top you’ve gathered that it isn’t written for you, it’s written for me. So why is it open?  What does that mean anyway?&lt;/p&gt;
&lt;p&gt;This icon, also on the bottom of my &lt;a href=&quot;http://onsclaims.wikispaces.com&quot;&gt;&lt;img src=&quot;http://onsclaims.wikispaces.com/file/view/ons-aci2.png/61358668/ons-aci2.png&quot; alt=&quot;floatright&quot; /&gt;&lt;/a&gt; webpage indicates that I make my best effort to make all content (AC) available as I go.  Other models involve some private results or information released only after some delay.  &lt;a href=&quot;http://onsclaims.wikispaces.com&quot;&gt;These different icons&lt;/a&gt; are used across the scientific community to identify Open Notebook Science (ONS).  The other icon at the bottom of each page is the Creative Commons license.  In addition to being openly visible, anything in this notebook can be reused and reproduced under the terms of this license.&lt;/p&gt;
&lt;p&gt;Researchers have found many reasons for making their notebook open: better collaborations, greater visibility and broader impact for funding requirements, sharing detailed methods, solving the dilemma of  null results publishing, helping other scientists advance, demonstrating the viability of the idea or participation in a community of open science.   For myself, I decided to try ONS as an experiment.  As I go along, I record reflections about the experience in my notebook, so it has gotten a category alongside my scientific research topics.  Follow along and see how the experiment works out.&lt;/p&gt;
&lt;h2 id=&quot;an-integrated-notebook&quot;&gt;An Integrated Notebook&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;http://www.carlboettiger.info/assets/files/mynotebook-300x123.png&quot; alt=&quot;floatright&quot; /&gt;&lt;figcaption&gt;floatright&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In these pages you will find not only thoughts and ideas, but references to the literature I read, the codes or manuscripts I write, derivations I scribble and graphs I create.  I see my notebook as consisting not only of the entries here (in Wordpress), but the databases for articles, code and images that are embedded or linked from the notebook to external repositories. (Mendeley, Github, Flickr).&lt;/p&gt;
&lt;h4 id=&quot;lab-notebook-wordpress&quot;&gt;&lt;a href=&quot;http://www.carlboettiger.info/research/lab-notebook&quot;&gt;Lab Notebook: Wordpress&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;I make daily entries in the lab notebook using Wordpress blog support.  I describe my objectives, progress and results   The notebook documents everything I would need to repeat my analysis.  I also record my notes from seminars, feedback from meetings, and outlines for talks and manuscripts.  My codes, my figures and the literature with my notes are all stored in external repositories and linked into my daily entries, keeping entries complete but compact.  The notebook supports links, reader comments, tags, timestamps, and full text search.&lt;/p&gt;
&lt;h4 id=&quot;literature-database-mendeley&quot;&gt;&lt;a href=&quot;http://www.mendeley.com/profiles/carl-boettiger/&quot;&gt;Literature Database: Mendeley&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Whenever I read an article, I add the pdf to my Mendeley collection, a reference database.  Within the database I can add comments and notation to the article, and use it to insert citations to articles into my daily notebook entries.   I can also share the annotations with collaborators, who can add their own comments and also add articles I should be aware of to the collection.&lt;/p&gt;
&lt;h4 id=&quot;code-database-github&quot;&gt;&lt;a href=&quot;https://github.com/cboettig&quot;&gt;Code database: Github&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;My actual work more often involves writing software, exploring simulations, performing data analysis or writing manuscripts or presentations – i.e. writing and revising text/code.  These changes are committed to Github with a comment in the log summarizing the update.  Despite continual revisions, the snapshot of any code or revision from any day can be recovered by the link directly from the lab notebook.&lt;/p&gt;
&lt;h4 id=&quot;image-database-flickr&quot;&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/collections/&quot;&gt;Image Database: Flickr&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Some kind of graphs or figures are the most common output of any code or exploration I do.  For calculations which I’ve worked out on a chalkboard or scratch paper it’s much faster to photograph than to type.  Any  simulation or analysis I run automatically adds the resulting figures with appropriate tags and description to my Flickr database.  The description points to the version of the code (on Github) that can reproduce it.  I can then embed particular results individually into a daily entry or add complete sets of images using a scrolling gallery.&lt;/p&gt;
&lt;h2 id=&quot;organization-navigation&quot;&gt;Organization &amp;amp; Navigation&lt;/h2&gt;
&lt;p&gt;Clicking on Lab Notebook on the top menu bar displays of my most recent notebook entries.  Each entry is given assigned a category corresponding to the research project (currently Comparative Phylogenetics, Stochastic Population Dynamics, and Adaptive Dynamics), or  entry type (my Teaching journal, Open Notebook Science thoughts and tools, notes from Seminars.)&lt;/p&gt;
&lt;p&gt;The footer of my webpage provides the navigation controls.  The calendar links to all entries on a selected date.  There’s also a category tree and full search. Entries also have tags.&lt;/p&gt;
&lt;p&gt;All of the other databases reflect the project categories: My Flickr tags (“&lt;a href=&quot;http://www.flickr.com/photos/cboettig/tags/phylogenetics/&quot;&gt;phylogenetics&lt;/a&gt;”, “&lt;a href=&quot;http://www.flickr.com/photos/cboettig/tags/stochpop/&quot;&gt;stochpop&lt;/a&gt;” and “&lt;a href=&quot;http://www.flickr.com/photos/cboettig/tags/adaptivedynamics/&quot;&gt;adaptivedynamics&lt;/a&gt;”), Mendeley Public groups (“&lt;a href=&quot;http://www.mendeley.com/groups/529971/phylogenetic-methods/&quot;&gt;Phylogenetic Methods&lt;/a&gt;”, “&lt;a href=&quot;http://www.mendeley.com/groups/634301/theoretical-ecology/&quot;&gt;Theoretical Ecology&lt;/a&gt;”, and “&lt;a href=&quot;http://www.mendeley.com/groups/529981/adaptive-dynamics/&quot;&gt;Adaptive Dynamics&lt;/a&gt;”), and Github repositories (&lt;a href=&quot;https://github.com/cboettig/Comparative-Phylogenetics&quot;&gt;“Comparative-Phylogenetic&lt;/a&gt;s&amp;quot; and &lt;a href=&quot;https://github.com/cboettig/structured-populations&quot;&gt;“structured-populations&lt;/a&gt;“,”&lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics&quot;&gt;AdapitveDynamics&lt;/a&gt;“).  The articles, images, or code in each database have stable urls to link to, and each database provides additional tags/groups/repositories for finer categorization, as well as search capability.&lt;/p&gt;
&lt;h2 id=&quot;the-social-lab-notebook&quot;&gt;The Social Lab Notebook&lt;/h2&gt;
&lt;p&gt;The services I integrate into &lt;img src=&quot;http://www.carlboettiger.info/assets/files/social.png&quot; alt=&quot;floatright&quot; /&gt; my notebook aren’t just relational databases.  They are also all social networking platforms built around a particular type of data (blog entries, publications, images, code). All have RSS feeds that let them live-update each other.  All (except Wordpress) have a notion of contacts and social graph.&lt;/p&gt;
&lt;p&gt;All have mobile applications,  a developer API so anyone can extend them, a large user base, and provide a cost-free service.  In addition to integrating with the notebook, they provide their own sophisticated interface to their content.&lt;/p&gt;
&lt;p&gt;At the hazard of coining a new acronym, I consider this makes it a “Social Lab Notebook.”  An Electronic Lab Notebook brings many advantages over its paper predecessors.  I feel that making it an Open Lab Notebook adds to this the potential benefits of Open Science, while a Social Lab Notebook leverages these  content-driven social networks to help achieve them.&lt;/p&gt;
&lt;p&gt;Without additional effort, I simultaneously contribute to the rapidly growing database of curated literature, reusable scientific images and a repository of open-source scientific code.  These objects rub shoulders with similar content in these broad-use databases, where they are more discoverable and reusable.  &lt;a href=&quot;http://blog.jonudell.net/2007/07/02/data-finds-data-then-people-find-people/&quot;&gt;Data finds data, then people find people&lt;/a&gt;.  As more scientists use these tools, the more powerful they become.&lt;/p&gt;
&lt;h2 id=&quot;a-bit-of-history&quot;&gt;A bit of history&lt;/h2&gt;
&lt;p&gt;I originally became interested in the concept of Open Notebook Science through reading about the open notebook of &lt;a href=&quot;http://cameronneylon.net/&quot;&gt;Cameron Neylon&lt;/a&gt;, and later also the groups of J&lt;a href=&quot;http://usefulchem.blogspot.com/&quot;&gt;ean-Claude Bradley&lt;/a&gt; and&lt;a href=&quot;http://openwetware.org/wiki/User:Skoch3&quot;&gt;Steve Koch&lt;/a&gt;. I was later &lt;a href=&quot;http://sciencecareers.sciencemag.org/career_magazine/previous_issues/articles/2010_04_09/caredit.a1000036&quot;&gt;featured in Science Careers&lt;/a&gt; for a piece on open notebook science.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://www.carlboettiger.info/assets/files/OWWEmblem.png&quot; alt=&quot;floatright&quot; /&gt; I began my experiment in ONS on the wiki-based platform &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger&quot;&gt;OpenWetWare&lt;/a&gt;.   With a tool to create a notebook template and an established community of researchers with such notebooks (also sharing course content, experimental protocols, lab webpages, etc) it provided an excellent introduction.  I was swiftly contacted by established PIs offering encouragement, advice and even collaboration.  My original notebooks remain there, with future entries connected from this site automatically through the Category feed.  Limitations in my ability to customize, control and extend OWW mediawiki platform have led me to migrate to my own independently hosted site and domain here.&lt;/p&gt;
&lt;h2 id=&quot;other-resources&quot;&gt;Other resources&lt;/h2&gt;
&lt;p&gt;Many others have assembled excellent collections, advice and resources on ONS.  I only point in the way of several that most influence me.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://friendfeed.com/science-2-0&quot;&gt;FriendFeed’s (FF) Science2.0&lt;/a&gt;:  I believe this is still the best place to ask a question about ONS, and its popular threads cover the major questions and latest news in the practice.  Most of the visionaries and experts in Open Science and online tools for science can be found here.  Thanks to so many of you there (and on FF Life Sciences) who have helped me along!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hmm, I don’t seem to be able to think of anything that wasn’t also discussed on FF.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Friday: Evolution reading, writing</title>
	 <link href="/2010/11/05/friday-evolution-reading-writing.html"/>
   <updated>2010-11-05T18:21:35+00:00</updated>
   <id>/11/05/friday-evolution-reading-writing</id>
   <content type="html">&lt;p&gt;Read through the article for Monday’s PBG270, &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20090752&quot;&gt;a 2009 Nature paper&lt;/a&gt;from the Plotkin lab on mutational robustness and the rate of evolution.  They consider an interesting little setup.  Start with a Moran model (individual born, may mutate, choses who to replace at random), but allow the following mutational structure (landscape).  Of P possible genotypes, each can only move to one of K neighbors by a single mutation.  Call the genotype(s) of optimal fitness C.  Call all those genotypes that have C as a neighbor (can reach in one mutation) B.  All other genotypes that have the same phenotype as B but different K neighbors genotype A.  q is the probability that the mutation changes the genotype but not the phenotype; a measure of robustness.&lt;/p&gt;
&lt;p&gt;I sketch out the possible outcomes described in the paper, to get a sense of why intermediate values of K/P are optimal.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.static.flickr.com/4011/5149250606_fbda9c83be_b.jpg&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Some things just need a white board.  Group discussion on paper Monday.&lt;/p&gt;
&lt;h3 id=&quot;phylogenetics-reading&quot;&gt;Phylogenetics Reading&lt;/h3&gt;
&lt;p&gt;Our Friday Phylogenetics discussion group is converging more and more with Wednesday Monte Carlo with Bruce Rannala. Last week Weds we discussed with Rannala we focused on species tree with the example from BEST: ﻿Liu, L. et al. &lt;em&gt;Coalescent methods for estimating phylogenetic trees. Molecular phylogenetics and evolution&lt;/em&gt; 53, 320-8(2009).&lt;/p&gt;
&lt;p&gt;And that Friday in PDG discussed their eariler paper, where BEST relied on running Mr Bayes separately first, ﻿Edwards, S.V., Liu, L. &amp;amp; Pearl, D.K. &lt;em&gt;High-resolution species trees without concatenation.&lt;/em&gt; Proceedings of the National Academy of Sciences of the United States of America 104, 5936-41(2007).&lt;/p&gt;
&lt;p&gt;This week we moved in Rannala Monte Carlo we ventured into horizontal gene transfer with ﻿Linz, S., Radtke, A. &amp;amp; Haeseler, A. von &lt;em&gt;A likelihood framework to measure horizontal gene transfer.&lt;/em&gt; Molecular biology and evolution 24, 1312-9(2007).&lt;/p&gt;
&lt;p&gt;and continued in PDG along the species-tree literature with the improved performance of star-beast: ﻿Heled, J. &amp;amp; Drummond, A.J. B_ayesian inference of species trees from multilocus data. _Molecular biology and evolution 27, 570-80(2010).&lt;/p&gt;
&lt;p&gt;Monte Carlo will continue with the BUCKy paper&lt;/p&gt;
&lt;p&gt;﻿1. Ané, C. et al. Bayesian estimation of concordance among gene trees. Molecular biology and evolution 24, 412-26(2007).&lt;/p&gt;
&lt;p&gt;Seems the software announcement has paper has only just come out in PLoS Comp. Bio this week? :&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Larget, B.R. et al. BUCKy: Gene tree/species tree reconciliation with Bayesian concordance analysis. PLoS computational biology 26, 2910-2911(2010).﻿&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In the Wainwright lunch today we also touched upon the recent Sys Biol papers, primarily in reference to diversification rates﻿﻿, ﻿1. Rabosky, D.L. Primary Controls on Species Richness in Higher Taxa. Systematic biology 59, 634-645(2010). 2. Rabosky, D.L. &amp;amp; Alfaro, M.E. Evolutionary Bangs and Whimpers: Methodological Advances and Conceptual Frameworks for Studying Exceptional Diversification. Systematic biology 59, 615-618(2010). 3. Fitzjohn, R.G. Quantitative Traits and Diversification. Systematic biology 59, 619-633(2010).&lt;/p&gt;
&lt;p&gt;Most of my notes on the articles are filed with the actual pdfs through Mendeley.  Writing here gives me a freedom to interweave how the narrative behind how the papers find my way into my library though.  Still figuring out documenting workflow around literature and talks.&lt;/p&gt;
&lt;p&gt;Too many meetings, not enough writing…&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Thursday</title>
	 <link href="/2010/11/05/thursday.html"/>
   <updated>2010-11-05T18:08:32+00:00</updated>
   <id>/11/05/thursday</id>
   <content type="html">&lt;p&gt;Wrote yesterday’s entry on power spectral analysis difficulties from yesterday.  Why don’t I remember my physics training better?  Bialek’s Phy562 notes still very helpful.  No one else seems to write about this stuff clearly enough for me.  Including me. 8a-11a&lt;/p&gt;
&lt;p&gt;Catching up on reading.  Good news and discussion items in Nature on publishing code and review materials, excellent piece on climate change scientists engaging media, climate high performance computing in Brazil; etc see headlines and links in my &lt;a href=&quot;http://twapperkeeper.com/person/cboettig&quot;&gt;twitter feed archive&lt;/a&gt; for today. 11-12:30.  A few good articles, see the Mendeley collections.&lt;/p&gt;
&lt;p&gt;Phylogenetics likelihood manuscript revisions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Reorganize methods section&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Adjust the models presented, include correct tree diagrams.  Rename models.  Present: BM, OU1, All Diff, Four Clades, OU.LP?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Power analysis rewrite, connection to non-nested models.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Revisit phylogenetics signal part, play to larger audience than the island.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Bayesian methods nod&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Continuing, 5-7. Model comparison section: write background on painting and broader relevance.&lt;/p&gt;
&lt;p&gt;Meeting with Alan, 2.&lt;/p&gt;
&lt;p&gt;Examples: Ground fish fisheries.  Epidemiology with vaccine forcing.  Drake data.  Scheffer data sets.&lt;/p&gt;
&lt;p&gt;EVE seminar, 4. Interesting talk og going into intervention instead of simply conservation. Some key points and links in twitter archive.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Getting the details right on the Fourier Transform approach to likelihood</title>
	 <link href="/2010/11/03/getting-the-details-right-on-the-fourier-transform-approach-to-likelihood.html"/>
   <updated>2010-11-03T16:28:39+00:00</updated>
   <id>/11/03/getting-the-details-right-on-the-fourier-transform-approach-to-likelihood</id>
   <content type="html">&lt;p&gt;Recall that we consider the power spectrum of some measurable fluctuating quantity x(t), defined as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ y(\omega) = \int_0^T dt e^{i\omega t} x(t) \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ S(\omega) = \lim_{T \to \infty} \frac{1}{2\pi T} \left| y(\omega)\right|^2 \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;A little work can show is equal to the Fourier transform of the autocorrelation function, $ x(t) x(t’) = C(t-t’) $.&lt;/p&gt;
&lt;p&gt;We evaluate the correlation function of their Fourier transform (note $ x () $ is really $ x()$, the new transformed variable, I’ve dropped the tilde only out of laziness):&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \langle x(\omega) x(\omega&amp;#39;) \rangle = \langle \int dt e^{i\omega t} x(t) \int dt&amp;#39; e^{i\omega&amp;#39; t&amp;#39;} x(t&amp;#39;) \rangle \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Bringing the expectation inside (by linearity) &lt;span class=&quot;math&quot;&gt;\[ \int dt \int dt&amp;#39; e^{i(\omega t+\omega&amp;#39; t&amp;#39;)}  \langle x(t)  x(t&amp;#39;) \rangle \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Defining $ = t-t’$, using the definition of the correlation function we have &lt;span class=&quot;math&quot;&gt;\[ \int dt e^{i (\omega+\omega&amp;#39;) t&amp;#39;} \int d \tau e^{-i \omega&amp;#39; \tau} C(\tau) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And we see that the $ t $ integral is the (two pi times the) delta function, hence&lt;span class=&quot;math&quot;&gt;\[ \langle x(\omega) x(\omega&amp;#39;) \rangle = 2 \pi  \delta (\omega + \omega&amp;#39;) \int d \tau e^{i \omega \tau}  C(\tau) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Note that in the last step we use the fact that delta fn is zero except where $ = -’$, and we &lt;em&gt;define&lt;/em&gt; this last integral as the Power spectrum, $ S()$.   Noting that as it is complex, $ x(-) = x(^*) $, so&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \langle x(\omega) x^*(\omega&amp;#39; ) \rangle = 2\pi  \delta(\omega -\omega&amp;#39;) S(\omega) \]&lt;/span&gt;,&lt;/p&gt;
&lt;p&gt;or at $ = -$, we have as claimed:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \langle x(\omega) x^*(\omega) \rangle = 2\pi S(\omega) \]&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Which is known as the Weiner Khinchine theorem.  Time averaging over the stationary distribution instead of averaging across replicates gets us the above version.  Getting this to work in the code has been less than successful.&lt;/p&gt;
&lt;h3 id=&quot;a-canonical-example-our-ou-process-case&quot;&gt;A canonical example: our OU process case&lt;/h3&gt;
&lt;p&gt;For the OU process, we can write down the correlation function of the stationary distribution (or even the time-dependent solution if we wanted) directly from an application of the the Ito calculus, (see &lt;a href=&quot;http://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process&quot;&gt;OU solution&lt;/a&gt;),&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ C(\tau) = \frac{\sigma^2}{2\alpha} e^{-\alpha |\tau|} \]&lt;/span&gt;,&lt;/p&gt;
&lt;p&gt;We can compute the Fourier transform of this analytic solution by hand, and recover the Lorentzian curve,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ S(\omega) = \frac{\sigma^2}{\alpha^2 +\omega^2} \]&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;troubles&quot;&gt;Troubles&lt;/h3&gt;
&lt;p&gt;I seem to be having difficulty demonstrating this in the simulation.:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1217/5147048292_e0ae6277f8_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Several practical concerns and options:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Accurate simulation of the OU process.  As we know the solution, this can be simulated exactly.  I’ve explored simulating it through simple Euler, the exact simulation, the analagous discrete time AR(1) process, and the general Milstein regime from the SDE R package.  Some differences, particularly visible in Euler vs exact, in the power spectrum, but neither lining up perfectly with the theoretical curve above.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Discussion of normalization.  The above Lorentzian is not normalized to integrate to unity, actually equals $ ^2/ $.  However this should reflect the actual power calculated from the system above.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Discretization concerns.  Long enough T, small enough dt, N, normalizing, rescaling, averaging, Nyquist frequency.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fourier definition concerns.   The definition can differ by a factor of 2 pi between physics and engineers.  Further, getting the units of the x-axis correct to line up frequencies with the correct components of the transform is crucial.  As a quick check I confirm that the fft of a sine function gives me the peak at the angular frequency I expect:&lt;/p&gt;
&lt;p&gt;n&amp;lt;- 2^10 dt&amp;lt;-1/8 t &amp;lt;- seq(0,dt&lt;em&gt;(n-1), by=dt) X &amp;lt;- sin(5&lt;/em&gt;t) + rnorm(n, .01) pwr &amp;lt;- abs(fft(dt&lt;em&gt;X))^2/(2&lt;/em&gt;pi&lt;em&gt;dt&lt;/em&gt;n) nyquist&amp;lt;-1/(2&lt;em&gt;dt) # half the sampling frequency w &amp;lt;- nyquist&lt;/em&gt;seq(0, 2*pi, length=n/2) plot(w, pwr[1:(n/2)], type=“l”) abline(v=5, col=“red”, lty=3)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1087/5145846483_e6f06c73f4_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Anyway, still in the troubleshooting process, trying to keep exploration documented in the version commits of power_spec.R, so s&lt;a href=&quot;https://github.com/cboettig/structured-populations/blob/6d8ce276363419a06b824ad984c6f78f5c4cfc2d/demos/power_spec.R&quot;&gt;ee code and commit log.&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;some-other-notes&quot;&gt;Some other notes&lt;/h3&gt;
&lt;p&gt;If we define the Power spectrum as the transform of $ C()$, then the inverse transform gives us (in Physics convention for Fourier)&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ C(\tau) := \langle x(t) x(t&amp;#39;) \rangle = \int_{-\inf}^{\inf}  \frac{d \omega}{2 \pi} e^{-i \omega (t-t&amp;#39;)} S(\omega) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and setting $ t = t’$ we have&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \langle [x(t) ]^2 \rangle = \int_{-\infty}^{\infty}  \frac{d \omega}{2 \pi} S(\omega) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Now if x(t) is Gaussian process, we can look at the transform of the errors. We note the transform of the Gaussian is Gaussian, taking the function that is normally distributed in x with variance $ ^2$ to one normally distributed in $ $ with variance $  /^3 $.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Reviews, organization, rewrites</title>
	 <link href="/2010/11/03/reviews-organization-rewrites.html"/>
   <updated>2010-11-03T05:20:18+00:00</updated>
   <id>/11/03/reviews-organization-rewrites</id>
   <content type="html">&lt;p&gt;Today’s a mixed bag of activities. Finished a journal review, comments confidential, recorded in my reviewed papers archive.  I then organized documents library (more below) and then back to paper revisions.&lt;/p&gt;
&lt;p&gt;The reference manager software Mendeley recently upgraded the way it handles groups and sharing, and I’ve been waiting to revise how it impacts my workflow around articles.  Articles can be organized into folders (collections) or kept unsorted within the library,  and can be part of as multiple collections.  Completely independent of this organization, articles can also be added to groups.  Articles added only to a group are still considered unsorted in terms of collections.  Groups can be public or private.  Public groups can have members and followers, and can be moderated or open.   I sort papers by the broad topics I am interested in. The challenge here is to find topics narrow enough to be useful but broad enough that articles can be easily classified, neither falling between the gaps or  falling into too many categories.  In this way, my organizational scheme reflects the use of categories in my lab notebook.  Unfortunately, while I have the option of tags, I do not have the option of sub-categories.  Further, it is harder to browse one’s list of tags in Mendeley than here in Wordpress.  Also, the categories I read extend somewhat beyond the categories I normally work in.  How many categories are useful?&lt;/p&gt;
&lt;p&gt;Here’s how I’ve chosen to break it down so far:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.mendeley.com/groups/529971/phylogenetic-methods/&quot;&gt;Phylogenetic Methods&lt;/a&gt; &lt;/strong&gt;– anything I’m reading pertaining to phylogenetic methods development and application.  This focuses primarily on comparative methods, primarily in continuous traits.  But this also includes comparative methods in discrete traits, rates of diversification (branching), inferring phylogenies from DNA data, and inferring divergence times from phylogenies.    I’ve pulled some highlights from this focus into a separate group (below).  A separate but related alternative might be an adaptive radiations list, which would stretch beyond phylogenetic literature as well.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A special focus subset of my phylogenetics collection focuses on those examples that show &lt;a href=&quot;http://www.mendeley.com/groups/541741/evolutionary-regime-shifts/&quot;&gt;&lt;strong&gt;evolutionary regime shifts&lt;/strong&gt;&lt;/a&gt; – again, primarily in continuous traits (methods like Brownie or OUCH), but also in diversification/branching.  Represents most of my personal focus out of the broader above category.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/634301/theoretical-ecology/&quot;&gt;&lt;strong&gt;Theoretical Ecology&lt;/strong&gt;&lt;/a&gt;.  Articles on theoretical ecology and modeling. The public list is a kind of best-of subset drawn from all of the theoretical ecology literature in my collection. Dominant themes include persistence and coexistence results, stochasticity, and population-level dynamics. The list is significantly biased to my own focus and interest rather than a more broad view.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/530001/early-warning-signs/&quot;&gt;&lt;strong&gt;Early Warning Signs&lt;/strong&gt;&lt;/a&gt; is another collection and public group.  Properly a subset of theoretical ecology, just as regime shifts are a subset of Phylogenetics.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/530051/math-methods-and-model-inference/&quot;&gt;&lt;strong&gt;Math Methods and Model Inference&lt;/strong&gt;&lt;/a&gt; is a collection of papers on some of the methods central to my research.  Currently the collection has two major themes – stochastic processes theory and approximations following Thomas Kurtz, van Kampen and others, and likelihood and Bayesian inference of models.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/530011/education/&quot;&gt;&lt;strong&gt;Education&lt;/strong&gt;&lt;/a&gt; Research papers on effective teaching methods, with focus on science education and active learning.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/530031/future-of-science/&quot;&gt;&lt;strong&gt;Future of Science&lt;/strong&gt;&lt;/a&gt; Articles on the process of science, with emphasis on Open Science, Open Access, Open Source, Science2.0, collaborative research, large databases, reproducible results, and high-performance computing.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Before the update, I simply curated my collection and it generated a feed.  Some of the articles fell outside the original definitions I’d set for the collections, phylogenetic comparative methods becoming all phylogenetic methods, and stochastic population dynamics becoming pretty much anything in theoretical ecology, though both reflecting primarily their original titles.  Now I find myself curating both the public groups and the list.  In some ways this is good, since I can have a lower threshold to add something to my own list then to a public collection.&lt;/p&gt;
&lt;p&gt;There are some challenges to keeping both lists updated.  When I select an article, I can immediately see which collections it’s in due to the highlighting of the labels, but not which groups it has been included in.  It seems a group is an independent copy of the article with its own timestamp, etc, and edits to the metadata of one do not impact the other.  In some ways this is good – allows private copy and a public copy of notes on the article.  But in tracking it is annoying that the objects are not the same and I cannot easily check if an article in a collection is in a group or vice versa.  Another challenge is that duplicates aren’t removed automatically, either in groups or collections.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Short note: Trait diversification rates controlled by other traits</title>
	 <link href="/2010/10/30/short-note-trait-diversification-rates-controlled-by-other-traits.html"/>
   <updated>2010-10-30T00:00:00+00:00</updated>
   <id>/10/30/short-note-trait-diversification-rates-controlled-by-other-traits</id>
   <content type="html">&lt;p&gt;Peter posed an interesting question to me this afternoon: can we infer a model in which the rate of evolution in one trait (say, its Brownian diversification rate parameter) depends on the value of another trait (say, linearly and assume the other trait depends on Brownian motion). Without all those assumptions we write this generally as:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX_t = f_x(X_t, Y_t) dt + \sigma_x(X_t, Y_t) d W_t \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ dY_t = f_y(Y_t) dt + \sigma_y(Y_t) d W_t \]&lt;/span&gt; (subscripts do not imply derivatives in my notation)&lt;/p&gt;
&lt;p&gt;Adding the assumptions: &lt;span class=&quot;math&quot;&gt;\[ dX_t =  \sigma_x \sigma_y Y_t d W_t \]&lt;/span&gt; &lt;span class=&quot;math&quot;&gt;\[ dY_t = \sigma_y d W_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I believe this is non-linear, hence the distribution of trait values is not Gaussian. Perhaps this should be obvious,  but late on a Friday let’s simulate &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/a27d60618f116fa167e15a077abaf54fb88fd258/demos/peters_Q.R&quot;&gt;(see code&lt;/a&gt;), and just look at the QQ-plot: &lt;img src=&quot;http://farm2.staticflickr.com/1406/5127610208_edb73d6483_o.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;This means the distribution of trait values on the tree under the model will not be multivariate normal, unlike the case for all other nicer models we’ve considered. I thought a transformation might save this, but I’m unfamiliar with multidimensional Lamperti transform and haven’t come across any good coverage of it, either on the web or in Oksendal or Iacus. Anyone?&lt;/p&gt;
&lt;p&gt;–Added note:  Yes, this is obvious.  as this is the product of two Gaussian processes, it is not Gaussian.  Still, looks simple enough to have a closed form solution…&lt;/p&gt;
&lt;h3 id=&quot;a-related-one-dimensional-model&quot;&gt;A related one-dimensional model&lt;/h3&gt;
&lt;p&gt;In one dimension we can have a trait value which influences its own rate of diversification:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX_t = f(X_t) dt + \sigma(X_t) dW \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And by applying a rarely discussed method known as the Lamperti transform, turn this into a linear function in a new variable:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ Y = \int_z^X \frac{1}{\sigma(u)} du \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then by Ito formula we find the Lamperti transform: &lt;span class=&quot;math&quot;&gt;\[ dY = \left( \frac{f(X_t)}{\sigma(X_t)} - \frac{1}{2} \partial_x \sigma(X_t) \right) dt + dW_t \]&lt;/span&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>A new twist on the approach</title>
	 <link href="/2010/10/28/a-new-twist-on-the-approach.html"/>
   <updated>2010-10-28T16:08:25+00:00</updated>
   <id>/10/28/a-new-twist-on-the-approach</id>
   <content type="html">&lt;p&gt;Matching the warning signal to different SDE models couldn’t retain the simplicity and generality needed, so I intend to work on the transformed data instead. Taking the power spectrum of the data, we have a new curve fitting problem:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.static.flickr.com/4020/5123075213_8d9dc10e28_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/e5794f83ad48e91297fc02584bd27272ced7ed62/demos/power_spec.R&quot;&gt;Code&lt;/a&gt;).  This can be turned into a linear curve fitting problem by taking the log of the inverse Fourrier transform, then the slope is our stability parameter.  Can we do this estimation by likelihood instead of least-squares?  What is the error model of scatter around the Lorentzian anyway?  Does this loose the temporal information of a changing rate for that parameter?&lt;/p&gt;
&lt;p&gt;Today’s goals:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Get the inverse fft matching the theory&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Compute likelihoods on the transformed data?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Compare between stationary and non-stationary models&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The big challenge: how do I define a likelihood function on the transformed data?  Is this even possible??&lt;/p&gt;
&lt;h3 id=&quot;victory-or-maybe-half-victory&quot;&gt;Victory!  (or maybe half victory)&lt;/h3&gt;
&lt;p&gt;So after some discussion with my brother, Alistair Boettiger: yes – it is possible to fit by likelihood: Imagine transforming the entire distribution of outcomes (ensemble) into a power spectrum. This creates a “fuzzy” power spectrum, with deviations from that expected by the model. A couple useful observations let us determine that distribution:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The mean of that distribution (fuzzy Lorentzian) is the expected power spectrum of the model; so given a candidate model we can easily subtract this out.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The errors are normally distributed.  This follows because &lt;strong&gt;(a)&lt;/strong&gt; the distribution of the original model was normal (exactly true for our linear SDEs / Fokker-Planck models, otherwise by linear noise approximation they are close to Gaussian); &lt;strong&gt;(b)&lt;/strong&gt; the Fourier transform is linear; and &lt;strong&gt;(c)&lt;/strong&gt; the Fourier transform of the Gaussian is Gaussian.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is otherwise known as &lt;em&gt;great news!&lt;/em&gt; The exact form I probably cannot write from parameters of the model, but will allow that error to be an extra parameter – giving us the two Lorentzian shape parameters (height and width, will fix position around zero as we’re not interested in regular oscillations) and the error term.  From this the likelihood is then easy to estimate from data as seen above.&lt;/p&gt;
&lt;h5 id=&quot;err-almost.&quot;&gt;Err… Almost.&lt;/h5&gt;
&lt;p&gt;  The above graph clearly doesn’t seem to show normal scatter about the curve.  Also, the power spectrum takes the (norm of the) square of the  FFT, so we have:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \left| (f(w) + N(w))^2 \right| = \left| f(w)^2 + 2f(w)N(w) +N(w)^2 \right| \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(| latex f(w)^2 |\)&lt;/span&gt; is the Lornetzian and $ N(w)$ the normal random variate.  That is, an error that looks like&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \left| 2 f(w)\right| \left| N(w)\right| +N(w)^2 \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So the error does depend on the mean, just as it appears. Note that for the complex-valued function &lt;span class=&quot;math&quot;&gt;\[ | f(x) ^2 | = |f(x)|^2 \]&lt;/span&gt; so $ |f(x)| $ is the square root of the Lorentzian signal, $ |f(x)|^2 $&lt;/p&gt;
&lt;p&gt;Calling the power in the data $ P(x) $ and the variance of the normal be $ ^2$ and the unit normal $ Z$, we have:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ (P(w) - |f(x)|^2 - \sigma^2)/(2\sigma) =  f(w) \left| Z \right| +Z^2 \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;hmm.. perhaps better to simply estimate the probability density directly from the first equation specifying the PDF(w). In any event, reduces to a nice likelihood calculation I should be able to implement in the code soon.&lt;/p&gt;
&lt;h3 id=&quot;next-up-the-rate-changing-model&quot;&gt;Next up: the rate-changing model&lt;/h3&gt;
&lt;p&gt;The remaining challenge is to understand how deviations in the model, particularly various loss of stability processes, impact this fitting, and how to frame the alternative model.  Presumably it is not also Lorentzian.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Red Noise (aside exercise)</title>
	 <link href="/2010/10/28/red-noise-aside-exercise.html"/>
   <updated>2010-10-28T00:00:00+00:00</updated>
   <id>/10/28/red-noise-aside-exercise</id>
   <content type="html">&lt;p&gt;Consider the first-order autoregressive process: &lt;span class=&quot;math&quot;&gt;\[ X_{t+1} = \rho X_t + \sqrt{1-\rho^2}Z_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Why the funny term at the end? This comes from normalizing the variance,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \begin{multline} E( (\rho X_t + \sqrt{1-\rho^2} Z_t)^2 )  =  \\
E (\rho^2 X_t^2)  + E(2 \rho X_t  \sqrt{1-\rho^2})  Z_t )  + \\
E( X_t^2 Z_t^2 (1-\rho^2) ) \end{multline}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;by independence:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[   = \rho^2  E(X_t^2)  + 2 \rho \sqrt{1-\rho^2}  E( X_t ) E( Z_t )  + E( X_t^2)  E(Z_t^2) (1-\rho^2)  \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and as &lt;span class=&quot;math&quot;&gt;\(E(Z_t) = 0\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(E(Z_t^2) = 1\)&lt;/span&gt; then&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[   = \rho^2  E(X_t^2)  +   E( X_t^2)  \sigma^2 (1-\rho^2) = E(X_t^2) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the variance is stationary, &lt;span class=&quot;math&quot;&gt;\(E((X_{t+1})^2) = E((X_{t})^2)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;A nice exercise connects this to the continuous time result,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX = -\gamma X dt + dW \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where the variance is again reduced by the correlation coefficient, &lt;span class=&quot;math&quot;&gt;\(E(X^2) = 1/(2\gamma)\)&lt;/span&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals -- Where are we now?</title>
	 <link href="/2010/10/27/warning-signals-where-are-we-now.html"/>
   <updated>2010-10-27T16:00:48+00:00</updated>
   <id>/10/27/warning-signals-where-are-we-now</id>
   <content type="html">&lt;p&gt;The last few days have involved an investigation into the ability to capture the essential features of the dynamics leading up to a saddle node bifurcation as a linear stochastic differential equation. The warning signals question then becomes a model-choice problem between constant and time-dependent coefficients:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX_t = \alpha \left(\theta_t - X_t\right) dt + \sigma_t dW_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX_t = \alpha_t (\theta_t - X_t) dt + \sigma_t dW_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where changing stability is characterized by critical slowing down seen in decreasing $ $. Unfortunately, a general parameterization for the other parameters which will change in both models is challenging, (see the end of yesterday’s notes) and without a good fit to these it may be difficult to attribute the model choice to sensitivity in $ $. Without the ability to frame reliable models to capture the process, we must be careful to compare them. Different mechanisms driving the bifurcation can create substantially different pictures that may not be well caught by the same parameterization of the above model.&lt;/p&gt;
&lt;h3 id=&quot;so-where-next&quot;&gt;So where next?&lt;/h3&gt;
&lt;p&gt;Ultimately, it is still necessary to quantify the probability of detection of a warning signal in the simplest, best-case scenario of the data observed from a system known to exhibit a saddle-node bifurcation. That is, we still want to compare a model involving the change with one not involving the change, and quantify the information necessary (sensitivity to rate of change, amount of data, etc – all issues of power) to distinguish between them. Instead of building this around the SDE above, we can build this around a transformation of the data that does not exhibit this sensitivity to the model details. Solving for the time-dependent spectral density seems a promising way to go, avoiding many of the issues highlighted in yesterday’s notes.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Correcting for the mean dynamics</title>
	 <link href="/2010/10/26/correcting-for-the-mean-dynamics.html"/>
   <updated>2010-10-26T16:46:24+00:00</updated>
   <id>/10/26/correcting-for-the-mean-dynamics</id>
   <content type="html">&lt;p&gt;Yesterday I began to address concerns of different models that have different mean dynamics, and how this influences the warning signals. This poses several kinds of issues.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;First, if the mean is changing, the model fitting must be appropriate to this – either by fitting this rate of change or correcting for it.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Second, the variance is expected to scale with the mean, and scale differently under different noise models (particularly environmental vs. demographic).  Hence information about the mean cannot simply be discarded (i.e. by subtracting out a regression fit).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Third, certain dynamics need not give much warning, even though they consist of saddle-node bifurcations.  By changing the curvature of the rate model we can examples with more and less advanced warning.  In some cases the change can happen fast enough that noise forces the system over the edge without warning.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;With changing mean:&lt;/p&gt;
&lt;embed src=&quot;http://www.carlboettiger.info/assets/files/bifur.swf&quot; width=300 height=300&gt;
&lt;p&gt;With “constant” mean:&lt;/p&gt;
&lt;embed src=&quot;http://www.carlboettiger.info/assets/files/bifur_mean_const.swf&quot; width=300 height=300&gt;
&lt;p&gt;Note that the mean changes quite suddenly at the end, though the loss of stability is more pronounced much earlier on.  (Images are is now sfw-flash objects instead of gif loops so can be paused, etc by right click. Hosted locally in this site’s media library as flickr stream doesn’t support flash.)&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/39a295ae0e3bde82af6800f8cf87f61f74726979/demos/saddle_analytics.R&quot;&gt;Code archive for these figures;&lt;/a&gt; uses the animation package and SWF tools to create the flash images.  Multiple root finding (a problem in the numerical examples earlier which used nlm) supported now by rootSolve package.&lt;/p&gt;
&lt;h3 id=&quot;so-what-does-this-mean&quot;&gt;So what does this mean?&lt;/h3&gt;
&lt;p&gt;Ignoring mean rate of change will be misleading, but a linear approximation to the rate of change doesn’t capture the second model well right near the switch point. Over most of the parameter range this can be ignored, with the rate estimated as essentially flat for this model. It is the corrections to the variance due to changes in the expected value that are more challenging. It is in this example that estimating the return rate, critical slowing down, will be more promising. The explicit analytics might help us further here:&lt;/p&gt;
&lt;p&gt;Starting from the expansion of the master equation and taking the linear noise approximation, we can express the dynamics in Ito form:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX_t = \left[ b(X_t)-d(X_t) \right] dt + \sqrt{\frac{b(X_t) + d(X_t)}{N}}dW_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Around the equilibrium &lt;span class=&quot;math&quot;&gt;\(\hat x\)&lt;/span&gt; we have variance&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \frac{b(\hat x) + d(\hat x)}{2 N  \left[\ partial_x b(x) - d(x)\right]_{x = \hat x}} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Defining: &lt;span class=&quot;math&quot;&gt;\[ \alpha(\hat x) =  \partial_x  \left[b(x) - d(x)\right]_{x = \hat x} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \sigma^2(\hat x) = \frac{b(\hat x) + d(\hat x)}{N} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and can write the correlation function: &lt;span class=&quot;math&quot;&gt;\[ \langle\langle X_0 X_t \rangle \rangle = \sigma^2(\hat x) e^{-\alpha(\hat x) t} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;It is precisely this &lt;span class=&quot;math&quot;&gt;\(\alpha(\hat x)\)&lt;/span&gt; that we wish to estimate. Now it changes due to changes in &lt;span class=&quot;math&quot;&gt;\(\hat x\)&lt;/span&gt; as well as changes in the bifurcation parameter, &lt;span class=&quot;math&quot;&gt;\(a\)&lt;/span&gt;, which of course also influences &lt;span class=&quot;math&quot;&gt;\(\hat x\)&lt;/span&gt; directly. So we want to rewrite this as a function of the bifurcation parameter alone:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \partial_x  \left[b(x,a) - d(x,a)\right]_{x = \hat x(a)} =: f(a) \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;A little tired of LaTeX writing, I  approximate &lt;span class=&quot;math&quot;&gt;\(\alpha(a)|_{\hat x}\)&lt;/span&gt;,  the slope at equilibrium as a function of the bifurcation parameter. Going astray: &lt;a href=&quot;http://www.flickr.com/photos/cboettig/5118738314&quot;&gt;calculation here&lt;/a&gt;, &lt;a href=&quot;http://farm2.static.flickr.com/1419/5118172479_aaf1a2d5a1_m.jpg&quot;&gt;results graphed here&lt;/a&gt;, upshot is assuming saturation doesn’t capture the bifurcation.  Applying that approximation earlier to the derivative expression gives a slope of &lt;span class=&quot;math&quot;&gt;\(-e\)&lt;/span&gt;, no &lt;span class=&quot;math&quot;&gt;\(a\)&lt;/span&gt; dependence at saturation anyway.&lt;/p&gt;
&lt;h4 id=&quot;numerical-solution&quot;&gt;Numerical Solution&lt;/h4&gt;
&lt;p&gt;Foregoing a complete analytic treatment, we can solve for function numerically to get the picture. For the first model with the steady changing mean, we see the mean, the eigenvalue &lt;span class=&quot;math&quot;&gt;\(\alpha\)&lt;/span&gt;, demographic noise term &lt;span class=&quot;math&quot;&gt;\(\sigma^2\)&lt;/span&gt;, and total variance: &lt;img src=&quot;http://farm2.staticflickr.com/1178/5119205688_e05388859a_o.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;And for the second model (note smaller values of a now lead to the bifurcation): &lt;img src=&quot;http://farm2.staticflickr.com/1220/5118603695_df7a11b494_o.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;(&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/a3ba76f81e72e972e2c5fa6e0cf87da5e15de80c/demos/saddle_analytics.R&quot;&gt;see code for these graphs&lt;/a&gt;, also has the updated code for flash animated bifurcations). Hard to justify good fits to a model form of &lt;span class=&quot;math&quot;&gt;\[ dX_t = \alpha(a, X_t) (\theta(a, X_t) - X_t)dt + \sigma(a, X_t) dW_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where the parameters are linear functions in time or in a (changing linearly with time). So, what’s the power spectrum of the time-dependent function&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\langle\langle X_0 X_t \rangle \rangle = \sigma^2(\hat x) e^{-\alpha(\hat x, t) t} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\alpha(\hat x, t)\)&lt;/span&gt; is a function of &lt;span class=&quot;math&quot;&gt;\(a\)&lt;/span&gt; as given by the graphs above and &lt;span class=&quot;math&quot;&gt;\(a\)&lt;/span&gt; changes linearly at some rate? Is it to this that we must compare fits under models of changing and non-changing &lt;span class=&quot;math&quot;&gt;\(a\)&lt;/span&gt;?&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Wrong picture, wrong model: why warning signals don't look like rare events</title>
	 <link href="/2010/10/25/wrong-picture-wrong-model-why-warning-signals-dont-look-like-rare-events.html"/>
   <updated>2010-10-25T23:24:45+00:00</updated>
   <id>/10/25/wrong-picture-wrong-model-why-warning-signals-dont-look-like-rare-events</id>
   <content type="html">&lt;p&gt;Detecting a warning signal of collapse isn’t about detecting that a system is non-stationary, but more specifically, that the system is about to do something sudden.  The classic saddle-node bifurcation example results in a picture like this:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1184/5103819890_b5a04908ae_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;A visible steady decrease interrupted by a sudden jump.  The goal is to distinguish this from the case of a steady decrease that involves no loss of stability – such as would be created by continually lowering the carrying capacity of logistic-model system at a linear rate.  As one involves a loss of stability and the other does not, the warning signal that attempts to measure the eigenvalue (equivalent to r in the standard logistic formulation) may enable one to distinguish between these two possibilities.  The picture that seems so often described is one of no change in mean, followed by a sudden jump.  Such a pattern can be produced in a bistable system simply by waiting long enough – as addressed through the theory of large deviations.  Such a case may instead result from loss of stability, even without the mean changing.  To explore this, I’ve constructed an example explicitly to avoid the mean changing but still show a change in stability before the bifurcation:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ d(x) = a \left( \hat x - K \right) + e K \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ b(x) = \frac{e K x^p}{x^p+h^p} \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;with $ a $ as the bifurcation parameter:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.static.flickr.com/1432/5115931711_c9c1142a7e_o.gif&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The red line is the death rate, blue the birth rate, and black the difference.  (Code is the first figure in this &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/54dbdb578f5a91e2796ce2c097f4abeca8719d30/demos/saddle_analytics.R&quot;&gt;version of saddle_analytics .R&lt;/a&gt;).  Such cases may have a rather simpler analysis, since changes in the equilibrium size can be ignored, but are less general and hence less common than the cases that may include changes in expected value of the state.&lt;/p&gt;
&lt;p&gt;Of course one can also imagine examples where most of the change will occur pretty much without warning, i.e. if the growth rate function looks like:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1327/5116083962_6c1334dd21_o.jpg&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Then the unstable point moves a great deal closer but no stability is lost until right before the bifurcation, hence there is very little warning.  In either case, there is a tendency to attempt to correct for any trend.  The general idea of this is quite valid – the loss of stability should appear in the variance, while the trend could have other causes (so could an increase in variance, but leaving that aside), so we do need to handle this correctly.  However, this overlooks the crucial second observation:&lt;/p&gt;
&lt;h3 id=&quot;noise-dependence-on-mean&quot;&gt;Noise dependence on mean&lt;/h3&gt;
&lt;p&gt;In general, the noise magnitude scales with the system state, as either &lt;span class=&quot;math&quot;&gt;\(\propto \sqrt{X_t} d W_t\)&lt;/span&gt; (in our demographic examples) or linearly. (environmental noise)   The decreasing state can obscure the increasing variance due to loss of stability.  Methods which simply subtract out a trend will fail to reflect this phenomenon.  At least for ecological systems where the state is a population abundance driven by a birth-death process, the assumption of no dependence,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ dX_t = \alpha (\theta - X_t) dt + \sigma dW_t \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;is unjustified.  This should not impact the actual estimate of the correlation time (autocorrelation rate or width of the Lorentzian from the power transform), but does impact the variance.&lt;/p&gt;
&lt;h3 id=&quot;reflections-in-an-example&quot;&gt;Reflections in an example&lt;/h3&gt;
&lt;p&gt;Example coming: consider the isotope data in the climate change shifts, showing several jumps and among the examples considered in Dakos et al.  2008:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/e/ec/DeuteriumCore.png&quot; alt=&quot;http://openwetware.org/images/e/ec/DeuteriumCore.png&quot; /&gt;&lt;figcaption&gt;http://openwetware.org/images/e/ec/DeuteriumCore.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;See other data sets, listed in&lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Stochastic_Population_Dynamics/2010/04/02&quot;&gt;earlier lab notebook entry (still on OWW&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;http://www.flickr.com/photos/cboettig/5115516967/in/photostream/&lt;/p&gt;
&lt;h3 id=&quot;comments-on-ons&quot;&gt;Comments on ONS&lt;/h3&gt;
&lt;p&gt;Images today are all included from flickr stream, embedded with Flickr Gallery plugin with the exception of the gif. As viewing animated gifs requires access to the original image, this prompted me to upgrade to Flickr Pro. Will be interesting to explore what can be done without limits, meanwhile the animated gif is a bit annoying. Today’s live feed reflects some of explorations on R animations in gifs and otherwise, see &lt;a href=&quot;http://www.delicious.com/cboettig/animation&quot;&gt;my bookmarks in delicious&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Recent posts have adopted the WP LaTeX plugin for equations.  Seems to work better than a few other plug-ins I tried (strange positioning etc), but open to suggestions on quick load times, machine readable equations, proper appearance.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals 2</title>
	 <link href="/2010/10/21/warning-signals-2.html"/>
   <updated>2010-10-21T00:00:00+00:00</updated>
   <id>/10/21/warning-signals-2</id>
   <content type="html">&lt;p&gt;Trying to select clear examples of sufficient and sufficient power in detecting warning signals. Addressing a couple side issues today as well:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Proper handling of trends&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Best model for eigenvalue change&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Computed an example with steeper nonlinearity to compare rate of change in lambda.  Here’s an example with Hill coefficient of 5 (&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/1122cbe8f0eed7670df1514c5572cf5c1f540e84/demos/saddle_analytics.R&quot;&gt;see code&lt;/a&gt;for details).  Note that the plot simply shows whichever root the numerical algorithm converges to at the time, should modify to express all roots.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1164/5103391608_0f219f6ff0_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(I’ve also updated the C code saddle node simulation to adjust Hill coefficient, but still have to add the wrappers to let this be set from the R level, details in the github repository).&lt;/p&gt;
&lt;p&gt;In the canonical form of the saddle-node bifurcation, &lt;span class=&quot;math&quot;&gt;\(\tfrac{dx}{dt} = x^2+a =: f(x)\)&lt;/span&gt; the equilibrium moves as the square root of the parameter, &lt;span class=&quot;math&quot;&gt;\(r = \pm \sqrt{x}\)&lt;/span&gt; and the eigenvalue is directly proportional to the equilibrium, &lt;span class=&quot;math&quot;&gt;\(\tfrac{df}{dx} = x\)&lt;/span&gt;.  The larger the nonlinearity, the larger the skew. As the canonical form can be viewed as a Taylor series on any saddle node bifurcation, to leading order we should be using the sqrt approach of lambda to zero wrt our bifurcation parameter: &lt;span class=&quot;math&quot;&gt;\(d\lambda/dt = -\sqrt{a}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Also working on trends - in this case, change in theta over time that must also be accounted for.  So both are quadratic rates of change in the canonical model.  If the bifurcation parameter is moving over a large range, the nonlinearity can be quite visible, but with the goal of detecting only small changes, the linear change is defensible. Seems the signal from the eigenvalue cannot be more sensitive than the change in the mean (in the saddle node bifurcation)?  Recall the goal is to detect a system that appears to be linearly decreasing, but is about to fall off an edge, vs a system that is linearly decreasing without decreasing stability. Showing the birth rate and death rate functions at the point of the bifurcation: (&lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/1413206233559970c86d4161ceb1ff60ae9c0987&quot;&gt;code&lt;/a&gt;)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1195/5103188523_57db900672_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;So these are essentially the models we want to compare.  Why warning signals are so often discussed as if the mean is not expected to change does not match the basic model or the original question – it’s detecting catastrophes, not detecting changes that we’re interested in.  Hence the corresponding crash to such a figure (actually with Hill coef p = 2)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm2.staticflickr.com/1184/5103819890_b5a04908ae_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;(&lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/6f2c00fe48278ac7dde98ce60ea18e409cfc02ed&quot;&gt;corresponding code&lt;/a&gt;)&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Spatial Warning Signals, power, etc</title>
	 <link href="/2010/10/21/spatial-warning-signals-power-etc.html"/>
   <updated>2010-10-21T00:00:00+00:00</updated>
   <id>/10/21/spatial-warning-signals-power-etc</id>
   <content type="html">&lt;p&gt;Noam gave an interesting presentation in our lab today, prompted me to do a little experimentation.  Weakening stability across a set of coupled patches should result in increased autocorrelation.  Decided to test this with a little visualization with help of &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/6f2393b74b60ddc090c18c617a1134ee313cd667/demos/noam.R&quot;&gt;a quick R script&lt;/a&gt;.  &lt;img src=&quot;http://farm2.static.flickr.com/1069/5101483914_5ee14d6b3e_b.jpg&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Time progresses across the x-axis, 1-D space (on S1) across the y-axis.  Each patch suffers a slow loss of stability, resulting in a clearly visible increase in autocorrelation.&lt;/p&gt;
&lt;h3 id=&quot;power-in-warning-signals&quot;&gt;Power in Warning Signals&lt;/h3&gt;
&lt;p&gt;Meanwhile, returning to my work with power in warning signals. Working on a more complete analytical description of the underlying saddle node bifurcation in the example to justify having the “true” underlying model. First, a quick script for the (larger) analytic equilibrium as a function of the bifurcation parameter. From this we can calculate the change in the eigenvalue at the equilibrium as we approach the bifurcation: (&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/e1f910f752f8edcdb0220703b972a107e169fb87/demos/saddle_analytics.R&quot;&gt;code here: saddle_analytics.R&lt;/a&gt;)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm5.staticflickr.com/4089/5101650050_2cc9530a89_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Note that the eigenvalue lambda is evaluated at the fixed point in each case, and over sufficient range in the bifurcation parameter, the change is non-linear. The bifurcation seems to happen at about &lt;span class=&quot;math&quot;&gt;\(a=174\)&lt;/span&gt;, corresponding to an equilibrium population of &lt;span class=&quot;math&quot;&gt;\(\hat x = 525\)&lt;/span&gt;. lambda doesn’t depend on the bifurcation parameter &lt;span class=&quot;math&quot;&gt;\[a\]&lt;/span&gt; except through the value of &lt;span class=&quot;math&quot;&gt;\(\hat x\)&lt;/span&gt;; Unfortunately closed form expressions for &lt;span class=&quot;math&quot;&gt;\(\frac{e K x^2}{h^2+x^2}-e x - a = 0\)&lt;/span&gt; aren’t particularly manageable. The jump in &lt;span class=&quot;math&quot;&gt;\(\hat x\)&lt;/span&gt; which results in a jump in lambda is the result of the numerical minimizer starting to grab the other root – of course lambda should in fact pass smoothly through zero, triggering the bifurcation.&lt;/p&gt;
&lt;h3 id=&quot;and-in-the-literature&quot;&gt;and in the literature…&lt;/h3&gt;
&lt;p&gt;Just noticed an&lt;a href=&quot;http://ff.im/-soIrK&quot;&gt;intriguing paper by R. M. Bailey&lt;/a&gt; on warning signals applied to a spatial simulation (cellular automata model). Appears to focus on classical indicators methods, without discussion of statistical inference or spatially based warning signals. Also, the bifurcation model is unclear to me, seems that some effects are rather related to changing the timescale (effectively the birth rate in this case?) of the model, not necessarily the stability. The need for non-dimensionalization strikes again. Finally, the question of perturbations into alternative stable states continues to be blended into discussions about critical slowing down and bifurcations. While the latter makes the former more likely, the rather different mechanisms by which each drives change seem conflated.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>ecology Abstract</title>
	 <link href="/2010/10/20/stochastic-population-dynamics-abstract.html"/>
   <updated>2010-10-20T00:00:00+00:00</updated>
   <id>/10/20/stochastic-population-dynamics-abstract</id>
   <content type="html">&lt;p&gt;Ecological population sizes fluctuate not only in response to environmental fluctuations but because of the stochastic nature of natural births and deaths. While in very large populations these fluctuations have negligible impact, ecology rarely obliges us by satisfying this limit. Age and stage structure in populations serve to amplify the effect, where the fate of the population is determined by a smaller subset of, say, the fecund adults alone. Demographic noise is probably responsible for the ultimate extinction of many populations once reduced to a small size. Yet the news isn’t all bad. Encoded in the very fluctuations we observe are clues about the biology that we could not see by looking only at averages. I am developing a theory of such fluctuations that uses this noise to inform our decisions about appropriate models and the underlying biological processes.&lt;/p&gt;
&lt;p&gt;This is the cover page to my stochastic population dynamics research.  Below are live feeds for the current entries in the notebook, most recent articles, figures and commits to the code.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.carlboettiger.info/archives/category/stochastic-population-dynamics/&quot;&gt;Notebook Entries&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Stochastic_Population_Dynamics&quot;&gt;Entries from before 20-Oct-2010&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/634301/theoretical-ecology/overview/&quot;&gt;Recently Added Articles&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/634301/theoretical-ecology/feed/rss&quot;&gt;reading feed&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/tags/stochpop/&quot;&gt;Recent Figures&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/cboettig/structured-populations&quot;&gt;Code Updates&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/cboettig/structured-populations/commits/master.atom&quot;&gt;code feed&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics Abstract</title>
	 <link href="/2010/10/20/adaptive-dynamics-abstract.html"/>
   <updated>2010-10-20T00:00:00+00:00</updated>
   <id>/10/20/adaptive-dynamics-abstract</id>
   <content type="html">&lt;p&gt;Adaptive dynamics is a set of recently developed techniques for understanding phenotypic evolution, using a dynamical systems approach to concepts from evolutionary game theory. In contrast to population genetics, this approach tends to explore richer ecological interactions and simpler genetic assumptions, with significant controversy. My own work has focused on a particular element of the theory known as the canonical equation, a macroscopic equation describing the deterministic rate of evolution.&lt;/p&gt;
&lt;p&gt;This is the cover page to my adaptive dynamics research.  Below are live feeds for the current entries in the notebook, most recent articles, figures and commits to the code.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.carlboettiger.info/archives/category/adaptive-dynamics&quot;&gt;Notebook Entries&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://openwetware.org/wiki/Category:Adaptive_Dynamics&quot;&gt;Entries from before 20-Oct-2010&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/529981/adaptive-dynamics/&quot;&gt;Recently Added Articles&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com/groups/529981/adaptive-dynamics/feed/rss&quot;&gt;Adaptive Dynamics reading&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/sets/72157624718737779/&quot;&gt;Recent Figures&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“adaptivedynamics” tag_mode=“all”]&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics&quot;&gt;Code Updates&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/cboettig/AdaptiveDynamics/commits/master.atom&quot;&gt;Adaptive dyanmics Code feed&lt;/a&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/10/19/warning-signals.html"/>
   <updated>2010-10-19T00:00:00+00:00</updated>
   <id>/10/19/warning-signals</id>
   <content type="html">&lt;h3 id=&quot;working-examples&quot;&gt;Working examples&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/demos/kendall.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/demos/kendall.R&quot;&gt;kendall.R&lt;/a&gt; example of kendall’s correlation test on standard warning signal indicator being misleading.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/10/18/Teaching.html"/>
   <updated>2010-10-18T00:00:00+00:00</updated>
   <id>/10/18/Teaching</id>
   <content type="html">&lt;h2 id=&quot;graduate-teaching-community-reflections-on-teaching&quot;&gt;Graduate Teaching Community – reflections on teaching&lt;/h2&gt;
&lt;p&gt;Haven’t made a lot of entries in this notebook as I’m not teaching regularly at the moment, though am still attending meetings of the Graduate Teaching Community, a record of which can be found on our &lt;a href=&quot;http://gtc-blog.blogspot.com&quot; title=&quot;http://gtc-blog.blogspot.com&quot;&gt;GTC blog&lt;/a&gt;. But today in GTC we are thinking about reflections on teaching, and starting with a little bit of journaling, so this seemed like a good place to do it.&lt;/p&gt;
&lt;p&gt;Cass and Karolyn have started us off writing on a few pre-reflection questions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;What are my learning goals for this lesson/course/class?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Often I emphasize problem solving, while I feel my students tend to emphasize factual content as the goal, and de-value problem solving ability. It is this latter perception that I’m most challenged by, and how to change it. The other challenge I think on most is student ownership of content. Not sure I can really define that, I guess it’s a feeling of mastery, or perhaps just familiarity with the content that’s the goal.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;What do I want to improve about my own teaching today?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - What assumptions do I have about my students when they enter my classroom? How do these assumptions affect my interactions with them, and what and how I teach?&lt;/p&gt;
&lt;h2 id=&quot;notes-from-the-rest-of-the-session&quot;&gt;Notes from the rest of the session&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Cycle: &lt;strong&gt;Prepare, Enact, Reflect.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Terminology: Procedural Reflection (what happened?) vs Task Analysis (what worked?) vs Critical Reflection (so what impact?). (see &lt;a href=&quot;http://www.uri.edu/hss/education/faculty/adamy.html&quot; title=&quot;http://www.uri.edu/hss/education/faculty/adamy.html&quot;&gt;Peter Ademie&lt;/a&gt;, &lt;a href=&quot;http://muse.jhu.edu/journals/theory_into_practice/v042/42.3howard.html#top&quot; title=&quot;http://muse.jhu.edu/journals/theory_into_practice/v042/42.3howard.html#top&quot;&gt;Tyrone Howard&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Reflection usually starts with teacher, then curriculum, then student. (i.e. early evaluation focuses on my handwriting on the blackboard, much more experienced teachers reflect on assumptions about student).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;different-kinds-of-reflection&quot;&gt;Different Kinds of Reflection&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Discussion of &lt;strong&gt;&lt;a href=&quot;http://www.lessonstudygroup.net/&quot; title=&quot;http://www.lessonstudygroup.net/&quot;&gt;Lesson Study&lt;/a&gt;&lt;/strong&gt; process. &lt;a href=&quot;http://www.lessonstudygroup.net/05r4informational_videos.html&quot; title=&quot;http://www.lessonstudygroup.net/05r4informational_videos.html&quot;&gt;Informational video&lt;/a&gt;. Basically, large numbers of teachers watch students learn. Began in Japan. Evaluates the lesson itself, not the teacher.&lt;/li&gt;
&lt;li&gt;Sharing practices:
&lt;ul&gt;
&lt;li&gt;Karolyn: Asks for questions / comments on index cards from students.&lt;/li&gt;
&lt;li&gt;Cass: &lt;a href=&quot;http://cassandrapaul.net/wordpress/&quot; title=&quot;http://cassandrapaul.net/wordpress/&quot;&gt;Online teaching journal&lt;/a&gt;. Reflect soon after works best!&lt;/li&gt;
&lt;li&gt;Robert (in abstentia) blue book responses – students write comments about what is working, he writes back in their notebooks.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;resources-at-the-uc-davis-center-for-excellence-in-teaching-and-learning&quot;&gt;Resources at the UC Davis &lt;a href=&quot;http://trc.ucdavis.edu/&quot; title=&quot;http://trc.ucdavis.edu/&quot;&gt;Center for Excellence in Teaching and Learning&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://trc.ucdavis.edu/?page_id=121&quot; title=&quot;http://trc.ucdavis.edu/?page_id=121&quot;&gt;Video tape your class&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://trc.ucdavis.edu/?page_id=120&quot; title=&quot;http://trc.ucdavis.edu/?page_id=120&quot;&gt;Interviews with students&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://trc.ucdavis.edu/?page_id=65&quot; title=&quot;http://trc.ucdavis.edu/?page_id=65&quot;&gt;Confidential Discussion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Status update</title>
	 <link href="/2010/10/15/Status-update.html"/>
   <updated>2010-10-15T00:00:00+00:00</updated>
   <id>/10/15/Status-update</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Actually out of town this day, but draft off to co-authors, will review Friday. meanwhile time to get back to some warning signals work, will be in other notebook for rest of the week.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing continues</title>
	 <link href="/2010/10/14/Writing-continues.html"/>
   <updated>2010-10-14T00:00:00+00:00</updated>
   <id>/10/14/Writing-continues</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Deleting large sections is a great way to spur better writing. Revised organization substantially, discussion somewhat loose still. But basic framework all in place.&lt;/li&gt;
&lt;li&gt;draft off to Peter and Graham!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Wednesday</title>
	 <link href="/2010/10/13/Wednesday.html"/>
   <updated>2010-10-13T00:00:00+00:00</updated>
   <id>/10/13/Wednesday</id>
   <content type="html">&lt;h3 id=&quot;monte-carlo&quot;&gt;Monte Carlo&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Reading Sanderson’s nonparametric rate smoothing and semi-parametric r8s papers in Monte Carlo with Rannala. Comments on articles in text, but great discussion today, particularly Bruce’s take on this style of approach.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Sanderson, M.J. Estimating absolute rates of molecular evolution and divergence times: a penalized likelihood approach. Molecular biology and evolution 19, 101-9(2002).&lt;/li&gt;
&lt;li&gt;Sanderson, M.J. A Nonparametric Approach of Rate Constancy to Estimating Divergence Times in the Absence. Molecular Biology and Evolution 14, 1218-1231(1997).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt; ### Hastings lab presentation&lt;/p&gt;
&lt;p&gt;Presented chalk talk on the Warning Signals project (see stochastic population dynamics notebook).&lt;/p&gt;
&lt;h3 id=&quot;misc&quot;&gt;Misc&lt;/h3&gt;
&lt;p&gt;Mendeley upgrade for Ubuntu up, still need to explore groups and reconsider organization of my lists…&lt;/p&gt;
&lt;h3 id=&quot;writing-lr-continues&quot;&gt;Writing LR continues&lt;/h3&gt;
&lt;p&gt;see version history.&lt;/p&gt;
&lt;h3 id=&quot;r-list-discussion-continued&quot;&gt;R list discussion continued&lt;/h3&gt;
&lt;p&gt;Good question about the applicability of lambda transforms to discrete models (though included in Geiger examples). Interpretation isn’t trivial, but neither can it be dismissed as simply incorrect to do. Here’s my take:&lt;/p&gt;
&lt;p&gt;Good question. Lambda is often taken as a measure of phylogenetic signal. It’s just a tree transform, so it’s just a matter of trying to explain what it means to say a discrete model would fit better if you rescaled the tree like so. In the BM case, you would argue that lambda &amp;lt;&amp;lt; 1 might mean something rather non-brownian is going on, making things forget their ancestry faster. In this case, it seems Lara is assuming an equal rates model, which means that an unbalanced fraction of taxa in a particular trait value can only be explained by phylogeny; not by the stationary solution of some model. A good fit with small lambda would indicate that the phylogeny was not being helpful in explaining this imbalance (imagine an 80/20 split in a binary trait arranged in the least parsimonious manner possible – this would prefer a small lambda and a hint that ecological forces are playing a more important role than phylogenetic inertia).&lt;/p&gt;
&lt;p&gt;If the rates can call differ, small lambda (an unimportant influence of phylogeny) may be confounding with higher transition rates, such that the system can forget its ancestry quickly and reach the stationary distribution. In such cases estimating the tree transforms such as lambda will have identifiability issues – perhaps that plays a role in Lara’s convergence error messages.&lt;/p&gt;
&lt;p&gt;In general if the model is fitting better with the tree transform then without it, this can be taken as an indication that the model itself isn’t a good description of the data. I think that’s as true in the land of continuous traits and BM as it is in discrete traits, regardless of how that particular transform is defined or motivated. Perhaps others would comment on this perspective.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>a day of writing</title>
	 <link href="/2010/10/12/a-day-of-writing.html"/>
   <updated>2010-10-12T00:00:00+00:00</updated>
   <id>/10/12/a-day-of-writing</id>
   <content type="html">&lt;p&gt;Figuring out the best way to present the critique of AIC, introduction to the method, introduction to the power test. Seeking inspiration from Huelsenbeck 1996 and digging farther back into the literature:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; 1. Cox, D.R. Further results on tests of separate families of hypotheses. Journal of the Royal Stastical Society 24, 406-424(1962). 2. Cox, D.R. Tests of Seperate Families of Hypotheses. Proceedings of the 4th Berkeley Symposium, University of California Press 105 - 123(1961). 3. Hall, P., Wilson, S. Two guidelines for bootstrap hypothesis testing. Biometrics 47, 757-762(1991).&lt;/p&gt;
&lt;h2 id=&quot;interesting-question-on-r-sig-phylo&quot;&gt;Interesting question on R-sig-phylo&lt;/h2&gt;
&lt;p&gt;My reply:&lt;/p&gt;
&lt;p&gt;A few responses in-line below, hope they’re helpful. In general averaging over trees to estimate parameters sounds great, a couple hurdles.&lt;/p&gt;
&lt;p&gt;On Tue, Oct 12, 2010 at 5:08 PM, Lara Poplarski &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#108;&amp;#x61;&amp;#114;&amp;#x61;&amp;#112;&amp;#x6f;&amp;#112;&amp;#108;&amp;#x61;&amp;#114;&amp;#x73;&amp;#x6b;&amp;#x69;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#108;&amp;#x61;&amp;#114;&amp;#x61;&amp;#112;&amp;#x6f;&amp;#112;&amp;#108;&amp;#x61;&amp;#114;&amp;#x73;&amp;#x6b;&amp;#x69;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; wrote:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   Dear List,

   I am new to R, and hope someone can kindly help with the following
   task. I have a Bayesian sample of trees in nexus format and discrete
   data; example trees and data are at the bottom of the email. I would
   like to use fitDiscrete in geiger to estimate parameter lambda for all
   variables. The idea is to then compare the distributions across trees
   of lambda values for the different variables.

   I have been using the following:

   for(i in 1:5) {
   cat(&amp;quot;t&amp;quot;,i,&amp;quot;\n&amp;quot;);
   fd&amp;lt;-fitDiscrete(treesi,data,treeTransform=&amp;quot;lambda&amp;quot;)
   print(fd)
   }

   A few specific questions:

   1. Since trees in my sample are non-ultrametric, I get the following warning:
   Warning: some tree transformations in GEIGER might not be sensible for
   nonultrametric trees.

   Is the lambda transformation sensible for non-ultrametric trees? I
   could not find further information on this in the manual or in the
   Pagel references.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; No, the transformation is only meaningful it the trees are ultrametric. The models describe rates of change through time, and thus assume branch lengths are proportional to time, not to number of substitutions. This is true for most models in comparative methods.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; 2. In some cases, I get the following warning: [1] “Warning: may not have converged to a proper solution.”&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   Does it make sense to get fitDiscrete to repeat the ML estimation for
   these cases, until convergence? Can someone suggest how to modify the
   loop above to do this?&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; There are several reasons why the maximum likelihood optimization routine can fail to converge, and you’re quite right that an insufficient number of iterations is one of them. I don’t believe Geiger supports passing additional arguments to the optim routine. The error message you see is produced by Geiger and includes both the case when the iteration number is insufficient or when the algorithm fails to converge for some other reason (such as a ridge of optima, for instance a nearly star like phylogeny will always give this error). See the help page on optim function for more information, but modifying the iterations and error handling will I believe require you to look into the geiger code.&lt;/p&gt;
&lt;p&gt;In leiu of this, you’ll want to note and exclude estimates that do not achieve convergence.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; 3. Finally, I would be grateful for pointers on how to tackle the output. For example, can someone suggest how to go about calculating the mean lambda value, across trees, for each of the 4 variables?&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; There seems to be a bug in the Geiger code whereby it doesn’t actually report the value of lambda (treeParam) if the data argument is a matrix, so this requires an extra step (otherwise you’d pass the whole data matrix and could skip my second apply fn).&lt;/p&gt;
&lt;p&gt;You want to create a matrix where each row represents a different tree, and each column a different trait value.&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;lambda &amp;lt;- sapply(1:n_trees,                        # Apply what follows to all trees
  function( i ){
    sapply(1:n_traits,                                    # Apply what follows for each trait
      function( j ){
        fd &amp;lt;- fitDiscrete(tree[[i]], data[, j ], treeT=&amp;quot;lambda&amp;quot; )     # fitDiscrete for tree i, trait j
        fd[[1]]$treeParam
     })
  }
)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then just calculate the average / variance / histogram / etc over the column.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; I also have a more general question. Both the tree sample and dataset are relative large (1000 trees * 80 variables), so based on preliminary runs I expect the analysis to take rather long. Any suggestions on how to speed things up and/or on a different approach to the tree sample/multiple variable set-up would be most welcome!&lt;/p&gt;
&lt;p&gt;Good point. Since the order you do the trees in doesn’t matter, an sapply function can be used instead of a for loop, it is generally much faster. If you have a multicore machine, take a look at the snowfall package in R, which will let you run your sapply loop in parallel automatically. Sounds like it will take a few days to run them all.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Many thanks in advance,&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Err, hope that made sense, feel free to ask for clarification etc. Carl&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Still writing</title>
	 <link href="/2010/10/11/Still-writing.html"/>
   <updated>2010-10-11T00:00:00+00:00</updated>
   <id>/10/11/Still-writing</id>
   <content type="html">&lt;p&gt;Ah, back after being in bed almost a week with flu. Back to writing manuscript, reworking the presentation of the actual method. Much of the day caught up in Watson’s practice orals (applying computational mechanics to inhibitory neuron circuits), checking in with Yun on his orals and then GTC. too many delays, hope I feel fully better soon.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>LR Manuscript</title>
	 <link href="/2010/10/05/LR-Manuscript.html"/>
   <updated>2010-10-05T00:00:00+00:00</updated>
   <id>/10/05/LR-Manuscript</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Still writing. Working on the comparisons to AIC section. Things to think about adding:&lt;/li&gt;
&lt;li&gt;Explicitly show p values on bootstrap&lt;/li&gt;
&lt;li&gt;What are we calling this thing anyway? After Hulsenbeck &amp;amp; Bull, 1996: ``likelihood heterogeneity test&lt;/li&gt;
&lt;li&gt;All-different seems to have some stability/convergence problems, perhaps a less aggressive example would be better? –Carl Boettiger 19:46, 5 October 2010 (EDT) Stability issues resulted from different fitting methods in initial fit vs. bootstraps. Using nelder-mead (with increased error tolerance) gives consistent, convergent results (that also result in better fits than the box-limited method of before).&lt;/li&gt;
&lt;li&gt;revisit intro to add map section&lt;/li&gt;
&lt;li&gt;Avoid confusion between simulating from a model and assuming that a model is “correct”&lt;/li&gt;
&lt;li&gt;What to do about OU.1? use the improved fit info…&lt;/li&gt;
&lt;li&gt;How about power examples for multiple peaks?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;provide power test between models (return the power directly). So far only do the full power curve on the tree over alpha for OU1 vs BM.&lt;/p&gt;
&lt;h3 id=&quot;more-power-tests&quot;&gt;More power tests&lt;/h3&gt;
&lt;p&gt;Power between OU.2 and OU.LP – a close call? The observed ratio (dark red) seems on the border between the ratio’s expected under one case and under the other. 1000 replicates. &lt;strong&gt;Flickr Error ( Photo not found ): PhotoID 5055243147&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Monday</title>
	 <link href="/2010/10/04/Monday.html"/>
   <updated>2010-10-04T00:00:00+00:00</updated>
   <id>/10/04/Monday</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;7:30 – 8:30 Read ﻿article for Wainwright’s 270:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Streisfeld, M.a. &amp;amp; Rausher, M.D. Population Genetics, Pleiotropy, and the Preferential Fixation of Mutations During Adaptive Evolution. Evolution no-no(2010).doi:10.1111/j.1558-5646.2010.01128.x&lt;/p&gt;
&lt;p&gt;Interesting approach, methods description a little light and both prediction and interpretation of pattern of mutations in coding, cis-reg, and transcription factor sites seems a little loose. Detailed notes on article in Mendeley. More comments after the discussion section at 1pm today.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;8:30 – 9:30 accepted and started reviewing article for Theoretical Ecol, review due Nov 1st. Return to later! (confidential notes in Mendeley)&lt;/li&gt;
&lt;li&gt;9:30 – 1:00pm working on LR manuscript.&lt;/li&gt;
&lt;li&gt;1pm Wainwright’s 270 on predicting evolution (Streisfeld article)&lt;/li&gt;
&lt;li&gt;2pm meet visiting student Ty at house&lt;/li&gt;
&lt;li&gt;4:30pm set up and facilitate Grad Teaching Community meeting&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(&lt;a href=&quot;http://www.carlboettiger.info/calendar&quot; title=&quot;http://www.carlboettiger.info/calendar&quot;&gt;calendar&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&quot;manuscript-scribble&quot;&gt;Manuscript scribble&lt;/h2&gt;
&lt;h3 id=&quot;code-updates&quot;&gt;Code updates&lt;/h3&gt;
&lt;p&gt;Added a “half different” painting of taxa to show problems with AIC persist even when parameters don’t exceed taxa (but still vastly overparameterized). see &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/commit/5e3eb6115e1d2e30f12a52713aba76b10ba470f0#diff-1&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/commit/5e3eb6115e1d2e30f12a52713aba76b10ba470f0#diff-1&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihood Ratio Paper</title>
	 <link href="/2010/10/03/Likelihood-Ratio-Paper.html"/>
   <updated>2010-10-03T00:00:00+00:00</updated>
   <id>/10/03/Likelihood-Ratio-Paper</id>
   <content type="html">&lt;h3 id=&quot;higher-resolution-power-plot-for-anoles-tree&quot;&gt;Higher resolution power plot for Anoles tree&lt;/h3&gt;
&lt;p&gt;Figure (below right) shows power for increasing alpha in the Anoles tree. The vertical line shows the estimated value of alpha for the body-size data – unlikely that a tree of this size can detect selection that is this weak even if it were present. Consequently, this fit should not be taken as evidence that BM is a better fit than the OU, but rather that the data is insufficient to inform this analysis.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/5049237297/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4144/5049237297_86c89766ab.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### The Geiger model fits&lt;/p&gt;
&lt;p&gt;Thinking of extending bootstrap methods to work for geiger tests, i.e. can one justify the lambda transform?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Wrote &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/8bcb043dd72d45566fa82de4af80672a42443673/demos/anoles_ape.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/8bcb043dd72d45566fa82de4af80672a42443673/demos/anoles_ape.R&quot;&gt;anoles_ape.R&lt;/a&gt; in Comparative-Phylogenetics code demos, showing converting the anoles dataset for use with geiger functions. Will write a general bootstrapping that can handle the geiger models. Unfortunately the geiger model fits are not general model fit objects that can be passed to generic functions such as update and simulate. fitContinuous should return the transformed tree, the data, a class object of the fit, the call etc, and be assigned a class. Will have to get around to this later.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Note: for Anoles data, almost none of the tree transformations can improve the likelihood. Delta (exp scaling of branch length) does, just:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; #### Model likelihoods for Anoles under various tree transformations&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; bm$Trait1$lnl
[1] -53.66927
&amp;gt; ou$Trait1$lnl
[1] -53.66268
&amp;gt; lambda$Trait1$lnl
[1] -53.66927
&amp;gt; kappa$Trait1$lnl
[1] -53.66927
&amp;gt; delta$Trait1$lnl
[1] -53.49763
&amp;gt; eb$Trait1$lnl
[1] -53.64517&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt; ### Back to Writing&lt;/p&gt;
&lt;p&gt;Reorganizing the manuscript structure … again. (draft not shown). Mapping out the outline here:&lt;/p&gt;
&lt;h4 id=&quot;are-phylogenies-informative&quot;&gt;Are phylogenies Informative?&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Concerns about the model&lt;/li&gt;
&lt;li&gt;Concerns about the data&lt;/li&gt;
&lt;li&gt;phylogenetic signal&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;examples-from-anoles&quot;&gt;Examples from Anoles&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Why model choice BM vs OU&lt;/li&gt;
&lt;li&gt;Why not AIC – the overparameterized example&lt;/li&gt;
&lt;li&gt;Why a power test: BM vs OU&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;… hmm, how is it dark already? better find my bike lights and continue this later.&lt;/p&gt;
&lt;h2 id=&quot;adaptive-dynamics-comparing-contour-plots&quot;&gt;Adaptive Dynamics: Comparing contour plots&lt;/h2&gt;
&lt;p&gt;Meanwhile, some adaptive dynamics simulations have completed at least. Should remember to save png as higher resolution, but the bottom line seems to show substantial differences between analytic approximation and numerical simulation:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_demo.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_demo.R&quot;&gt;code for figures below&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Comparing results, simulation on the left, Analytic on the right.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Thursday</title>
	 <link href="/2010/09/30/Thursday.html"/>
   <updated>2010-09-30T00:00:00+00:00</updated>
   <id>/09/30/Thursday</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Alan will write introduction to manuscript. Schedule meeting for next week.&lt;/li&gt;
&lt;li&gt;Scheduling the Hastings lab meeting &lt;a href=&quot;http://www.doodle.com/r7ahgfgz4aw6h4ca&quot; title=&quot;http://www.doodle.com/r7ahgfgz4aw6h4ca&quot;&gt;doodle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Coordinate with Baskett lab&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;resources-for-abc-bayesian-inference-in-ecological-and-spatial-context-workshop&quot;&gt;Resources for ABC / Bayesian inference in ecological and spatial context workshop&lt;/h4&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Sisson Sa, Fan Y, Tanaka MM. Sequential Monte Carlo without likelihoods. Proceedings of the National Academy of Sciences of the United States of America. 2007;104(6):1760-5. Available at: &lt;a href=&quot;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1794282&amp;amp;tool=pmcentrez&amp;amp;rendertype=abstract&quot; class=&quot;uri&quot; title=&quot;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1794282&amp;amp;tool=pmcentrez&amp;amp;rendertype=abstract&quot;&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1794282&amp;amp;tool=pmcentrez&amp;amp;rendertype=abstract&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;de Valpine P, Hastings A. Fitting Population Models Incorporating Process Noise and Observation Error. Ecological Monographs. 2002;72(1):57-76. Available at: &lt;a href=&quot;http://www.esajournals.org/doi/abs/10.1890/0012-9615%282002%29072%5B0057%3AFPMIPN%5D2.0.CO%3B2&quot; title=&quot;http://www.esajournals.org/doi/abs/10.1890/0012-9615%282002%29072%5B0057%3AFPMIPN%5D2.0.CO%3B2&quot;&gt;http://www.esajournals.org/doi/abs/10.1890/0012-9615%282002%29072%5B0057%3AFPMIPN%5D2.0.CO%3B2&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Bolker B. Ecological Models and Data in R. Princeton and Oxford: Princeton University Press; 2007.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics Updates</title>
	 <link href="/2010/09/30/Adaptive-Dynamics-Updates.html"/>
   <updated>2010-09-30T00:00:00+00:00</updated>
   <id>/09/30/Adaptive-Dynamics-Updates</id>
   <content type="html">&lt;p&gt;The numerical coexistence time simulations are still running, (Server rest brought down these runs two weeks ago, and they take a few weeks to do all the replicates) meanwhile here are the rest of the analytic set (and one simulation that finished). &lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_analytics.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_analytics.R&quot;&gt;See code&lt;/a&gt; for parameters etc. (Below in frame)&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; EVE Seminar: Brad Shaffer ————————-&lt;/p&gt;
&lt;p&gt;A rather good talk on the California Tiger salamander, emphasizing intersection of ecological and evolutionary investigation in a conservation, management-oriented context.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Land near vernal pool 10x more valuable than 1km away, though salamander habitat extends up to 2km, order of magnitude farther than expected. Estimated from reproductive value of individuals times individual density as a function of distance from the pond.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hybrid study with over 60 markers for the invasive, and three superinvasive genes that must all be present to give the much more competitive large-phenotype metamorph.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;See Brad’s recent Tiger Salamander publications for details.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/09/15/Writing.html"/>
   <updated>2010-09-15T00:00:00+00:00</updated>
   <id>/09/15/Writing</id>
   <content type="html">&lt;p&gt;Working on likelihood ratio/phylogenetic signal manuscript.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### scrap notes from more literature combing&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cheverud 1985 autocorellational model, extended by Gittlman &amp;amp; Kot 1990&lt;/li&gt;
&lt;li&gt;Grafen 89, Pagen &amp;amp; Harvey 89 extending PIC to polytomies&lt;/li&gt;
&lt;li&gt;Harvey &amp;amp; Mace 82, Harvey &amp;amp; Clutton Brock 85 taxonomic rather than phylogenetic&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;From Blomberg et al: “The three best-justified phylogenetically based statistical methods can all be applied with a star phylogeny, in which case they yield results that are exactly the same as a conventional analysis (phylogenetically independent contrasts: Felsenstein 1985; generalized least squares: Grafen 1989; Martins and Hansen 1997; Garland and Ives 2000; Rohlf 2001; Monte Carlo simulations: Martins and Garland 1991; Garland et al. 1993; Reynolds and Lee 1996)”&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;papers claiming: apply only if significant&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(e.g., Gittleman and Kot 1990; Gittleman et al. 1996a; Abouheif 1999). Gittleman and Luh 1992&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/09/14/Writing.html"/>
   <updated>2010-09-14T00:00:00+00:00</updated>
   <id>/09/14/Writing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Working on likelihood ratio/phylogenetic signal manuscript&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Power plots</title>
	 <link href="/2010/09/14/Power-plots.html"/>
   <updated>2010-09-14T00:00:00+00:00</updated>
   <id>/09/14/Power-plots</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4990607836/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4125/4990607836_ed7ab13d3d.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Testing power code. currently null and test distributions of likelihood scores are distinguishable even for small beta on the long time scale. See &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/e47014434e8924ee586be6d5c141c914970a9bd4/demos/warning_example2.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/e47014434e8924ee586be6d5c141c914970a9bd4/demos/warning_example2.R&quot;&gt;code for run&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;running on shorter timescale. Note that parameters match but small code differences in repository code on the last commit since I committed the version on the local machine (my laptop, for development) but ran a slightly tweaked code (typo in reps vs nboot, .o1), on the production server.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;a href=&quot;http://www.flickr.com/photos/cboettig/4991026870/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4130/4991026870_19829f95b9.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Same string of values, shorter timescale. First four values of beta are .001, .01, .5, 1, for a length of time T=50. Will have to quantify detection of the rate of change vs magnitude of change, and also evaluate power analyses of change point.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Peter meeting</title>
	 <link href="/2010/09/13/Peter-meeting.html"/>
   <updated>2010-09-13T00:00:00+00:00</updated>
   <id>/09/13/Peter-meeting</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.sicb.org/meetings/2011/abstracts/index.php3&quot; title=&quot;http://www.sicb.org/meetings/2011/abstracts/index.php3&quot;&gt;SICB&lt;/a&gt; conference
&lt;ul&gt;
&lt;li&gt;Abstract – sent&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Phylogenetic comparative methods have become all but ubiquitous in only a few decades, forcing us to reconsider if information from a phylogenetic tree can justify the results. Existing approaches to this question have been inadequate and do not scale with tree size or the ability to resolve branches. For instance, selection between phylogenetic models typically based on information criteria fails to adequately reflect this uncertainty, and can lead to preference for arbitrarily complicated models. Common measures of phylogenetic signal tend to characterize the goodness-of-fit of a Brownian motion model to the data, rather than indicate whether the data is sufficient to confidently distinguish between different hypotheses. We present a Monte Carlo based approach that allows us to reliably select models of the appropriate complexity and identify when a given phylogenetic tree contains insufficient information to test the hypothesis. We conclude that researchers should not assume a model such as Brownian motion a priori but test alternate hypotheses; not test for correlations between traits and branch lengths before applying a phylogenetic model but rather analyze the power of the tree to identify the chosen model from the alternative hypotheses.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;Application&lt;/li&gt;
&lt;li&gt;Membership?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Meeting with Alan</title>
	 <link href="/2010/09/10/Meeting-with-Alan.html"/>
   <updated>2010-09-10T00:00:00+00:00</updated>
   <id>/09/10/Meeting-with-Alan</id>
   <content type="html">&lt;h3 id=&quot;some-discussion-of-references&quot;&gt;Some discussion of references&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;﻿ Ovaskainen O, Meerson B. Stochastic models of population extinction. Trends in Ecology &amp;amp; Evolution. 2010;(Box 3):1-10. Available at: &lt;a href=&quot;http://dx.doi.org/10.1016/j.tree.2010.07.009&quot; class=&quot;uri&quot; title=&quot;http://dx.doi.org/10.1016/j.tree.2010.07.009&quot;&gt;http://dx.doi.org/10.1016/j.tree.2010.07.009&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;﻿* Goel NS, Richter-Dyn N. Stochastic Models in Biology. The Blackburn Press; 2004:269. Available at: &lt;a href=&quot;http://www.amazon.com/Stochastic-Models-Biology-Narendra-Goel/dp/193066592X&quot; class=&quot;uri&quot; title=&quot;http://www.amazon.com/Stochastic-Models-Biology-Narendra-Goel/dp/193066592X&quot;&gt;http://www.amazon.com/Stochastic-Models-Biology-Narendra-Goel/dp/193066592X&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bjørnstad O, Finkenstädt B, BT. Dynamics of measles epidemics: estimating scaling of transmission rates using a time series SIR model. Ecological Monographs. 2002;72(2):169-184. Available at: &lt;a href=&quot;http://www.esajournals.org/doi/pdf/10.1890/0012-9615(2002)072%5B0169%3ADOMEES%5D2.0.CO%3B2&quot; title=&quot;http://www.esajournals.org/doi/pdf/10.1890/0012-9615(2002)072%5B0169%3ADOMEES%5D2.0.CO%3B2&quot;&gt;http://www.esajournals.org/doi/pdf/10.1890/0012-9615(2002)072%5B0169%3ADOMEES%5D2.0.CO%3B2&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Grenfell BT, Bjørnstad ON, Finkenstädt BF. Dynamics of measles epidemics: scaling noise, determinism, and predictability with the TSIR model. Ecological Monographs. 2002;72(2):185-202. Available at: &lt;a href=&quot;http://www.esajournals.org/doi/pdf/10.1890/0012-9615(2002)072%5B0185%3ADOMESN%5D2.0.CO%3B2&quot; title=&quot;http://www.esajournals.org/doi/pdf/10.1890/0012-9615(2002)072%5B0185%3ADOMESN%5D2.0.CO%3B2&quot;&gt;http://www.esajournals.org/doi/pdf/10.1890/0012-9615(2002)072%5B0185%3ADOMESN%5D2.0.CO%3B2&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;update-on-manuscripts&quot;&gt;Update on Manuscripts&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Revisited the summary report I’d sent Alan with updates on each project. Discussed beetles project two-step process (see Grenfell references above addressing similar concerns but in discrete time).&lt;/li&gt;
&lt;li&gt;Focus on the warning signals paper. Aim to have the power analysis result finished by meeting next Thursday, 3pm.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Lab Notebooks</title>
	 <link href="/2010/09/07/lab-notebooks.html"/>
   <updated>2010-09-07T08:23:45+00:00</updated>
   <id>/09/07/lab-notebooks</id>
   <content type="html">&lt;p&gt;I strive for a transparent and reproducible research process.  My lab notebooks are kept on an open wiki (via &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger&quot;&gt;OpenWetWare&lt;/a&gt;).  I curate the literature I read into several public lists (&lt;a href=&quot;http://www.mendeley.com/profiles/carl-boettiger&quot;&gt;Mendeley&lt;/a&gt;), maintain my research source code and simulations on a collective database for open source development (&lt;a href=&quot;http://github.com/cboettig&quot;&gt;Github&lt;/a&gt;), and am active on academic forums and mailing lists. These web-based tools make a largely automated, interlinked archive of my work I can search, update and share easily.  They have native social media functionality which helps me connect to related research and extend my impact.&lt;/p&gt;
&lt;p&gt;My lab notebooks haven’t yet been migrated to this site. Currently they can still be found on OpenWetWare.  I may consider migrating them here in the future.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics&quot;&gt;Comparative Phylogenetics&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Stochastic_Population_Dynamics&quot;&gt;Stochastic Population Dynamics&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A more at-a-glance view of my research comes from my&lt;a href=&quot;http://www.carlboettiger.info/research/open-science&quot;&gt;activity feeds&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Meeting with Sam</title>
	 <link href="/2010/09/07/Meeting-with-Sam.html"/>
   <updated>2010-09-07T00:00:00+00:00</updated>
   <id>/09/07/Meeting-with-Sam</id>
   <content type="html">&lt;p&gt;Discussing elements of likelihood ratio manuscript and review results from release of constraint data. Figure out what to include in one manuscript, what order to present elements in, and what examples are necessary.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Phylogenetic Signal introduction. Need for examples? A good example where phylogenetically independent contrasts is misleading, but lambda/K definition of phylogenetic signal is also misleading.&lt;/li&gt;
&lt;li&gt;Power in phylogenetic tree:&lt;/li&gt;
&lt;li&gt;&lt;img src=&quot;http://openwetware.org/images/8/8c/Full_power_examples.png&quot; title=&quot;Power in Trees&quot; alt=&quot;image&quot; /&gt;&lt;/li&gt;
&lt;li&gt;Likelihood ratio and model choice: Monte Carlo LR approach, support in the literature http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/08/25.
&lt;ul&gt;
&lt;li&gt;Release of Constraint. &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/07/28&quot;&gt;Cetartiodactyle body size&lt;/a&gt;, &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/07/26&quot;&gt;Parrotfish&lt;/a&gt;, &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/08/05&quot;&gt;others&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;run-analyses-directly-in-lab-notebook&quot;&gt;Run analyses directly in lab notebook&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>evolution Research Abstract</title>
	 <link href="/2010/09/04/hello-world-2.html"/>
   <updated>2010-09-04T16:51:53+00:00</updated>
   <id>/09/04/hello-world-2</id>
   <content type="html">&lt;p&gt;Comparative methods in evolutionary biology use phylogenetic trees to explore the origins and maintenance of biodiversity. I develop methods to extend the kinds of questions we can ask and also to test the statistical limits of our ability to make evolutionary inferences through such a periscope into the past.  I am particularly interested in detecting evolutionary regime shifts – locations in evolutionary history where the governing rules or parameters shift suddenly – as well as more general questions of model choice, informativeness &amp;amp; identifiability in phylogenetic inference.&lt;/p&gt;
&lt;p&gt;This is the cover page to my phylogenetics research.  Below are displayed the live rss feeds for the current entries in the notebook, most recent articles, figures and commits to the code.  This serves to give a brief overview of the project’s current status through these different aspects.&lt;/p&gt;
&lt;h2 id=&quot;recent-notebook-entries&quot;&gt;&lt;a href=&quot;http://www.carlboettiger.info/archives/category/phylogenetics&quot;&gt;Recent Notebook Entries&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;[rssinpage rssfeed=‘http://www.carlboettiger.info/archives/category/phylogenetics/feed’ rssformat=‘x: Y’ rssitems=“5” rssdateformat=‘j F Y’ rsstimezone=‘America/Los_Angeles’]&lt;/p&gt;
&lt;h2 id=&quot;recently-added-articles&quot;&gt;&lt;a href=&quot;http://www.mendeley.com/groups/529971/phylogenetic-methods/overview/&quot;&gt;Recently Added Articles&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;[rssinpage rssfeed=‘http://www.mendeley.com/groups/529971/phylogenetic-methods/feed’ rssformat=‘x: Y’ rssitems=“5” rssdateformat=‘j F Y’ rsstimezone=‘America/Los_Angeles’]&lt;/p&gt;
&lt;h2 id=&quot;recent-figures&quot;&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/tags/phylogenetics/&quot;&gt;Recent Figures&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;[flickr-gallery mode=“tag” tags=“phylogenetics” &lt;code&gt;tag_mode=&amp;quot;all&amp;quot;&lt;/code&gt;]&lt;/p&gt;
&lt;h2 id=&quot;code-updates&quot;&gt;&lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics&quot;&gt;Code Updates&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;[cetsEmbedRSS id=http://github.com/cboettig/Comparative-Phylogenetics/commits/master.atom itemcount=5 itemauthor=0 itemdate=1 itemcontent=0]&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Updating examples of stochastic structured population dynamics</title>
	 <link href="/2010/09/02/Updating-examples-of-stochastic-structured-population-dynamics.html"/>
   <updated>2010-09-02T00:00:00+00:00</updated>
   <id>/09/02/Updating-examples-of-stochastic-structured-population-dynamics</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4951239235/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4125/4951239235_6c3c8f7c9a.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Demonstrating the differences in accounting for the two-step transitions explicitly.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Dotted lines show the one_step process, solid show the two_step process. &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/1e5c89c02c0e34665ffafeb13894ab8c7787a05c/demos/beetles_example.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/1e5c89c02c0e34665ffafeb13894ab8c7787a05c/demos/beetles_example.R&quot;&gt;code&lt;/a&gt;. Code embedded below (experimental, wonder if this is easier than following the link).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; Summer Research Summary ———————–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Finished and sent off the summer research summary for my afternoon meeting with Adam and Micha.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Entry title</title>
	 <link href="/2010/09/01/Entry-title.html"/>
   <updated>2010-09-01T00:00:00+00:00</updated>
   <id>/09/01/Entry-title</id>
   <content type="html">&lt;p&gt;Automated scripts for image uploads. Tag-based generation of a slideshow:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; Running the script:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ./flickr_slideshow *.png&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creates the html code that can be embedded into the notebook for a slideshow those images. Images only get the date-time tag as a unique id.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; This one uses the mediawiki plugin. More formatting options could be incorporated of course. (Creates the thumbnail images down the right-hand side).&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4948495209/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4123/4948495209_c4ed1eae65_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4948495397/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4083/4948495397_572743d7f2_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4948495377/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4133/4948495377_3e2e5d7cdd_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4949084108/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4089/4949084108_951a7f0ffd_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4948495319/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4088/4948495319_a0faf77aea_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4949084050/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4103/4949084050_5cdd93caa6_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4949084018/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4131/4949084018_5a8a09cbdc_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4949084074/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4145/4949084074_cca4f29743_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4948495433/&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4085/4948495433_905a01901f_t.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Good practice/brush up on my regular expressions and bash scripting anyway. Scripts re-upload images each time, even if the image hasn’t changed. Makes the photostream confusing but that’s only temporary. Could simply add the figures to the version management, might be easier, though doesn’t enable things like the slideshow or the social options on a particular figure. Maybe just as well that it’s a free account, duplicates whose urls I don’t track will be lost to the ether.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Adaptive Dynamics Runs ———————-&lt;/p&gt;
&lt;p&gt;Above figures correspond to these &lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_demo.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_demo.R&quot;&gt;analytic approximations&lt;/a&gt; and &lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/R/coexist_time.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/R/coexist_time.R&quot;&gt;coexistence simulations&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Now Re-running coexistence simulations on the (-0.2, 0.2) grid and plotting side-by-side with analytics on same parameters; &lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/0f9a7975a8dd47c9a7683484a38a4f3bd3f9ad00/demos/coexist_demo.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/0f9a7975a8dd47c9a7683484a38a4f3bd3f9ad00/demos/coexist_demo.R&quot;&gt;code&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tuesday</title>
	 <link href="/2010/08/31/Tuesday.html"/>
   <updated>2010-08-31T00:00:00+00:00</updated>
   <id>/08/31/Tuesday</id>
   <content type="html">&lt;p&gt;Much of today’s activity included in yesterday’s.&lt;/p&gt;
&lt;h2 id=&quot;recording-reading&quot;&gt;Recording Reading&lt;/h2&gt;
&lt;p&gt;Still looking for a good way to capture time snapshots of what I’ve read. Perhaps the Mendeley API will have a good solution. Here I try twapper-keeper to create an rss of my tweets on a given day, and the google api, but not very ideal solutions. Checked a variety of ways to &lt;a href=&quot;http://www.readwriteweb.com/archives/6_ways_to_filter_your_rss_feeds.php&quot; title=&quot;http://www.readwriteweb.com/archives/6_ways_to_filter_your_rss_feeds.php&quot;&gt;filter rss feeds&lt;/a&gt; by date so that it would just show the current ones, none seem to manage this though.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt; Loading…&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Summer Review</title>
	 <link href="/2010/08/30/Summer-Review.html"/>
   <updated>2010-08-30T00:00:00+00:00</updated>
   <id>/08/30/Summer-Review</id>
   <content type="html">&lt;h3 id=&quot;stochastic-population-dynamics-in-beetles&quot;&gt;Stochastic Population Dynamics in Beetles&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;early-warning-from-fluctuations-in-populations&quot;&gt;Early Warning from Fluctuations in Populations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/08/30/Adaptive-Dynamics.html"/>
   <updated>2010-08-30T00:00:00+00:00</updated>
   <id>/08/30/Adaptive-Dynamics</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/46456847@N08/4942856122/&quot; title=&quot;analytic_contours1 by cboettig, on Flickr&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4142/4942856122_41461002c9.jpg&quot; alt=&quot;analytic_contours1&quot; /&gt;&lt;/a&gt; Simulation Results (&lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/R/coexist_time.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/R/coexist_time.R&quot;&gt;code&lt;/a&gt;) &lt;a href=&quot;http://www.flickr.com/photos/46456847@N08/4942856132/&quot; title=&quot;coexist_sim1 by cboettig, on Flickr&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4074/4942856132_6b916510c2.jpg&quot; alt=&quot;coexist_sim1&quot; /&gt;&lt;/a&gt; Analytics (&lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_analytics.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_analytics.R&quot;&gt;Analytics code&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&quot;notebooks-and-files&quot;&gt;Notebooks and files&lt;/h2&gt;
&lt;p&gt;Looking at a better way to get figures into my online notebook. I often run simulations that generate figures which I look at, make some adjustments to the code based on the figure, and then delete or overwrite the figure without uploading it to my notebook, because it isn’t “right” or “finished” and uploading takes a lot of clicks, particularly when the code generates 36 figures in a run. Then I discover on some later date that I really want to take another look at the figure. While I usually have the version of the code that generated it saved in github, the codes sometimes take many hours to run, so this isn’t very efficient – it would make much more sense to have everything saved in the notebook. I’m looking into photo hosting sites for figures, as I think these could offer many other benefits as well. Seeing what friendfeed can suggest on this:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Exploring Flickr for scientific figures in my notebook&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4942856122/&quot; title=&quot;analytic_contours1&quot;&gt;&lt;img src=&quot;http://farm5.static.flickr.com/4142/4942856122_41461002c9_m.jpg&quot; alt=&quot;analytic_contours1&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/cboettig/4942856122/&quot; title=&quot;Enlarge&quot;&gt;&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Image embedded using the mediawiki flickr plugin&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;So I’ve set up a &lt;a href=&quot;http://www.flickr.com/photos/46456847@N08/&quot; title=&quot;http://www.flickr.com/photos/46456847@N08/&quot;&gt;flickr account&lt;/a&gt;. First things first: edit settings so default permissions are cc-by. Now time to explore.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;First concern was for permanent stable links, which it seems are guaranteed even in the free account. Will wait and see if I need the capacity of the pro account, but 100MB/month should be a good start.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;offlinedesktop-tools-for-flickr&quot;&gt;Offline/Desktop tools for Flickr&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;One of the most promising things about flickr seems to be the extensive development around it. Several linux native programs support Flickr, including the social netwoking manager, gwibber. Particularly interested in tools that will let me have the automated, command-line upload ability to connect to my notebook. Even if I can automatically get figures into Flickr, I guess there’s still the step of getting them into the notebook. I’m beginning to understand more and more why Cameron talks about aggregators so much. Meanwhile, looking at two ubuntu-native tools:&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://code.google.com/p/dfo/&quot; title=&quot;http://code.google.com/p/dfo/&quot;&gt;DFO&lt;/a&gt;, the Desktop flickr organizer for gnome. Looks nice, easy GUI, very polished. However, no longer under active development and not sure if it has command line support. Can be installed with apt-get.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;–Carl Boettiger 18:21, 30 August 2010 (EDT) Doesn’t seem reliable for uploading, sometimes images don’t appear&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://sites.google.com/site/manishrjain/flickrfs#usage&quot; title=&quot;http://sites.google.com/site/manishrjain/flickrfs#usage&quot;&gt;flickrfs&lt;/a&gt; – remote mount your flickr account like a directory. No interface but then acting like a directory means immediate interoperability with command line and other desktop applications. Should make adding/uploading very easy. Uses filename.meta for metadata. Can be installed directly with apt-get.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;–Carl Boettiger 18:21, 30 August 2010 (EDT) Unable to actually get the directory to mount with user permissions. Mounts but unable to add with root permissions&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://kflickr.sourceforge.net/wikka.php?wakka=Kflickr&quot; title=&quot;http://kflickr.sourceforge.net/wikka.php?wakka=Kflickr&quot;&gt;kflickr&lt;/a&gt;: native KDE flickr uploader. Works great, simple and intuitive. Just for uploading though. No obvious command line interface.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.webupd8.org/2010/03/nautilus-flickr-uploader-linux.html&quot; title=&quot;http://www.webupd8.org/2010/03/nautilus-flickr-uploader-linux.html&quot;&gt;Nautilus integration&lt;/a&gt; works. simple, easy. We’ll see about scripting. apt-get able: nautilus-flickr-uploader&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://search.cpan.org/~cpb/Flickr-Upload/flickr_upload&quot; title=&quot;http://search.cpan.org/~cpb/Flickr-Upload/flickr_upload&quot;&gt;flickr_upload&lt;/a&gt;&lt;/strong&gt; Yay, an easy to use command-line tool that just works. This looks very promising, able to upload photos and add tags with ease.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt; flickr_upload --tag=&amp;quot;my_tag&amp;quot; image.jpg&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;from-flickr-to-notebook&quot;&gt;From Flickr to Notebook&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Can embed flickr using the &lt;a href=&quot;http://wiki.edsimpson.co.uk/index.php/Extended_Flickr_Extension_Syntax#Size&quot; title=&quot;http://wiki.edsimpson.co.uk/index.php/Extended_Flickr_Extension_Syntax#Size&quot;&gt;mediawiki plugin&lt;/a&gt;. Note that syntax is a bit picky, no spaces, a few set sizes. Can always embed as above with html, which, unlike photobucket embed, lets you set the image size in the html.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Looking for embedding options for a whole collection. Flickr supports “sets” and other kinds of groups (including tags). Site will make a slideshow of a set but prevents iframe embedding:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;  &amp;lt;html&amp;gt;&amp;lt;iframe height=&amp;quot;500px&amp;quot; width=&amp;quot;1000px&amp;quot; src=&amp;quot;http://www.flickr.com/photos/46456847@N08/sets/72157624718737779/show/&amp;quot;&amp;gt;
&amp;lt;/iframe&amp;gt;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ah, seems to have it’s own embedding option linked from its slideshow.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Slideshows can also be created using tags. Replacing every instance of the tag in the embed script with the new tag works to create a slideshow of that tag, making it easy to automate this. So, with a single commandline call I can embed the full 30 likelihood ratio comparisons from a few days ago:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;flickr_upload --tag=&amp;quot;LR_anoles&amp;quot; *vs*.png&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;adaptive-dynamics-analytics-results&quot;&gt;Adaptive Dynamics Analytics Results&lt;/h2&gt;
&lt;p&gt;The numerical coexistence time simulations are still running, meanwhile here are the rest of the analytic set (and one simulation that finished). &lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_analytics.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/a4374f840ca0ff81bc2775eff6309a904640bf99/demos/coexist_analytics.R&quot;&gt;See code&lt;/a&gt; for parameters etc.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt; More Open Notebook Science discussion ————————————-&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihood ratio ToDo</title>
	 <link href="/2010/08/27/Likelihood-ratio-ToDo.html"/>
   <updated>2010-08-27T00:00:00+00:00</updated>
   <id>/08/27/Likelihood-ratio-ToDo</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Inclusion of power figure, discussion of power. (include comparison to smaller trees?)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;code-todo&quot;&gt;Code ToDo&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Fix parallelization – lower-level parallelization in LR_boot function seems to have high memory and processing overhead. Parallelize over alpha only. Funny that sfSapply at lower level conflicts when inside an upper-level sfSapply call? Can the lower level be put into sequential mode? Requires more experimenting, probably with simple test functions.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create package around power analysis, including ability to test bootstraps&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Testing of optimizer convergence / error handling in the traitmodels method&lt;/li&gt;
&lt;li&gt;remove traitmodels dependence from power analysis library?&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Incorporate faster linear method from traitmodels (at least for bm and ou1) into the wrightscape package…&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Power test results ——————&lt;/p&gt;
&lt;p&gt;An estimate of how informative a phylogeny is for applications in comparative methods. The independent of trait data, depending only on the structure and size of the tree. (i.e. more taxa help, but unresolved polytomes help less – a large star tree has zero power). All trees are normalized to unit length for comparison of the weakest strength of selection detectable on the tree. For instance, in the 5-taxa primate tree, even if the strength of selection were strong enough to decrease the correlation between ancestors (by e^-2) along a branch only 1/50th of the whole tree length, one would still have only about a 20% chance of detecting that force (at the 95% confidence level). Meanwhile on the carnivora tree one would have about 70% chance of detecting a force of selection 50 times weaker than that, a force that would take the entire time in the tree to decrease the correlation between ancestors by e^-2.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/8/8c/Full_power_examples.png&quot; alt=&quot;Image:Full_power_examples.png&quot; /&gt;&lt;figcaption&gt;Image:Full_power_examples.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/416b1535c4d201a6733667fb38fa744dda1eb510/demos/power_examples.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/416b1535c4d201a6733667fb38fa744dda1eb510/demos/power_examples.R&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihood Ratio Paper- Power in Trees</title>
	 <link href="/2010/08/26/Likelihood-Ratio-Paper--Power-in-Trees.html"/>
   <updated>2010-08-26T00:00:00+00:00</updated>
   <id>/08/26/Likelihood-Ratio-Paper--Power-in-Trees</id>
   <content type="html">&lt;p&gt;&lt;br /&gt; ### Power in Trees tests (Results from single OU simulation per alpha, run yesterday)&lt;/p&gt;
&lt;p&gt;2000 replicates gives a cleaner picture of the critical alpha, though with low alpha values the estimates of p are quite variable. Also more variable on the smaller trees. Even arbitrarily large alpha aren’t significant on the 5-taxa primate tree. On the small geospiza tree (13 taxa) from the geiger package we find:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;0.5735   0.29  0.704 0.6465  0.993  0.838 0.8605 0.9355  0.782  0.845   0.93 
 &amp;quot;0.1&amp;quot;  &amp;quot;0.2&amp;quot;  &amp;quot;0.3&amp;quot;  &amp;quot;0.4&amp;quot;  &amp;quot;0.5&amp;quot;  &amp;quot;0.6&amp;quot;  &amp;quot;0.7&amp;quot;  &amp;quot;0.8&amp;quot;  &amp;quot;0.9&amp;quot;    &amp;quot;1&amp;quot;    &amp;quot;2&amp;quot; 
 0.945 0.9985  0.958 0.7725 0.9995  0.982  0.949  0.992      1   0.99  0.999 
   &amp;quot;3&amp;quot;    &amp;quot;4&amp;quot;    &amp;quot;5&amp;quot;    &amp;quot;6&amp;quot;    &amp;quot;7&amp;quot;    &amp;quot;8&amp;quot;    &amp;quot;9&amp;quot;   &amp;quot;10&amp;quot;   &amp;quot;20&amp;quot;   &amp;quot;30&amp;quot;   &amp;quot;40&amp;quot; 
0.9895 
  &amp;quot;50&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;P values on top row, alpha values in quotes below the p value. Notice 9 fails to be significant at 0.95% confidence level, though might as easily be somewhere around 6. For the Labrid tree with 114 taxa the pattern is clearer though not perfect:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt; 0.621  0.502 0.9735   0.66 0.5185 0.8075 0.9975 0.9665  0.907  0.997 0.9945 
 &amp;quot;0.1&amp;quot;  &amp;quot;0.2&amp;quot;  &amp;quot;0.3&amp;quot;  &amp;quot;0.4&amp;quot;  &amp;quot;0.5&amp;quot;  &amp;quot;0.6&amp;quot;  &amp;quot;0.7&amp;quot;  &amp;quot;0.8&amp;quot;  &amp;quot;0.9&amp;quot;    &amp;quot;1&amp;quot;    &amp;quot;2&amp;quot; 
     1      1      1      1      1      1      1      1      1      1      1 
   &amp;quot;3&amp;quot;    &amp;quot;4&amp;quot;    &amp;quot;5&amp;quot;    &amp;quot;6&amp;quot;    &amp;quot;7&amp;quot;    &amp;quot;8&amp;quot;    &amp;quot;9&amp;quot;   &amp;quot;10&amp;quot;   &amp;quot;20&amp;quot;   &amp;quot;30&amp;quot;   &amp;quot;40&amp;quot; 
     1 
  &amp;quot;50&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Significance clearly sets in between alpha of 0.9 and 1.&lt;/p&gt;
&lt;p&gt;Summary:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; birds$min_alpha
[1] 10
13 taxa
&amp;gt; primates$min_alpha
[1] 1000
(5 taxa)
&amp;gt; carnivora$min_alpha
[1] 1
260 taxa
&amp;gt; labrids$min_alpha
[1] 1
114 taxa
&amp;gt; carex$min_alpha
[1] 2
53 taxa
&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;reducing-the-noise-in-the-power-estimation&quot;&gt;reducing the noise in the power estimation&lt;/h4&gt;
&lt;p&gt;I’ve just implemented the power test for the smallest alpha that can be detected at the 95% level using the (whatarewecallingitnow) likelihood ratio monte carlo approach on a given tree. I try simulating under successively higher alpha values and then see if the resulting dataset can be distinguished. In my first implementation, this involves only one simulation from the OU model at a given alpha, and then the N bootstrap simulations from the null brownian model per alpha.&lt;/p&gt;
&lt;p&gt;Obviously I want more than one simulation from the OU process. It seems I could (1) simulate under the OU model of a given alpha, (2) fit the BM model to the resulting data, (3) simulate under that BM model to get the “bootstrap” data, for which (4) I refit the BM and OU models and compare the likelihood ratio of these refit models. That sounds pretty convoluted when I describe it that way, but I think this is the “natural” thing to do? i.e. steps 2-4 are the bootstrap process which I normally repeat N times for a single dataset, now instead of using a single dataset I draw a dataset from the distribution….&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; New approach: multiple simulations from alpha ———————————————&lt;/p&gt;
&lt;h4 id=&quot;plots-show-decreasing-power-with-decreasing-alpha&quot;&gt;Plots show decreasing power with decreasing alpha&lt;/h4&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/ec/Power_alpha5.png/180px-Power_alpha5.png&quot; alt=&quot;Anoles data at alpha=25. Red curve is the LR distribution when simulations come from OU with alpha=25, blue line is LR distribution when simulations come from BM models fit to those OU-generated data&quot; /&gt;&lt;figcaption&gt;Anoles data at alpha=25. Red curve is the LR distribution when simulations come from OU with alpha=25, blue line is LR distribution when simulations come from BM models fit to those OU-generated data&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Anoles data at alpha=25. Red curve is the LR distribution when simulations come from OU with alpha=25, blue line is LR distribution when simulations come from BM models fit to those OU-generated data&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/9/9a/Power_alpha1.png/180px-Power_alpha1.png&quot; alt=&quot;Anoles data at alpha=1.&quot; /&gt;&lt;figcaption&gt;Anoles data at alpha=1.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Anoles data at alpha=1.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/7/79/Power_alpha.png/180px-Power_alpha.png&quot; alt=&quot;Anoles data at alpha=0.25.&quot; /&gt;&lt;figcaption&gt;Anoles data at alpha=0.25.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Anoles data at alpha=0.25.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; New procedure:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;   ## Draw a data sample from the distribution produced by test
    data &amp;lt;- simulate(test, n=nboot)
 
    ## fit the null models to these data -- so we simulate from the appropriate null
    nulls &amp;lt;- lapply(1:nboot, function(i){
            update(null, data[[i]])
    })
    tests &amp;lt;- lapply(1:nboot, function(i){
            update(test, data[[i]])
    })
    t0_dist &amp;lt;- sapply(1:nboot, function(i){
        if(is(tests[[i]], &amp;quot;hansentree&amp;quot;)){ t0 &amp;lt;- -2*(nulls[[i]]@loglik - tests[[i]]@loglik) }
        else { t0 &amp;lt;- -2*(nulls[[i]]@loglik - tests[[i]]$loglik) }
    })
 
 
    ## Data come from a distribution of nulls, 
    X &amp;lt;- sapply(1:nboot, function(i){
        simulate(nulls[[i]])
    })
 
    t &amp;lt;- sapply(1:nboot, function(i){
        refit_null &amp;lt;- update(null, X[[i]])
        refit_test &amp;lt;- update(test, X[[i]])
        if(is(refit_test, &amp;quot;hansentree&amp;quot;)){ out &amp;lt;- -2*(refit_null@loglik - refit_test@loglik) }
        else { out &amp;lt;- -2*(refit_null@loglik - refit_test$loglik) }
        out
    })
 
 plot(density(out$t), col=&amp;#39;blue&amp;#39;, lwd=3,xlim=range(c(out$t0_dist,out$t)) )
 lines(density(out$t0_dist), col=&amp;#39;red&amp;#39;, lwd=3)&lt;/code&gt;&lt;/pre&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/4/4b/Null_LR.png/180px-Null_LR.png&quot; alt=&quot;Null distributions of the LR all lie on top of eachother regardless of sigma&quot; /&gt;&lt;figcaption&gt;Null distributions of the LR all lie on top of eachother regardless of sigma&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Null distributions of the LR all lie on top of eachother regardless of sigma&lt;/p&gt;
&lt;p&gt;From these it is possible to estimate the power (see &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/6f6c8d70d342761e508e949f710aced716ddf472/R/powertest.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/6f6c8d70d342761e508e949f710aced716ddf472/R/powertest.R&quot;&gt;powertest.R code&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Note that the null distribution (the blue curve) doesn’t actually differ and so doesn’t need to be re-simulated with different values.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/c/c1/Anoles_power.png/180px-Anoles_power.png&quot; alt=&quot;anoles power&quot; /&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;anoles power&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Meanwhile ———&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Finishing the story on model choice in the Anoles dataset. Resimulating with extra replicates and including all 5 original models.&lt;/li&gt;
&lt;li&gt;Good news is that 2000 bootstraps on all 6 models against each other is quite fast on the 16-processor &lt;em&gt;zero&lt;/em&gt;, an hour or so. Bad news is the ou2 funny painted model isn’t bootstrapping the LR correctly, though all the other pairs are.&lt;/li&gt;
&lt;li&gt;Other sorta bad news is that OU_LP does a handy job at beating all other models under Monte Carlo Likelihood Ratio test, so the final conclusion doesn’t have the punchiness a contradiction would. At least the contrived OU2 contradicts this. Should also add the “all different” painting to the mix to demonstrate. –Carl Boettiger 01:24, 27 August 2010 (EDT) Fixed, order of nodes conflicted.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;slideshow-of-results&quot;&gt;Slideshow of results&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;http://photobucket.com/redirect/album?showShareLB=1&quot;&gt;&lt;img src=&quot;http://pic.pbsrc.com/share/icons/embed/btn_geturs.gif&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;a href=&quot;http://s1212.photobucket.com/albums/cc458/cboettig/&quot;&gt;&lt;img src=&quot;http://pic.pbsrc.com/share/icons/embed/btn_viewall.gif&quot; alt=&quot;image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;code-updates&quot;&gt;Code updates&lt;/h2&gt;
&lt;p&gt;–Carl Boettiger 03:26, 27 August 2010 (EDT)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Just implemented the fast version of the power test, which avoids re-simulating from the Brownian motion null, and handles the parallelization with more finesse, and as a single function. Set to run examples overnight.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Removed the traitmodels support from the power test for the moment, until the convergence issues are dealt with. The s3/s4 class differences to access elements make this annoying as method dependency must be handled explicitly by if statements not automatically by class generics. (guess could access by index? – Nope, S4 classes aren’t subsettable)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;updated-power-curves-for-trees&quot;&gt;Updated power curves for trees&lt;/h4&gt;
&lt;p&gt;Using the faster approach avoiding re-sampling the null distribution for each alpha, I generate power curves for trees of different sizes and complexity. The larger, richer trees show more power.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/916ec3622b5b51578c2fe871584f1846b1bddf1f/R/powertest.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/916ec3622b5b51578c2fe871584f1846b1bddf1f/R/powertest.R&quot;&gt;Code for method&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/83e0ecf41603d4f6280f9e497be89c152e661107/demos/power_examples.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/83e0ecf41603d4f6280f9e497be89c152e661107/demos/power_examples.R&quot;&gt;Code for example&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/d/d8/Fast_power_examples.png&quot; alt=&quot;Image:Fast_power_examples.png&quot; /&gt;&lt;figcaption&gt;Image:Fast_power_examples.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihood Ratio Manuscript</title>
	 <link href="/2010/08/25/Likelihood-Ratio-Manuscript.html"/>
   <updated>2010-08-25T00:00:00+00:00</updated>
   <id>/08/25/Likelihood-Ratio-Manuscript</id>
   <content type="html">&lt;h3 id=&quot;graham-peter-meeting&quot;&gt;Graham &amp;amp; Peter Meeting&lt;/h3&gt;
&lt;h4 id=&quot;some-comments-on-neyman-pearson-and-approaches&quot;&gt;Some comments on Neyman Pearson and approaches&lt;/h4&gt;
&lt;p&gt;&amp;gt; In the phylogenetics world, Huelsenbeck has a paper doing this: &amp;quot; A Likelihood Ratio Test to Detect Conflicting Phylogenetic Signal&amp;quot; and there’s a good introduction to the paper.&lt;/p&gt;
&lt;p&gt;This is great, nice to know there’s a basis for it.&lt;/p&gt;
&lt;p&gt;&amp;gt; I see that in the paper John references, &amp;quot; Statistical tests of models of DNA substitution “, they call what you’re doing”Monte Carlo“, and refers to some sort of resampling-the-data equivalent as the bootstrap. The references in that paper are useful: Riplay ’87 and Cox ’61 and ’62. (the first Cox paper is the one I referred to before)&lt;/p&gt;
&lt;p&gt;Yes, it seems a lot of the literature assumes bootstrap means non-parametric bootstrap, and there also seems some bias against the word, so Monte Carlo might be more useful, if less precise, than calling it parametric bootstrap.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &amp;gt; There’s also some literature on mixture models, for instance, in “On Bootstrapping the Likelihood Ratio Test Stastistic for the Number of Components in a Normal Mixture”:&lt;/p&gt;
&lt;p&gt;&amp;gt; &amp;quot; In many situations in practice, for example in cluster analysis where g is the number of components correspond the number of non-overlapping clusters to be produced for the to data, there is no a priori knowledge of g. An obvious way of approaching this problem is to use the likelihood ratio test statistic to test for the smallest value of g compatible with the data. Unfortunately with mixture models, it is well known that regularity conditions do not hold for -2 log A to have its usual asymptotic null distribution of chi-squared with degrees of freedom equal to the difference between the number of parameters under the null and alternative hypotheses. In the context of latent class models, Aitkin, Anderson and Hinde (1981) assessed the null distribution -2 log A using a resampling of method which can be viewed as a particular application of the general bootstrap approach of Efron (1979, 1982). The assessment made is on the basis of a number, say K, of bootstrap replications of -2 log A obtained by appropriate of resampling. More recently, Aitkin and Rubin (1985) adopted an approach which places a prior distribution on the vector of mixing proportions over which the likelihood is integrated before the evaluation of -2 log A. &amp;quot;&lt;/p&gt;
&lt;p&gt;&amp;gt; However, they do things somewhat differently: they re-estimate their parameters for each bootstrapped replicate, and take the likelihood ratio with the resulting parameters.&lt;/p&gt;
&lt;p&gt;This is in fact what I am doing. This makes more sense to me since it treats the simulated data. I should make sure to be more explicit in the paper.&lt;/p&gt;
&lt;p&gt;&amp;gt; Hm, and crucially, here’s a section from Goldman “…DNA substitution” “It is crucially important that these likelihoods be maximized independently for each i (i.e., \alpha and \beta must be estimated separately for each x_i) when performing the Monte Carlo simulation, and not simply calculated under the assumption that \hat \alpha and \hat \beta as estimated from the original data; equation (9b)] are correct.”&lt;/p&gt;
&lt;p&gt;&amp;gt; They refer to Hall and Wilson as saying that not doing this: e.g. not re-estimating the parameters each time, dramatically reduces the power. That paper looks like a good one. Although it says it’s about “nonparametric” bootstrapping; I would have thought this was parametric bootstrapping.&lt;/p&gt;
&lt;p&gt;Right, I have tried both and have found the same thing. Great to have the references to justify it. I’m with you on parametric/non-parametric, though all the non-parametric Bayesians use “non-parametric” in the same sense, as the number of parameters varies with the richness of the data, rather than being predefined.&lt;/p&gt;
&lt;p&gt;&amp;gt; &lt;a href=&quot;http://www.bibsonomy.org/user/peter.ralph/bootstrapAll&quot; title=&quot;http://www.bibsonomy.org/user/peter.ralph/bootstrapAll&quot;&gt;these papers&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; #### some more comments&lt;/p&gt;
&lt;p&gt;-So, Butler and King choose your OU.3 out of their five models? And where do you end up? There is a bit of resolution lacking, here.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; -Do you check to see if the empirical likelihood distributions are relatively stable? (e.g. simulating more isn’t changing them much)&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; -We really ought to find this talked about in the statistical literature. The test of the sort we are talking about is proposed in Cox, “Tests of Separate Families of Hypotheses”, &lt;a href=&quot;http://projecteuclid.org/euclid.bsmsp/1200512162&quot; class=&quot;uri&quot; title=&quot;http://projecteuclid.org/euclid.bsmsp/1200512162&quot;&gt;http://projecteuclid.org/euclid.bsmsp/1200512162&lt;/a&gt; equation (48). Except this does not involve bootstrapping; this has probably been dealt with in the literature. They seem to do this in high-energy physics: &lt;a href=&quot;http://www.springerlink.com/content/q02303062221314n/&quot; class=&quot;uri&quot; title=&quot;http://www.springerlink.com/content/q02303062221314n/&quot;&gt;http://www.springerlink.com/content/q02303062221314n/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; . 2: “correlation typically strongest under a BM model” — really?&lt;/p&gt;
&lt;p&gt;. 4: Not clear why if “The sample points are then statistically independent and the method of phylogenetically independent contrasts will be positively misleading.”&lt;/p&gt;
&lt;p&gt;in general: the processes generally only “reach” the stationary distribution colloquially – to be correct, they “approach” it.&lt;/p&gt;
&lt;p&gt;. 4: For example 1(c), it seems like the two models (correlation due to phylogeny or due to selection towards different optima) may not actually be separable, at least if the branches are long as you imply. (oh, you talk about this on p. 5 ?)&lt;/p&gt;
&lt;p&gt;top of p. 5: For an OU model one can do independent contrasts also, is this not done?&lt;/p&gt;
&lt;p&gt;top of p. 6: The reasoning for “Insufficient data” isn’t so good.&lt;/p&gt;
&lt;p&gt;. 6: “Because the BM model does not have a stationary distribution, correlations established during shared history along a phylogeny are never erased…” – Actually, the correlation still approaches zero as the length of the terminal nodes grows: this approaches the star-tree, for which the tips are independent.&lt;/p&gt;
&lt;p&gt;. 7: “dividing the size data into two groups by maximum likelihood” – dividing by ML how?&lt;/p&gt;
&lt;p&gt;. 8, Figure 3: It seems that in Figure 3, each model’s distribution of AIC score is computed under itself? That is, the red curve were the AIC scores of observations got by simulating under the red model? If so, then the figure does not say that OU.2 outperforms the others. It says that AIC isn’t correctly penalizing, because if it was, all of those curves would be centered in the same place. (right? that’s the point of the penalization?) It would be better, if indeed you aren’t already, to simulate under one model and draw those curves.&lt;/p&gt;
&lt;p&gt;. 9: “most powerful test” means something specific; it shouldn’t be followed by “of the probability of falsely accepting the null hypothesis”.&lt;/p&gt;
&lt;p&gt;. 9: Do you have a citation for the likelihood ratio failing in the case of a boundary value?&lt;/p&gt;
&lt;p&gt;. 10: did you actually implement the bootstrap corrections of Efron et al?&lt;/p&gt;
&lt;p&gt;. 10: I think a better word than “confirm” could be used. Or at least some discussion.&lt;/p&gt;
&lt;p&gt;. 11: Discussion about OU.2 vs OU.3 – P=.06 isn’t all that small, considering the multiple testing going on? Some more discussion is called for.&lt;/p&gt;
&lt;p&gt;. 12 and elsewhere: Probably should avoid “robust” without specifying robust to what, since it means something specific.&lt;/p&gt;
&lt;p&gt;Fig 7: Why don’t you show the corresponding plot for OU.3 vs OU.*?&lt;/p&gt;
&lt;h4 id=&quot;more-comments-by-hand-on-manuscript-printout&quot;&gt;More comments by hand on manuscript printout&lt;/h4&gt;
&lt;h2 id=&quot;power-in-trees-direct-test&quot;&gt;Power in Trees direct test&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Implementing a direct test of power in trees, see &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/dab536f6c70a0bd47847bb088c4277c4b439c5e7/R/powertest.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/dab536f6c70a0bd47847bb088c4277c4b439c5e7/R/powertest.R&quot;&gt;powertest.R&lt;/a&gt; in Comparative-Phylogenetics. Approach simulates data on the tree at progressively higher values of alpha, and uses the Monte Carlo likelihood ratio test to decide the minimum alpha that can be detected relative to the length of the tree. Requires a single likelihood ratio bootstrap on each value of alpha to be tested.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Added support for my older traitmodels function, which I’ve resurrected as a branch from the wrightscape library. located in ~/Documents/experimental/wrightscape-clone/wrightscape/R and is on a branch called single_peak_ou&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - Fits of OU are a subset of BM, so in principle should always outperform the likelihood of BM. Numerics struggle to converge in some cases giving wildly poor likelihoods though.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;parallelization is giving strange errors&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; Error in checkForRemoteErrors(val) : 
 one node produced an error: Starting of snow cluster failed! Error in socketConnection(port = port, server = TRUE, blocking = TRUE,   
 cannot open the connection&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;–Carl Boettiger 02:45, 26 August 2010 (EDT) Fixed by removing the snowfall parallelization in the LR_boot function.&lt;/p&gt;
&lt;h4 id=&quot;primates-example&quot;&gt;primates Example&lt;/h4&gt;
&lt;p&gt;using the trivial 5-taxa primate tree often used in ape package examples, minimum alpha exceeds all values tested (&amp;gt;2000). As expected.&lt;/p&gt;
&lt;h4 id=&quot;anoles-example&quot;&gt;Anoles Example&lt;/h4&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; out2 &amp;lt;- treepower(tree, nboot=100, cpu=1, alpha=alpha )
 
$min_alpha
[1] 6
 
$p
 [1] 0.27 0.86 0.65 0.21 0.17 0.98 0.16 0.69 0.39 0.93 0.97 0.97 1.00 1.00 0.94
[16] 1.00 0.99 1.00 0.99 1.00 1.00 1.00 1.00&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; #### Labrids Example&lt;/p&gt;
&lt;p&gt;appears to be somewhere around 1.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; #### Geospiza Example&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; birds2 &amp;lt;- treepower(ape2ouch(geospiza$geospiza.tree), nboot=100, cpu=1, alpha=alpha)
&amp;gt; birds2$p
 [1] 0.80 0.61 0.17 0.71 0.33 0.72 0.61 0.69 0.80 0.35 0.99 0.78 0.94 1.00 0.94
[16] 0.93 0.72 0.88 0.98 1.00 1.00 0.96 0.97
&amp;gt; alpha
 [1]  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1.0  2.0  3.0  4.0  5.0  6.0
[16]  7.0  8.0  9.0 10.0 20.0 30.0 40.0 50.0
minimum detectable alpha is 9
 
&amp;gt; #fewer replicates, varied outcome
&amp;gt; out &amp;lt;- treepower(tree, nboot=40, cpu=1, alpha=alpha )
&amp;gt; out$p
 [1] 0.375 0.775 0.675 0.525 0.500 0.725 0.950 0.950 1.000 0.575 0.775 1.000
[13] 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000
minimum detectable alpha is 2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; #### Running additional examples overnight =&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/08/19/Writing.html"/>
   <updated>2010-08-19T00:00:00+00:00</updated>
   <id>/08/19/Writing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;revising likelihood ratio manuscript – added a section of conceptual examples to link the model choice and phylogenetic signal sections.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Entry title</title>
	 <link href="/2010/08/19/Entry-title.html"/>
   <updated>2010-08-19T00:00:00+00:00</updated>
   <id>/08/19/Entry-title</id>
   <content type="html">&lt;p&gt;OWW was down, notebook embedded from springnote:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals -- still in code development</title>
	 <link href="/2010/08/18/Warning-Signals----still-in-code-development.html"/>
   <updated>2010-08-18T00:00:00+00:00</updated>
   <id>/08/18/Warning-Signals----still-in-code-development</id>
   <content type="html">&lt;p&gt;OWW was down, notebook embedded from springnote:&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/08/17/Warning-Signals.html"/>
   <updated>2010-08-17T00:00:00+00:00</updated>
   <id>/08/17/Warning-Signals</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Bootstrapping for likelihood ratios!&lt;/li&gt;
&lt;li&gt;Updated class behavior – all simulation and fitting routines now return timeseries objects as data with correct range and timestep.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;updated plotting routines. Likelihood ratio plotting function. Bootstraps of parameters can be plotted using the output from the likelihood ratio fit simulation, avoiding redundancy, just specify which model is desired. Bootstrap likelihood ratio plots includes the original ratio and calculates plot range using this information.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Warning signal model implementation needs to also receive the absolute time, and update alpha_0 as alpha_0 + beta*t&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/08/16/Warning-Signals.html"/>
   <updated>2010-08-16T00:00:00+00:00</updated>
   <id>/08/16/Warning-Signals</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;bootstrapping models implemented&lt;/li&gt;
&lt;li&gt;improved handling of model classes – included T, t0, N, and X0 in object def&lt;/li&gt;
&lt;li&gt;implemented plotting for model bootstrap&lt;/li&gt;
&lt;li&gt;difficulties with changePt model fit remain. fixed one source of trouble – no longer passes zero-length data to OU.lik() when t_shift is outside the time interval.
&lt;ul&gt;
&lt;li&gt;Still giving errors on coercing lists into doubles for the saddle_node bifurcation simulated data set. –&lt;strong&gt;fixed&lt;/strong&gt;, was getting t_shift as a vector from time(X).&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;code-tricks&quot;&gt;Code Tricks&lt;/h2&gt;
&lt;p&gt;Duncan pts out: the S3 mechanism is&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; custom =
 function(x, y, ...)
 UseMethod(&amp;quot;custom&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then that will find and use custom.foo, etc. based on the class of the value of x. You can have it dispatch on a different parameter, but that is not very common. And to dispatch on the types/classes of multiple parameters, e.g. x is a numeric vector, y is a matrix, you would need to use S4.&lt;/p&gt;
&lt;p&gt;See the &lt;a href=&quot;http://sekhon.berkeley.edu/library/methods/html/setGeneric.html&quot; title=&quot;http://sekhon.berkeley.edu/library/methods/html/setGeneric.html&quot;&gt;setGeneric()&lt;/a&gt; function in R for S4 method (also compatible with S3 classes).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/08/15/Warning-Signals.html"/>
   <updated>2010-08-15T00:00:00+00:00</updated>
   <id>/08/15/Warning-Signals</id>
   <content type="html">&lt;p&gt;Exploring convergence in maximum likelihood model fits each on data produced by their own simulation method:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fit1, basic OU method, converges just fine. (using L-BFGS-B method with appropriate bounding box to avoid negatives).&lt;/li&gt;
&lt;li&gt;fit2 , the linear change rate model, converges fine using Nelder-Meade (using 1e12 ~ inf likelihood return when attempting negative alpha or sigma), but throws hard errors for L-BFGS-B:&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; Error in optim(pars, warning.likfn, method = method, lower = lower) : 
 non-finite finite-difference value [3]&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;fit3 runs on “L-BFGS-B” and returns reasonable values, though not meeting convergence standards. Converges successfully on Nelder-Mead.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;using &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/48c204f7cff5c29c7c7a80b24f760cd051df8a21/demos/warning_example.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/48c204f7cff5c29c7c7a80b24f760cd051df8a21/demos/warning_example.R&quot;&gt;this version&lt;/a&gt; of warning_example.R for the example exploration and&lt;/li&gt;
&lt;li&gt;&lt;p&gt;using &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/48c204f7cff5c29c7c7a80b24f760cd051df8a21/R/sde_likelihood.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/48c204f7cff5c29c7c7a80b24f760cd051df8a21/R/sde_likelihood.R&quot;&gt;this version&lt;/a&gt; of methods from sde_likelihood.R&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;code-notes&quot;&gt;Code notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Because optim call takes just parameters and not data, writing data directly to the environment as X so it can be found, following the example of sde package. However this means in functions that want to pass the data to optim calls, they must write the data to the appropriate level, right&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/08/13/Adaptive-Dynamics.html"/>
   <updated>2010-08-13T00:00:00+00:00</updated>
   <id>/08/13/Adaptive-Dynamics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Wrote the code for a better interface to simulate coexistence times and creating contour plots from the results.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/6/62/Coexist_simulated_times.png&quot; alt=&quot;Image:Coexist_simulated_times.png&quot; /&gt;&lt;figcaption&gt;Image:Coexist_simulated_times.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;see &lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/4d45eb416aac48221574b6eb782c80bbec885c12/demos/coexist_demo.R&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics/blob/4d45eb416aac48221574b6eb782c80bbec885c12/demos/coexist_demo.R&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/08/12/Warning-Signals.html"/>
   <updated>2010-08-12T00:00:00+00:00</updated>
   <id>/08/12/Warning-Signals</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Reworking code to allow standard format for:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;evaluating likelihood, – &lt;strong&gt;Done&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;fitting by maximum-likelihood, – &lt;strong&gt;Done&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;simulating, – &lt;strong&gt;Done&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;bootstrapping&lt;/li&gt;
&lt;li&gt;plotting models and bootstrap results.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;changePt.sim, changePt.lik implemented.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; #### Function Behavior notes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;R’s mle function wants a named list.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Updated parameter handling of OU.lik to allow parameters in alpha,theta,sigma format or theta1, theta2, theta3 format, as either lists or numerics, named or unnamed. Type handling in each function isn’t helping the speed, but optimization will have to wait.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - &lt;em&gt;Note:&lt;/em&gt; Considered allowing for a generalized change-point function, taking two separate models and splitting them over a changepoint. No obvious way to handle which parameters are global and which are local when the models can differ in their parameter structure though, so not simply generalizable and abstract.&lt;/p&gt;
&lt;h3 id=&quot;logic-for-model-analysis&quot;&gt;Logic for model analysis&lt;/h3&gt;
&lt;p&gt;Collection of different models, each with a suite of associated methods. Current models are:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;OU&lt;/li&gt;
&lt;li&gt;Warning, a linear change in alpha&lt;/li&gt;
&lt;li&gt;ChangePt, a discrete jump in alpha&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Methods&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;simulate&lt;/li&gt;
&lt;li&gt;evaluate likelihood&lt;/li&gt;
&lt;li&gt;fit by likelihood&lt;/li&gt;
&lt;li&gt;bootstrap parameter estimates&lt;/li&gt;
&lt;li&gt;bootstrap model choice (Neyman-Pearson)&lt;/li&gt;
&lt;li&gt;plotting functions for: simulation, parameter bootstrap, model choice, model value fit expected value over time-series&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;challenges&quot;&gt;Challenges&lt;/h4&gt;
&lt;p&gt;Trouble getting convergence for maximum likelihood fits to simulation results. By throwing inf log likelihood with out-of-bounds parameters (should really set a limit epsilon rather than zero on alpha/sigma values using “L-BFGS-B” method) can avoid hard errors in optim, but mle throws hard errors and optim complains about convergence: “ERROR: ABNORMAL_TERMINATION_IN_LNSRCH”, a convergence error of 52 in “L-BFGS-B” method.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/08/12/Adaptive-Dynamics.html"/>
   <updated>2010-08-12T00:00:00+00:00</updated>
   <id>/08/12/Adaptive-Dynamics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Created plotting functions for:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;waiting time distribution by phase, (cumulative and difference),&lt;/li&gt;
&lt;li&gt;distribution of number of failures before invasion of dimophism can occur and after it has occurred (indicating if mutational rate is more limiting or mutational step size (selection gradient).&lt;/li&gt;
&lt;li&gt;Adding to the pairwise invasibility plot the locations where dimorphism collapses, color coded by the time of collapse.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Exploring branching time distributions in different regimes by phase. Trying to figure out which parameter regimes which actually branch successfully in under 5e5 time units. Note that these aren’t timesteps, since this is Gillespie simulation; I think about birth R*Ko events occur every time unit, so an R=1, ko=500 simulations this is about 5e8, with about 2.5e4 - 2.5e5 mutations occurring in the simulation. with 100 ensembles and 4 parameter regimes this is 1e11 events. As the algorithm scales tightly on how many populations it must handle (much faster when essentially monomorphic) this isn’t directly proportional to speed, but on the 16 processor machines takes about a couple hours to run…&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Branching success by regimes tried&lt;/p&gt;
&lt;h4 id=&quot;first-set&quot;&gt;First set&lt;/h4&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt; rep &amp;lt;- 100
 cpu &amp;lt;- 16
 all[[1]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 1e-3, sigma_c2 = .8, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
 all[[2]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 1e-3, sigma_c2 = .1, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
 all[[3]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 5e-4, sigma_c2 = .8, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
 all[[4]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 1e-4, sigma_c2 = .3, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
 
for(i in 1:4){
    png(file=paste(&amp;quot;run2_waitingtimes_ens_&amp;quot;, i, &amp;quot;.png&amp;quot;, sep=&amp;quot;&amp;quot;))
    plot_waitingtimes(all[[i]])
    dev.off()
 
    png(file=paste(&amp;quot;run2_butterfly_ens_&amp;quot;, i, &amp;quot;.png&amp;quot;, sep=&amp;quot;&amp;quot;))
    plot_butterfly(all[[i]])
    dev.off()
 
    png(file=paste(&amp;quot;run2_failures_ens_&amp;quot;, i, &amp;quot;.png&amp;quot;, sep=&amp;quot;&amp;quot;))
    plot_failures(all[[i]])
    dev.off()
}
 
&amp;gt; proc.time()
    user   system  elapsed 
   2.700    0.440 4685.922&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;corresponds to a runtime of about 78 minutes, with most simulations running to maximum time. Results in run order shown&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/c/c9/Failures_ens_1.png/400px-Failures_ens_1.png&quot; alt=&quot;image&quot; /&gt; ::::: &lt;img src=&quot;http://openwetware.org/images/thumb/6/63/Failures_ens_2.png/400px-Failures_ens_2.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/7/71/Failures_ens_3.png/400px-Failures_ens_3.png&quot; alt=&quot;image&quot; /&gt; ::::: &lt;img src=&quot;http://openwetware.org/images/thumb/7/7f/Failures_ens_4.png/400px-Failures_ens_4.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/b/bc/Butterfly_ens_1.png/400px-Butterfly_ens_1.png&quot; alt=&quot;image&quot; /&gt; ::::: &lt;img src=&quot;http://openwetware.org/images/thumb/7/75/Butterfly_ens_2.png/400px-Butterfly_ens_2.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/8/87/Butterfly_ens_3.png/400px-Butterfly_ens_3.png&quot; alt=&quot;image&quot; /&gt; ::::: &lt;img src=&quot;http://openwetware.org/images/thumb/1/1e/Butterfly_ens_4.png/400px-Butterfly_ens_4.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Spikes at the end of waiting times indicate simulation termination before event occurs, from runs that never branched&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/8/8b/Waitingtimes_ens_1.png/400px-Waitingtimes_ens_1.png&quot; alt=&quot;image&quot; /&gt; ::::: &lt;img src=&quot;http://openwetware.org/images/thumb/e/e4/Waitingtimes_ens_2.png/400px-Waitingtimes_ens_2.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/3/35/Waitingtimes_ens_3.png/400px-Waitingtimes_ens_3.png&quot; alt=&quot;image&quot; /&gt; ::::: &lt;img src=&quot;http://openwetware.org/images/thumb/6/69/Waitingtimes_ens_4.png/400px-Waitingtimes_ens_4.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Trying to find parameters where more runs will finish in 5e5 max time.&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;all[[1]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 5e-3, sigma_c2 = .8, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
all[[2]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 1e-3, sigma_c2 = .1, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
all[[3]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.03, mu = 5e-4, sigma_c2 = .3, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
all[[4]] &amp;lt;- ensemble_sim(rep=rep, sigma_mu = 0.05, mu = 1e-4, sigma_c2 = .3, sigma_k2 = 1, ko = 500, xo = 0.1, threshold = 30, cpu=cpu)
 
==== Second Set ====&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;1 and 2 complete fine (2 is the easiest branching situation of the set clearly). 3 and 4 struggle to complete. Should try more exploratory sets before the large simulations.&lt;/p&gt;
&lt;p&gt;(probably not worth loading second set of figures), first and second sets are reliably finishing most of time in these parameters. Quite surprising for the first since the branching point becomes very weak, but the high mutation rate makes this possible.&lt;/p&gt;
&lt;h2 id=&quot;updates-needed-for-code&quot;&gt;Updates needed for code&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Simulation should have option to record full path&lt;/li&gt;
&lt;li&gt;Recording times of coexistence&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;updates-needed-for-notebook&quot;&gt;Updates needed for Notebook?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Somewhat tedious way to record results, even using the multiple uploads feature. Still, need to be able to preserve the figures and the code that creates them for each day. Wondering how the &lt;a href=&quot;http://github.com/blog/699-making-github-more-open-git-backed-wikis&quot; title=&quot;http://github.com/blog/699-making-github-more-open-git-backed-wikis&quot;&gt;revised github wiki&lt;/a&gt; would fare for this…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/08/11/Adaptive-Dynamics.html"/>
   <updated>2010-08-11T00:00:00+00:00</updated>
   <id>/08/11/Adaptive-Dynamics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Adding demos directory for the simulations to create the figures in User:Carl Boettiger/Notebook/Comparative Phylogenetics/2010/05/03 and User:Carl Boettiger/Notebook/Comparative Phylogenetics/2010/05/04&lt;/li&gt;
&lt;li&gt;Updating the contour plot figure as per suggestions by Rupert and Ulf:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/10/Butterfly.png/500px-Butterfly.png&quot; alt=&quot;Branching times, original figure&quot; /&gt;&lt;figcaption&gt;Branching times, original figure&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Branching times, original figure&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;use more points for the simulation, and don’t put them on a regular grid, but maybe draw them from a uniform distribution, so as not to create spurious impressions of symmetry. You could then maybe also use the tripack package to draw colored &lt;a href=&quot;http://en.wikipedia.org/wiki/Voronoi_diagram&quot; title=&quot;http://en.wikipedia.org/wiki/Voronoi_diagram&quot;&gt;Voronoi cells&lt;/a&gt; instead of same-sized symbols.&lt;/li&gt;
&lt;li&gt;color cells as grayscales from white (short) to dark (long survival) because the colors probably falsely suggest discrete jumps where there are probably none. Also, a legend that relates the colors to the numbers on the contour lines would be helpful for the viewer.&lt;/li&gt;
&lt;li&gt;make the contour lines (from analytics) more smooth, presumably by choosing more supporting points.&lt;/li&gt;
&lt;li&gt;choose axes to cover the same range and make plot quadratic, so that symmetries are easily revealed.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;more-questions&quot;&gt;&amp;amp; more questions:&lt;/h4&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Calculate the expected survival time, if we just assume that the dimorphic population moves away from the branching point on a trajectory given by the canonical equation, given a (demographically equilibrated) starting point at (or near) the branching point?&lt;/li&gt;
&lt;li&gt;How does this picture now change (if it does?) when the total number of individuals is in- or decreased and the relative magnitude of demographic fluctuations thus changed?&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;some-notebook-commentary&quot;&gt;Some notebook commentary&lt;/h3&gt;
&lt;p&gt;Unfortunately I once again regret that I did not have a lab notebook last summer while doing most of this research. At least I have the version history, though in svn, and the biweekly reports.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/08/10/Warning-Signals.html"/>
   <updated>2010-08-10T00:00:00+00:00</updated>
   <id>/08/10/Warning-Signals</id>
   <content type="html">&lt;h3 id=&quot;alternate-models&quot;&gt;Alternate models&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Writing down the change-point model correctly now, starting with the simulation. &lt;strong&gt;Done.&lt;/strong&gt; Implemented in &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/959b426292915ebc90222b971f8298870df5c912/R/sde_likelihood.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/959b426292915ebc90222b971f8298870df5c912/R/sde_likelihood.R&quot;&gt;sde_likelihood.R&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Implementing Neyman-Pearson comparisons for all three models.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;linearizing-directly-from-the-saddle-node-model&quot;&gt;Linearizing directly from the saddle node model&lt;/h4&gt;
&lt;p&gt;Dynamics:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/8/3/1/8313f708bcb8cef91bf83746d04c8941.png&quot; alt=&quot;\frac{K e n^2}{n^2 + h^2} - e n - a&quot; /&gt;&lt;figcaption&gt;\frac{K e n^2}{n^2 + h^2} - e n - a&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Slope (alpha) at equilibrium comes from the derivative:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/f/9/9/f99debdc2a427e17fe5e2c5054996df2.png&quot; alt=&quot;\frac{1}{n} \left( \frac{K e n^2}{n^2 + h^2} - e n - a \right) -\frac{2 K e n^3}{\left( n^2 + h^2 \right)^2}&quot; /&gt;&lt;figcaption&gt;\frac{1}{n} \left( \frac{K e n^2}{n^2 + h^2} - e n - a \right) -\frac{2 K e n^3}{\left( n^2 + h^2 \right)^2}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/0/4/d/04dd614e5354123085866d3a9dd01000.png&quot; alt=&quot;\implies -\frac{2 K e n^3}{\left( n^2 + h^2 \right)^2}&quot; /&gt;&lt;figcaption&gt;\implies -\frac{2 K e n^3}{\left( n^2 + h^2 \right)^2}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;is the slope evaluated at n equal to equilbrium (which is the root of some messy cubic).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihood ratio update</title>
	 <link href="/2010/08/10/Likelihood-ratio-update.html"/>
   <updated>2010-08-10T00:00:00+00:00</updated>
   <id>/08/10/Likelihood-ratio-update</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Sent drafts of Likelihood ratio paper to Peter Wainwright (Sunday 08/08) and Graham Coop (Monday 08/09)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;wrightscape&quot;&gt;Wrightscape&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Sent Peter more information on the release of constraint results in the Labrid system.&lt;/li&gt;
&lt;li&gt;Starting wrightscape manuscript.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;changes-to-wrightscape.r&quot;&gt;Changes to &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/4556a517a96467d5efe993ec585adcc66b925c46/R/wrightscape.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/4556a517a96467d5efe993ec585adcc66b925c46/R/wrightscape.R&quot;&gt;wrightscape.R&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;added a tree plotting function to the wrighttree class.&lt;/li&gt;
&lt;li&gt;labels on parameter bootstrap distributions for labrids in last week’s entry reversed wrasses and parrotfish. I’ve updated the software so that the plotting function takes care of the labeling automatically (when these were made it had to be added manually, while the automation of the data conversions and the painting by clade reversed the label assignments).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals by model choice</title>
	 <link href="/2010/08/09/Warning-Signals-by-model-choice.html"/>
   <updated>2010-08-09T00:00:00+00:00</updated>
   <id>/08/09/Warning-Signals-by-model-choice</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Finished implementation of simulation from saddle-node example&lt;/li&gt;
&lt;li&gt;Implemented simulation from transition density for all three models&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;whoops&quot;&gt;Whoops&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The change point model can’t be summarized by the transition density, as this depends only on the time interval and not the absolute time. The nice description of being able to solve for the transition density when the transition occurs during the time interval specified is neither necessary nor applicable in this context!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/08/08/Warning-Signals.html"/>
   <updated>2010-08-08T00:00:00+00:00</updated>
   <id>/08/08/Warning-Signals</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Working on implementation of the the TwoRates model looking for changepoint:&lt;/li&gt;
&lt;li&gt;See for most of code implementation &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/R/sde_likelihood.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/R/sde_likelihood.R&quot;&gt;sde_likelihood.R&lt;/a&gt; and for the model choice example see &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/demos/warning_example.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/demos/warning_example.R&quot;&gt;warning_example.R&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;general-code-cleanup&quot;&gt;General Code cleanup&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Added a &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/src/saddle_node_direct.c&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/src/saddle_node_direct.c&quot;&gt;saddle-node bifurcation&lt;/a&gt; simulation in the format of the metapop/hastings/crowley/beetles models already in the stochastic population dynamics library. Allows for C-based parallelized ensemble simulation using my Gillespie library. R call to all of these models can be found in &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/R/ind_based_models.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/c12b986d2804c261b2126edd4c53e421446f020a/R/ind_based_models.R&quot;&gt;ind_based_models.R&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Reading</title>
	 <link href="/2010/08/07/Reading.html"/>
   <updated>2010-08-07T00:00:00+00:00</updated>
   <id>/08/07/Reading</id>
   <content type="html">&lt;p&gt;Trying to make this show reading of the day, the script below shows only current reading:&lt;/p&gt;
&lt;p&gt;Friendfeed discussion on solving this:&lt;/p&gt;
&lt;h2 id=&quot;warning-signals&quot;&gt;Warning Signals&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Implementing likelihood-based methods for early warning signals. Trying three models:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/3/f/8/3f8dd657158475757eb6bd177e3c3ad1.png&quot; alt=&quot;\begin{align} dX =&amp;amp; (\theta_1 + \theta_2 X) dt + \theta_3 dW_t \\ dX =&amp;amp;(\alpha_0+\beta t) (\theta + X) dt + \sigma dW_t \\ dX =&amp;amp; \alpha(t) (\theta + X) dt + \sigma dW_t \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} dX =&amp;amp; (\theta_1 + \theta_2 X) dt + \theta_3 dW_t \\ dX =&amp;amp;(\alpha_0+\beta t) (\theta + X) dt + \sigma dW_t \\ dX =&amp;amp; \alpha(t) (\theta + X) dt + \sigma dW_t \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; - Model 3 is intended to be a changepoint analysis, where α(&lt;em&gt;t&lt;/em&gt;) is piecewise constant. - I solved analytically the transition probability density in Model 2 on User:Carl Boettiger/Notebook/Stochastic Population Dynamics/2010/05/06, see this and the following entry. - Code implementations are in &lt;a href=&quot;http://github.com/cboettig/structured-populations&quot; title=&quot;http://github.com/cboettig/structured-populations&quot;&gt;Structured Populations&lt;/a&gt; repository&lt;/p&gt;
&lt;h4 id=&quot;to-do&quot;&gt;To Do&lt;/h4&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Simulation routine for custom equations (2, 3)&lt;/li&gt;
&lt;li&gt;Neyman-Pearson Likelihood ratio test method between models&lt;/li&gt;
&lt;li&gt;Simulation from actual population dynamics – update warning signals method to return individual runs&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Batch Data</title>
	 <link href="/2010/08/05/Batch-Data.html"/>
   <updated>2010-08-05T00:00:00+00:00</updated>
   <id>/08/05/Batch-Data</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Some of the nexus files don’t seem to read into R. Opening and saving the file in figtree solves this.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;data-sets&quot;&gt;Data Sets&lt;/h2&gt;
&lt;h3 id=&quot;labrid-traits&quot;&gt;Labrid traits&lt;/h3&gt;
&lt;p&gt;–Carl Boettiger 00:52, 11 August 2010 (EDT) Note: labels on parameter bootstrap distributions have reversed wrasses and parrotfish. I’ve updated the software so that the plotting function takes care of the labeling automatically (when these were made it had to be added manually, while the automation of the data conversions and the painting by clade reversed the label assignments). See User:Carl Boettiger/Notebook/Comparative Phylogenetics/2010/08/10.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/f/f4/Gapedistance_mm_model.png/500px-Gapedistance_mm_model.png&quot; alt=&quot;Gape distance (weighted by body mass)&quot; /&gt;&lt;figcaption&gt;Gape distance (weighted by body mass)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Gape distance (weighted by body mass)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/c/c3/Gapedistance_mm_pars.png/500px-Gapedistance_mm_pars.png&quot; alt=&quot;Gape distance (weighted by body mass)&quot; /&gt;&lt;figcaption&gt;Gape distance (weighted by body mass)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Gape distance (weighted by body mass)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/b/b4/Protrusiondistance_mm_model.png/500px-Protrusiondistance_mm_model.png&quot; alt=&quot;Protrusion distance weighted by body mass&quot; /&gt;&lt;figcaption&gt;Protrusion distance weighted by body mass&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Protrusion distance weighted by body mass&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/b/be/Protrusiondistance_mm_pars.png/500px-Protrusiondistance_mm_pars.png&quot; alt=&quot;Protrusion distance weighted by body mass&quot; /&gt;&lt;figcaption&gt;Protrusion distance weighted by body mass&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Protrusion distance weighted by body mass&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/1f/Bodymass_g_model.png/500px-Bodymass_g_model.png&quot; alt=&quot;Body Mass&quot; /&gt;&lt;figcaption&gt;Body Mass&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Body Mass&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/2b/Bodymass_g_pars.png/500px-Bodymass_g_pars.png&quot; alt=&quot;Body Mass&quot; /&gt;&lt;figcaption&gt;Body Mass&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Body Mass&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/6/60/Jawclosingleverratio_model.png/500px-Jawclosingleverratio_model.png&quot; alt=&quot;Jaw closing lever ratio&quot; /&gt;&lt;figcaption&gt;Jaw closing lever ratio&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Jaw closing lever ratio&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/9/91/Jawclosingleverratio_pars.png/500px-Jawclosingleverratio_pars.png&quot; alt=&quot;Jaw closing lever ratio&quot; /&gt;&lt;figcaption&gt;Jaw closing lever ratio&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Jaw closing lever ratio&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/36/Jawopeningleverratio_model.png/500px-Jawopeningleverratio_model.png&quot; alt=&quot;Jaw opening lever ratio&quot; /&gt;&lt;figcaption&gt;Jaw opening lever ratio&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Jaw opening lever ratio&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/26/Jawopeningleverratio_pars.png/500px-Jawopeningleverratio_pars.png&quot; alt=&quot;Jaw opening lever ratio&quot; /&gt;&lt;figcaption&gt;Jaw opening lever ratio&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Jaw opening lever ratio&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/4/4e/Jawkt_model.png/500px-Jawkt_model.png&quot; alt=&quot;Jaw kinematic transmission&quot; /&gt;&lt;figcaption&gt;Jaw kinematic transmission&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Jaw kinematic transmission&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/0/00/Jawkt_pars.png/500px-Jawkt_pars.png&quot; alt=&quot;Jaw kinematic transmission&quot; /&gt;&lt;figcaption&gt;Jaw kinematic transmission&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Jaw kinematic transmission&lt;/p&gt;
&lt;p&gt;Based on nboot = 100&lt;/p&gt;
&lt;p&gt;Various muscle mass traits do not seem to converge.&lt;/p&gt;
&lt;h3 id=&quot;carnivora-traits&quot;&gt;Carnivora Traits&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/1d/Carnivora_models.png/500px-Carnivora_models.png&quot; alt=&quot;Carnivore size by habitat: aquatic vs terrestrial&quot; /&gt;&lt;figcaption&gt;Carnivore size by habitat: aquatic vs terrestrial&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Carnivore size by habitat: aquatic vs terrestrial&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/5/56/Carnivora_pars.png/500px-Carnivora_pars.png&quot; alt=&quot;Carnivore size by habitat: aquatic vs terrestrial&quot; /&gt;&lt;figcaption&gt;Carnivore size by habitat: aquatic vs terrestrial&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Carnivore size by habitat: aquatic vs terrestrial&lt;/p&gt;
&lt;p&gt;No preference for any model. OU.1 fit has non-zero, though small alpha, which cannot be distinguished significantly from the Brownian motion model. No evidence for either of the regimes models. (Might compare ws2 to ou1 though)&lt;/p&gt;
&lt;p&gt;Brownian motion:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;sigma squared:
         [,1]
[1,] 3.922782
 
theta:
NULL
   loglik  deviance       aic     aic.c       sic       dof 
-317.3379  634.6758  638.6758  638.7225  645.7971    2.0000&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;OU.1:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;alpha:
          [,1]
[1,] 0.2056982
 
sigma squared:
         [,1]
[1,] 4.099564
 
theta:
$size
 
9.39714 
 
   loglik  deviance       aic     aic.c       sic       dof 
-318.9566  637.9133  643.9133  644.0070  654.5953    3.0000&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; The coding of marine and freshwater separate, as well as a terrestrial regime does not converge under the wrightscape simplex method using the hansen initial conditions, but does just fine using the standard 1,1 initial conditions. Running now.&lt;/p&gt;
&lt;h3 id=&quot;mammalia&quot;&gt;Mammalia&lt;/h3&gt;
&lt;p&gt;The huge mammalia data set takes a while even fitting the hansen model on the painting. bm loglik returns INF, ou1 returns loglik of -3727. the multiple regime model simplex routine fails to converge using the seed from ou2. Note the dramatic differences in the log body size optima found by the regime model. Certainly these differences must accomplish most of the difference in likelihood of this model.&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;alpha:
           [,1]
[1,] 0.01144819
 
sigma squared:
         [,1]
[1,] 6.277772
 
theta:
$size
       1062     aquatic terrestrial      volant 
   8.961080  254.067332    8.059478 -217.152860 
 
   loglik  deviance       aic     aic.c       sic       dof 
-3721.305  7442.610  7454.610  7454.634  7491.439     6.000&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Data Format functions</title>
	 <link href="/2010/08/04/Data-Format-functions.html"/>
   <updated>2010-08-04T00:00:00+00:00</updated>
   <id>/08/04/Data-Format-functions</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Spent much of the day trying to code an intelligent data-preprocessing function. Seems to mostly be working now, see github for details. Testing on a variety of datasets.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Currently the function assumes paintings can be specified by common ancestors of a set of tips, assumes non-overlapping clades. Doesn’t error-check for this either.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;should also have more output processing functions, particularly to return a “phylo” object together with paintings (see earlier existing code in my Comparative-Phylogenetics repository).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;exploration-on-new-data-sets&quot;&gt;Exploration on new data sets&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Carnivora&lt;/strong&gt; – running with aquatic/terrestrial encoding and marine/freshwater/terrestrial encoding. Both set to run overnight. Wrightscape’s simplex method has some trouble with certain initial conditions on the three-regime model.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Mammalia&lt;/strong&gt; – body size, with regime by biome (aquatic, terrestrial, volant (bats). Huge data set, also running over night.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cetacea&lt;/strong&gt; – body size by diet. my preprocessing function seems to have some trouble with the painting&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/08/03/Writing.html"/>
   <updated>2010-08-03T00:00:00+00:00</updated>
   <id>/08/03/Writing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Finished a draft of manuscript on Likelihood ratio, sent to Sam and Peter Ralph.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Open Science Summit Day 3</title>
	 <link href="/2010/07/31/Open-Science-Summit-Day-3.html"/>
   <updated>2010-07-31T00:00:00+00:00</updated>
   <id>/07/31/Open-Science-Summit-Day-3</id>
   <content type="html">&lt;p&gt;see previous day for links to more details on summit.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Open Science Summit day 2</title>
	 <link href="/2010/07/30/Open-Science-Summit-day-2.html"/>
   <updated>2010-07-30T00:00:00+00:00</updated>
   <id>/07/30/Open-Science-Summit-day-2</id>
   <content type="html">&lt;p&gt;Full day (really – no breaks, lunch served during talks) of talks at the open science summit…&lt;/p&gt;
&lt;p&gt;Amazingly well web-captured conference, in addition to streaming on fora.tv, &lt;a href=&quot;http://gnusha.org/transcripts/open-science-summit-2010/&quot; title=&quot;http://gnusha.org/transcripts/open-science-summit-2010/&quot;&gt;complete transcripts&lt;/a&gt; of talks are available thanks to someone with fast fingers.&lt;/p&gt;
&lt;p&gt;Also through the back-channel, particularly the links it shares:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Open Science Summit</title>
	 <link href="/2010/07/29/Open-Science-Summit.html"/>
   <updated>2010-07-29T00:00:00+00:00</updated>
   <id>/07/29/Open-Science-Summit</id>
   <content type="html">&lt;p&gt;First day of the Open Science Summit, began with excellent panel discussion including Cameron Neylon, Victoria Stodden, Peter Murray-Rust and Jason Hoyt. Followed by great lineup of short talks, but behind schedule and no breaks.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://opensciencesummit.com/schedule/schedule&quot; title=&quot;http://opensciencesummit.com/schedule/schedule&quot;&gt;Conference Schedule&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Backchannel &lt;a href=&quot;http://opensciencefoundation.com/oss2010/&quot; title=&quot;http://opensciencefoundation.com/oss2010/&quot;&gt;twitter archive&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;A neat &lt;a href=&quot;http://oss2010.backchan.nl/conferences/view/30&quot; title=&quot;http://oss2010.backchan.nl/conferences/view/30&quot;&gt;backchannel question proposing&lt;/a&gt; site used for the conference.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Cetartiodactyle data</title>
	 <link href="/2010/07/28/Cetartiodactyle-data.html"/>
   <updated>2010-07-28T00:00:00+00:00</updated>
   <id>/07/28/Cetartiodactyle-data</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Exploring the cetartiodactyle data (unreleased)&lt;/li&gt;
&lt;li&gt;Nelder-Mead fails to converge or improve upon the hansen model. Likelihood scores differ little:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; bm@loglik
[1] -362.6228
&amp;gt; ou1@loglik
[1] -364.9039
&amp;gt; ws1$loglik
[1] -362.7616
&amp;gt; ou2@loglik
[1] -361.6976
&amp;gt; ws2$loglik
[1] -361.2542&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;See &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/8989487c30adbafb6e43ce8b6231722e278f58a5/demos/cetaceans.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/8989487c30adbafb6e43ce8b6231722e278f58a5/demos/cetaceans.R&quot;&gt;Cetaceans code&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/4/4e/CetaceanModels.png/600px-CetaceanModels.png&quot; alt=&quot;Fig. 1 The Brownian Motion model is preferred to the OU.1 model (left). Two separate optima are supported over a single optima (right).&quot; /&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Fig. 1&lt;/strong&gt; The Brownian Motion model is preferred to the OU.1 model (left). Two separate optima are supported over a single optima (right).&lt;/p&gt;
&lt;p&gt;This shows the complementary conclusion to the Labrid data-set – While there is support for separate regimes between the cetaceans and artiodactyles, the differences in likelihood are adequately explained by differences in the selective optimum location for each regime, and do not support different strengths of selection (alpha) or different rates of evolution (sigma). This comparison isn’t directly shown through bootstrap likelihood ratio as it is already clear since the likelihood score of the two-peak model matches the nested, simpler ou2 model from ouch/hansen method that only lets optima positions differ.&lt;/p&gt;
&lt;p&gt;It is possible this is due to a likelihood ridge frustrating the algorithm, as the full wrightscape model is seeded using the values from ou2 for alpha and sigma, though some further exploration with initial conditions does not seem to bear this out.&lt;/p&gt;
&lt;h2 id=&quot;code-algorithm&quot;&gt;Code &amp;amp; algorithm&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Nelder-Mead set to 20000 iterations is a bit ambitious, usually converges in under 500 or never converges.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parameter Estimates for Labrid-Parrotfish model</title>
	 <link href="/2010/07/27/Parameter-Estimates-for-Labrid-Parrotfish-model.html"/>
   <updated>2010-07-27T00:00:00+00:00</updated>
   <id>/07/27/Parameter-Estimates-for-Labrid-Parrotfish-model</id>
   <content type="html">&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/4/41/Gape_pars.png&quot; alt=&quot;See fast_boot and plot.wrightscape functions in code. Gape size&quot; /&gt;&lt;figcaption&gt;See fast_boot and plot.wrightscape functions in code. Gape size&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;See fast_boot and plot.wrightscape functions in &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/534fe67518edcb8b2488bf9d6ae7a4efe30f39cc/R/wrightscape.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/534fe67518edcb8b2488bf9d6ae7a4efe30f39cc/R/wrightscape.R&quot;&gt;code&lt;/a&gt;. &lt;strong&gt;Gape size&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/1/19/Protrusion_pars.png&quot; alt=&quot;See fast_boot and plot.wrightscape functions in code Jaw Protrusion&quot; /&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;See fast_boot and plot.wrightscape functions in &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/534fe67518edcb8b2488bf9d6ae7a4efe30f39cc/R/wrightscape.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/534fe67518edcb8b2488bf9d6ae7a4efe30f39cc/R/wrightscape.R&quot;&gt;code&lt;/a&gt; &lt;strong&gt;Jaw Protrusion&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Figures show strong evidence for the relax of constraint hypothesis, as the strength of selection (alpha parameters) appears to have substantially weakened in both morphological traits in the parrotfish clade relative to the wrasses clade. The wrasses show strong preference for OU model with substantial stabilizing selection, while the Parrotfish estimate almost zero stabilizing selection (Brownian model, clear phylogenetic signal).&lt;/p&gt;
&lt;p&gt;Note that while the theta and sigma parameters can be accurately estimated in the wrasses, the model places little confidence on the reconstructed values of these parameters in the smaller Parrotfish clade, even though alpha seems well-defined in both clades.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parrotfish Model choice</title>
	 <link href="/2010/07/26/Parrotfish-Model-choice.html"/>
   <updated>2010-07-26T00:00:00+00:00</updated>
   <id>/07/26/Parrotfish-Model-choice</id>
   <content type="html">&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/6/66/Labrid_gape.png/800px-Labrid_gape.png&quot; alt=&quot;code, Gape data&quot; /&gt;&lt;figcaption&gt;code, Gape data&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/5e2f978e955bb5de58dc4be5c48ca6c6a35c5f5b/demos/labrids.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/5e2f978e955bb5de58dc4be5c48ca6c6a35c5f5b/demos/labrids.R&quot;&gt;code&lt;/a&gt;, Gape data&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/38/Labrid_protrusion.png/800px-Labrid_protrusion.png&quot; alt=&quot;code, Protrusion data&quot; /&gt;&lt;figcaption&gt;code, Protrusion data&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/fc6ee6e944d6852106cdb9ef74e1207f9db2da3e/demos/labrids.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/fc6ee6e944d6852106cdb9ef74e1207f9db2da3e/demos/labrids.R&quot;&gt;code&lt;/a&gt;, Protrusion data&lt;/p&gt;
&lt;p&gt;For both the gape data and the jaw protrusion data, the model treating parrotfish clade as a separate regime using ouch (differing optima) is not supported (even though it does have better AIC score for the protrusion data). The model using my new method allowing alpha and sigma to differ is strongly supported, providing support for the “release of constraint” hypothesis.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/07/23/Writing.html"/>
   <updated>2010-07-23T00:00:00+00:00</updated>
   <id>/07/23/Writing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Working on likelihood ratio manuscript.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;labrid-herbivory-data&quot;&gt;Labrid Herbivory data&lt;/h2&gt;
&lt;p&gt;Parrotfish gape shows significant differences for independent OU models (alpha, theta, sigma different) than wrasses. While the two-peak ouch model gets no support, allowing alpha and sigma to very results in a strongly significant model improvement.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/6/66/Labrid_gape.png/800px-Labrid_gape.png&quot; alt=&quot;code&quot; /&gt;&lt;figcaption&gt;code&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/5e2f978e955bb5de58dc4be5c48ca6c6a35c5f5b/demos/labrids.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/5e2f978e955bb5de58dc4be5c48ca6c6a35c5f5b/demos/labrids.R&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt; &amp;gt; ws2$
 ws2$alpha    ws2$data     ws2$loglik   ws2$regimes  ws2$sigma    ws2$theta    ws2$tree     ws2$Xo
 &amp;gt; ws2$theta
 [1] 0.2245493 0.9569619
 &amp;gt; ws2$alpha
 [1] 2.943846e+00 4.995744e-06
 &amp;gt; ws2$sigma
 [1] 0.5160019 1.2435074&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; (bootstraps/uncertainty of alpha, theta, sigma coming)&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/07/22/Writing.html"/>
   <updated>2010-07-22T00:00:00+00:00</updated>
   <id>/07/22/Writing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Working on likelihood ratio manuscript.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/07/21/Writing.html"/>
   <updated>2010-07-21T00:00:00+00:00</updated>
   <id>/07/21/Writing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;working on likelihood ratio manuscript.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Writing</title>
	 <link href="/2010/07/20/Writing.html"/>
   <updated>2010-07-20T00:00:00+00:00</updated>
   <id>/07/20/Writing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;working on Likelihood ratio manuscript. Some more literature review and outlining.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Wainwright Meeting</title>
	 <link href="/2010/07/19/Wainwright-Meeting.html"/>
   <updated>2010-07-19T00:00:00+00:00</updated>
   <id>/07/19/Wainwright-Meeting</id>
   <content type="html">&lt;p&gt;Discussed goals and appropriate approach. Settled on linear order rather than trying to directly implement the full MCMC over paintings solution directly. Breaks into four steps/manuscripts:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Phylogenetic signal and model choice in Comparative Methods: Likelihood ratio approach&lt;/li&gt;
&lt;li&gt;Detecting changing constraints in evolution: varying alpha and sigma across the tree&lt;/li&gt;
&lt;li&gt;Bayesian approach for all existing continuous trait comparative methods&lt;/li&gt;
&lt;li&gt;MCMC over possible histories to infer number of niches&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parrotfish-Wrasse example</title>
	 <link href="/2010/07/15/Parrotfish-Wrasse-example.html"/>
   <updated>2010-07-15T00:00:00+00:00</updated>
   <id>/07/15/Parrotfish-Wrasse-example</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Painting the tree with parrotfish as a separate regime from wrasses, I find significant support for a model with separate optima with differential strengths of selection and diversification as well with respect to fin angle.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/10/Wrightscape_labrid.png/800px-Wrightscape_labrid.png&quot; alt=&quot;code&quot; /&gt;&lt;figcaption&gt;code&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/08c98a9a0f4a5a67caedc9dbe8c6d0172c49d5c3/demos/labrids.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/08c98a9a0f4a5a67caedc9dbe8c6d0172c49d5c3/demos/labrids.R&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The painting for this tree (click for larger and zoom in):&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/8/85/Parrotfish_paint.png/800px-Parrotfish_paint.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Organizing analyses, data, codes</title>
	 <link href="/2010/07/14/Organizing-analyses-data-codes.html"/>
   <updated>2010-07-14T00:00:00+00:00</updated>
   <id>/07/14/Organizing-analyses-data-codes</id>
   <content type="html">&lt;h3 id=&quot;codes&quot;&gt;Codes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Should have a suite of likelihood tools as a package&lt;/li&gt;
&lt;li&gt;Suite of data manipulation functions, mostly to and from ape/ouch&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; idealized workflow:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Read in nexus file and csv data.&lt;/li&gt;
&lt;li&gt;Call model fit for each model to be tested (BM, one peak, multiple peaks, multiple peaks with independent selective forces)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - A function checks tree and data for matches, discards those without match. This could be done automatically by the model fit. Could use a flag to disable the check when being called by the bootstrap function. - Convert data to the correct format. This could be done by the model fit, again with a flag to disable checking if not needed. - Model fit should take tree in either format and return it in the format given. Tools should allow conversions between formats later as well.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; More Examples ————-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Labrid data set with parrot fish as separate regime.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Example illustrates data starting with nexus file and csv, dropping unmatched tips, converting formats and identifying clade by the common ancestor of its two most distant members:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;# labrid example
 
# This data has not been released
require(wrightscape)
require(geiger)
source(&amp;quot;/home/cboettig/Documents/ucdavis/research/phylotrees/code/Comparative-Phylogenetics/R/data_formats.R&amp;quot;)
 
#path = &amp;quot;/home/cboettig/Documents/research/phylotrees/data/labrids/&amp;quot;
path = &amp;quot;../../data/labrids/&amp;quot;
labrid_tree &amp;lt;- read.nexus(paste(path, &amp;quot;labrid_tree.nex&amp;quot;, sep=&amp;quot;&amp;quot;))
labrid_data &amp;lt;-read.csv(paste(path,&amp;quot;labrid.csv&amp;quot;, sep=&amp;quot;&amp;quot;))
rownames(labrid_data) &amp;lt;- labrid_data[,1]
 
# We&amp;#39;ll just use the fin angle data
fin_angle &amp;lt;- labrid_data$FinAngle
names(fin_angle) &amp;lt;- labrid_data[,1]
 
  # Convert the data, dropping unmatched tips
  labrid &amp;lt;- treedata(labrid_tree, fin_angle)
  names(labrid$data) &amp;lt;- rownames(labrid$data)
  labrid &amp;lt;- ape2ouch_all(labrid$phy, labrid$data)
 
  # We&amp;#39;ll paint the parrotfish a different regime
  parrotfish &amp;lt;- labrid$tree@nodelabels[c(pmatch(&amp;quot;Scarus_spinus&amp;quot;, labrid$tree@nodelabels), pmatch(&amp;quot;Crypto&amp;quot;, labrid$tree@nodelabels) )]
  parrotfish_clade &amp;lt;- as.integer(mrcaOUCH(parrotfish, labrid$tree))
 
  parrotfish_regime &amp;lt;- paintBranches(parrotfish_clade, labrid$tree)
 
  single_regime &amp;lt;- as.factor(character(labrid$tree@nnodes))
  names(single_regime) &amp;lt;- labrid$tree@nodes
 
  bm &amp;lt;- brown(labrid$data, labrid$tree)
  ou1 &amp;lt;- hansen(labrid$data, labrid$tree, regime=single_regime, 1, 1)
  ws1 &amp;lt;- wrightscape(labrid$data, labrid$tree, regime=single_regime, 1, 1)
  ou2 &amp;lt;- hansen(labrid$data, labrid$tree, regime=parrotfish_regime, 1, 1)
  ws2 &amp;lt;- wrightscape(labrid$data, labrid$tree, regime=parrotfish_regime, (ou2@sqrt.alpha)^2, ou2@sigma)
 
  labrid_models &amp;lt;- list(bm = bm, ws1=ws1, ou2=ou2, ws2=ws2)
 
    LR &amp;lt;- choose_model(labrid_models, 100)
    png(&amp;quot;wrightscape_labrid.png&amp;quot;,width=2000, height=600) 
    par(mfrow=c(1,3))
    pretty_plot(LR[[1]], main=&amp;quot;support for OU over BM&amp;quot;)
    pretty_plot(LR[[2]], main=&amp;quot;support for 2 peaks over 1&amp;quot;)
    pretty_plot(LR[[3]], main=&amp;quot;support for differential selective strength&amp;quot;)
    dev.off()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;bootstrap is still running…&lt;/p&gt;
&lt;h2 id=&quot;optimization-thoughts&quot;&gt;Optimization thoughts&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;While seeding the alpha and sigma values with the global estimates increases the convergence speed of the simplex method, it is possible that this biases the method to estimate that the regimes are more similar than they actually are, since getting off the ridge might be difficult. (Could consider ways to not treat alpha and sigma independently?) Testing this idea with the simulated annealing approach, which has a better chance of getting off the ridge.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;R code can now toggle algorithm to use simulated annealing or simplex method.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Using the labrid data set with fin morphology, simulated annealing does seem to get off the ridge. However, estimated optimum is outside the observed range, suggests uncertainty dominates the parameter estimates of the smaller parrotfish clade rather than representing significant differences.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ~&lt;sub&gt;~&lt;/sub&gt; {.de1} &amp;gt; # Nelder Mead, conditioning on hansen initial guess &amp;gt; ws2&lt;span class=&quot;math&quot;&gt;\(alpha; ws2\)&lt;/span&gt;theta; ws2&lt;span class=&quot;math&quot;&gt;\(sigma; ws2\)&lt;/span&gt;loglik [1] 1.079384 1.114845 [1] 51.43308 46.82123 [1] 14.44427 15.41473 [1] -381.3925 &amp;gt; &amp;gt; # simulated annealing improvement: &amp;gt; ws2_&lt;span class=&quot;math&quot;&gt;\(alpha; ws2_\)&lt;/span&gt;theta; ws2_&lt;span class=&quot;math&quot;&gt;\(sigma; ws2_\)&lt;/span&gt;loglik [1] 1.354885 2.187390 [1] 50.87688 29.35945 [1] 15.26238 10.99948 [1] -379.96 &amp;gt; &amp;gt; # subsequent Nelder Mead pushes values more extreme &amp;gt; ws2_fast&lt;span class=&quot;math&quot;&gt;\(alpha; ws2_fast\)&lt;/span&gt;theta; ws2_fast&lt;span class=&quot;math&quot;&gt;\(sigma; ws2_fast\)&lt;/span&gt;loglik [1] 0.6420187 4.2991044 [1] 52.17393 7.42868 [1] 13.05538 3.05305 [1] -377.3622 &amp;gt; ~&lt;sub&gt;~&lt;/sub&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Bootstrapping the independent alpha-sigma models</title>
	 <link href="/2010/07/13/Bootstrapping-the-independent-alpha-sigma-models.html"/>
   <updated>2010-07-13T00:00:00+00:00</updated>
   <id>/07/13/Bootstrapping-the-independent-alpha-sigma-models</id>
   <content type="html">&lt;p&gt;I compare in a robust framework the likelihood that species mean trait values are generated by Brownian motion, a single peak OU model, or a model with different regimes (postulated in the literature) in which the selective strength (alpha) and diversification rate (sigma) are fixed across the entire tree or allowed to vary by selective regime. (Regimes are defined as branches with different values for the selective optimum).&lt;/p&gt;
&lt;p&gt;The parametric bootstrap of the likelihood ratio statistic provides a rigorous way to quantify the probability that the model choice is correct: the probability that the data was produced by the test model vs the null model is assured by the Neyman-Pearson lemma. Because the models are nested in a natural hierarchy, pairwise tests of successively more complicated models provide an efficient and robust way to select between models, whereas other methods may be misleading.&lt;/p&gt;
&lt;h3 id=&quot;anoles-data&quot;&gt;Anoles Data&lt;/h3&gt;
&lt;p&gt;OU cannot reject BM, OU.LP (three peaks) can reject OU single peak model (and hence BM). Allowing alpha and sigma to vary by regime shows an improvement better then expected by chance under the global alpha/sigma model 93% of the time, which we may take as insufficient justification of the separate strengths of selection and diversification between regimes.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/ec/Wrightscape_anoles.png/800px-Wrightscape_anoles.png&quot; alt=&quot;code&quot; /&gt;&lt;figcaption&gt;code&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;   require(wrightscape)
    data(bimac)
    tree &amp;lt;- with(bimac,ouchtree(nodes=node,ancestors=ancestor,times=time/max(time),labels=species))
    bm &amp;lt;- brown(log(bimac[&amp;#39;size&amp;#39;]), tree)
    ou1 &amp;lt;- hansen(log(bimac[&amp;#39;size&amp;#39;]), tree, bimac[&amp;#39;OU.1&amp;#39;], 1, 1)
    ws1 &amp;lt;- wrightscape(log(bimac[&amp;#39;size&amp;#39;]), tree, bimac[&amp;#39;OU.1&amp;#39;], 1, 1)
    ou2 &amp;lt;- hansen(log(bimac[&amp;#39;size&amp;#39;]), tree, bimac[&amp;#39;OU.LP&amp;#39;], 1, 1)
    ws2 &amp;lt;- wrightscape(log(bimac[&amp;#39;size&amp;#39;]), tree, bimac[&amp;#39;OU.LP&amp;#39;], (ou2@sqrt.alpha)^2, ou2@sigma)
 
    model_list &amp;lt;- list(bm = bm, ws1 = ws1, ou2 = ou2, ws2 = ws2)
    LR &amp;lt;- choose_model(model_list, 100)
 
    png(&amp;quot;wrightscape_anoles.png&amp;quot;, width = 2000, height=600)
    par(mfrow=c(1,3))
    pretty_plot(LR[[1]], main=&amp;quot;support for OU over BM&amp;quot;)
    pretty_plot(LR[[2]], main=&amp;quot;support for multiple peaks over 1&amp;quot;)
    pretty_plot(LR[[3]], main=&amp;quot;support for differential selective strength&amp;quot;)
    dev.off()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; ### Sedges Data&lt;/p&gt;
&lt;p&gt;OU model clearly rejects BM, two regimes clearly rejects the single OU peak, and separate selective regimes appears supported at the p = 0.02 level.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/2f/Sedges.png/800px-Sedges.png&quot; alt=&quot;code&quot; /&gt;&lt;figcaption&gt;code&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/b3eabf29caa6fcf5e9f5e0b54d7c0fdf5bf6a79a/R/wrightscape.R&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;   require(wrightscape)
    require(maticce)
    data(carex)
    attach(carex)
 
    treedata &amp;lt;- ape2ouch_all(ovales.tree, ovales.data)
    ou2_regimes &amp;lt;- paintBranches(list(ovales.nodes[[2]]), treedata$tree)
    ou1_regimes &amp;lt;- as.factor(rep(1, length(ou2_regimes) ))
    names(ou1_regimes) &amp;lt;- names(ou2_regimes)
 
# Fit the models
    bm &amp;lt;- brown(treedata$data, treedata$tree)
    ws1 &amp;lt;- wrightscape(treedata$data, treedata$tree, ou1_regimes, 1, 1)
    ou2 &amp;lt;- hansen(treedata$data, treedata$tree, ou2_regimes, 1, 1)
    ws2 &amp;lt;- wrightscape(treedata$data, treedata$tree, ou2_regimes, (ou2@sqrt.alpha)^2, ou2@sigma)
 
    model_list &amp;lt;- list(bm = bm, ws1 = ws1, ou2 = ou2, ws2 = ws2)
    LR &amp;lt;- choose_model(model_list, 100)
    pretty_plot(LR[[1]], main=&amp;quot;support for OU over BM&amp;quot;)
    pretty_plot(LR[[2]], main=&amp;quot;support for 2 peaks over 1&amp;quot;)
    pretty_plot(LR[[3]], main=&amp;quot;support for differential selective strength&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;significant-code-changes&quot;&gt;Significant code changes&lt;/h2&gt;
&lt;p&gt;Fixed handling of out-of-bounds parameters. Used to just write in the boundary size whenever the algorithm tried to go outside the boundary, which essentially breaks the algorithm. Now it returns a minus log likelihood of infinity (GSL_POSINF) instead, which seems to greatly improve the observed performance of the algorithm.&lt;/p&gt;
&lt;p&gt;Should have a way to indicate whether negative values are appropriate or not for theta parameters!&lt;/p&gt;
&lt;p&gt;Simplex method convergence – still struggles with parameter rich models. During bootstrapping a substantial number of runs will hit the maximum number of iterations. Increased to 20,000 iterations and relaxed error tolerance to 1e-6, which seems to mostly fix this. Method should probably throw a warning when it hits the maximum iterations though.&lt;/p&gt;
&lt;h2 id=&quot;optimization&quot;&gt;Optimization&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Appropriate treatment for root parameter?&lt;/li&gt;
&lt;li&gt;appropriate handling for parameter boundaries?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; simulated annealing vs simplex method&lt;/p&gt;
&lt;p&gt;Add back the fast method for single regime&lt;/p&gt;
&lt;p&gt;parameter global/local controls&lt;/p&gt;
&lt;p&gt;R level control of search algorithm parameters&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Multivariate normal random variables</title>
	 <link href="/2010/07/12/Multivariate-normal-random-variables.html"/>
   <updated>2010-07-12T00:00:00+00:00</updated>
   <id>/07/12/Multivariate-normal-random-variables</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;GSL lacks a multivariate normal random variable option, so have implemented one using the eigenvalue decomposition (default method in the R function rmvnorm). Function should consider doing error handling (i.e. warning if covariance matrix isn’t positive definite or if the vectors given don’t match dimensions), though these may be mostly unnecessary cost. Also uses a general blas matrix multiplication when one of the matrices is just sqrt(eigenvalues) on the diagonal, so this could possibly be sped up considerably using the correct blas matrix multiply.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;As the solutions to the regimes model are still multivariate normal, simulating data sets just means drawing random numbers from this distribution, as opposed to actually evolving the SDE along the tree.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Status - Thoughts</title>
	 <link href="/2010/07/09/Status---Thoughts.html"/>
   <updated>2010-07-09T00:00:00+00:00</updated>
   <id>/07/09/Status---Thoughts</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Goal:&lt;/strong&gt; BM vs OU vs proposed multipeak OU model with and without global alpha/sigma. Anoles dataset, carex dataset, labrids?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Added ape2ouch_all function based on maticce to convert file formats. Might be worth checking against my current implementation. Meanwhile it’s really the converting trees back from ouch to ape that gives the ace function trouble. something about ordering of the nodes, even though that shouldn’t matter in the phylo format.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;For the moment, probably worth always running hansen first and using output to seed the run of wrightscape.&lt;/li&gt;
&lt;li&gt;Later, should modify so that wrightscape and declare any parameters global or local&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Wrightscape’s simulated annealing should do something clever to choose which parameters to optimize first.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - Write bootstrap version for wrightscape. Use the object class and call categories to choose appropriate method automatically.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;MCMC version! Does this need to be reversible jump or can I just run this on the richest model and look at overlap?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;negative values can somehow sneak in to simulated annealing approach.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;need to figure out distributing R packages with C code depending on GSL&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Make sense of max-likelihood inferred painting approach. Write a full R implementation for stochastic mapping (simmap).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Need a simulation method for wrightscape!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;code-updates&quot;&gt;Code Updates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Rewriting likelihood bootstrap method. Should guess the correct method (for the moment will ignore the auto-partitioning approach?) Should make pretty plots.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Evolutionary Regime Shift examples</title>
	 <link href="/2010/07/08/Evolutionary-Regime-Shift-examples.html"/>
   <updated>2010-07-08T00:00:00+00:00</updated>
   <id>/07/08/Evolutionary-Regime-Shift-examples</id>
   <content type="html">&lt;p&gt;Time to get more data and examples to start testing methods, particularly for cases in where regime shifts are hypothesized by painting a tree. Starting a Mendeley public collection for the literature in Web of Science that actually applies either the OUCH or Brownie framework to identify shifts in rates of continuous trait evolution.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com&quot;&gt;Research&lt;/a&gt; collected using Mendeley&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; now I’ll have to see how hard it is to obtain both the trees and trait data…&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - Web of Science has 77 papers citing Butler and King 2004, of 21 promising-looking ones 13 actually applied (or came close enough) to applying a regime-based method (some of these actually used Brownie but make mention of the ouch approach. Smith Sa, Beaulieu JM. 2009 actually comments about no method existing to vary alpha across trees. 47 cite O’Meara et al. 2006, with considerable overlap.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Edwards &amp;amp; Smith evaluate a fantastically large data set painted with C3 and C4 plants looking at temperature analysis.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Andrew Hipp’s datasets on chromosome evolution in sedges might be a good place to start. Data is included in his &lt;em&gt;maticce&lt;/em&gt; R package (built on ouch).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Multitype OU process interfaces</title>
	 <link href="/2010/07/07/Multitype-OU-process-interfaces.html"/>
   <updated>2010-07-07T00:00:00+00:00</updated>
   <id>/07/07/Multitype-OU-process-interfaces</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Removing old implementations from the R package, so will need to grab them from the &lt;a href=&quot;http://github.com/cboettig/wrightscape/commit/a3cebb06b8e0e28fe43fbb22e6bd9f0c499271e3&quot; title=&quot;http://github.com/cboettig/wrightscape/commit/a3cebb06b8e0e28fe43fbb22e6bd9f0c499271e3&quot;&gt;version history&lt;/a&gt; from now on to access the original linear implementations.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Nelder-Mead simplex algorithm seems quite sensitive to starting conditions. Seeding it with values fit from the hansen algorithm (global alpha and sigma), it rapidly improves the log likelihood score (going up from 25 to 30, which is just barely significant according to AIC). With more arbitrary starting conditions it significantly under-performs even Brownian motion models.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Implemented a simulated annealing likelihood maximization routine, which proves much more robust to starting conditions, though taking significantly longer to converge. Also this performance requires appropriately high starting temperature and number of regimes. Hopefully is easy to convert to an MCMC routine. Should add lockable parameters and should use the faster linear solvers for BM and OU1 to make a general MCMC suite for comparative methods.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Ensemble simulations of beetle dynamics</title>
	 <link href="/2010/07/07/Ensemble-simulations-of-beetle-dynamics.html"/>
   <updated>2010-07-07T00:00:00+00:00</updated>
   <id>/07/07/Ensemble-simulations-of-beetle-dynamics</id>
   <content type="html">&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/15/Gamma_beetle_ensemble_ibm.png/300px-Gamma_beetle_ensemble_ibm.png&quot; alt=&quot;code Fig 1&quot; /&gt;&lt;figcaption&gt;code Fig 1&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/efdfa0a033b7597824797af8659397a7bf7b4f3b&quot; title=&quot;http://github.com/cboettig/structured-populations/commit/efdfa0a033b7597824797af8659397a7bf7b4f3b&quot;&gt;code&lt;/a&gt; &lt;strong&gt;Fig 1&lt;/strong&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/d/da/Ibm_compare.png/300px-Ibm_compare.png&quot; alt=&quot;code Fig 2&quot; /&gt;&lt;figcaption&gt;code Fig 2&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/efdfa0a033b7597824797af8659397a7bf7b4f3b&quot; title=&quot;http://github.com/cboettig/structured-populations/commit/efdfa0a033b7597824797af8659397a7bf7b4f3b&quot;&gt;code&lt;/a&gt; &lt;strong&gt;Fig 2&lt;/strong&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/30/Stable_nodes.png/300px-Stable_nodes.png&quot; alt=&quot;code Fig 3&quot; /&gt;&lt;figcaption&gt;code Fig 3&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/4f2d9ec4a0adf5170436f5ade875da92f39593c1&quot; title=&quot;http://github.com/cboettig/structured-populations/commit/4f2d9ec4a0adf5170436f5ade875da92f39593c1&quot;&gt;code&lt;/a&gt; &lt;strong&gt;Fig 3&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Exploring full ensemble simulations of beetle dynamics. Linear noise approximations (&lt;strong&gt;Fig 2&lt;/strong&gt;) show divergent noise under oscillating conditions (&lt;strong&gt;Fig 2&lt;/strong&gt; lower panel), though this may be an artifact of the approximation, which applies only for finite time calculations.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Note that mean dynamics agree, and oscillations damp out, &lt;strong&gt;Fig 1&lt;/strong&gt; simulation means (circles) fall exactly on predicted lines. Variance dynamics do not agree. &lt;strong&gt;Fig 1:&lt;/strong&gt; plot shows variances from individual based simulation (invisible in fig 1), which seem to reach stable values.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;strong&gt;Fig 3&lt;/strong&gt; Unfortunately the variance dynamics do not seem to match between individual simulation and analytic approx for the stable node solution either, even though the mean dynamics agree. (yellow circles hard to see, click on image for larger) but fall directly on mean line but well above variance prediction…) Reason for the disagreement is unclear, bears further investigation before the Fig 1 conclusion can be certain.&lt;/p&gt;
&lt;h3 id=&quot;computing-implementation&quot;&gt;Computing implementation&lt;/h3&gt;
&lt;p&gt;Disabled compiled support of openMP in the simulation. For some reason when called from R, the code runs the code on each processor with the same replicate index, in addition to performing all the replicates. Because I need += to add up all the members in a given class, the second time through using the same index it continues to increment the value, getting the wrong number in the process. Disabling openMP from R for the moment by removing the flags from the Makevars file as a work-around.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Generalizing the multi-type OU process- continued</title>
	 <link href="/2010/07/02/Generalizing-the-multi-type-OU-process--continued.html"/>
   <updated>2010-07-02T00:00:00+00:00</updated>
   <id>/07/02/Generalizing-the-multi-type-OU-process--continued</id>
   <content type="html">&lt;p&gt;Efficiency updates:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;As expected, calculating the last common ancestor on the fly was responsible for a significant (&amp;gt;50%) fraction of the computational effort, so it’s worth calculating this once for the tree and storing the information.&lt;/li&gt;
&lt;li&gt;Current profiling table:&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; %   cumulative   self              self     total           
time   seconds   seconds    calls  us/call  us/call  name    
57.14      0.08     0.08  1604986     0.05     0.05  calc_gamma
35.71      0.13     0.05   802493     0.06     0.16  calc_var
 7.14      0.14     0.01     1517     6.59     6.59  alloc_tips
 0.00      0.14     0.00   837384     0.00     0.00  node_age
 0.00      0.14     0.00    34891     0.00     0.00  calc_mean
 0.00      0.14     0.00     2025     0.00     0.00  get_lca
 0.00      0.14     0.00     1517     0.00    92.29  calc_lik
 0.00      0.14     0.00     1517     0.00     0.00  log_normal_lik
 0.00      0.14     0.00        1     0.00     0.00  fit_model
 0.00      0.14     0.00        1     0.00     0.00  multimin&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;calc_gamma doesn’t need to be called the &lt;em&gt;n&lt;/em&gt;&lt;sup&gt;2&lt;/sup&gt; times in calc_var, but could be stored from the calc_mean computation, so it would be called no more than calc_mean is. This would probably speed up calc_var, since it’s a significant fraction of that time, and leave alloc_tips as the most intensive function. Like get_lca, alloc_tips could be performed once for the entire tree and stored in the tree structure. Several other optimizations are quite natural but should wait until these primary inefficiencies are dealt with. Likewise any parallelization will be best applied at higher level (bootstrapping, maybe MCMC steps).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Note that we’re getting 1517 calls to the likelihood function in 0.14 seconds; better than 10,000 likelihood calculations a second.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Multitype OU Processes with varying alpha and sigma</title>
	 <link href="/2010/07/01/Multitype-OU-Processes-with-varying-alpha-and-sigma.html"/>
   <updated>2010-07-01T00:00:00+00:00</updated>
   <id>/07/01/Multitype-OU-Processes-with-varying-alpha-and-sigma</id>
   <content type="html">&lt;p&gt;Been meaning to sit down and work this one out for a while; somehow travel and conferences helped out with that – now I only have to transcribe some dozen messy hotel notepad sheets to get the calculations into this lab notebook. Meanwhile, 15 hours on a train from Portland was just the right amount of time to code up the approach, which is now implemented at the C level for the Anoles dataset; code in the &lt;a href=&quot;http://github.com/cboettig/wrightscape&quot; title=&quot;http://github.com/cboettig/wrightscape&quot;&gt;wrightscape project&lt;/a&gt; on github.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - current algorithm will replace the existing codebase for the wrightscape project. Currently the &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/007476cec25babd95f1829b8c14ddfadfb53e1a9/src/makefile&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/007476cec25babd95f1829b8c14ddfadfb53e1a9/src/makefile&quot;&gt;makefile&lt;/a&gt;, &lt;a href=&quot;http://github.com/cboettig/wrightscape/commit/02a8611bc2008cbcbcc567d41552b569683d40e9#diff-0&quot; title=&quot;http://github.com/cboettig/wrightscape/commit/02a8611bc2008cbcbcc567d41552b569683d40e9#diff-0&quot;&gt;p_multimin.c&lt;/a&gt;, and &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/007476cec25babd95f1829b8c14ddfadfb53e1a9/src/piecewise_regimes.c&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/007476cec25babd95f1829b8c14ddfadfb53e1a9/src/piecewise_regimes.c&quot;&gt;piecewise_regimes.c&lt;/a&gt; (the main file) contain the standalone version of the new method. Will soon remove older scripts from the active version and break up piecewise_regimes.c into multiple files as appropriate.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>iEvoBio day two</title>
	 <link href="/2010/06/30/iEvoBio-day-two.html"/>
   <updated>2010-06-30T00:00:00+00:00</updated>
   <id>/06/30/iEvoBio-day-two</id>
   <content type="html">&lt;p&gt;Program:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; My Lightning talk on Open Science:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.slideshare.net/cboettig/ievobio&quot; title=&quot;Ievobio&quot;&gt;Ievobio&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;View more &lt;a href=&quot;http://www.slideshare.net/&quot;&gt;presentations&lt;/a&gt; from &lt;a href=&quot;http://www.slideshare.net/cboettig&quot;&gt;cboettig&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also in &lt;a href=&quot;http://precedings.nature.com/documents/4602/version/1&quot; title=&quot;http://precedings.nature.com/documents/4602/version/1&quot;&gt;Nature Proceedings&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>iEvoBio day one</title>
	 <link href="/2010/06/29/iEvoBio-day-one.html"/>
   <updated>2010-06-29T00:00:00+00:00</updated>
   <id>/06/29/iEvoBio-day-one</id>
   <content type="html">&lt;p&gt;Program:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://twitter.com/#search?q=%23ievobio&quot; title=&quot;http://twitter.com/#search?q=%23ievobio&quot;&gt;conference twitter&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Lunch with O’Meara &amp;amp; Price, discussing working group potential&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Dinner with Nescent folks on Dryad project and others&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Evolution 2010 Day 3</title>
	 <link href="/2010/06/28/Evolution-2010-Day-3.html"/>
   <updated>2010-06-28T00:00:00+00:00</updated>
   <id>/06/28/Evolution-2010-Day-3</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Chris Martin&lt;/strong&gt;: Trophic innovation drives exceptional rates of morphological diversification in two adaptive radiations of Cyprinodon pupfishes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Fantastic story of exceptional rates of evolution and trophic novelty in two tropical lakes. (8:45, Adaptation 9, talk 097002)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;David Plachetzki&lt;/strong&gt;: Deep homology and the evolution of animal senses: insights from Cnidaria&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Cnidarians have homologous proteins to opsins and taste receptors!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Jeremy Yoder&lt;/strong&gt;: Coevolution and gene flow in obligate pollination mutualism&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Two species of joshua tree each with its own pollinator yucca moth. Moth larva laid in and eat some of Joshua tree fruit, obligate for pollination but if too many eggs are laid tree aborts that fruit. Nice gene flow story reflecting the ability/inability of each moth to cross-pollinate the other tree. Trees overlap in distribution only at one location (top of a horseshoe shape in Nevada).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Pat MacIntyre&lt;/strong&gt;: Adaptation and niche breath among polyploid cytotypes of Claytonia perfoliata&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Peter Ralph&lt;/strong&gt;: Spatial parallel evolution: one wave or many?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Nice spatial spread genetic structure model&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Tracy Heath&lt;/strong&gt; (Huelsenbeck group) A Dirchlet process model for estimating lineage-specific substitution rates and dating divergences&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;[github source code?]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Charles Marshall&lt;/strong&gt;: Looking under the hood: the meaning of Bayesian priors on divergence times in light of the nature of the fossil record&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Excellent talk discussing limitations and challenges in dating fossils, particularly limitations in rock record itself. A couple nice papers for much better ways on selecting which fossils to use, etc.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Michael Turelli&lt;/strong&gt;: Spatial spread of CI-causing Wolbachia&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Cubic growth function for spread of wolbachia with an allee effect, and how this modifies Fisher’s wave equation for spatial spread. Going to applied in 7 million dollar project in releasing wolbachia-infected mosquitoes in Australia to control Dange fever.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Tom Near&lt;/strong&gt;: Informed calibration priors and calibration sampling strategies in molecular divergence time of ray-finned fishes&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;NESCent information session&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Dinner with some NESCent folks&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Evolution 2010 Day 2</title>
	 <link href="/2010/06/27/Evolution-2010-Day-2.html"/>
   <updated>2010-06-27T00:00:00+00:00</updated>
   <id>/06/27/Evolution-2010-Day-2</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Clay Cressler&lt;/strong&gt; : Can you trust evolutionary parameters estimated by complex phylogenetic comparative methods? A simulation study with OUCH&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Jeet Sukumaran&lt;/strong&gt; (Mark Holder lab) Performance and robustness of phylogeographic analytical studies&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tests common macroscopic models of inferring population structure (i.e. via coalescent) an individual based simulation model.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Graham Slater&lt;/strong&gt;, Luke Harmon, Liam Revell, Marc Suchard, Mike Alfaro. Estimating rates of phenotypic evolution and speciation from incomplete trees.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Fascinating talk on estimating rates when the tree is not resolved to the species level. Approximate Bayesian Computing based approach which simulates the tree to the species level as a pure birth process with trait evolution by Brownian motion, estimating parameter posteriors by ABC. Seemed to me this calculation could be done analytically, since the Brownian rate inference depends only on the distribution of branch lengths, which is simply exponential under the pure-birth (or constant birth-death) model. For instance:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/9/4/294d88d35ebd9a564f9f93f531fdfa03.png&quot; alt=&quot;\begin{align} L(\beta | u ) &amp;amp;= \frac{1}{\beta^N} \exp \left( \frac{- Q(\vec u)}{2 \beta} \right)\\ Q(\vec u) &amp;amp;= \sum_i \frac{(u_i - u_{i’})^2 }{v_{ii’} } \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} L(\beta | u ) &amp;amp;= \frac{1}{\beta^N} \exp \left( \frac{- Q(\vec u)}{2 \beta} \right)\\ Q(\vec u) &amp;amp;= \sum_i \frac{(u_i - u_{i’})^2 }{v_{ii’} } \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Well, if the branch length &lt;em&gt;v&lt;/em&gt;~*i**i*’~ is exponentially distributed with parameter λ&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/e/2/e/e2ec1a2a59f94c87a70a64983656c668.png&quot; alt=&quot;\begin{align} L(\beta | u) &amp;amp;= \int \exp\left(- \sum_i \frac{(u_i - u_{i’})^2 }{v }/2\beta \right) \lambda e^{-\lambda v} / \beta^N dv \\ L(\beta | u) &amp;amp;= \int \exp\left(- \frac{\sum_i (u_i - u_{i’})^2 }{2\beta v} - \lambda v \right) \lambda / \beta^N dv \\\end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} L(\beta | u) &amp;amp;= \int \exp\left(- \sum_i \frac{(u_i - u_{i’})^2 }{v }/2\beta \right) \lambda e^{-\lambda v} / \beta^N dv \\ L(\beta | u) &amp;amp;= \int \exp\left(- \frac{\sum_i (u_i - u_{i’})^2 }{2\beta v} - \lambda v \right) \lambda / \beta^N dv \\\end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If we simply estimated the branch length as the mean always, we’d have &lt;img src=&quot;http://openwetware.org/images/math/0/e/6/0e699e1dc4680e00fc6e8b5fb962a35e.png&quot; alt=&quot;\beta = \sum_i \frac{(u_i - u_{i’})^2 }{2 N \lambda T }&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - &lt;strong&gt;Andrew Hipp&lt;/strong&gt; Chromosome and genome size evolution in sedges&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;John Huelsenbeck&lt;/strong&gt; The growth of Bayesian phylogenetics&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Evolution 2010</title>
	 <link href="/2010/06/26/Evolution-2010.html"/>
   <updated>2010-06-26T00:00:00+00:00</updated>
   <id>/06/26/Evolution-2010</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Carl Boettiger&lt;/strong&gt; A new phylogenetic comparative method: detecting niches and transitions with continuous characters&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;My slides:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.slideshare.net/cboettig/a-new-phylogenetic-comparative-method-detecting-niches-and-transitions-with-continuous-characters&quot; title=&quot;A new phylogenetic comparative method: detecting niches and transitions with continuous characters&quot;&gt;A new phylogenetic comparative method: detecting niches and transitions with continuous characters&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;View more &lt;a href=&quot;http://www.slideshare.net/&quot;&gt;presentations&lt;/a&gt; from &lt;a href=&quot;http://www.slideshare.net/cboettig&quot;&gt;cboettig&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Joe Felsenstein&lt;/strong&gt; A comparative method for discrete and continuous characters using the threshold model&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Lynsey McInnes&lt;/strong&gt;: Deep-time changes to equilibrium diversity – a simulation study of th power to detect rule changes from reconstructed phylogenies&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Johnathan Davies&lt;/strong&gt; Neutral Biodiversity theory can explain imbalance of phylogenetic trees&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Ezra Miller&lt;/strong&gt; Consensus by averaging phylogenetic trees.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>CSGF Conference Thursday</title>
	 <link href="/2010/06/24/CSGF-Conference-Thursday.html"/>
   <updated>2010-06-24T00:00:00+00:00</updated>
   <id>/06/24/CSGF-Conference-Thursday</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://www.krellinst.org/conf/csgf/2010-conference/conference-agenda&quot; title=&quot;http://www.krellinst.org/conf/csgf/2010-conference/conference-agenda&quot;&gt;Conference Agenda&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>CSGF Conference Day 2</title>
	 <link href="/2010/06/23/DoE-CSGF-Conference-Day-2.html"/>
   <updated>2010-06-23T00:00:00+00:00</updated>
   <id>/06/23/DoE-CSGF-Conference-Day-2</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http---www.krellinst.org-conf-csgf-&quot; title=&quot;http---www.krellinst.org-conf-csgf-&quot;&gt;DoE CSGF Conference&lt;/a&gt;, Day 2&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.krellinst.org/conf/csgf/2010-conference/conference-agenda&quot; title=&quot;http://www.krellinst.org/conf/csgf/2010-conference/conference-agenda&quot;&gt;Conference Agenda&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Fellows Poster Session&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/38/CarlPresentsPoster.jpg/300px-CarlPresentsPoster.jpg&quot; alt=&quot;Photo credit Michelle King, Krell Institute. Others in the photo are: Devin Matthews, University of Texas at Austin, DOE CSGF fellow (dark blue CSGF shirt) and Jeff Lewandowski, Computational Science and Discovery Magazine.&quot; /&gt;&lt;figcaption&gt;Photo credit Michelle King, Krell Institute. Others in the photo are: Devin Matthews, University of Texas at Austin, DOE CSGF fellow (dark blue CSGF shirt) and Jeff Lewandowski, Computational Science and Discovery Magazine.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Photo credit Michelle King, Krell Institute. Others in the photo are: Devin Matthews, University of Texas at Austin, DOE CSGF fellow (dark blue CSGF shirt) and Jeff Lewandowski, Computational Science and Discovery Magazine.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; Presented my poster which qualified as a finalist in the competition.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>CSGF Conference- Tuesday</title>
	 <link href="/2010/06/22/CSGF-Conference-Tuesday.html"/>
   <updated>2010-06-22T00:00:00+00:00</updated>
   <id>/06/22/CSGF-Conference-Tuesday</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://www.krellinst.org/conf/csgf/2010-conference/conference-agenda&quot; title=&quot;http://www.krellinst.org/conf/csgf/2010-conference/conference-agenda&quot;&gt;Conference Agenda&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### HPC Survey Results&lt;/p&gt;
&lt;p&gt;Presented the results of my survey of the computational habits and tools of CSGF fellows and alumni. See my &lt;a href=&quot;http://openwetware.org/wiki/Image:CSGF_survey_summary.pdf&quot; title=&quot;http://openwetware.org/wiki/Image:CSGF_survey_summary.pdf&quot;&gt;Survey summary&lt;/a&gt;. Slides, data, etc available on my github &lt;a href=&quot;http://github.com/cboettig/sandbox/tree/master/csgf_survey/&quot; title=&quot;http://github.com/cboettig/sandbox/tree/master/csgf_survey/&quot;&gt;repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>CSGF Conference- HPC Workshop</title>
	 <link href="/2010/06/21/CSGF-Conference-HPC-Workshop.html"/>
   <updated>2010-06-21T00:00:00+00:00</updated>
   <id>/06/21/CSGF-Conference-HPC-Workshop</id>
   <content type="html">&lt;p&gt;I found the breakout sessions in the afternoon particularly fascinating for their paradigm-breaking look into the future of high performance computing. While FLOPS become free, huge scale and ultra-low-power devices (little voltage difference to identify bits) make error handling a topic of major concern, and the idea of “wasting” processors to perform redundant calculations to avoid errors becomes quite serious. Other ideas, like moving computation around the memory instead of the reverse, the rise of large data and questioning the role of GPU and other novel architecture was also an important theme. Breaking out of the cycle of simply scaling up the MPI paradigm will open new questions but require new hardware, new algorithms, and new kinds of thinking.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Wainwright Lab Meeting</title>
	 <link href="/2010/06/16/Wainwright-Lab-Meeting.html"/>
   <updated>2010-06-16T00:00:00+00:00</updated>
   <id>/06/16/Wainwright-Lab-Meeting</id>
   <content type="html">&lt;p&gt;Presented a revised version of my talk for Evolution 2010, focusing on the inadequacy of information-criteria heuristics for model choice in phylogenetic comparative methods and presenting the likelihood-ratio based approach I’ve been working on. Much better received this time. (The last two weeks have been pretty dedicated to preparing for the upcoming conferences, mostly for this presentation, so not much in the way of new research. Will be able to return to new stuff in July, following iEvoBio).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Questions</title>
	 <link href="/2010/06/10/Questions.html"/>
   <updated>2010-06-10T00:00:00+00:00</updated>
   <id>/06/10/Questions</id>
   <content type="html">&lt;p&gt;Current population dynamics model macroscopic equations:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/1/c/2/1c26a2c6740e377965fa6e85d41e3f33.png&quot; alt=&quot;\begin{align} \dot E &amp;amp;= f_E(E,L,A) = -\mu_e E - c_{le} E L - c_{ae} E A - a_e E + b A \\ \dot L &amp;amp;= f_L(E, L) = -\mu_L L + a_e E - a_L L \\ \dot P &amp;amp;= f_P(L,P) = -\mu_P P - a_p P + a_L L\\ \dot A &amp;amp;= f_A(P,A) = -\mu_A A + a_p P \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \dot E &amp;amp;= f_E(E,L,A) = -\mu_e E - c_{le} E L - c_{ae} E A - a_e E + b A \\ \dot L &amp;amp;= f_L(E, L) = -\mu_L L + a_e E - a_L L \\ \dot P &amp;amp;= f_P(L,P) = -\mu_P P - a_p P + a_L L\\ \dot A &amp;amp;= f_A(P,A) = -\mu_A A + a_p P \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Interpreting μ terms as death events, b as birth, and the &lt;em&gt;a&lt;/em&gt; terms as transitions between age classes gives a natural form for the master equation.&lt;/p&gt;
&lt;h3 id=&quot;divergent-solutions-to-the-linear-noise-approximation&quot;&gt;Divergent Solutions to the linear noise approximation?&lt;/h3&gt;
&lt;p&gt;Breaking the age classes into &lt;em&gt;k&lt;/em&gt; subclasses makes waiting time within an age class gamma instead of exponential, which better matches observation. Also allows sustained oscillations. The numerical solution to the linear noise approximation shows divergent variance dynamics. Is this a numerical artifact?&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/eb/Oscillate_noise2.png/500px-Oscillate_noise2.png&quot; alt=&quot;Numerical solution to linear noise b=5, ue= 0, ul = 0.001, up = 0, ua = 0.01, ae = .13*k, al = .01*k, ap = .15*k, cle = .2, cap = .1, cae = 5, V=volume&quot; /&gt;&lt;figcaption&gt;Numerical solution to linear noise b=5, ue= 0, ul = 0.001, up = 0, ua = 0.01, ae = .13*k, al = .01*k, ap = .15*k, cle = .2, cap = .1, cae = 5, V=volume&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Numerical solution to linear noise&lt;/strong&gt; b=5, ue= 0, ul = 0.001, up = 0, ua = 0.01, ae = .13*k, al = .01*k, ap = .15*k, cle = .2, cap = .1, cae = 5, V=volume&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/0af18d6f4b63ef63ced376f0c73cec16b83c66b5/R/gamma_beetles.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/0af18d6f4b63ef63ced376f0c73cec16b83c66b5/R/gamma_beetles.R&quot;&gt;version-stable code&lt;/a&gt;.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/a/a9/Ibm_gamma.png&quot; alt=&quot;individual base simulation with same parameters&quot; /&gt;&lt;figcaption&gt;individual base simulation with same parameters&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/c361d07025b038c3d435018b751a6858c71f89c7/R/ind_based_models.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/c361d07025b038c3d435018b751a6858c71f89c7/R/ind_based_models.R&quot;&gt;Version-stable code&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;differences-between-two-step-correlated-events-and-two-single-steps&quot;&gt;Differences between two-step (correlated events) and two single steps&lt;/h3&gt;
&lt;p&gt;Can we distinguish between a process where an element leaves one population and enters another (i.e. a transitions from one age class to the next) and a model where death rate in one class is equal to the birth rate in another? The linear noise approximation for a two-step process obeys a different equation than the one-step:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/5/e/b/5eb413fd88e12c41c39cf48c811fc71a.png&quot; alt=&quot;\begin{align} &amp;amp; \frac{d}{dt} E(p) = b(p)-d(p) + \sum_{j \neq i} \tau_{ji}(p) - \tau_{ij}(p) =: f(p)\\ &amp;amp; \frac{d}{dt} M = \textrm{diag}( b(p) + d(p) ) - T + Df(p) M + M Df(p)^T \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} &amp;amp; \frac{d}{dt} E(p) = b(p)-d(p) + \sum_{j \neq i} \tau_{ji}(p) - \tau_{ij}(p) =: f(p)\\ &amp;amp; \frac{d}{dt} M = \textrm{diag}( b(p) + d(p) ) - T + Df(p) M + M Df(p)^T \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;where &lt;em&gt;T&lt;/em&gt; is a symmetric matrix with off-diagonal elements &lt;em&gt;i,j&lt;/em&gt; τ~&lt;em&gt;i&lt;strong&gt;j&lt;em&gt;~(&lt;/em&gt;p&lt;em&gt;) + τ&lt;/em&gt;j&lt;/strong&gt;i&lt;/em&gt;(&lt;em&gt;p&lt;/em&gt;) and diagonal elements chosen so that rows sum to zero. This approximation is implemented in &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/noise_approx.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/noise_approx.R&quot;&gt;noise_approx.R&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;How different can this be from simply implementing all transitions as single-steps?&lt;/p&gt;
&lt;p&gt;So far the difference seems small in my examples:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/e8/Crowley_covariance.png/400px-Crowley_covariance.png&quot; alt=&quot;hastings covarainces, b1 = 0, b2 = .6, d1 = d2 = .1, c1 = c2 =.5, K =1e4&quot; /&gt;&lt;figcaption&gt;hastings covarainces, b1 = 0, b2 = .6, d1 = d2 = .1, c1 = c2 =.5, K =1e4&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/26/Fixed_2.png/400px-Fixed_2.png&quot; alt=&quot;Comparison. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&quot; /&gt;&lt;figcaption&gt;Comparison. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Comparison. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Graham & Peter Meeting</title>
	 <link href="/2010/06/09/Graham-and-Peter-Meeting.html"/>
   <updated>2010-06-09T00:00:00+00:00</updated>
   <id>/06/09/Graham-and-Peter-Meeting</id>
   <content type="html">&lt;p&gt;Fantastic meeting with Graham and Peter today, covered a lot of ground.&lt;/p&gt;
&lt;h4 id=&quot;mnv&quot;&gt;MNV&lt;/h4&gt;
&lt;p&gt;I briefly sketched the multivariate normal solution for joint probability across the tree under the regimes model. The original regimes approach did not take advantage of the fact that the solution to the joint probability across the tree is multivariate normal given the painting. This allows the calculation to be partitioned as outlined in Saturday’s entry:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/b/7/d/b7d74172c4b6e8084dc7907ec3dd6300.png&quot; alt=&quot;P(X | \vec \theta, \mathbb{Q} ) = P(X | C) P(C | \mathbb{Q} )&quot; /&gt;&lt;figcaption&gt;P(X | \vec \theta, \mathbb{Q} ) = P(X | C) P(C | \mathbb{Q} )&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; #### Importance Sampling&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The method I had outlined by reusing the tree library and weighting by the probability that the Q matrix generated that tree goes by the name &lt;em&gt;Importance Sampling&lt;/em&gt;, though it ought to have been re-weighted by the probability it was produced from the original Q matrix used to generate it (Q’), and then averaged. (In my examples (github) I generate from the same distribution as a weight from and these agree). A brief summary excerpted from Wikipedia:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/math/3/7/3/373dde81b17f8f8f1d2b77732bbd9ada.png&quot; alt=&quot;\begin{align} p_t &amp;amp; {} = {E} [1(X \ge t)] \\ &amp;amp; {} = \int 1(x \ge t) \frac{f(x)}{f_*(x)} f_*(x) \,dx \\ &amp;amp; {} = {E_*} [1(X \ge t) W(X)] \end{align}&quot; /&gt;&lt;/p&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/4/0/2406dfcf6682ef40f4c5142f0fceb5b6.png&quot; alt=&quot;W(\cdot) \equiv \frac{f(\cdot)}{f_*(\cdot)}&quot; /&gt;&lt;figcaption&gt;W(\cdot) \equiv \frac{f(\cdot)}{f_*(\cdot)}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;is a likelihood ratio and is referred to as the weighting function. The last equality in the above equation motivates the estimator&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/a/9/d/a9d937b80a14419bcbcd9e73159727ea.png&quot; alt=&quot;\hat p_t = \frac{1}{K}\,\sum_{i=1}^K 1(X_i \ge t) W(X_i),\,\quad \quad X_i \sim f_*&quot; /&gt;&lt;figcaption&gt;\hat p_t = \frac{1}{K}\,\sum_{i=1}^K 1(X_i \ge t) W(X_i),\,\quad \quad X_i \sim f_*&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This is the importance sampling estimator of &lt;img src=&quot;http://openwetware.org/images/math/1/e/4/1e48d42b7f9d92edeb2212f749b47b4a.png&quot; alt=&quot;p_t\,&quot; /&gt; and is unbiased. That is, the estimation procedure is to generate i.i.d. samples from &lt;img src=&quot;http://openwetware.org/images/math/4/e/9/4e91b5d2c89ec590d25607953484706c.png&quot; alt=&quot;f_*\,&quot; /&gt; and for each sample which exceeds &lt;img src=&quot;http://openwetware.org/images/math/0/c/6/0c68620ee2ea4f1286fcd672a47ea080.png&quot; alt=&quot;t\,&quot; /&gt;, the estimate is incremented by the weight &lt;img src=&quot;http://openwetware.org/images/math/2/f/1/2f1e8d5af98f2c9643b0334c73ccc25b.png&quot; alt=&quot;W\,&quot; /&gt; evaluated at the sample value. The results are averaged over &lt;img src=&quot;http://openwetware.org/images/math/d/0/e/d0e1b8571128845c03a4cfac00d43b66.png&quot; alt=&quot;K\,&quot; /&gt; trials.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - Unfortunately having to know the &lt;img src=&quot;http://openwetware.org/images/math/d/5/d/d5dd2924b7a98d52bb15c85b966071e6.png&quot; alt=&quot;f_*(\cdot)&quot; /&gt; term means that I cannot produce the painting library arbitrarily, but will be stuck finding the right painting only with the probability that I can simulate it from the prior.&lt;/p&gt;
&lt;h4 id=&quot;mcmc&quot;&gt;MCMC&lt;/h4&gt;
&lt;p&gt;Partitioning the problem&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/f/d/6/fd6dcd9d7346f612450994c84b39a7f5.png&quot; alt=&quot;P(X | \vec \theta, \mathbb{Q} ) = P(X | C) P(C | \mathbb{Q} ) P( \mathbb{Q} ) P( \vec \theta)&quot; /&gt;&lt;figcaption&gt;P(X | \vec \theta, \mathbb{Q} ) = P(X | C) P(C | \mathbb{Q} ) P( \mathbb{Q} ) P( \vec \theta)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;and proposing paintings directly, we can MCMC over the space of possible paintings &lt;em&gt;C&lt;/em&gt;, OU parameters &lt;img src=&quot;http://openwetware.org/images/math/1/c/8/1c876a2b07f33c4f32b5f73a9d790a18.png&quot; alt=&quot;\vec \theta&quot; /&gt; and transition matrices &lt;img src=&quot;http://openwetware.org/images/math/d/4/5/d45a4aa156a8ac07ab80e7d9cf5fa79f.png&quot; alt=&quot;\mathbb{Q}&quot; /&gt;. Still, as this problem is hard in the discrete case over &lt;img src=&quot;http://openwetware.org/images/math/d/4/5/d45a4aa156a8ac07ab80e7d9cf5fa79f.png&quot; alt=&quot;\mathbb{Q}&quot; /&gt; (BayesTraits), optimizing the MCMC will still be interesting…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Discussion of Hastings ratio&lt;/li&gt;
&lt;li&gt;Discussion of reversible jump&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;wainwright-lab-meeting-4-6pm&quot;&gt;Wainwright Lab Meeting, 4-6pm&lt;/h2&gt;
&lt;p&gt;Presented three potential questions to focus on for the Evolution talk:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Defining clusters from raw data, with example in Labrids&lt;/li&gt;
&lt;li&gt;Inferring paintings and transition rates directly from data via MCMC&lt;/li&gt;
&lt;li&gt;Risks in AIC-based model choice&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The group clearly indicated that I should focus on the third, AIC topic, as it is the furthest along and the most immediate impact to the audience. Surprising to me as it is also the least biologically driven. Back to the drawing board now to figure out how to tell this story clearly and succinctly.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Making slides for Evolution meeting</title>
	 <link href="/2010/06/08/Making-slides-for-Evolution-meeting.html"/>
   <updated>2010-06-08T00:00:00+00:00</updated>
   <id>/06/08/Making-slides-for-Evolution-meeting</id>
   <content type="html">&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/4/42/VsBM.png/180px-VsBM.png&quot; alt=&quot;Anoles LP model vs BM&quot; /&gt;&lt;figcaption&gt;Anoles LP model vs BM&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Anoles LP model vs BM&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/c/c5/VsOU1.png/180px-VsOU1.png&quot; alt=&quot;Anoles LP fits vs OU1&quot; /&gt;&lt;figcaption&gt;Anoles LP fits vs OU1&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Anoles LP fits vs OU1&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/4/44/NP.png/180px-NP.png&quot; alt=&quot;Anoles Neyman-Pearson model selection&quot; /&gt;&lt;figcaption&gt;Anoles Neyman-Pearson model selection&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Anoles Neyman-Pearson model selection&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/d/d3/Q.png/180px-Q.png&quot; alt=&quot;Visualization of transition matrix&quot; /&gt;&lt;figcaption&gt;Visualization of transition matrix&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Visualization of transition matrix&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Implementing the new approach</title>
	 <link href="/2010/06/06/Implementing-the-new-approach.html"/>
   <updated>2010-06-06T00:00:00+00:00</updated>
   <id>/06/06/Implementing-the-new-approach</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Spent just about the entire day off and on implementing the approach described in yesterday’s entry. Code includes the more direct implementation of the likelihood by generating trees from the process and averaging, as well as by weighting trees by their probability. Methods appear to agree reasonably well. The second approach should generate a wider variety of trees instead of using those produced by the first method. This could be done by varying the parameters of the transition rates to populate the collection. This needs significantly more exploring.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - Note that the major time savings in the new approach stem from the fact that when the transition matrix is changed, it may not be necessary generate new trees, only to change the weights &lt;img src=&quot;http://openwetware.org/images/math/5/a/0/5a0d9e1f1ef3c42a0ec1e51e7535d4e1.png&quot; alt=&quot;P(C|\mathbb{Q})&quot; /&gt;, and therefore it is not necessary to recalculate the likelihood of the OU model, since the painting hasn’t changed. Indeed, even the optimization / posteriors can be saved for each tree, offering substantial computational savings. In this way, every time the algorithm generates and fits a new tree, it can use that information for the rest of time, while it uses the MCMC approach to generate more likely trees, rather than trying an exhaustive approach. Note that this is MCMC approach can be used for an entirely frequentist style if desired, not all MCMCs are used to integrate posteriors. The makov chain construction part just speeds up the integration by monte carlo approach by focusing on the meaningful area of parameter space.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Still actually need to implement the MCMC portion, so far just calculates the likelihood.&lt;/li&gt;
&lt;li&gt;Also should implement the multi-tree initialization and tree-augmentation steps.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Implementation of the approach (&lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/75b7bfdc7b1d5ccd3ce986db9cd5f7dd034cd5d1/R/method3.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/75b7bfdc7b1d5ccd3ce986db9cd5f7dd034cd5d1/R/method3.R&quot;&gt;version stable copy&lt;/a&gt;) (&lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/master/R/method3.R&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/blob/master/R/method3.R&quot;&gt;most current version&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Computational note: All in pure R, may move all or slowest parts to C after profiling and optimization. Requires the &lt;a href=&quot;http://cran.r-project.org/web/packages/msm/&quot; title=&quot;http://cran.r-project.org/web/packages/msm/&quot;&gt;msm&lt;/a&gt; package (multistate/hidden markov) for &lt;a href=&quot;http://pbil.univ-lyon1.fr/library/msm/html/MatrixExp.html&quot; title=&quot;http://pbil.univ-lyon1.fr/library/msm/html/MatrixExp.html&quot;&gt;its matrix exponentials&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihood Calculation</title>
	 <link href="/2010/06/05/Likelihood-Calculation.html"/>
   <updated>2010-06-05T00:00:00+00:00</updated>
   <id>/06/05/Likelihood-Calculation</id>
   <content type="html">&lt;h3 id=&quot;direct-calculation-of-the-joint-probability&quot;&gt;Direct Calculation of the Joint Probability&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/d/d9/Sampletree.png/180px-Sampletree.png&quot; alt=&quot;Fig 1 Sample tree&quot; /&gt;&lt;figcaption&gt;Fig 1 Sample tree&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Fig 1&lt;/strong&gt; Sample tree&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;This is the approach implemented in the wrightscape project &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/master/src/matrix_method.c&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/master/src/matrix_method.c&quot;&gt;matrix_method.c&lt;/a&gt;. Consider an example phylogenetic tree (Fig 1) over which a stochastic process describes the evolution of trait &lt;em&gt;x,&lt;/em&gt; defined by the transition probability rate &lt;em&gt;w&lt;/em&gt;. Then the joint probability for a set of observed traits under this process can be written:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/0/a/c/0ac79d1c40c55d61a5acf6e240f06438.png&quot; alt=&quot;\begin{align} P(x_1, x_2, x_3, x_4) =&amp;amp; \int d x_7 \Biggl[ \left[ \int d x_5 w(x_7, x_5, t_5) w(x_5, x_1, t_1) w(x_5, x_2, t_1) \right] \\ &amp;amp; \times \left[ \int d x_6 w(x_7, x_6, t_6) w(x_6, x_3, t_3) w(x_6, x_4, t_3) \right] P(x_7) \Biggr] \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} P(x_1, x_2, x_3, x_4) =&amp;amp; \int d x_7 \Biggl[ \left[ \int d x_5 w(x_7, x_5, t_5) w(x_5, x_1, t_1) w(x_5, x_2, t_1) \right] \\ &amp;amp; \times \left[ \int d x_6 w(x_7, x_6, t_6) w(x_6, x_3, t_3) w(x_6, x_4, t_3) \right] P(x_7) \Biggr] \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The transition density from any state to any state can be represented as a matrix over the domain of the integral. So at each node, we have a transition probability of entering any state that node can assume from any state from which its ancestor could assume. Though we have an analytical expression for this probability, we must evaluate it &lt;em&gt;n&lt;/em&gt;&lt;sup&gt;2&lt;/sup&gt; times for each matrix, then perform the matrix multiplications that are the equivalent discretization of the integral formulation above. If the tips are known they are represented instead by a single column of that matrix – i.e. transitions from any state to the known tip state. So:&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Taking the element-wise product (denoted *) of the tip vectors times the matrix (chalkboard boldface) of the internal node prunes that node down to a single vector, and this can be recursed:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/8/1/6/8169d9da7630c0db3078b7f473f701e3.png&quot; alt=&quot;\int d x_5 w(x_7, x_5, t_5) w(x_5, x_1, t_1) w(x_5, x_2, t_1) \approx \mathbb{W}_5 (\vec W_1 * \vec W_2) \to \vec W_5&quot; /&gt;&lt;figcaption&gt;\int d x_5 w(x_7, x_5, t_5) w(x_5, x_1, t_1) w(x_5, x_2, t_1) \approx \mathbb{W}_5 (\vec W_1 * \vec W_2) \to \vec W_5&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;See implementation in the code, &lt;a href=&quot;http://github.com/cboettig/wrightscape/blob/master/src/matrix_method.c&quot; title=&quot;http://github.com/cboettig/wrightscape/blob/master/src/matrix_method.c&quot;&gt;matrix_method.c&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;While the discretization is substantially faster than the numerical integration, since it reduces the problem to a series of matrix products (note that given the root note and all tip nodes, then this produces a joint probability as a single scalar. Unknown tips results in a tensor, indicating the dimensionality of the full data space).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Most of the time is spent computing the elements of the matrices at each node, see Yesterday’s entry, which reduces performance to substantially below that of the linear likelihood schemes compared in that model. The advantage of this approach is that the W matrices can be computed in principle for any process, and once computed the actual calculation of the joint probability (the recursive integrals) occurs very fast, even for reasonably large grids. (No matrix inversion, just products!) It is rather the calculation of each element of the matrix separately that is both the rate limiting step and leads to poor (quadratic) scaling of compute time with increasing grid resolution. This leads us to consider some other approaches:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Given a painting&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Given a painting we can determine the likelihood of this regimes model (mixtures of OUs) with given parameter values (i.e. using the OUCH framework). For instance, if we assume as OUCH does, that for OU processes, *d**X* = α(θ − &lt;em&gt;X&lt;/em&gt;)*d**t* + σ*d**B*&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt;,&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;sigma and alpha are global parameters but there can be different values of theta under regimes, then the joint probability is &lt;em&gt;still&lt;/em&gt; multivariate normal, so its likelihood is given by&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/a/0/a/a0ad9db46854c4a616ce6959095cf21d.png&quot; alt=&quot;f_X(x) = \frac{1}{ (2\pi)^{k/2}|\Sigma|^{1/2} } \exp\!\Big( {-\tfrac{1}{2}}(x-\mu)’\Sigma^{-1}(x-\mu) \Big),&quot; /&gt;&lt;figcaption&gt;f_X(x) = \frac{1}{ (2\pi)^{k/2}|\Sigma|^{1/2} } \exp\!\Big( {-\tfrac{1}{2}}(x-\mu)’\Sigma^{-1}(x-\mu) \Big),&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;The addition of regimes with different thetas alters the calculation of the means, which can still be done using the solution to the expectation of the OU process. For instance, a tip that has spent time &lt;em&gt;t&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt; in regime 1 followed by time &lt;em&gt;t&lt;/em&gt;&lt;sub&gt;2&lt;/sub&gt; in regime 2 has expectation:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/f/b/2fb3833cbe74fff7dccf6210efd5a427.png&quot; alt=&quot;E(X) = (X_0 e^{-\alpha_1 t_1} + \theta_1) e^{\alpha_2 t_2} + \theta_2&quot; /&gt;&lt;figcaption&gt;E(X) = (X_0 e^{-\alpha_1 t_1} + \theta_1) e^{\alpha_2 t_2} + \theta_2&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;and so forth. If we assume alpha and sigma are the same for all processes than the variance calculation is unaltered. We could also generalize this to allow regimes to change at points other than nodes, though in practice this may be unimportant. For varying alpha and sigma, we would need to modify the variance calculation (will hopefully write down soon). So all this is well implemented given the tree, but our desire is to avoid having to specify a painting.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Speed in this method depends largely on the ability to calculate distances between nodes on a tree. While many common implementations of this exist, including my own, it appears that most of the phylogenetics codes do not use the computationally optimum algorithms, which are surprisingly recent in the CS literature. See the &lt;a href=&quot;http://www.topcoder.com/tc?module=Static&amp;amp;d1=tutorials&amp;amp;d2=lowestCommonAncestor&quot; title=&quot;http://www.topcoder.com/tc?module=Static&amp;amp;d1=tutorials&amp;amp;d2=lowestCommonAncestor&quot;&gt;algorithms described here&lt;/a&gt;. It appears that this distance goes by the name patristic in the phylogenetics literature. (Sample algorithms in practice – see &lt;a href=&quot;http://www.mathworks.com/access/helpdesk/help/toolbox/bioinfo/ug/a1075738685b2.html&quot; title=&quot;http://www.mathworks.com/access/helpdesk/help/toolbox/bioinfo/ug/a1075738685b2.html&quot;&gt;Matlab&lt;/a&gt;, &lt;a href=&quot;http://github.com/jeetsukumaran/DendroPy/blob/master/dendropy/treecalc.py&quot; title=&quot;http://github.com/jeetsukumaran/DendroPy/blob/master/dendropy/treecalc.py&quot;&gt;dendropy&lt;/a&gt;, &lt;a href=&quot;https://www.nescent.org/wg_phyloinformatics/R_Hackathon_1/DataTreeManipulation&quot; title=&quot;https://www.nescent.org/wg_phyloinformatics/R_Hackathon_1/DataTreeManipulation&quot;&gt;R&lt;/a&gt;, etc. Sample papers see &lt;a href=&quot;http://en.wikipedia.org/wiki/Lowest_common_ancestor&quot; title=&quot;http://en.wikipedia.org/wiki/Lowest_common_ancestor&quot;&gt;on lowest common ancestor&lt;/a&gt; problem on wikipedia.)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;original-appraoach&quot;&gt;Original appraoach&lt;/h4&gt;
&lt;p&gt;The Labrid example tackles this problem by attempting to generate a reasonable distribution of paintings from the data by clustering.&lt;/p&gt;
&lt;h3 id=&quot;distributions-of-paintings&quot;&gt;Distributions of Paintings&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;We’d like not to actually integrate over paintings, but over stochastic mappings (continuous time finite state Markov chains) that generate the paintings. This reduces the parameter set (i.e. two additional parameters for the two regimes case, or six for the three regime case, without assuming equal forward-back rates or an ordering of the peaks).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The most straight-forward implementation of this approach is to generate paintings from a particular parameterization of a transition matrix and calculate the probability of the data of each. Averaging these probabilities effectively integrates over the distribution of paintings generated from the transition density. Unfortunately, this may not be much faster. However, we can do better than this by realizing that &lt;em&gt;given a painting, we can compute the probability that it is generated from any particular transition matrix!&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - In this way we can construct the probability of the parameter set of the regimes &lt;img src=&quot;http://openwetware.org/images/math/1/c/8/1c876a2b07f33c4f32b5f73a9d790a18.png&quot; alt=&quot;\vec \theta&quot; /&gt;, and the transition probabilities &lt;img src=&quot;http://openwetware.org/images/math/d/4/5/d45a4aa156a8ac07ab80e7d9cf5fa79f.png&quot; alt=&quot;\mathbb{Q}&quot; /&gt; through a particular painting &lt;em&gt;C&lt;/em&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/b/7/d/b7d74172c4b6e8084dc7907ec3dd6300.png&quot; alt=&quot;P(X | \vec \theta, \mathbb{Q} ) = P(X | C) P(C | \mathbb{Q} )&quot; /&gt;&lt;figcaption&gt;P(X | \vec \theta, \mathbb{Q} ) = P(X | C) P(C | \mathbb{Q} )&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Comparative Phylogenetics Talk</title>
	 <link href="/2010/06/04/Comparative-Phylogenetics-Talk.html"/>
   <updated>2010-06-04T00:00:00+00:00</updated>
   <id>/06/04/Comparative-Phylogenetics-Talk</id>
   <content type="html">&lt;p&gt;Practice talk in Wainwright lab meeting next Weds. 12 minutes.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Introduce question: Inferring the number of regimes&lt;/li&gt;
&lt;li&gt;Context relative to existing methods&lt;/li&gt;
&lt;li&gt;Statistical challenges – model-dependent phylogenetic signal problem&lt;/li&gt;
&lt;li&gt;Labrid example&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;frameworks-for-approaching-regimes-question&quot;&gt;Frameworks for approaching regimes question&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;wrightscape&lt;/li&gt;
&lt;li&gt;&lt;p&gt;phylogenetically corrected clustering&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;speed/feasibility concerns, rate limiting steps.&lt;/li&gt;
&lt;li&gt;model realism / representation concerns&lt;/li&gt;
&lt;li&gt;&lt;p&gt;statistical concerns&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;returning-to-wrightscape-approach&quot;&gt;Returning to Wrightscape approach&lt;/h2&gt;
&lt;p&gt;Haven’t worked on the full problem of inferring multiple peaks directly from comparative data using the joint probability calculation since the beginning of this notebook, so about time to return to the direct problem and compare with the more heuristic approach of “phylogenetically corrected clustering” and also synthesize the work on uncertainty which has been a dominate theme thus far (add category label for this group!)&lt;/p&gt;
&lt;p&gt;The direct calculation is still going by the name wrightscape, and the project (without its svn history unforunately) has been migrated to git and pushed to github. So thus far the current code for this project is independent of that in Comparative-Phylogenetics project repository. This is the home of the &lt;a href=&quot;http://github.com/cboettig/wrightscape&quot; title=&quot;http://github.com/cboettig/wrightscape&quot;&gt;Wrightscape repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Since it’s been a while since I’ve worked on this project, I begin by refreshing myself as to the organizational structure of the code. The callgraph provides a good summary:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/b/b6/Callgraph.png/700px-Callgraph.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Generated with valgrind and visualized in kcachegrind by:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; make debug
 valgrind --tool=callgrind ./jointprob
 kcachegrind callgrind.out.*&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;kcachegrind then displays the call graph, (and other information), which can save as png.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; We see the code compare a likelihood calculation using the linear solutions compared with that of the matrix approach for the sample data (which includes both trivially small tree example and the bimac dataset from the Butler &amp;amp; King (2004) paper) for BM fit, OU fit, and the matrix approach OU fit. The matrix approach clearly takes the dominate amount of time, though results agree closely with the exact linear solutions in both examples:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; analytic bm llik = -8.648713
 analytic ou llik = -8.570838
 matrix llik = -8.582334
 analytic bm llik = -65.106558
 analytic ou llik = -61.906121
 matrix llik = -61.927070&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So what is the matrix approach implement exactly? Desending the call graph further, we see it is mostly computing the transition matrix that sits at each node (which it can do directly using the analytic OU solution). Then the matrix solution to the joint probability is specified by:&lt;/p&gt;
&lt;p&gt;So what generality is gained by this approach? While the matrix formulation is general, this requires the direct calculation applied to each node. Should be able to simultaneously solve everything in a particular regime directly, if there is a meaningful way to MCMC over larger regime partitions rather than over node assignments.&lt;/p&gt;
&lt;h2 id=&quot;evolution-meeting&quot;&gt;Evolution meeting&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Aaron King’s student, &lt;a href=&quot;http://www-personal.umich.edu/~cressler/&quot; title=&quot;http://www-personal.umich.edu/~cressler/&quot;&gt;Clayton Cressler&lt;/a&gt; &lt;a href=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=501&quot; title=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=501&quot;&gt;talk&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Liam Revell &lt;a href=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=459&quot; title=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=459&quot;&gt;talk&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Luke Harmon &lt;a href=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=133&quot; title=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=133&quot;&gt;talks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Michael Alfaro &lt;a href=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=1379&quot; title=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=1379&quot;&gt;talk&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - Hilmar Lapp, Rod Page - My &lt;a href=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=18&quot; title=&quot;http://2010.evolutionmeeting.org/search/index.php?func=detail&amp;amp;aid=18&quot;&gt;talk&lt;/a&gt; - Search &lt;a href=&quot;http://2010.evolutionmeeting.org/search/index.php?func=SelectAuth&amp;amp;ltr=All&quot; title=&quot;http://2010.evolutionmeeting.org/search/index.php?func=SelectAuth&amp;amp;ltr=All&quot;&gt;all talks&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - Doesn’t look like Andrew Hipp is listed. See my mattice entry from April.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Entry title</title>
	 <link href="/2010/06/03/Entry-title.html"/>
   <updated>2010-06-03T00:00:00+00:00</updated>
   <id>/06/03/Entry-title</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Insert content here…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Actually starting at Arkin Lab</title>
	 <link href="/2010/06/02/Actually-starting-at-Arkin-Lab.html"/>
   <updated>2010-06-02T00:00:00+00:00</updated>
   <id>/06/02/Actually-starting-at-Arkin-Lab</id>
   <content type="html">&lt;h3 id=&quot;meeting-with-m.-samoilov&quot;&gt;Meeting with M. Samoilov&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Kurtz Theorems: two limits, timescale and system size, often taken in the wrong order in practice.&lt;/li&gt;
&lt;li&gt;Einstein-Smoluchowski debate regarding Langevin correspondence to Ito vs Statonvich representations resolved: [theorem]. (Statonvich is the more natural interpretation of the way in which we measure data to compare to Langevin. Of course Ito and Stratonvich can be mapped back and forth anyway).&lt;/li&gt;
&lt;li&gt;Of course this difference doesn’t exist, and nothing goes wrong / no stochastic surprises if dynamics are linear.&lt;/li&gt;
&lt;li&gt;Necessary limits of applicability not often checked in SDE famework.&lt;/li&gt;
&lt;li&gt;Deterministic limit often works better than these limits would imply, as the same deterministic equation arises from multiple cases&lt;/li&gt;
&lt;li&gt;Hamiltonian-Jacobi derivation sheds some light on why deterministic result is more general (requires fewer assumptions/weaker limits than SDE approach)&lt;/li&gt;
&lt;li&gt;Intrinsic + extrinsic noise is hard. Environmental noise poorly defined, hard to make physical. Can be incorporated into the master equation directly in a more meaningful way, still very hard problem. Still, environmental noise often not needed to capture the behavior once we go back to original master equation.&lt;/li&gt;
&lt;li&gt;References and examples to come.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Gamma Waiting times on individual level</title>
	 <link href="/2010/06/01/Gamma-Waiting-times-on-individual-level.html"/>
   <updated>2010-06-01T00:00:00+00:00</updated>
   <id>/06/01/Gamma-Waiting-times-on-individual-level</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Wrote the proper record structure into C code to handle reporting to R, including ensemble data.&lt;/li&gt;
&lt;li&gt;Wrote the R interface to the dynamics.&lt;/li&gt;
&lt;li&gt;Needs exploration.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/a/a9/Ibm_gamma.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/c361d07025b038c3d435018b751a6858c71f89c7/R/ind_based_models.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/c361d07025b038c3d435018b751a6858c71f89c7/R/ind_based_models.R&quot;&gt;Version-stable code&lt;/a&gt; for parameters. Run using defaults, graph as:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;  png(&amp;quot;ibm_gamma.png&amp;quot;)
  o &amp;lt;- gamma_beetles_ibm()
  plot(o$times, o$mv[[1,1]], type=&amp;#39;l&amp;#39;, col=&amp;quot;yellow&amp;quot;)
  lines(o$times, o$mv[[1,2]], col=&amp;quot;yellowgreen&amp;quot;)
  lines(o$times, o$mv[[1,3]], col=&amp;quot;lightgreen&amp;quot;)
  lines(o$times, o$mv[[1,4]], col=&amp;quot;darkgreen&amp;quot;)
  dev.off()
  o$parameters
      b      ue      ul      up      ua      ae      al      ap     cle     cap 
  5.000   0.000   0.001   0.000   0.010   1.300   0.100   1.500   0.200   0.100 
    cae       V 
  5.000 100.000&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Simulation reports actual parameters above, chosen to match the theory results from last week (linear noise approximation).&lt;/li&gt;
&lt;li&gt;Comparisons using ensemble data against theory coming soon.&lt;/li&gt;
&lt;li&gt;Single replicate .c based IBM is currently faster than the ode system (with variance dynamics).&lt;/li&gt;
&lt;li&gt;Note: Entry and graph above actually added on June 3rd, parameters weren’t named correctly on June 1st, so simulation wasn’t oscillating.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>CSGF Survey</title>
	 <link href="/2010/05/31/CSGF-Survey.html"/>
   <updated>2010-05-31T00:00:00+00:00</updated>
   <id>/05/31/CSGF-Survey</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Wrote survey. Getting feedback and will send out this week.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;previous comments&lt;/p&gt;
&lt;h2 id=&quot;wiki-tricks&quot;&gt;Wiki Tricks&lt;/h2&gt;
&lt;p&gt;Exploring use of &lt;a href=&quot;http://wiki.freegeek.org/index.php/Www-mediawiki-client&quot; title=&quot;http://wiki.freegeek.org/index.php/Www-mediawiki-client&quot;&gt;mvs&lt;/a&gt; to download and upload entries from openwetware. The mediawiki client is easy to install as described in the link. Doesn’t seem to have a tool to grab everything in my Notebook namespace, but with a little bash script I can grab all the entries in a particular notebook:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ~&lt;sub&gt;~&lt;/sub&gt; {.de1} #! /bin/bash mvs login -d openwetware.org -u Carl_Boettiger -w index.php   for j in &lt;code&gt;seq 3 5&lt;/code&gt;; { for i in &lt;code&gt;seq 1 9&lt;/code&gt;; do mvs update User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/0&lt;span class=&quot;math&quot;&gt;\(j/0\)&lt;/span&gt;i.wiki done   for i in &lt;code&gt;seq 10 31&lt;/code&gt;; do mvs update User:Carl_Boettiger/Notebook/Comparative_Phylogenetics/2010/0&lt;span class=&quot;math&quot;&gt;\(j/\)&lt;/span&gt;i.wiki done } ~&lt;sub&gt;~&lt;/sub&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;login should specify -p password (omitted here for obvious reasons)&lt;/li&gt;
&lt;li&gt;For some reason can’t get commit to push changes back up. (See the link above for examples on how to commit data).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Error:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; Doing commit User:Carl_Boettiger.wiki with host: openwetware.org and lang: en
 Can&amp;#39;t call method &amp;quot;isa&amp;quot; without a package or object reference at /usr/bin/mvs line 96.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; - Also looking into a personal copy of OWW: OpenWetWare:Software/Subwikis, which would similarly allow offline work.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Individual based simulation with gamma waiting times</title>
	 <link href="/2010/05/29/Individual-based-simulation-with-gamma-waiting-times.html"/>
   <updated>2010-05-29T00:00:00+00:00</updated>
   <id>/05/29/Individual-based-simulation-with-gamma-waiting-times</id>
   <content type="html">&lt;p&gt;Began implementing the individual-based simulation of gamma waiting times by subdividing the first three age classes into K subclasses. Required rewriting gillespie function so as to intelligently calculate rates rather than writing 3K+1 functions. This leads to an alternative gillespie simulation interface that takes a function to calculate rates, producing cumulative sum (though perhaps that step should be moved into the raw gillespie code) of rates for each event, and an outcome function that will execute the outcome of each of those events. Additionally there is still the fixed interval tasks function and a custom record class for the output.&lt;/p&gt;
&lt;p&gt;See the github page for code, commit details, etc.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Conference call w- Bob and Brett</title>
	 <link href="/2010/05/28/Conference-call-w--Bob-and-Brett.html"/>
   <updated>2010-05-28T00:00:00+00:00</updated>
   <id>/05/28/Conference-call-w--Bob-and-Brett</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;So far no large noise in larval class alone, several potential mechanisms we may have missed so far:&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;getting-large-noise-in-larva&quot;&gt;Getting large noise in larva&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Noise from egg class (due to nonlinear dynamics)&lt;/li&gt;
&lt;li&gt;Nonlinearity in larval class due to large larva eating smaller ones&lt;/li&gt;
&lt;li&gt;Unknown effect of more realistic aging/stage transitions.&lt;/li&gt;
&lt;li&gt;Long transients? – Experiments start with larva, pupa, adults to speed up transient period.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Summary of Structured Population noise so far</title>
	 <link href="/2010/05/27/Summary-of-Structured-Population-noise-so-far.html"/>
   <updated>2010-05-27T00:00:00+00:00</updated>
   <id>/05/27/Summary-of-Structured-Population-noise-so-far</id>
   <content type="html">&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/eb/Oscillate_noise2.png/180px-Oscillate_noise2.png&quot; alt=&quot;Fig 1 Code b=5, ue= 0, ul = 0.001, up = 0, ua = 0.01, ae = .13*k, al = .01*k, ap = .15*k, cle = .2, cap = .1, cae = 5, V=volume&quot; /&gt;&lt;figcaption&gt;Fig 1 Code b=5, ue= 0, ul = 0.001, up = 0, ua = 0.01, ae = .13*k, al = .01*k, ap = .15*k, cle = .2, cap = .1, cae = 5, V=volume&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Fig 1&lt;/strong&gt; &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/0af18d6f4b63ef63ced376f0c73cec16b83c66b5/R/gamma_beetles.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/0af18d6f4b63ef63ced376f0c73cec16b83c66b5/R/gamma_beetles.R&quot;&gt;Code&lt;/a&gt; b=5, ue= 0, ul = 0.001, up = 0, ua = 0.01, ae = .13*k, al = .01*k, ap = .15*k, cle = .2, cap = .1, cae = 5, V=volume&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/6/62/Poisson_noise.png/180px-Poisson_noise.png&quot; alt=&quot;Fig 2 b=5, ue= 0, ul = 0.001, up = 0, ua = .001, ae = .1*k, al = .01*k, ap = .1*k, cle = 1, cap = .4, cae = 1, V=volume&quot; /&gt;&lt;figcaption&gt;Fig 2 b=5, ue= 0, ul = 0.001, up = 0, ua = .001, ae = .1*k, al = .01*k, ap = .1*k, cle = 1, cap = .4, cae = 1, V=volume&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Fig 2&lt;/strong&gt; b=5, ue= 0, ul = 0.001, up = 0, ua = .001, ae = .1*k, al = .01*k, ap = .1*k, cle = 1, cap = .4, cae = 1, V=volume&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### System Size Expansion&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Analytic calculation captures the noise propagation through the age structure correctly. This can lead to much larger estimates of the impact of demographic stochastically than previously believed.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;This covariance mechanism requires coupling through the nonlinear terms, otherwise it can simply cancel out. The asymmetric, nonlinear term such as in the generalized crowley model seems to be the simplest way to produce a large demographic noise effect:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/e/5/c/e5cdffa3fd231edfaed2a137abdc4797.png&quot; alt=&quot;\partial_i f_i \ll \partial_i f_j&quot; /&gt;&lt;figcaption&gt;\partial_i f_i \ll \partial_i f_j&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Earlier descriptions have failed to include the connections in the noise structure, i.e. from &lt;a href=&quot;http://www.jstor.org/stable/2657219&quot; title=&quot;http://www.jstor.org/stable/2657219&quot;&gt;Dennis et al 2001&lt;/a&gt; “that the noise variables are uncorrelated with each other within a time unit (off-diagonal elements of the matrix are zero).”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Two interesting side-questions have emerged – the influence of the two-step vs one-step transitions and the connections of multiple stages.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Status of Noise in LPA Model&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Macroscopic dynamics&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/1/c/2/1c26a2c6740e377965fa6e85d41e3f33.png&quot; alt=&quot;\begin{align} \dot E &amp;amp;= f_E(E,L,A) = -\mu_e E - c_{le} E L - c_{ae} E A - a_e E + b A \\ \dot L &amp;amp;= f_L(E, L) = -\mu_L L + a_e E - a_L L \\ \dot P &amp;amp;= f_P(L,P) = -\mu_P P - a_p P + a_L L\\ \dot A &amp;amp;= f_A(P,A) = -\mu_A A + a_p P \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \dot E &amp;amp;= f_E(E,L,A) = -\mu_e E - c_{le} E L - c_{ae} E A - a_e E + b A \\ \dot L &amp;amp;= f_L(E, L) = -\mu_L L + a_e E - a_L L \\ \dot P &amp;amp;= f_P(L,P) = -\mu_P P - a_p P + a_L L\\ \dot A &amp;amp;= f_A(P,A) = -\mu_A A + a_p P \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; - A noisy larval population with stable adult population could be driven in the LPA model by weak damping in the larval class &lt;img src=&quot;http://openwetware.org/images/math/f/8/5/f85e13222f810483cb55eebefa911dc4.png&quot; alt=&quot;\partial_L f_L \approx 0&quot; /&gt; relative to a strong covariance term amplifying fluctuations from another class, &lt;img src=&quot;http://openwetware.org/images/math/a/6/3/a6381f2e34a7d68d6de0c6c63fcd9de9.png&quot; alt=&quot;\partial_j f_L \gg \partial_j f_j&quot; /&gt;. As larval dynamics are connected only to egg dynamics and only through a_e, this makes the oscillations relatively small.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - The stable adult noise can be driven by strong damping or weak coupling &lt;img src=&quot;http://openwetware.org/images/math/9/1/2/9124e1d69db343ffcfdfab9aaac349ae.png&quot; alt=&quot;\partial_A f_A(\hat X) \ll 0&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;comparison-to-dennis-et-al-model&quot;&gt;Comparison to Dennis et al model&lt;/h3&gt;
&lt;p&gt;which assumes&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/e/0/b/e0b78e071f7a2db61e77e3721e3dabab.png&quot; alt=&quot;d \vec X = f(\vec X) d\vec X + \sqrt{f(\vec X)} d\mathbb{B}_t&quot; /&gt;&lt;figcaption&gt;d \vec X = f(\vec X) d\vec X + \sqrt{f(\vec X)} d\mathbb{B}_t&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Which underestimates the noise twice over, with no covariance and a noise based on a pure birth process (difference instead of sum of rates).&lt;/p&gt;
&lt;h2 id=&quot;continuing-beetles-research&quot;&gt;Continuing Beetles Research&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Sustained oscillations seem to be yielding divergent noise dynamics. Fig 1.&lt;/li&gt;
&lt;li&gt;Identical model in a different parameter regime, noise is essentially Poisson, with variances matching means within each stage, and no suggestion of the instability seen in the oscillating case. Fig 2.&lt;/li&gt;
&lt;li&gt;Extensions (two-step, phases) and break-downs of the approximation (see/discuss with Michael Samoilov and Adam Arkin)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Misc —-&lt;/p&gt;
&lt;p&gt;embed any webpage in an oww page:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;lt;html&amp;gt;&amp;lt;iframe height=&amp;quot;500px&amp;quot; width=&amp;quot;1000px&amp;quot; src=&amp;quot;http://two.ucdavis.edu/~cboettig&amp;quot;&amp;gt;&amp;lt;/iframe&amp;gt;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Rethinking Beetles Noise</title>
	 <link href="/2010/05/26/Rethinking-Beetles-Noise.html"/>
   <updated>2010-05-26T00:00:00+00:00</updated>
   <id>/05/26/Rethinking-Beetles-Noise</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Noise in the larval class is damped by &lt;img src=&quot;http://openwetware.org/images/math/d/0/8/d084393ee59f54a76685ec96a58d5713.png&quot; alt=&quot;\partial_L f_L&quot; /&gt; and grows proportional to its intrinsic variation and the contribution of other classes through their derivatives of &lt;em&gt;f&lt;/em&gt;&lt;sub&gt;&lt;em&gt;L&lt;/em&gt;&lt;/sub&gt;, that is, &lt;img src=&quot;http://openwetware.org/images/math/0/8/c/08c6845f4c466dddff7c0cf1d0c9bdd9.png&quot; alt=&quot;\partial_E f_l&quot; /&gt; as well as the sum of its intrinsic rates (essentially whichever is larger). Taking &lt;em&gt;E&lt;/em&gt; dynamics to be fast we might reduce to a continous time LPA model:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/8/8/6/8868897b28c0269a662476f8cdaba956.png&quot; alt=&quot;\begin{align} &amp;amp; \dot L = a_e \frac{bA - c_{ea} A - c_{el} L}{a_e + \mu_e} - a_l - \mu_l \\ &amp;amp; \dot P = a_l L - \mu_p P - a_p P \\ &amp;amp; \dot A = a_p P - \mu_a A \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} &amp;amp; \dot L = a_e \frac{bA - c_{ea} A - c_{el} L}{a_e + \mu_e} - a_l - \mu_l \\ &amp;amp; \dot P = a_l L - \mu_p P - a_p P \\ &amp;amp; \dot A = a_p P - \mu_a A \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;and the larval fluctuations are essentially:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/0/b/2/0b28c653e98e1add40660bcfa8397dfa.png&quot; alt=&quot;\begin{align} \sigma^2_L &amp;amp;= \frac{\nu + \beta_L}{2 \partial_L f_L} \\ \nu &amp;amp;= \frac{ 2(\partial_A f_L)^2 \sigma_A^2 }{\partial_L f_L + \partial_A f_A} \\ \partial_A L &amp;amp;= \frac{a_e (b - c_{ea} ) }{a_e + \mu_e} \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \sigma^2_L &amp;amp;= \frac{\nu + \beta_L}{2 \partial_L f_L} \\ \nu &amp;amp;= \frac{ 2(\partial_A f_L)^2 \sigma_A^2 }{\partial_L f_L + \partial_A f_A} \\ \partial_A L &amp;amp;= \frac{a_e (b - c_{ea} ) }{a_e + \mu_e} \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;where β&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt; is the intrinsic noise of the age class. Hence a class &lt;em&gt;i&lt;/em&gt; which propagates large noise to another class &lt;em&gt;j&lt;/em&gt; has a large &lt;img src=&quot;http://openwetware.org/images/math/7/b/e/7be2b5af5d2cc89a7191b64172d0111a.png&quot; alt=&quot;\partial_i f_j&quot; /&gt;. If this term is a linear transition λ&lt;em&gt;X&lt;/em&gt;&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt;, then the same term appears in &lt;em&gt;f&lt;/em&gt;&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt; and hence damps the noise &lt;img src=&quot;http://openwetware.org/images/math/8/5/8/858533c45c5df12a7e743e031638f296.png&quot; alt=&quot;\sigma_i^2&quot; /&gt; and cancels out. Hence noise must propagate into a class through nonlinear transition rates OR through an asymmetry in the transition (i.e. the c_1, c_2 large noise example in the generalized crowley).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Compare to noise in Eggs:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/c/b/4/cb43757c3eeb52669b9771261087ddd2.png&quot; alt=&quot;\sigma^2_E = \frac{ \frac{ (\sigma_L^2 c_{el} +\sigma_A^2 c_{ea} )E^2 }{\mu_A + \mu_L + a_L}+ \beta_E/2}{\mu_E + c_{ea} A + c_{el} L + a_e}&quot; /&gt;&lt;figcaption&gt;\sigma^2_E = \frac{ \frac{ (\sigma_L^2 c_{el} +\sigma_A^2 c_{ea} )E^2 }{\mu_A + \mu_L + a_L}+ \beta_E/2}{\mu_E + c_{ea} A + c_{el} L + a_e}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; Adding age delay to beetle dynamics ———————————–&lt;/p&gt;
&lt;p&gt;Current formulation has used exponential waiting times between stages. By subdividing the classes (increasing the system dimension size) and creating single jump within-state transitions, these become gamma-distributed waiting times. Adding ten steps to each phase and a little parameter fiddling introduces sustained oscillations. (&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/a03864e0e22ae210f784f51988e9eb1812005177/R/gamma_beetles.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/a03864e0e22ae210f784f51988e9eb1812005177/R/gamma_beetles.R&quot;&gt;Version-stable code&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/e/e1/Age_delay.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; beetle_pars &amp;lt;- c(b=5, ue= 0, ul = 0.001, up = 0.00001, ua = 0.01, ae = 1.3, al = .1, ap = 1.5, cle = .2, cap = .1, cae = 5, V=100)&lt;/p&gt;
&lt;p&gt;Xo[1] = 100&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Implementation still needs trouble-shooting, variance dynamics don’t seem to be being computed correctly. &lt;strong&gt;done&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Adult class doesn’t need multiple stages. &lt;strong&gt;done&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Code should allow for a general k classes rather than a fixed 10 classes. &lt;strong&gt;done&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and now we have noise in oscillatory, gamma-waiting model:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/d/d2/Oscillate_noise.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;parameters as before, see &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/0af18d6f4b63ef63ced376f0c73cec16b83c66b5/R/gamma_beetles.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/0af18d6f4b63ef63ced376f0c73cec16b83c66b5/R/gamma_beetles.R&quot;&gt;version-stable code&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Misc / Code notes —————–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;R-evolution parallelizes the variance dynamics calculation (perhaps the matrix multiplication step?) and is probably responsible for the openmp parallelization working.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://arxiv.org/abs/1005.2718#&quot; title=&quot;http://arxiv.org/abs/1005.2718#&quot;&gt;article&lt;/a&gt; on cloud computing vs grid. reminds me to include questions on cloud computing in the CSGF survey.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Should also take a closer read of the recent: Kendall BE, Wittmann ME. A stochastic model for annual reproductive success. The American naturalist. 2010;175(4):461-8. Available at: &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20163244&quot; class=&quot;uri&quot; title=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20163244&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/20163244&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Bug fixed!</title>
	 <link href="/2010/05/25/Bug-fixed.html"/>
   <updated>2010-05-25T00:00:00+00:00</updated>
   <id>/05/25/Bug-fixed</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Wasn’t taking the Jacobian of the transition terms. Fixes the unstable behavior and disagreement between simulations and theory.&lt;/li&gt;
&lt;li&gt;Other note: the “hastings.c” model can trivially be obtained from the standard crowley-form metapopulation model by taking b_1 = 0.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the crowley class of models at least, seems that while the two-step vs one-step involved different dynamics, this difference exists only in transients while equilbrium covariances agree.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/e/e8/Crowley_covariance.png/400px-Crowley_covariance.png&quot; alt=&quot;hastings covarainces, b1 = 0, b2 = .6, d1 = d2 = .1, c1 = c2 =.5, K =1e4&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - Corrected figures from Friday:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/2/26/Fixed_2.png/360px-Fixed_2.png&quot; alt=&quot;Fig 1. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&quot; /&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Fig 1. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/6/63/Fixed_bug.png/360px-Fixed_bug.png&quot; alt=&quot;Fig. 2. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = .1, c = .15&quot; /&gt;&lt;figcaption&gt;Fig. 2. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = .1, c = .15&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Fig. 2. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = .1, c = .15&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; #### Beetle dynamics&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Variances aren’t exactly in agreement, though much closer. Simulations with 30 replicates a piece for speed, will rerun for finer resolution on variances comparisons.&lt;/li&gt;
&lt;li&gt;Wondering what parameter regimes will make most pronounced difference.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/9/98/Beetles.png&quot; alt=&quot;Image:Beetles.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Status on Structured Populations</title>
	 <link href="/2010/05/24/Status-on-Structured-Populations.html"/>
   <updated>2010-05-24T00:00:00+00:00</updated>
   <id>/05/24/Status-on-Structured-Populations</id>
   <content type="html">&lt;h3 id=&quot;model-roundup&quot;&gt;Model roundup&lt;/h3&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;metapop&lt;/strong&gt; Two populations with one-step transitions. IBM in C code, R interface to IBM and linear noise approximation.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;crowley&lt;/strong&gt; One-step transitions version of metapop. R interface to IBM and linear noise.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;beetles&lt;/strong&gt; Two-step transitions with exponential waiting times in age classes. R interface completed in ind_based_models.R&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;hastings&lt;/strong&gt; Simple two-step model. no R interfaces yet.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;tribolium&lt;/strong&gt; Non-markov aging process. R interface completed in simulate.R. includes likelihood inference as well.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Individual-based models, implemented in C using my gillespie library, interfaced in R in ind_based_models.R. Could probably benefit from C++ class structure, as the codes involve more written repetition than necessary, and renaming similar functions to avoid name conflicts in the object files for the R package. All individual simulations now include parallelization of replicates the C level via the gillespie library, which seems to be working correctly even when called from R.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;R files with model names include individual based simulation and the approximation, plotted in comparison.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Beetles simple noise simulation likewise does not agree with the approximation, still troubleshooting the approximation.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/8/82/Beetles_bugs.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;other-exploration&quot;&gt;Other exploration&lt;/h2&gt;
&lt;p&gt;Revisit Phil Holmes notes on free-response protocol / information theory and Neyman-Pearson theorem.&lt;/p&gt;
&lt;h2 id=&quot;meetings&quot;&gt;Meetings&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Schreiber Lab meeting, discussed articles 4 and 5 below.&lt;/li&gt;
&lt;li&gt;Discussion with Graham, see phylogenetics notebook.&lt;/li&gt;
&lt;li&gt;GTC meeting, more on toolbox, interesting stats discussion afterwards, neg binomial as number of failures before n successes, claim that this almost always outperforms poisson models (in information criteria sense) on ecological datasets – nothing is ever uncorrelated…&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;reading&quot;&gt;Reading&lt;/h2&gt;
&lt;p&gt;A couple good articles today, see Mendeley for details.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Goel AK, Vattam SS, Rugaber S, et al. Learning Functional and Causal Abstractions of Classroom Aquaria The SBF Theory of Understanding of Complex Systems ACT : Interactive Construction of SBF Models. In Review.&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Crutchfield JP, Whalen S. Structural Drift : The Population Dynamics of Sequential Learning. In review. 2010:1-14.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Raghib M, Hill Na, Dieckmann U. A multiscale maximum entropy moment closure for locally regulated space-time point process models of population dynamics. Journal of mathematical biology. 2010. Available at: &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20446087&quot; class=&quot;uri&quot; title=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20446087&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/20446087&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Lindegren M, Möllmann C, Nielsen A, et al. Ecological forecasting under climate change: the case of Baltic cod. Proceedings. Biological sciences / The Royal Society. 2010. Available at: &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20236982&quot; class=&quot;uri&quot; title=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20236982&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/20236982&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Berkley Ha, Kendall BE, Mitarai S, Siegel Da. Turbulent dispersal promotes species coexistence. Ecology Letters. 2010;13(3):360-371. Available at: &lt;a href=&quot;http://blackwell-synergy.com/doi/abs/10.1111/j.1461-0248.2009.01427.x&quot; class=&quot;uri&quot; title=&quot;http://blackwell-synergy.com/doi/abs/10.1111/j.1461-0248.2009.01427.x&quot;&gt;http://blackwell-synergy.com/doi/abs/10.1111/j.1461-0248.2009.01427.x&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;misc-code&quot;&gt;Misc Code&lt;/h2&gt;
&lt;p&gt;Apparently R doesn’t have a convenient generalized eigenvalue solver (for case of a matrix on either side). Wrote quick interface to the gsl lapack routines. Github’s gists seem an ideal way to store and share such code snippets, so here it is embedded.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Puzzled over the two-step jump process results</title>
	 <link href="/2010/05/21/Puzzled-over-the-two-step-jump-process-results.html"/>
   <updated>2010-05-21T00:00:00+00:00</updated>
   <id>/05/21/Puzzled-over-the-two-step-jump-process-results</id>
   <content type="html">&lt;p&gt;The variance dynamics are slightly different if the continuous time Markov process allows events to contain two steps (such as a transition of an individual from one age class to another, or one patch to another, etc) as well as one step birth/death) transitions. &lt;em&gt;V&lt;/em&gt;τ~*i**j&lt;em&gt;~(&lt;/em&gt;X* / &lt;em&gt;V&lt;/em&gt;) to represent the rate of transitions from state &lt;em&gt;i&lt;/em&gt; to state &lt;em&gt;j&lt;/em&gt;. We change variables for our state space from the discrete count state variable &lt;em&gt;X&lt;/em&gt; by dividing by the system size (volume) V, to obtain the continuous, mean-field approximation of the density &lt;em&gt;p = X/V.&lt;/em&gt; Then:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/math/5/e/b/5eb413fd88e12c41c39cf48c811fc71a.png&quot; alt=&quot;\begin{align} &amp;amp; \frac{d}{dt} E(p) = b(p)-d(p) + \sum_{j \neq i} \tau_{ji}(p) - \tau_{ij}(p) =: f(p)\\ &amp;amp; \frac{d}{dt} M = \textrm{diag}( b(p) + d(p) ) - T + Df(p) M + M Df(p)^T \end{align}&quot; /&gt;&lt;/p&gt;
&lt;p&gt;where &lt;em&gt;T&lt;/em&gt; is a symmetric matrix with off-diagonal elements &lt;em&gt;i,j&lt;/em&gt; τ~&lt;em&gt;i&lt;strong&gt;j&lt;em&gt;~(&lt;/em&gt;p&lt;em&gt;) + τ&lt;/em&gt;j&lt;/strong&gt;i&lt;/em&gt;(&lt;em&gt;p&lt;/em&gt;) and diagonal elements chosen so that rows sum to zero. This approximation is implemented in &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/noise_approx.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/noise_approx.R&quot;&gt;noise_approx.R&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;example-crowley-model&quot;&gt;Example: Crowley model&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Carl Boettiger 15:05, 25 May 2010 (EDT)&lt;/strong&gt;: (some corrections to eqns)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(Note this is the original Crowley model where the &lt;em&gt;c&lt;/em&gt; coefficients are equal. In the original model this represented competition for space by overgrowth and hence would more naturally be expressed as a two step process).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/7/c/4/7c49b2c47e74e60537d6345e8b7a9c6a.png&quot; alt=&quot;\begin{align} \dot x &amp;amp;= b_1 x (K - x - y)/K - d_1 x + c x y/K \\ \dot y &amp;amp;= b_2 y (K - x - y)/K - d_1 y - c x y/K \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \dot x &amp;amp;= b_1 x (K - x - y)/K - d_1 x + c x y/K \\ \dot y &amp;amp;= b_2 y (K - x - y)/K - d_1 y - c x y/K \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Interpreting the &lt;em&gt;cxy&lt;/em&gt; terms as transitions rather than independent birth and death events results in the same mean-field dynamics but differing fluctuations. For instance, the covariance dynamics are:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/4/c/24c57b2b520fa2223fc7f059ade57d81.png&quot; alt=&quot;\frac{d}{dt} \textrm{Cov}(x,y) = \left(b_1 (1-2x-y)-d_1 +c y + b_2(1-x-2y)-d_2 -c x \right)\textrm{Cov}(x,y) - (b_1 x +c x )\sigma_y^2 -(b_2 y -c y)\sigma_x^2 - cxy&quot; /&gt;&lt;figcaption&gt;\frac{d}{dt} \textrm{Cov}(x,y) = \left(b_1 (1-2x-y)-d_1 +c y + b_2(1-x-2y)-d_2 -c x \right)\textrm{Cov}(x,y) - (b_1 x +c x )\sigma_y^2 -(b_2 y -c y)\sigma_x^2 - cxy&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Whereas interpreted as single-step birth and death the &lt;em&gt;cxy&lt;/em&gt; term at the end is absent.&lt;/p&gt;
&lt;p&gt;The variance dynamics are similarly altered.&lt;/p&gt;
&lt;h4 id=&quot;numerical-implementation&quot;&gt;Numerical implementation&lt;/h4&gt;
&lt;p&gt;This individual-based simulation is implemented in &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/src/metapop.c&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/src/metapop.c&quot;&gt;metapop.c&lt;/a&gt; and callable from R interface from &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/ind_based_models.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/ind_based_models.R&quot;&gt;ind_based_models.R&lt;/a&gt; as metapop_ibm(). The file &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/metapop.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/metapop.R&quot;&gt;metapop.R&lt;/a&gt; specifies the dynamics of birth, death, transition matrix and the Jacobian so that linear_noise_approx() function from above can be used to calculate the moments. This file also runs the crolwey_ibm model (from crowley.c, interface in the ind_based.models.R) and the linear noise approximation to it from &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/crowley.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/crowley.R&quot;&gt;crowley.R&lt;/a&gt; to compare how the two-step process changes the noise dynamics.&lt;/p&gt;
&lt;p&gt;This comparison can be run simply by loading the package and running metapop_example() function.&lt;/p&gt;
&lt;p&gt;For some reason the individual based-simulation of the two-step process seems to resemble that of the one-step process more, while the two-step linear noise approximation alternately underestimates (Fig 1) or overestimates (Fig 2) the variance. Looking for bugs in the implementation at the moment.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Carl Boettiger 21:43, 26 May 2010 (EDT)&lt;/strong&gt;: Bug found, see corrected graphs on Tuesday’s (5/25) entry.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/8/84/Compare_noise.png/360px-Compare_noise.png&quot; alt=&quot;Fig 1. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&quot; /&gt;&lt;figcaption&gt;Fig 1. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Fig 1. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = c = .1&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/f/f3/Compare_noise2.png/360px-Compare_noise2.png&quot; alt=&quot;Fig. 2. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = .1, c = .15&quot; /&gt;&lt;figcaption&gt;Fig. 2. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = .1, c = .15&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Fig. 2. Parameters: b_1 = .2, b_2 = .1, d_1 = d_2 = .1, c = .15&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Beetle dynamics exploration & adjustments</title>
	 <link href="/2010/05/20/Beetle-dynamics-exploration-and-adjustments.html"/>
   <updated>2010-05-20T00:00:00+00:00</updated>
   <id>/05/20/Beetle-dynamics-exploration-and-adjustments</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Adjusted individual based Crowley model to follow same parameterization as the macroscopic model. IBM rules had divided b and c by K in the dynamics while the macroscopic was just using rescaled dynamical rates. Now both use the rescaled rates as parameter values while the equations match.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Variation in the Crowley model agrees between individual-based simulation and the equations.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;code-troubleshooting&quot;&gt;Code troubleshooting&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;openmp private declarations perform allocs without frees! parallel code has memory leaks not present in the serial code. Will need to learn&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Noisy Beetles</title>
	 <link href="/2010/05/19/Noisy-Beetles.html"/>
   <updated>2010-05-19T00:00:00+00:00</updated>
   <id>/05/19/Noisy-Beetles</id>
   <content type="html">&lt;h3 id=&quot;goals&quot;&gt;Goals&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;individual-based simulation via my gillespie C library with 2-step transitions.
&lt;ul&gt;
&lt;li&gt;Integrate the function definitions from R? Use of R formula language?&lt;/li&gt;
&lt;li&gt;Conversely, have the R code use the C functions?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Handle population-size scaling correctly&lt;/li&gt;
&lt;li&gt;Methods write-up, read/compare to other examples.&lt;/li&gt;
&lt;li&gt;Exploration/demonstration of the significance of two-step process vs two one-step processes. Highlight which examples will show largest differences, and in which terms (means vs variances/covariances, etc).&lt;/li&gt;
&lt;li&gt;Noise response to parameter changes (a la habitat fragmentation, etc)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;code-updates&quot;&gt;Code Updates&lt;/h2&gt;
&lt;h3 id=&quot;merged-warning-signals-into-structured-populations&quot;&gt;Merged Warning-Signals into Structured populations&lt;/h3&gt;
&lt;p&gt;The future development of the structured populations package will depend directly on the gillespie library source code in warningSignals repository. Though these two projects will have different higher level functions as they will share much of the same base C machinery it made sense at this point to merge the projects. This preserves their &lt;a href=&quot;http://github.com/cboettig/structured-populations/network&quot; title=&quot;http://github.com/cboettig/structured-populations/network&quot;&gt;independent histories&lt;/a&gt; while avoiding the duplication of code. Will have to figure out whether or not to close down/remove the warning signals github and local repositories all together to avoid confusion (would break links to remove the github version).&lt;/p&gt;
&lt;p&gt;Fortunately, this merger is remarkably easy on using git:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;git fetch ../regime_shifts master:regime_shifts   # imports the entire regime shifts project history as a branch, names it regime_shifts
git merge regime_shifts # Merges that branch onto the current (master) branch&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;structural-modifications&quot;&gt;Structural modifications&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;gillespie command must now be passed functional handles to the the reset function (needed to reset loop in ensemble ) and the fixed_interval_tasks function. This makes the dependencies more explicit and also allows clean handling of having different models with different versions of these functions in the same library. R package cannot compile with the redundant namespace otherwise.&lt;/li&gt;
&lt;li&gt;Still need to figure out what to do about main() function to allow modular, independent compiles and still allow R package compile…&lt;/li&gt;
&lt;li&gt;UPDATE: the R package now compiles and loads. makefile is depricated currently and all main functions replaced inside a single main fn call. General updates across code (including NAMESPACE).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Other Code Changes and notes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Implemented R interface for crowley individual-based model and simplified beetle individual-based model with exponential waiting times between stages (with two step process though, corresponding to the lin noise approx in this system).&lt;/li&gt;
&lt;li&gt;Recall the extern “C” command when using C++ code to avoid the name mangling trouble.&lt;/li&gt;
&lt;li&gt;seems openmp compiling from within R is working, at least turns both processors on full, will need more exploration. Will also have to consider storing the full ensemble of runs in C vs calculating moments on the fly (and avoiding packet collisions in parallel).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;reading&quot;&gt;Reading&lt;/h2&gt;
&lt;p&gt;Set up Google Reader last night for ToCs via rss rather than my former system of eToCs. Convient tag/like/share options, nice to separate from the email process.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Came across the &lt;a href=&quot;http://hdl.handle.net/10.1093/bioinformatics/btq110&quot; title=&quot;doi:10.1093/bioinformatics/btq110&quot;&gt;DensiTree&lt;/a&gt; paper in bioinformatics to visualize posterior tree densities that had been demonstrated in beta @ Phylogenetics workshop.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rather well done if classical treatment of SIS birth death model &lt;a href=&quot;http://hdl.handle.net/10.1007/s00285-010-0336-x&quot; title=&quot;doi:10.1007/s00285-010-0336-x&quot;&gt;in JMB&lt;/a&gt; with diffusion approximation, OU approximation and extinction times. Seems clearly explained a makes a nice reference.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Interesting &lt;a href=&quot;http://www.youtube.com/watch?v=u6XAPnuFjJc&amp;amp;feature=player_embedded&quot; title=&quot;http://www.youtube.com/watch?v=u6XAPnuFjJc&amp;amp;feature=player_embedded&quot;&gt;talk&lt;/a&gt; and presentation style, take this approach to the classroom? Motivating students? (Talk adapted from &lt;a href=&quot;http://www.youtube.com/watch?v=_mG-hhWL_ug&amp;amp;feature=channel&quot; title=&quot;http://www.youtube.com/watch?v=_mG-hhWL_ug&amp;amp;feature=channel&quot;&gt;Dan Pink&lt;/a&gt;).&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Another &lt;a href=&quot;http://www.youtube.com/watch?v=iLstkIZ5t8g&amp;amp;feature=related&quot; title=&quot;http://www.youtube.com/watch?v=iLstkIZ5t8g&amp;amp;feature=related&quot;&gt;Richard Florida&lt;/a&gt; talk.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Noisy beetles</title>
	 <link href="/2010/05/18/Noisy-beetles.html"/>
   <updated>2010-05-18T00:00:00+00:00</updated>
   <id>/05/18/Noisy-beetles</id>
   <content type="html">&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/30/Beetles_noise.png/400px-Beetles_noise.png&quot; alt=&quot;Fig 1: Noise in lavae dominate&quot; /&gt;&lt;figcaption&gt;Fig 1: Noise in lavae dominate&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Fig 1:&lt;/strong&gt; Noise in lavae dominate&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/3f/Beetles_noise2.png/180px-Beetles_noise2.png&quot; alt=&quot;Fig: 2 lower mortality, higher noise&quot; /&gt;&lt;figcaption&gt;Fig: 2 lower mortality, higher noise&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Fig: 2&lt;/strong&gt; lower mortality, higher noise&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Success! My first full implementation of the four stage (EPLA) beetle model, so far without any adaptation, and the noise of the larval class dominates (Fig 1). Without the time delays the stationary dynamics are stable nodes, at least in this part of parameter space, with a large adult class clamping tightly down on the other classes. Despite adults being the most numerous, the larval class is the most variable, just as observed.&lt;/li&gt;
&lt;li&gt;Standard parameter set, figure produced by &lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/0b6ce3ea1210284b71f3ab270b1ad6532ee0f31b/R/beetles.R&quot; title=&quot;http://github.com/cboettig/structured-populations/commit/0b6ce3ea1210284b71f3ab270b1ad6532ee0f31b/R/beetles.R&quot;&gt;this version&lt;/a&gt; of the beetles.R code.&lt;/li&gt;
&lt;li&gt;The level of noise depends closely on mortality estimate for this larva class. For instance, cutting the mortality rate of larva from 0.001 to 0.0001 results in much larger noise, Fig 2.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Modifications to implementation&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Updated code to accurately take account of the two-step process. (Will add notes on the mathematics later, meanwhile is implemented in the &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/22c42eb726ddc6216932906953eea18dc165185f/R/noise_approx.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/22c42eb726ddc6216932906953eea18dc165185f/R/noise_approx.R&quot;&gt;noise_approx.R&lt;/a&gt; (version stable link) code.&lt;/li&gt;
&lt;li&gt;User now specifies the birth and death rates separately, rather than the first and second jump moments (b and f). User also specifies the two-step jumps and (as before) the Jacobian of b(x)-d(x).&lt;/li&gt;
&lt;li&gt;Added cannibalism of adults on pupae, who previously had no mortality terms. Without this their noise level will rise indefinitely.&lt;/li&gt;
&lt;li&gt;Separated the code for the linear noise approximation from the code for the &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/crowley.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/crowley.R&quot;&gt;crowley&lt;/a&gt; and &lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/0b6ce3ea1210284b71f3ab270b1ad6532ee0f31b/R/beetles.R&quot; title=&quot;http://github.com/cboettig/structured-populations/commit/0b6ce3ea1210284b71f3ab270b1ad6532ee0f31b/R/beetles.R&quot;&gt;beetles&lt;/a&gt; models.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;git-log&quot;&gt;Git log&lt;/h3&gt;
&lt;p&gt;commit 0b6ce3ea1210284b71f3ab270b1ad6532ee0f31b Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Tue May 18 23:54:45 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   added adult cannibalism on pupa&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit 22c42eb726ddc6216932906953eea18dc165185f Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Tue May 18 15:59:51 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   getting second-order transitions implmented&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit 2cb4215b1028619e96ec809875c693fb84fdc185 Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Tue May 18 15:22:24 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   replaced f and g with birth and death&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit c9bc00fbf7dcd3eabd1935d1df96adb7dd54480d Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Tue May 18 14:13:25 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   seperated examples from noise approx code&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; Misc / Reading ————–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nsf.gov/news/news_summ.jsp?cntn_id=116928&quot; title=&quot;http://www.nsf.gov/news/news_summ.jsp?cntn_id=116928&quot;&gt;NSF&lt;/a&gt; to require data management in all proposals:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;“Researchers from numerous disciplines need to work together to attack complex problems; openly sharing data will pave the way for researchers to communicate and collaborate more effectively.”&lt;/p&gt;
&lt;p&gt;“This is the first step in what will be a more comprehensive approach to data policy,” added Cora Marrett, NSF acting deputy director. “It will address the need for data from publicly-funded research to be made public.”&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Annual Progress Report</title>
	 <link href="/2010/05/17/Annual-Progress-Report.html"/>
   <updated>2010-05-17T00:00:00+00:00</updated>
   <id>/05/17/Annual-Progress-Report</id>
   <content type="html">&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;Tomorrow will be meeting with my dissertation committee: Alan Hastings, Peter Wainwright, and Brian Moore. This provides a good opportunity to summarize the status of my current projects and my principle accomplishments for the year. Will try a tex’d document as I’ve done in previous years but here’s for some preliminary brainstorming.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Summary: In the past year, I’ve published one paper, given 4 talks (CPB, NIMBioS, Berkeley, IIASA), read 144+ articles and wrote 9000+ lines of code. I spent last summer at IIASA, passed my qualifying exam in January, and attended the Bodega Phylogenetics workshop in March. I’m working primarily on four projects. If my thesis had a unifying title, it would be something like: &lt;strong&gt;&lt;em&gt;Inference in a noisy world&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;evolution&quot;&gt;Evolution&lt;/h3&gt;
&lt;h4 id=&quot;adaptive-dynamics&quot;&gt;Adaptive Dynamics&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Publication: &lt;a href=&quot;http://hdl.handle.net/10.1016/j.tpb.2009.10.003&quot; title=&quot;doi:10.1016/j.tpb.2009.10.003&quot;&gt;&lt;em&gt;Fluctuation Domains in Adaptive Evolution&lt;/em&gt;&lt;/a&gt; appeared in TPB Feburary.&lt;/li&gt;
&lt;li&gt;Finishing research from last summer at IIASA on predicting &lt;em&gt;The Waiting Time Until Evolution Branching&lt;/em&gt; occurs. Manuscript by end of summer?&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics&quot;&gt;Adaptive Dynamics code&lt;/a&gt; project.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;comparative-phylogenetics&quot;&gt;Comparative Phylogenetics&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Labrid fin morphology paper&lt;/li&gt;
&lt;li&gt;Quantifying the information in phylogenetic trees: robust model choice in comparative phylogenetics&lt;/li&gt;
&lt;li&gt;logarithms and Brownian motion&lt;/li&gt;
&lt;li&gt;Joint-probability solution?&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://phylogenetics.uservoice.com/forums/43843-general?lang=en&amp;amp;utm_campaign=Widgets&amp;amp;utm_content=tab-widget&amp;amp;utm_medium=widget&amp;amp;utm_source=phylogenetics.uservoice.com&quot; title=&quot;http://phylogenetics.uservoice.com/forums/43843-general?lang=en&amp;amp;utm_campaign=Widgets&amp;amp;utm_content=tab-widget&amp;amp;utm_medium=widget&amp;amp;utm_source=phylogenetics.uservoice.com&quot;&gt;Collection&lt;/a&gt; of smaller extensions to phylogenetic methods&lt;/li&gt;
&lt;li&gt;Apply comparative methods in Primate brain morphology (with Daniel Mietchen)&lt;/li&gt;
&lt;li&gt;Density dependence/equilibrium models in speciation rates. Model uncertainty in rates.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;ecology&quot;&gt;Ecology&lt;/h3&gt;
&lt;h4 id=&quot;early-warning-signals&quot;&gt;Early Warning Signals&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Misleading signals and more robust approaches.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;structured-population-dynamics-aka-beetles&quot;&gt;Structured Population Dynamics (aka beetles)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Large effects of demographic noise through nonlinear dynamics in structured populations&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Talks &amp;amp; Conferences&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Talks to: CPB (Davis), NIMBioS (Tennessee), Comp Bio students (Berkeley)&lt;/li&gt;
&lt;li&gt;in-house talks to EDG (Fall &amp;amp; Spring), Hastings lab,&lt;/li&gt;
&lt;li&gt;Courses: Anoles. Begun Monte Carlo. Phylogenetics Discussion Group (winter/spring).&lt;/li&gt;
&lt;li&gt;Bodega Phylogenetics Workshop.&lt;/li&gt;
&lt;li&gt;Lab group meetings: Hastings, Schreiber. occasionally Wainwright, Crutchfield,&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;upcoming&quot;&gt;Upcoming&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Conferences this summer: Evolution &amp;amp; iEvoBio. CSGF. Open Science.&lt;/li&gt;
&lt;li&gt;Arkin group at LBL&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;methods-and-misc&quot;&gt;Methods and Misc&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Technology/Science2.0 : Learned git for version management, github project hosting. Mendeley database for papers. OpenWetWare for lab notebooks. Forums.&lt;/li&gt;
&lt;li&gt;Interviewed in &lt;a href=&quot;http://sciencecareers.sciencemag.org/career_magazine/previous_issues/articles/2010_04_09/caredit.a1000036&quot; title=&quot;http://sciencecareers.sciencemag.org/career_magazine/previous_issues/articles/2010_04_09/caredit.a1000036&quot;&gt;Science Careers&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Help start UC_Davis_Open_Science group.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://gtc-blog.blogspot.com/&quot; title=&quot;http://gtc-blog.blogspot.com/&quot;&gt;Grad Teaching Community&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; #### Footnote on some stats&lt;/p&gt;
&lt;p&gt;Thanks to the various Science 2.0 spirit technology I’ve employed in my research, it’s remarkably easy to get statistics on what I’ve done over the year. For instance, as I read articles I add them to my Mendeley database, making it easy to recover my article statistics, and also plot these trends over time. Similarly, version management software such as git makes it easy to track the progress of my codes. Will be interesting to revisit these stats next year. Meanwhile:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Articles&lt;/strong&gt;: I’ve read 144 articles since November (when I started using Mendeley). Most read journal has been Evolution (25 articles), most read authors are Peter Wainwright and Johnathan Losos. 81 articles were in comparative methods. 6 have been reviews I’ve done for different journal submissions.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Code:&lt;/strong&gt; I’ve written over 9000 lines of code in five projects: regime_shifts (1417), structured_pops (684), Comparative-Phylogenetics (2265), Adaptive-Dynamics (1326), wrightscape (3380).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; Code Tricks ———–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Was curious how to quickly find the number of lines of code in my projects. While Github has several useful graphs, they &lt;a href=&quot;http://support.github.com/discussions/feature-requests/186-lines-of-code-graph&quot; title=&quot;http://support.github.com/discussions/feature-requests/186-lines-of-code-graph&quot;&gt;haven’t yet&lt;/a&gt; added this feature. Fortunately this question was already &lt;a href=&quot;http://stackoverflow.com/questions/23907/how-can-i-graph-the-lines-of-code-history-for-git-repo/2854506#2854506&quot; title=&quot;http://stackoverflow.com/questions/23907/how-can-i-graph-the-lines-of-code-history-for-git-repo/2854506#2854506&quot;&gt;answered on stackoverflow&lt;/a&gt; with a very nice little python script, which I’ve named gitlines and have added to my path. Running gitlines from anywhere in the project directories gives a list of total lines in each commit for the project.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Monday ——&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;10a - 11:30a Steering committee meeting&lt;/li&gt;
&lt;li&gt;Chat Sebastian re: linear noise approximation in patch dynamics, see earlier manuscript&lt;/li&gt;
&lt;li&gt;1p Sebastian lab meeting/pizza social, Discussed F1000, Kyle mentioned niche modeling &lt;a href=&quot;http://hdl.handle.net/10.1126/science.1187468&quot; title=&quot;doi:10.1126/science.1187468&quot;&gt;paper&lt;/a&gt; in Science. Discussed which ToC’s people read, also compare to which they use or cite.&lt;/li&gt;
&lt;li&gt;5p Richard McElreath speaking to GTC on teaching mathematical modeling to biologists&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;research&quot;&gt;Research&lt;/h2&gt;
&lt;p&gt;From discussion with Sebastian: Structured population dynamics need to consider stage transitions as simultaneous two-step events rather than two one-step events. results in slightly different form for evolution of the covariance matrix. Excepting this yesterday’s form is accurate.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>General matrix form and correcting equations</title>
	 <link href="/2010/05/16/General-matrix-form-and-correcting-equations.html"/>
   <updated>2010-05-16T00:00:00+00:00</updated>
   <id>/05/16/General-matrix-form-and-correcting-equations</id>
   <content type="html">&lt;p&gt;Pursuing a matrix form, seems I had missed some terms in the covariance equations Friday, which are suggested by the nice symmetry of this representation: &lt;img src=&quot;http://openwetware.org/images/thumb/5/55/Eqns.jpg/800px-Eqns.jpg&quot; alt=&quot;image&quot; /&gt; (sometimes chalk and a camera are faster than tex).&lt;/p&gt;
&lt;p&gt;This suggests the general form looks like&lt;/p&gt;
&lt;p&gt;*d**M* = *J**M* + (*J**M&lt;em&gt;)&lt;sup&gt;&lt;em&gt;T&lt;/em&gt;&lt;/sup&gt; + &lt;/em&gt;g*&lt;/p&gt;
&lt;p&gt;Where &lt;em&gt;M&lt;/em&gt; is the covariance matrix and &lt;em&gt;J&lt;/em&gt; the Jacobian of &lt;em&gt;f&lt;/em&gt; as before. &lt;em&gt;dM&lt;/em&gt; is the matrix of derivative terms, though clearly not a rigorous notation.&lt;/p&gt;
&lt;h2 id=&quot;fixing-crowley-results&quot;&gt;Fixing Crowley results&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;A couple numerical errors in the implementation of the Crowley model yesterday led to the divergence. The updated numerical results can produce large but stable noise. Also applies system size scaling to match the individual-based simulation.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/d/d5/Crowley_noise.png&quot; alt=&quot;Image:Crowley_noise.png&quot; /&gt;&lt;figcaption&gt;Image:Crowley_noise.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Working on graphing the direct comparison between the approximation and the individual simulation next.&lt;/li&gt;
&lt;li&gt;Also working on updating gillespie simulation in &lt;a href=&quot;http://github.com/cboettig/warningSignals&quot; title=&quot;http://github.com/cboettig/warningSignals&quot;&gt;warningSignals&lt;/a&gt; in order to remerge the crowley branch with the master branch.&lt;/li&gt;
&lt;li&gt;warningSignals crowley branch successfully merged back onto master.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Next steps&lt;/em&gt;:
&lt;ul&gt;
&lt;li&gt;Add individual simulations to R interface for warningSignals (currently C code just computes window-averaging and ensemble on the fly instead of saving the full sample history).&lt;/li&gt;
&lt;li&gt;add R function interface to Crowley model&lt;/li&gt;
&lt;li&gt;Compare Crowley simulation to analytics.&lt;/li&gt;
&lt;li&gt;Increase density-dependence and decrease size of key class in Crowley for larger noise effects.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Large Intrinsic Noise</title>
	 <link href="/2010/05/15/Large-Intrinsic-Noise.html"/>
   <updated>2010-05-15T00:00:00+00:00</updated>
   <id>/05/15/Large-Intrinsic-Noise</id>
   <content type="html">&lt;h3 id=&quot;modified-crowley-model&quot;&gt;Modified Crowley model&lt;/h3&gt;
&lt;p&gt;Realizing &lt;em&gt;Arbitrarily large demographic noise&lt;/em&gt; systems??&lt;/p&gt;
&lt;p&gt;Consider the Crowley model from last week which I’d implemented as an individual birth-death model: (&lt;em&gt;x&lt;/em&gt; is the better competitor, &lt;em&gt;y&lt;/em&gt; the better colonist)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/7/5/b/75bbcc817dc349b3e49eee488c36554e.png&quot; alt=&quot;\begin{align} \dot x &amp;amp;= b_1 x (K - x - y) - d_1 x + c_1 x y = \alpha_1(x,y) \\ \dot y &amp;amp;= b_2 y (K - x - y) - d_1 y - c_2 x y = \beta_1(x,y) \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \dot x &amp;amp;= b_1 x (K - x - y) - d_1 x + c_1 x y = \alpha_1(x,y) \\ \dot y &amp;amp;= b_2 y (K - x - y) - d_1 y - c_2 x y = \beta_1(x,y) \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;I’ve implemented the linear noise approximation for this model as a system of coupled ODEs:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/b/a/1/ba156d602601209f3d2db74507362626.png&quot; alt=&quot;\begin{align} \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \alpha_{1,0}}{\partial \phi} \langle \xi^2 \rangle + 2 \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \xi \eta \rangle + \alpha_{2,0} \\ \frac{d \langle \xi \eta \rangle}{d t} &amp;amp;= \left( \frac{\partial \alpha_{1,0}}{\partial \phi} + \frac{\partial \beta_{1,0} }{\partial \psi} \right)\langle \xi \eta \rangle+ \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \eta^2 \rangle \\ \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \beta_{1,0}}{\partial \psi} \langle \eta^2 \rangle + \beta_{2,0} \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \alpha_{1,0}}{\partial \phi} \langle \xi^2 \rangle + 2 \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \xi \eta \rangle + \alpha_{2,0} \\ \frac{d \langle \xi \eta \rangle}{d t} &amp;amp;= \left( \frac{\partial \alpha_{1,0}}{\partial \phi} + \frac{\partial \beta_{1,0} }{\partial \psi} \right)\langle \xi \eta \rangle+ \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \eta^2 \rangle \\ \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \beta_{1,0}}{\partial \psi} \langle \eta^2 \rangle + \beta_{2,0} \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;And solved numerically (&lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/bd1769fef7af9eecf32a5ec40f886bc2b74dd1b9/R/noise_approx.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/bd1769fef7af9eecf32a5ec40f886bc2b74dd1b9/R/noise_approx.R&quot;&gt;R code&lt;/a&gt;, links directly to this version and can run stand-alone from the package) using parameter values matching the individual based simulation (&lt;a href=&quot;http://github.com/cboettig/warningSignals/commit/ddb5d73d011a2eaa7b894e925ffddec74250e043&quot; title=&quot;http://github.com/cboettig/warningSignals/commit/ddb5d73d011a2eaa7b894e925ffddec74250e043&quot;&gt;C code&lt;/a&gt; from warning_signals package).&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/7/7b/Diverge.png&quot; alt=&quot;Image:Diverge.png&quot; /&gt;&lt;figcaption&gt;Image:Diverge.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;As this simulation clearly shows, even though I’ve started the population at the expected abundances and the average dynamics are stable, the variance term for the colonist diverges. With weaker c_2 it is easy to have equilibrium variances and have the expected variance of the competitor be larger than that of the colonist (despite smaller abundance).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Structured Population Dynamics</title>
	 <link href="/2010/05/14/Structured-Population-Dynamics.html"/>
   <updated>2010-05-14T00:00:00+00:00</updated>
   <id>/05/14/Structured-Population-Dynamics</id>
   <content type="html">&lt;h3 id=&quot;beetle-model&quot;&gt;Beetle Model&lt;/h3&gt;
&lt;p&gt;Macroscopic equations:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/1/c/2/1c26a2c6740e377965fa6e85d41e3f33.png&quot; alt=&quot;\begin{align} \dot E &amp;amp;= f_E(E,L,A) = -\mu_e E - c_{le} E L - c_{ae} E A - a_e E + b A \\ \dot L &amp;amp;= f_L(E, L) = -\mu_L L + a_e E - a_L L \\ \dot P &amp;amp;= f_P(L,P) = -\mu_P P - a_p P + a_L L\\ \dot A &amp;amp;= f_A(P,A) = -\mu_A A + a_p P \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \dot E &amp;amp;= f_E(E,L,A) = -\mu_e E - c_{le} E L - c_{ae} E A - a_e E + b A \\ \dot L &amp;amp;= f_L(E, L) = -\mu_L L + a_e E - a_L L \\ \dot P &amp;amp;= f_P(L,P) = -\mu_P P - a_p P + a_L L\\ \dot A &amp;amp;= f_A(P,A) = -\mu_A A + a_p P \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Has the corresponding variance-covariance dynamics&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/1/2/4/1249afdfb5963c156af5b5709ac8a669.png&quot; alt=&quot;\begin{align} &amp;amp;\frac{d}{dt} \sigma_E^2 = 2\partial_E f_E \sigma_E^2 + g_E + 2\textrm{Cov}(E,L) \partial_L f_E + 2\textrm{Cov}(E,A) \partial_A f_E \\ &amp;amp;\frac{d}{dt} \sigma_L^2 = 2\partial_L f_L \sigma_L^2 + g_L + 2\textrm{Cov}(E,L) \partial_E f_L \\ &amp;amp;\frac{d}{dt} \sigma_P^2 = 2\partial_P f_P \sigma_P^2 + g_P + 2\textrm{Cov}(L,P) \partial_L f_P \\ &amp;amp;\frac{d}{dt} \sigma_A^2 = 2\partial_A f_A \sigma_A^2 + g_A + 2\textrm{Cov}(P,A) \partial_P f_A \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(E,L) = \left( \partial_E f_E + \partial_L f_L \right) \textrm{Cov}(E,L) + \partial_L f_E \sigma_L^2 + \partial_E f_L \sigma_E^2 \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(E,A) = \left( \partial_E f_E + \partial_A f_A \right) \textrm{Cov}(E,A) + \partial_A f_E \sigma_A^2 + \partial_E f_A \sigma_E^2 \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(L,P) = \left( \partial_P f_P + \partial_L f_L \right) \textrm{Cov}(L,P) + \partial_L f_P \sigma_L^2 + \partial_P f_L \sigma_P^2 \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(A,P) = \left( \partial_P f_P + \partial_A f_A \right) \textrm{Cov}(A,P) + \partial_A f_P \sigma_A^2 + \partial_P f_A \sigma_P^2 \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} &amp;amp;\frac{d}{dt} \sigma_E^2 = 2\partial_E f_E \sigma_E^2 + g_E + 2\textrm{Cov}(E,L) \partial_L f_E + 2\textrm{Cov}(E,A) \partial_A f_E \\ &amp;amp;\frac{d}{dt} \sigma_L^2 = 2\partial_L f_L \sigma_L^2 + g_L + 2\textrm{Cov}(E,L) \partial_E f_L \\ &amp;amp;\frac{d}{dt} \sigma_P^2 = 2\partial_P f_P \sigma_P^2 + g_P + 2\textrm{Cov}(L,P) \partial_L f_P \\ &amp;amp;\frac{d}{dt} \sigma_A^2 = 2\partial_A f_A \sigma_A^2 + g_A + 2\textrm{Cov}(P,A) \partial_P f_A \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(E,L) = \left( \partial_E f_E + \partial_L f_L \right) \textrm{Cov}(E,L) + \partial_L f_E \sigma_L^2 + \partial_E f_L \sigma_E^2 \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(E,A) = \left( \partial_E f_E + \partial_A f_A \right) \textrm{Cov}(E,A) + \partial_A f_E \sigma_A^2 + \partial_E f_A \sigma_E^2 \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(L,P) = \left( \partial_P f_P + \partial_L f_L \right) \textrm{Cov}(L,P) + \partial_L f_P \sigma_L^2 + \partial_P f_L \sigma_P^2 \\ &amp;amp;\frac{d}{dt} \textrm{Cov}(A,P) = \left( \partial_P f_P + \partial_A f_A \right) \textrm{Cov}(A,P) + \partial_A f_P \sigma_A^2 + \partial_P f_A \sigma_P^2 \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Where &lt;em&gt;g_i&lt;/em&gt; is the second jump moment, which is a function of the state (&lt;em&gt;E&lt;/em&gt;, &lt;em&gt;L&lt;/em&gt;, &lt;em&gt;P&lt;/em&gt;, &lt;em&gt;A&lt;/em&gt;) just as &lt;em&gt;f_i&lt;/em&gt; is. (In this case it will correspond to the sum of all birth and death terms).&lt;/p&gt;
&lt;h3 id=&quot;general-form-algorithm&quot;&gt;General Form &amp;amp; Algorithm&lt;/h3&gt;
&lt;p&gt;Consider the dynamics are given by&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/0/1/5/0155c412fb0a830912daef0b2e65b0dd.png&quot; alt=&quot;\dot X_i = f_i(\vec X)&quot; /&gt;&lt;figcaption&gt;\dot X_i = f_i(\vec X)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;and define variance-covariance matrix &lt;em&gt;M&lt;/em&gt; and the Jacobian matrix of &lt;em&gt;f&lt;/em&gt; as &lt;em&gt;J&lt;/em&gt;. Then the dynamics of the diagonal elements (variance terms) are written as&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/a/0/9/a0963cc09f8b045656952fc47a21587f.png&quot; alt=&quot;\dot \sigma_i^2 = 2 g_i + 2\sum_k J_{ik} M_{ik} \partial_k f_i&quot; /&gt;&lt;figcaption&gt;\dot \sigma_i^2 = 2 g_i + 2\sum_k J_{ik} M_{ik} \partial_k f_i&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;While the dynamics of the off-diagonal elements (covariance terms) are given by&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/b/b/d/bbd80770f9365cec3c61b2ce68e34a0a.png&quot; alt=&quot;\frac{d}{dt} \textrm{Cov(i,j)} = \dot M_{ij} = \partial_i f_i M_{ji} + \partial_j f_j M_{ij} + \partial_i f_j M_{ii} + \partial_j f_i M_{jj}&quot; /&gt;&lt;figcaption&gt;\frac{d}{dt} \textrm{Cov(i,j)} = \dot M_{ij} = \partial_i f_i M_{ji} + \partial_j f_j M_{ij} + \partial_i f_j M_{ii} + \partial_j f_i M_{jj}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Track current implementation of the algorithm &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/noise_approx.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/noise_approx.R&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Beetles workshop Day 2</title>
	 <link href="/2010/05/13/Beetles-workshop-Day-2.html"/>
   <updated>2010-05-13T00:00:00+00:00</updated>
   <id>/05/13/Beetles-workshop-Day-2</id>
   <content type="html">&lt;h3 id=&quot;goals&quot;&gt;Goals&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;van Kampen expansion of LPA model, maximize noise in L while keeping A robust?&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/b/a/1/ba156d602601209f3d2db74507362626.png&quot; alt=&quot;\begin{align} \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \alpha_{1,0}}{\partial \phi} \langle \xi^2 \rangle + 2 \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \xi \eta \rangle + \alpha_{2,0} \\ \frac{d \langle \xi \eta \rangle}{d t} &amp;amp;= \left( \frac{\partial \alpha_{1,0}}{\partial \phi} + \frac{\partial \beta_{1,0} }{\partial \psi} \right)\langle \xi \eta \rangle+ \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \eta^2 \rangle \\ \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \beta_{1,0}}{\partial \psi} \langle \eta^2 \rangle + \beta_{2,0} \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \alpha_{1,0}}{\partial \phi} \langle \xi^2 \rangle + 2 \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \xi \eta \rangle + \alpha_{2,0} \\ \frac{d \langle \xi \eta \rangle}{d t} &amp;amp;= \left( \frac{\partial \alpha_{1,0}}{\partial \phi} + \frac{\partial \beta_{1,0} }{\partial \psi} \right)\langle \xi \eta \rangle+ \frac{\partial \alpha_{1,0} }{\partial \psi} \langle \eta^2 \rangle \\ \frac{d \langle \xi^2 \rangle}{d t} &amp;amp;= 2 \frac{\partial \beta_{1,0}}{\partial \psi} \langle \eta^2 \rangle + \beta_{2,0} \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Indiv. heterogeneity issue: dividing larval class into a smaller, highly-cannibal and remainder of more weakly cannibalistic.&lt;/li&gt;
&lt;li&gt;Pulse dynamics – interspike interval, magnitude?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;potential-data&quot;&gt;Potential Data&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;1995 Dennis et al. – 5 replicate populations (2-cycle dataset), 5 age-cycles.&lt;/li&gt;
&lt;li&gt;eight-year chaotic time series&lt;/li&gt;
&lt;li&gt;Strawbridge daily samples (single replicate), occasional disease in lines though.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;literature&quot;&gt;Literature&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://hdl.handle.net/10.1080/10236190802282669&quot; title=&quot;doi:10.1080/10236190802282669&quot;&gt;Caswell 2009&lt;/a&gt; Sensitivity of density dependent dynamics&lt;/li&gt;
&lt;li&gt;Kendall (yet unpublished)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://hdl.handle.net/10.1086/528965&quot; title=&quot;doi:10.1086/528965&quot;&gt;Vindenes 2008&lt;/a&gt; Individual heterogeneity &amp;amp; demographic stochasticity.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://hdl.handle.net/10.1086/285863&quot; title=&quot;doi:10.1086/285863&quot;&gt;Ludwig 1996&lt;/a&gt; Failure of diffusion approximation in small populations.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;next-steps&quot;&gt;Next Steps&lt;/h3&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Analytic description of large demographic noise systems&lt;/li&gt;
&lt;li&gt;Comparisons to beetle datasets&lt;/li&gt;
&lt;li&gt;Paper Outline. Skype meeting May 28th.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/05/13/Adaptive-Dynamics.html"/>
   <updated>2010-05-13T00:00:00+00:00</updated>
   <id>/05/13/Adaptive-Dynamics</id>
   <content type="html">&lt;h3 id=&quot;public-code-hosting&quot;&gt;Public code hosting&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Project code now &lt;a href=&quot;http://github.com/cboettig/AdaptiveDynamics&quot; title=&quot;http://github.com/cboettig/AdaptiveDynamics&quot;&gt;available through Github&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advantages to public hosting:&lt;/strong&gt; Replication of adaptive dynamics simulations can be difficult, particularly in matching various nuisance parameters. While there is certainly much pedagogical value in individual researchers implementing their own simulations, verification and reproducibility of scientific results would be greatly facilitated by adapting an accepted open source code base and adding branches, etc. Researchers could much more immediately benefit from the work of their colleagues and spend more time implementing novel research and less reproducing it. Many eyes would ensure more robust, efficient and bug-free code.&lt;/li&gt;
&lt;li&gt;Current code has a long way to come, particularly in terms of documentation.&lt;/li&gt;
&lt;li&gt;The C-Matrix approach lacks the desired level of generality, though it does accelerate the calculations significantly compared to the straight forward implementation that would recalculate competition coefficients after each birth or death event instead of only after each mutation.&lt;/li&gt;
&lt;li&gt;Motivation for public hosting partly comes partly from email request for the code from my fluctuation domains paper, in which a researcher pointed out the difficulty in replicating certain branching results.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Misc —-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Most work today in Stochastic Population Dynamics (second day of beetle workshop).&lt;/li&gt;
&lt;li&gt;Migrated Firefox bookmarks to &lt;a href=&quot;http://delicious.com/cboettig&quot; title=&quot;http://delicious.com/cboettig&quot;&gt;delicious&lt;/a&gt;. Should encourage me to bookmark more frequently, slowly entering the modern world here.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://launchpad.e2conf.com/vote-now/&quot; title=&quot;http://launchpad.e2conf.com/vote-now/&quot;&gt;Enterprise 2.0&lt;/a&gt; competition for enterprise solutions, have much in common with challenges in science. Wonder what we’re already doing well vs what could be transfered from here.&lt;/li&gt;
&lt;li&gt;Search history is an interesting source of statistics – apparently I view 100-300 pages a day? Many are gmail/wiki/notebook pages, still.&lt;/li&gt;
&lt;li&gt;Looked into website polling / voting schemes that can be added to websites, i.e. Facebook’s &lt;a href=&quot;http://developers.facebook.com/docs/reference/plugins/like&quot; title=&quot;http://developers.facebook.com/docs/reference/plugins/like&quot;&gt;like&lt;/a&gt; button and the &lt;a href=&quot;http://about.digg.com/button&quot; title=&quot;http://about.digg.com/button&quot;&gt;digg button&lt;/a&gt;. A colleague was looking into ways to get students to rank the usefulness of various course content. Probably many other, possibly better solutions but an intriguing idea.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Roi and Sam Comparative Phylogenetics R Workshop</title>
	 <link href="/2010/05/12/Roi-and-Sam-Comparative-Phylogenetics-R-Workshop.html"/>
   <updated>2010-05-12T00:00:00+00:00</updated>
   <id>/05/12/Roi-and-Sam-Comparative-Phylogenetics-R-Workshop</id>
   <content type="html">&lt;h4 id=&quot;day-2-4p---630p&quot;&gt;Day 2: 4p - 6:30p&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Attending the R workshop by Roi Holzmann and Sam Price from the Wainwright lab. Missed the introductory session on Monday.&lt;/li&gt;
&lt;li&gt;Course data currently &lt;a href=&quot;http://www.eve.ucdavis.edu/~wainwrightlab/links.html&quot; title=&quot;http://www.eve.ucdavis.edu/~wainwrightlab/links.html&quot;&gt;available here&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Resources:&lt;/strong&gt; &lt;a href=&quot;http://www.springerlink.com/content/t83625/?p=4c6cda22762140f6a15f6cac9fbfe592&amp;amp;pi=0&quot; title=&quot;http://www.springerlink.com/content/t83625/?p=4c6cda22762140f6a15f6cac9fbfe592&amp;amp;pi=0&quot;&gt;Springer R books&lt;/a&gt; pdfs available through UC Davis.&lt;/li&gt;
&lt;li&gt;In particular: &lt;a href=&quot;http://www.springerlink.com/content/x20480/?p=82707f7c898f49c6a0fdf4f42a2fb48e&amp;amp;pi=1&quot; title=&quot;http://www.springerlink.com/content/x20480/?p=82707f7c898f49c6a0fdf4f42a2fb48e&amp;amp;pi=1&quot;&gt;R book w/ ape&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;speciation-diversification&quot;&gt;Speciation &amp;amp; Diversification&lt;/h3&gt;
&lt;p&gt;3rd session (4:10 - 5:10 pm): Packages: Laser, Geiger, Ape, apTreeshape &amp;amp; Diversitree&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lineage through time plots ape and laser:&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; ltt.plot() or plotLtt()&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Simulating trees (Yule and Birth/Death)&lt;/li&gt;
&lt;li&gt;Tree statistics (gamma statistic - Pybus &amp;amp; Harvey etc.)&lt;/li&gt;
&lt;li&gt;Laser&lt;/li&gt;
&lt;li&gt;MEDUSA - shifts in diversification rates (in Gieger)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Discrete data&lt;/p&gt;
&lt;p&gt;4th session (5:30 - 6:30 pm): Packages: Ape &amp;amp; Geiger&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ancestral state reconstruction&lt;/li&gt;
&lt;li&gt;Fitting models of evolution (fitDiscrete in Geiger)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Hastings Beetle Workshop</title>
	 <link href="/2010/05/12/Hastings-Beetle-Workshop.html"/>
   <updated>2010-05-12T00:00:00+00:00</updated>
   <id>/05/12/Hastings-Beetle-Workshop</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://bill.srnr.arizona.edu/Bob_Costantino/cos1.html&quot; title=&quot;http://bill.srnr.arizona.edu/Bob_Costantino/cos1.html&quot;&gt;Bob Costantino&lt;/a&gt; and &lt;a href=&quot;http://www.colorado.edu/eeb/facultysites/melbourne/&quot; title=&quot;http://www.colorado.edu/eeb/facultysites/melbourne/&quot;&gt;Brett Melbourne&lt;/a&gt; are joining us for the next two days to talk about stochastic population dynamics in &lt;em&gt;Tribolium.&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Morning Session, 9a - 11a
&lt;ul&gt;
&lt;li&gt;Outline the individual based model, toolbox&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Group lunch, noon-1:30&lt;/li&gt;
&lt;li&gt;My lab Presentation, 2p-3p
&lt;ul&gt;
&lt;li&gt;Present multidimensional linear noise approximation approach to characterizing the demographically stochastic &lt;em&gt;key class.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Afternoon session, 3p-4p
&lt;ul&gt;
&lt;li&gt;Follow-up on understanding noise propagation in age structure dynamics.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;( Phylogenetics Workshop, 4-6:30)&lt;/li&gt;
&lt;li&gt;Group dinner 7:00-9:00&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(Details to be transcribed still)&lt;/p&gt;
&lt;h3 id=&quot;presentation&quot;&gt;Presentation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Motivation: qualitative differences from noise – geometric mean fitness&lt;/li&gt;
&lt;li&gt;Why demographic noise is often negligible&lt;/li&gt;
&lt;li&gt;Why it isn’t
&lt;ul&gt;
&lt;li&gt;Enhancement&lt;/li&gt;
&lt;li&gt;Inflation&lt;/li&gt;
&lt;li&gt;transient bimodality&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Notion of key class in age structured model
&lt;ul&gt;
&lt;li&gt;Crowley-based model simulation&lt;/li&gt;
&lt;li&gt;Analytic approximation&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Insights from linear noise approximation&lt;/li&gt;
&lt;li&gt;Challenges: inference based and computationally based difficulties.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Peter Meeting</title>
	 <link href="/2010/05/11/Peter-Meeting.html"/>
   <updated>2010-05-11T00:00:00+00:00</updated>
   <id>/05/11/Peter-Meeting</id>
   <content type="html">&lt;p&gt;Discussed potential solution to the model choice scenario:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Consider an ordered list of models, A, B, C, D&lt;/li&gt;
&lt;li&gt;Then the Neyman-Pearson Lemma (see earlier entry on this) lets us walk through the list in the following fashion: We generate the simulated data sets under model A and compare likelihood ratios in each case. If the likelihood ratio of the observed data falls outside the 95% confidence interval, than it with this confidence that we are saying the data justify the alternate model (model B). Then repeat, generating under model B and comparing to model C, and so forth until we cannot reject the simpler model.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;More subtle concerns:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The model generating the data used in the bootstrap in an estimate, and shouldn’t be treated as the true model with no uncertainty, but rather be bootstrapped itself.&lt;/li&gt;
&lt;li&gt;Of course the method should consider probabilistic partitions of the data. The MLE partition alone will be misleading.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes&quot;&gt;Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;My lightning talk proposal to iEvoBio was accepted!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Still mostly working in the Stochastic Population Dynamics notebook this week.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Demographic Noise</title>
	 <link href="/2010/05/11/Demographic-Noise.html"/>
   <updated>2010-05-11T00:00:00+00:00</updated>
   <id>/05/11/Demographic-Noise</id>
   <content type="html">&lt;h3 id=&quot;crowley-model&quot;&gt;Crowley Model&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Exploring the extent to which demographic stochasticity in a key class can reverberate through the entire population dynamics.&lt;/li&gt;
&lt;li&gt;Starting with a simple test case of a modified Crowley model:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/7/5/f/75f2b0cfed3d87a63da03d093581eefd.png&quot; alt=&quot;\begin{align} \dot x &amp;amp;= b_1 x (K - x - y) - d_1 x + c_1 x y \\ \dot y &amp;amp;= b_2 y (K - x - y) - d_1 y - c_2 x y \end{align}&quot; /&gt;&lt;figcaption&gt;\begin{align} \dot x &amp;amp;= b_1 x (K - x - y) - d_1 x + c_1 x y \\ \dot y &amp;amp;= b_2 y (K - x - y) - d_1 y - c_2 x y \end{align}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Model is implemented on a &lt;a href=&quot;http://github.com/cboettig/warningSignals/tree/crowley#&quot; title=&quot;http://github.com/cboettig/warningSignals/tree/crowley#&quot;&gt;branch&lt;/a&gt; of the warningSignals package. Model in &lt;a href=&quot;http://github.com/cboettig/warningSignals/blob/crowley/src/crowley.c&quot; title=&quot;http://github.com/cboettig/warningSignals/blob/crowley/src/crowley.c&quot;&gt;crowley.c&lt;/a&gt;, Depends on modified gillespie.c library in this package.&lt;/li&gt;
&lt;li&gt;Branching necessary as implementation simplifies the gillespie function dependencies, but these changes would break compatibility with warning_signals.c and its R functions. Once warning_signals.c is updated to the new interface format I can remerge the branches.&lt;/li&gt;
&lt;li&gt;compile with &lt;em&gt;make crowley&lt;/em&gt; for the moment, will add R interface soon.&lt;/li&gt;
&lt;li&gt;Branches need to be pushed to the github server separately, see the &lt;a href=&quot;http://github.com/guides/push-a-branch-to-github&quot; title=&quot;http://github.com/guides/push-a-branch-to-github&quot;&gt;github directions&lt;/a&gt;, but essentially&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; git push origin branchname&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;will do the trick.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; #### Parameters for small class&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Values: b_1 = 0.11, b_2 = 0.6, d_1 = d_2 = c_1 = 0.1, c_2 = 4, K = 10000.&lt;/li&gt;
&lt;li&gt;Expected sizes: E(x) = 500, E(y) = 4500, (analytic)&lt;/li&gt;
&lt;li&gt;Variation (from simulation) SD(x) ≈ 120, SD(y) ≈ 1000&lt;/li&gt;
&lt;li&gt;For K = 1000, means are 1/10th and extinction very common within 500 time units, and possible in either group. Extinctions of smaller population not uncommon for K = 10000 in 5000 time units.&lt;/li&gt;
&lt;li&gt;Freezing dynamics of x (&lt;em&gt;i.e.&lt;/em&gt; b_1 = .00, d_1 = .00, c_1 = .00) greatly decreases fluctuations in Y (more than an order of magnitude, SD(y) ≈ 70).&lt;/li&gt;
&lt;li&gt;Analytic description should be straight-forward linear noise approximation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Alan Meeting</title>
	 <link href="/2010/05/10/Alan-Meeting.html"/>
   <updated>2010-05-10T00:00:00+00:00</updated>
   <id>/05/10/Alan-Meeting</id>
   <content type="html">&lt;h3 id=&quot;updates&quot;&gt;Updates&lt;/h3&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Likelihood calculation for beetle model.&lt;/li&gt;
&lt;li&gt;Proposed model and calculations Linear parameter change for warning signal model. Results in a few test cases.&lt;/li&gt;
&lt;li&gt;Likelihood methods within SDE framework, an outline of methods. Subtle problems, good approximations, powerful approaches.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt; ### Questions&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;LPA vs ELLPA model&lt;/li&gt;
&lt;li&gt;Defining state space in individual-based model vs stage based model, setting initial conditions? &lt;strong&gt;&lt;em&gt;Conclusion:&lt;/em&gt;&lt;/strong&gt; Means non-Markovian system, so likelihood isn’t determined in one step approach. More lit review, see: Ellner [&lt;a href=&quot;#bibkey_Ellner&quot;&gt;1&lt;/a&gt;], Perry, [&lt;a href=&quot;#bibkey_Perry&quot;&gt;2&lt;/a&gt;, &lt;a href=&quot;#bibkey_Perry2&quot;&gt;3&lt;/a&gt;, &lt;a href=&quot;#bibkey_Perry3&quot;&gt;4&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;Calculating likelihood while accounting for non-independence of the occupancy of each stage? Focus on one class? &lt;strong&gt;&lt;em&gt;Conclusions:&lt;/em&gt;&lt;/strong&gt; Choose Larvae.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;parameter-fitting&quot;&gt;Parameter fitting&lt;/h3&gt;
&lt;p&gt;On likelihood based model selection vs model based estimates of process:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Some cases maximum likelihood estimate agrees with statistical definition – variance definition is mle of sigma parameter for indep gaussian random numbers, the arithmetic mean is the mle for lambda in the poisson, etc. Doesn’t necessarily hold true in these time-series analyses, at least for numerical fitting. Would be better to estimate theta from the mean and search for other parameters.&lt;/li&gt;
&lt;li&gt;requires more precise parameterization&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=16673349&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Ellner SP and Rees M. .&lt;/a&gt; pmid:16673349. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=16673349&quot; title=&quot;PMID 16673349&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=16673349&quot; title=&quot;PMID 16673349&quot;&gt;HubMed&lt;/a&gt; [Ellner]&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=19886497&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;De Valpine P. .&lt;/a&gt; pmid:19886497. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=19886497&quot; title=&quot;PMID 19886497&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=19886497&quot; title=&quot;PMID 19886497&quot;&gt;HubMed&lt;/a&gt; [Perry]&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=19739392&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Polansky L, de Valpine P, Lloyd-Smith JO, and Getz WM. .&lt;/a&gt; pmid:19739392. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=19739392&quot; title=&quot;PMID 19739392&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=19739392&quot; title=&quot;PMID 19739392&quot;&gt;HubMed&lt;/a&gt; [Perry2]&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=19425421&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;de Valpine P. .&lt;/a&gt; pmid:19425421. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=19425421&quot; title=&quot;PMID 19425421&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=19425421&quot; title=&quot;PMID 19425421&quot;&gt;HubMed&lt;/a&gt; [Perry3]&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;All Medline abstracts: &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=16673349,19886497,19739392,19425421&quot; title=&quot;All abstracts at PubMed&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=16673349,19886497,19739392,19425421&quot; title=&quot;All abstracts at HubMed&quot;&gt;HubMed&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Research: Themes for Weds/Thurs workshop with Bob and Brett ———————————————————–&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Why is this all important?&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Importance of space&lt;/li&gt;
&lt;li&gt;Importance of environmental variation&lt;/li&gt;
&lt;li&gt;Importance of intrinsic variation &amp;lt;- us&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;A recipe for trouble&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Age or stage structure&lt;/li&gt;
&lt;li&gt;Density dependence&lt;/li&gt;
&lt;li&gt;demographic stochasticity&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;reading-misc&quot;&gt;Reading / Misc&lt;/h2&gt;
&lt;h3 id=&quot;open-access&quot;&gt;Open Access&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Answering a question for a colleague about whether posting on arxiv was consistent with &lt;a href=&quot;http://www.elsevier.com/wps/find/authorsview.authors/copyright&quot; title=&quot;http://www.elsevier.com/wps/find/authorsview.authors/copyright&quot;&gt;Elsevier’s policies&lt;/a&gt;. (&lt;a href=&quot;http://www.elsevier.com/wps/find/authorshome.authors/preprints&quot; title=&quot;http://www.elsevier.com/wps/find/authorshome.authors/preprints&quot;&gt;It is&lt;/a&gt;). Many Eslevier journals including TPB provide a watermarked authors copy of post-publication pdf explicitly for posting on the author’s website and sharing with colleagues.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; - Fun stats: &lt;a href=&quot;http://romeo.eprints.org/stats.php&quot; title=&quot;http://romeo.eprints.org/stats.php&quot;&gt;90% of journals&lt;/a&gt; allow archiving preprints, many major funders (NIH, Wellcome) and require open archives, and the &lt;a href=&quot;http://www.arl.org/sparc/advocacy/frpaa/index.shtml&quot; title=&quot;http://www.arl.org/sparc/advocacy/frpaa/index.shtml&quot;&gt;FRPAA&lt;/a&gt; bill now before congress would require it for almost all public funding. &lt;a href=&quot;http://www.eprints.org/openaccess/self-faq/#self-archiving-legal&quot; title=&quot;http://www.eprints.org/openaccess/self-faq/#self-archiving-legal&quot;&gt;Very few publishers maintain&lt;/a&gt; the Ingelfinger rule of refusing to publish things that are archived before publication. Open archives are now the norm.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;arXiv’s &lt;a href=&quot;http://arxiv.org/help/endorsement&quot; title=&quot;http://arxiv.org/help/endorsement&quot;&gt;endorsement&lt;/a&gt; system seems to be a source of confusion sometimes. &lt;a href=&quot;http://arxiv.org/abs/1004.4233&quot; title=&quot;http://arxiv.org/abs/1004.4233&quot;&gt;Our TPB paper&lt;/a&gt; on arXiv.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;open-education&quot;&gt;Open Education&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.youtube.com/watch?v=PHvoBPjhsBA&quot; title=&quot;http://www.youtube.com/watch?v=PHvoBPjhsBA&quot;&gt;This is how we dream&lt;/a&gt; a fantastic piece on the changing media of writing. &lt;a href=&quot;http://www.youtube.com/watch?v=6KsEQnOkTZ0&amp;amp;feature=related&quot; title=&quot;http://www.youtube.com/watch?v=6KsEQnOkTZ0&amp;amp;feature=related&quot;&gt;part 2&lt;/a&gt;. From Richard Miller, at Rutgers.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://edseminars.apple.com/event/2610&quot; title=&quot;http://edseminars.apple.com/event/2610&quot;&gt;AcademiX&lt;/a&gt; an exciting conference on the open future of learning.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals with SDEs</title>
	 <link href="/2010/05/09/Warning-Signals-with-SDEs.html"/>
   <updated>2010-05-09T00:00:00+00:00</updated>
   <id>/05/09/Warning-Signals-with-SDEs</id>
   <content type="html">&lt;h3 id=&quot;summary&quot;&gt;Summary&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Have a functional likelihood calculation from the full individual-based simulation, see Friday. Accuracy needs more testing, and the computation is probably too slow for optimization routines.&lt;/li&gt;
&lt;li&gt;Have an implementation of the linear decrease in stability model with analytic conditional probability density. Needed a couple adjustments today.&lt;/li&gt;
&lt;li&gt;Need to add direct simulation to the warning signals package, currently retunrs only time-averaged/ensemble averaged stats. Can be approximated by setting the window equal to the timestep and ensembles equal to one.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;revising-testing-the-math&quot;&gt;Revising &amp;amp; Testing the math&lt;/h3&gt;
&lt;p&gt;Revisions to the equations from Thursday’s entry:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Added an alpha_0 parameter – the alpha dynamics shouldn’t start at zero.&lt;/li&gt;
&lt;li&gt;The variance integral had a factor of two that wasn’t carried through. Also this calculation changes as a result of the alpha_0&lt;/li&gt;
&lt;li&gt;The resulting analytical solution for the variance depends on a difference of error functions, which has poor numerical behavior for small beta. Implemented a flag in the R code which drops down to the analytic solution of beta=0 when it begins to run into this numerical round-off, otherwise numerics return variance of zero. Compared to analytic simulations.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;effective-model-choice-absence-of-a-warning-signal&quot;&gt;Effective model choice: absence of a warning signal&lt;/h3&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Generate a data set that does not contain a warning signal, using the OU model.&lt;/li&gt;
&lt;li&gt;Fit both model with changing stability and the simple OU model.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;theta &amp;lt;- 3
alpha &amp;lt;- 1
sigma &amp;lt;- 2
X &amp;lt;- sde.sim(model=&amp;quot;OU&amp;quot;, theta= c(theta*alpha,alpha,sigma), X0=Xo, N=1000, T=1000)  # (SDE package parameterizes OU differently)
 
 
# These starting conditions converge to the wrong set of parameters but achieve the same likelihood
 
Call:
mle(minuslogl = warning.lik, start = list(alpha_0 = 2, theta = 1, 
    sigma = 2, beta = 2), method = &amp;quot;L-BFGS-B&amp;quot;, lower = c(0, 0, 
    0, 1e-09), control = list(maxit = 1000))
 
Coefficients:
         Estimate   Std. Error
alpha_0 0.5812878 139.62180181
theta   3.0881681   0.06202446
sigma   1.9305852  43.26824107
beta    1.0907615 279.24384653
-2 log L: 3401.722 
 
 
## These parameters converge closer to the true parameter set, and achieve much smaller Std Error
Call:
mle(minuslogl = warning.lik, start = list(alpha_0 = 2, theta = 1, 
    sigma = 2, beta = 0.2), method = &amp;quot;L-BFGS-B&amp;quot;, lower = c(0, 
    0, 0, 1e-09), control = list(maxit = 1000))
 
Coefficients:
          Estimate Std. Error
alpha_0 1.10203570        NaN
theta   3.08817901 0.06202212
sigma   2.09564217 0.02879976
beta    0.04950086        NaN
-2 log L: 3401.722 
 
 
 
## Matches the parameter values from the simple OU model (beta = 0), and same likelihood
 
mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5, 
    theta3 = 0.5), method = &amp;quot;L-BFGS-B&amp;quot;, lower = c(-Inf, 0, 0))
 
Coefficients:
       Estimate Std. Error
theta1 3.479407 0.29304030
theta2 1.126721 0.09219684
theta3 2.103550 0.07886453
-2 log L: 3401.722 
 
## And matches (even outperforms) the likelihood of the true parameters:
&amp;gt; 2*warning.lik(alpha_0, theta, sigma, beta)
[1] 3405.286
&amp;gt; 2*OU.lik(alpha*theta, alpha, sigma) 
[1] 3405.837&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;analysis-of-results&quot;&gt;Analysis of Results&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;So bad news is fit of the richer model can depend on initial conditions, and maximizing likelihood alone doesn’t guarantee finding the right parameters.
&lt;ul&gt;
&lt;li&gt;Luckily this alternate peak seems to have broader uncertainty&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Good news is that both approaches achieve the likelihood of the true parameter values. Any information criterion would successfully reject the change of stability model in this case.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Code Updates&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Warning Signals project has also &lt;a href=&quot;http://github.com/cboettig/warningSignals&quot; title=&quot;http://github.com/cboettig/warningSignals&quot;&gt;migrated to Github&lt;/a&gt;. Nicer interface, git is much faster, handles branching &amp;amp; merging very elegantly and this centralizes my projects.&lt;/li&gt;
&lt;li&gt;the optimization function in R takes control argument for maximum number of iterations as demonstrated above, though we don’t hit the default max (100) yet, which is promising for being able to optimize the individual-based model over at least a subset of parameters.&lt;/li&gt;
&lt;li&gt;Ironically the sde_likelihood library for this analysis has been developed in the Structured-Populations package, though it has now been integrated into the warningSignals package.&lt;/li&gt;
&lt;li&gt;Handy: function &lt;em&gt;formals()&lt;/em&gt; gives the arguments/defaults of an R function.&lt;/li&gt;
&lt;li&gt;Should look into how mle() is calculating the standard error estimate on parameters.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;misc&quot;&gt;Misc&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Joined Nature’s &lt;a href=&quot;http://www.nature.com/scitable&quot; title=&quot;http://www.nature.com/scitable&quot;&gt;SciTable&lt;/a&gt;, aimed at undergraduates and professors teaching mostly. We’ll see if it’s any use.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.youtube.com/watch?v=lFZ0z5Fm-Ng&quot; title=&quot;http://www.youtube.com/watch?v=lFZ0z5Fm-Ng&quot;&gt;Statistics&lt;/a&gt; on Social media, youtube-style.&lt;/li&gt;
&lt;li&gt;Persuasive &lt;a href=&quot;http://www.wired.com/techbiz/media/magazine/15-07/st_thompson&quot; title=&quot;http://www.wired.com/techbiz/media/magazine/15-07/st_thompson&quot;&gt;case for twitter&lt;/a&gt;, a social sixth sense?&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.bestcollegesonline.com/blog/2009/07/21/100-serious-twitter-tips-for-academics/&quot; title=&quot;http://www.bestcollegesonline.com/blog/2009/07/21/100-serious-twitter-tips-for-academics/&quot;&gt;100 twitter tips&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;added category tags to notebooks yesterday. Should help organize the subprojects in each notebook.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Likelihood calculation</title>
	 <link href="/2010/05/07/Likelihood-calculation.html"/>
   <updated>2010-05-07T00:00:00+00:00</updated>
   <id>/05/07/Likelihood-calculation</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Implemented the likelihood calculation in &lt;a href=&quot;http://github.com/cboettig/structured-populations/blob/master/R/simulate.R&quot; title=&quot;http://github.com/cboettig/structured-populations/blob/master/R/simulate.R&quot;&gt;simulate.R code&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;See &lt;a href=&quot;http://github.com/cboettig/structured-populations/commit/786d5bc1fe419c036428e4502cdbe1ea33010e9b&quot; title=&quot;http://github.com/cboettig/structured-populations/commit/786d5bc1fe419c036428e4502cdbe1ea33010e9b&quot;&gt;today’s revision changes&lt;/a&gt; via github&lt;/li&gt;
&lt;li&gt;beetle_sim() updated to return the full simulation to R.&lt;/li&gt;
&lt;li&gt;likelihood calculation by simulation done in parallel&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;library(beetles)
sim &amp;lt;- beetle_sim()
L &amp;lt;- likelihood(par=sim$par, X=sim$state[,2:6], Dt = sim$state[2,1]-sim$state[1,1] )
-sum(log(L))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Decent estimates of likelihood may be challenging: Modifying default settings for longer tome series:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; sim &amp;lt;- beetle_sim(dt = 7, T = 500)
&amp;gt; L &amp;lt;- likelihood(par=sim$par, X=sim$state[,2:6], dt = sim$state[2,1]-sim$state[1,1], reps=100 )
&amp;gt; L2 &amp;lt;- likelihood(par=sim$par, X=sim$state[,2:6], dt = sim$state[2,1]-sim$state[1,1], reps=100 )
&amp;gt; -sum(log(L2))
[1] 2132.963
&amp;gt; -sum(log(L))
[1] 2033.309&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;… Likelihood estimates differ significantly on same data. Compute times for the above runs on dual core are ~ minute, on our 8 core server ~ 10 seconds.&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; system.time(L &amp;lt;- likelihood(par=sim$par, X=sim$state[,2:6], dt = sim$state[2,1]-sim$state[1,1], reps=100, cpu=8 ))
Explicit sfStop() is missing: stop now.
 
Stopping cluster
 
snowfall 1.83 initialized (using snow 0.3-3): parallel execution on 8 CPUs.
 
Library beetles loaded.
Library beetles loaded in cluster.
 
   user  system elapsed 
  0.020   0.040  10.463&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; ### Challenges&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Initializing simulation:&lt;/strong&gt; State-space of the individual based model doesn’t really reduce to the five-dimensional stages. State is actually specified by the continuously valued age of every individual, so state space varies as population size fluctuates and is quite much larger. Though the age class groupings are intended as an approximation to this, there are several possible ways to initialize the simulation during each time interval for the likelihood calculation. Currently starting all individuals of a given age class at the &lt;em&gt;beginning&lt;/em&gt; of the age class, but might make a significant difference if the ages are or aren’t synchronized.&lt;/li&gt;
&lt;li&gt;Still haven’t added heterogeneity in age maturity or in cannibalism rates.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Non-independence of states&lt;/strong&gt;: State-space for the likelihood calculation is essentially five-dimensional: at each point in time have the population abundance in each of the five age classes (egg, immature larva, asymptotic-sized larva, pupae, adults). Of course probability of occupancy in each class isn’t independent of the other classes, so likelihood of the entire distribution of states can’t be computed directly.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Comparison to LPA model&lt;/strong&gt; will have to collapse larval class and ignore egg class?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;code-notes&quot;&gt;Code Notes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Consider returning log likelihoods directly from kernel density estimator for greater speed.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Answered a question on &lt;a href=&quot;http://www.mail-archive.com/help-gsl@gnu.org/msg03168.html&quot; title=&quot;http://www.mail-archive.com/help-gsl@gnu.org/msg03168.html&quot;&gt;gsl-help&lt;/a&gt; regarding kernel density estimation. Should expand these functions to allow for other bandwidth methods, etc.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Code needs doxygen documentation.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;kde library needs .cpp extension, seems that R gets confused mixing C and C++ code? Compiles fine by makefile but not by R when extensions don’t match.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Goals</title>
	 <link href="/2010/05/06/Goals.html"/>
   <updated>2010-05-06T00:00:00+00:00</updated>
   <id>/05/06/Goals</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Model choice exercise with sdes&lt;/li&gt;
&lt;li&gt;general likelihood calculation from simulation&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;test-case&quot;&gt;Test Case&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;d&lt;strong&gt;X&lt;em&gt;&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt; = α&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt;(θ − &lt;/em&gt;X&lt;em&gt;&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt;)&lt;/em&gt;d&lt;/strong&gt;t&lt;/em&gt; + σ*d**t*&lt;/p&gt;
&lt;p&gt;&lt;em&gt;d&lt;/em&gt;α&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt; = − β&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Approach ——–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The linear approximation to the warning signals dynamics can be captured by the OU process, look for changing α&lt;/li&gt;
&lt;li&gt;SDE models will also provide some of the coarser approximations for the structured population dynamics. Formulations of these still to do.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;conditional-probability&quot;&gt;Conditional probability&lt;/h2&gt;
&lt;p&gt;Solution to the time dependent OU process, see Gardiner 4th ed. pg 111, eq. (4.5.109).&lt;/p&gt;
&lt;p&gt;Solve using &lt;img src=&quot;http://openwetware.org/images/math/2/6/1/261158506a921c58c07cce2014f09198.png&quot; alt=&quot;f(X_t) = X_t \exp\left( - \int_0^t \alpha(s) ds \right)&quot; /&gt; and apply &lt;a href=&quot;http://en.wikipedia.org/wiki/It%C5%8D%E2%80%93Doeblin%27s_formula&quot; title=&quot;http://en.wikipedia.org/wiki/It%C5%8D%E2%80%93Doeblin%27s_formula&quot;&gt;Ito formula&lt;/a&gt;, giving&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/8/b/2/8b2d9515dd6a89360e9c97a122103193.png&quot; alt=&quot;X_t = X_0 \exp\left( - \int_0^t \alpha(s) ds \right) +\theta\left( 1- \exp\left( - \int_0^t \alpha(s) ds \right) \right) + \int_0^t \sigma \exp\left( - \int_0^t \alpha(s) ds \right) dW_t&quot; /&gt;&lt;figcaption&gt;X_t = X_0 \exp\left( - \int_0^t \alpha(s) ds \right) +\theta\left( 1- \exp\left( - \int_0^t \alpha(s) ds \right) \right) + \int_0^t \sigma \exp\left( - \int_0^t \alpha(s) ds \right) dW_t&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;And the moments are:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/math/e/5/a/e5ab85ca602fb12998c2eb985474c7e6.png&quot; alt=&quot;\begin{align} E(X_T) &amp;amp;= X_0 \exp\left( - \int_0^T \alpha(s) ds \right) +\theta\left( 1- \exp\left( - \int_0^T \alpha(s) ds \right) \right) \\ \operatorname{Var}(X_T) &amp;amp;= \sigma^2 \int_0^T \exp\left( -2 \int_0^t \alpha(s) ds \right) d t \end{align}&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Using the exact solution I can write down the conditional density function. We can evaluate both integrals for this linear increase model:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/e/8/f/e8f494fb0fc3fffba3ebbf121a70100a.png&quot; alt=&quot;\int_0^t (\beta t +\alpha_0 ) dt = \beta t^2/2 + \alpha_0 t&quot; /&gt;&lt;figcaption&gt;\int_0^t (\beta t +\alpha_0 ) dt = \beta t^2/2 + \alpha_0 t&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/7/a/2/7a2b755c9174107368e4480c60e685b4.png&quot; alt=&quot;\int_0^t e^{ - \beta s^2 - 2\alpha_0 s} ds = \frac{\sqrt{\pi}e^{\alpha_0^2/\beta} }{2\sqrt{\beta}} \left( \operatorname{erf} \left( \frac{ \alpha_0+\beta t }{ \sqrt{\beta} } \right) - \operatorname{erf} \left( \frac{ \alpha_0 }{ \sqrt{\beta} } \right) \right)&quot; /&gt;&lt;figcaption&gt;\int_0^t e^{ - \beta s^2 - 2\alpha_0 s} ds = \frac{\sqrt{\pi}e^{\alpha_0^2/\beta} }{2\sqrt{\beta}} \left( \operatorname{erf} \left( \frac{ \alpha_0+\beta t }{ \sqrt{\beta} } \right) - \operatorname{erf} \left( \frac{ \alpha_0 }{ \sqrt{\beta} } \right) \right)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; - Next, implement the conditional probability density in R:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;numeric_V &amp;lt;- function(Dt, pars){
    vint &amp;lt;- function(x){
        exp(-pars$beta*x^2 -2* pars$alpha_0*x)
    }
    int &amp;lt;- integrate(vint, 0, Dt)
    int$value*pars$sigma^2
}
 
analytic_V &amp;lt;- function(Dt, pars){
    if( erf(pars$alpha/sqrt(pars$beta) ) != 1){
 
        Log_Vx &amp;lt;- log(pars$sigma^2 *  sqrt(pi) ) + pars$alpha_0^2/(pars$beta)  + log( ( erf( (pars$alpha_0+pars$beta*Dt)/(sqrt(pars$beta) ) ) - erf(pars$alpha_0/(sqrt(pars$beta) ) ))/(2*sqrt(pars$beta) ))
        class(Log_Vx) = &amp;quot;numeric&amp;quot;
        Vx &amp;lt;- exp(Log_Vx)
    } else {
        warning(&amp;quot;beta near zero, using approximation&amp;quot;)
        Vx &amp;lt;- pars$sigma^2*(1-exp(-2*pars$alpha*Dt))/(2*pars$alpha)
 
    }
        Vx
}
 
# Parametrization dXt = alpha(theta - Xt)dt + sigma*dWt, alpha(t) = beta*t+alpha_0
warning_model &amp;lt;- function(Dt, Xo, pars){
    int &amp;lt;- pars$beta*Dt^2/2 + pars$alpha_0*Dt
    Ex &amp;lt;- Xo * exp(-int) + pars$theta * (1 - exp(-int) )
    Vx &amp;lt;- analytic_V(Dt, pars)
 
    return(list(Ex=Ex,Vx=Vx))
}
 
dcWarning &amp;lt;- function(x, Dt, x0, pars, log = FALSE){
  P &amp;lt;- warning_model(Dt, x0, pars)
  dnorm(x, mean=P$Ex, sd=sqrt(P$Vx), log=log)
}
 
 
warning.lik &amp;lt;- function(alpha_0, theta, sigma, beta){
  n &amp;lt;- length(X)
  dt &amp;lt;- deltat(X)
  pars = list(alpha_0=alpha_0, theta=theta, sigma=sigma, beta=beta)
  -sum( dcWarning(X[2:n], dt, X[1:(n-1)], pars, log=TRUE) )
}
 
 
require(stats4)
require(sde)
require(NORMT3)
 
set.seed(123)
theta &amp;lt;- 3
alpha &amp;lt;- 1
sigma &amp;lt;- 2
alpha_0 &amp;lt;- 1
beta &amp;lt;- .01
pars = list(alpha_0=alpha, theta=theta, sigma=sigma, beta=beta)
 
warning_model(1, 1, pars)
setOU(1, 1, theta=c(theta*alpha, alpha, sigma) )
 
numeric_V(Dt, pars)
analytic_V(Dt, pars)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; #### Note on Numerics&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Unfortunately the analytic solution does not have nice numerical properties for small β, which is the interesting limiting case (no/very slow change in stability). The error functions both approach unity, making the difference tiny, while the exponential term diverges. The result is that variances for too small beta suddenly become zero, instead of the appropriate limit. The numerical integration is more robust to this. Analytic implementation is modified to just provide the limit case when erf functions both evaluate at exactly 1.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;This linear test case model is quite restrictive. If the eigenvalue is decreasing, doing so in a linear way need not out perform a model in which it is not decreasing at all. It would be interesting to test if this is more sensitive than change point estimation. Iacus
&lt;ol start=&quot;2008&quot; type=&quot;1&quot;&gt;
&lt;li&gt;implements a least-squares based change point estimation in the R sde package.&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Misc Notes ———-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Upgraded to Ubuntu 10.04. Went fine on the experimental partition with a reformat to extension 4 and a fresh install. Fast boot times, spiffy system. Full upgrade on main (ext3) partition failed miserably though, can’t even boot up successfully following the upgrade.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Adding additional packages when fine, mostly copied configuration files over. A couple extra steps to get dual monitors working again, as the resolution wasn’t properly detected. &lt;a href=&quot;http://ubuntuforums.org/showthread.php?t=1112186&quot; title=&quot;http://ubuntuforums.org/showthread.php?t=1112186&quot;&gt;Solution here&lt;/a&gt;, essentially:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt; #!/bin/bash         
 xrandr --newmode &amp;quot;1920x1200_60.00&amp;quot; 193.16 1920 2048 2256 2592 1200 1201 1204 1242 -HSync +Vsync
 xrandr --newmode &amp;quot;1280x1040_60.00&amp;quot;  110.63  1280 1360 1496 1712  1040 1041 1044 1077  -HSync +Vsync
 xrandr --addmode VGA1 1920x1200_60.00
 xrandr --addmode VGA1 1280x1040_60.00&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; - vim-full is deprecated, vim-latexsuite needs additional installation, read: /usr/share/doc/vim-latexsuite/README.Debian after installing. Also vim’s “+y copy to clipboard doesn’t work with pure vim, so installing xclip vim-common and vim-gnome to fixed this.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Wednesday</title>
	 <link href="/2010/05/05/Wednesday.html"/>
   <updated>2010-05-05T00:00:00+00:00</updated>
   <id>/05/05/Wednesday</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Structured populations part of project migrated to &lt;a href=&quot;http://github.com/cboettig/structured-populations&quot; title=&quot;http://github.com/cboettig/structured-populations&quot;&gt;github&lt;/a&gt; from the google code page.&lt;/li&gt;
&lt;li&gt;Finally switched to using STL for linked list in simulation.&lt;/li&gt;
&lt;li&gt;Have working simulation function&lt;/li&gt;
&lt;li&gt;ensemble run function also calculates the probability based on kernel-density estimation from the replicates.&lt;/li&gt;
&lt;li&gt;Working on likelihood calculation.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;code-progress&quot;&gt;Code progress&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Lots of fun trying to get full structured population simulator working accurately. See &lt;a href=&quot;http://github.com/cboettig/structured-populations/commits/master&quot; title=&quot;http://github.com/cboettig/structured-populations/commits/master&quot;&gt;git log&lt;/a&gt; for details, but ended up abandoning two separate versions of custom-written C linked lists and just switched entire code over to C++ to use the STL’s linked list, which finally worked like a charm.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;exploring-github&quot;&gt;Exploring Github&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Github pages: gh-pages lets you create webpage associated with the project. The page isn’t automatically linked from the actual project page though, and though is easy to set up initially requires editing with a mix of ruby/html and fancy processing. Doesn’t seem particularly promising as I hoped, since all subsequent editing has to be done in raw mode. Can also create user pages this way. See &lt;a href=&quot;http://cboettig.github.com/structured-populations/&quot; title=&quot;http://cboettig.github.com/structured-populations/&quot;&gt;sample page&lt;/a&gt; for this project.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Much more promising: project page displays the readme, which can have &lt;a href=&quot;http://github.com/guides/readme-formatting&quot; title=&quot;http://github.com/guides/readme-formatting&quot;&gt;advanced markup&lt;/a&gt;, i.e. will try formatting readme files in &lt;a href=&quot;http://daringfireball.net/projects/markdown/syntax&quot; title=&quot;http://daringfireball.net/projects/markdown/syntax&quot;&gt;markdown&lt;/a&gt;, should be easy to learn, similar but not matching mediawiki. See the &lt;a href=&quot;http://github.github.com/github-flavored-markdown/&quot; title=&quot;http://github.github.com/github-flavored-markdown/&quot;&gt;github guide on markdown&lt;/a&gt;, does some extra github related functions, &lt;a href=&quot;http://github.github.com/github-flavored-markdown/preview.html&quot; title=&quot;http://github.github.com/github-flavored-markdown/preview.html&quot;&gt;see live demo&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;RSS feed anything – commit logs, etc. Follow other users or projects, rss feed automatically to git dashboard.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Lots more on &lt;a href=&quot;http://github.com/guides/home&quot; title=&quot;http://github.com/guides/home&quot;&gt;Git guides&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Primates</title>
	 <link href="/2010/05/05/Primates.html"/>
   <updated>2010-05-05T00:00:00+00:00</updated>
   <id>/05/05/Primates</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Primates project now has a &lt;a href=&quot;http://github.com/cboettig/sandbox&quot; title=&quot;http://github.com/cboettig/sandbox&quot;&gt;Github repository&lt;/a&gt;. Updates are embedded from here.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Experimenting with distributing code and data effectively. Pluses and minuses of three options:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;zipped file with R code and data. Requires setting working directory, harder to update. Subsequent uploads must include all the data, rather than incremental.&lt;/li&gt;
&lt;li&gt;Directly grab repository over github. Simple to update and access, stores only incremental changes. Requires knowledge of git&lt;/li&gt;
&lt;li&gt;R package: Nicely integrates data, code, and documentation. Requires installing R packages.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Learning the R packaging system for data. You can have .R files in the data/ directory of a package. The call to the data() function runs those files from that directory, making it unnecessary to specify the path to the data and allowing the use of complicated functions, see the example from the ape package:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;require(ape, quietly = TRUE, save = FALSE)
bird.orders &amp;lt;- read.tree(&amp;quot;bird.orders.tre&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt; Primate Phylogeny —————–&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Carl Boettiger 00:37, 30 April 2010 (EDT)&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Simon sent me the tree data from their paper:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=19860891&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Chatterjee HJ, Ho SY, Barnes I, and Groves C. .&lt;/a&gt; pmid:19860891. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=19860891&quot; title=&quot;PMID 19860891&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=19860891&quot; title=&quot;PMID 19860891&quot;&gt;HubMed&lt;/a&gt; [primates]&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;This is the first calibrated ultrametric tree I’ve been able to couple to the primate data Daniel provided. I’ve preformed a quick ancestral state reconstruction on log brain weight (warmer colors are more massive).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/9/96/Primates.png&quot; alt=&quot;Image:Primates.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### R code to create figure&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;library(ape)
library(geiger)
genera_set &amp;lt;- read.nexus(&amp;quot;mt.genera.ucld.trees&amp;quot;)
nuc_set &amp;lt;- read.nexus(&amp;quot;nuc.ucld.trees&amp;quot;)
genera &amp;lt;- genera_set[[1]]
nuc &amp;lt;- nuc_set[[1]]
nuc_names &amp;lt;- nuc$tip.label
genera_names &amp;lt;- genera$tip.label
traits &amp;lt;- read.csv(&amp;quot;Primate_brain_comparisons.csv&amp;quot;)
 
dups &amp;lt;- duplicated(traits[[&amp;#39;Genus&amp;#39;]])
trait_names &amp;lt;- as.character(traits$Genus[!dups])
x &amp;lt;- traits$log_brain.weight[!dups]
names(x) &amp;lt;- trait_names
 
 
compare &amp;lt;- treedata(nuc, x)
plot(compare$phy)
out &amp;lt;- ace(compare$data, compare$phy)
 
# a similar function but for the continuous ancestral state 
plot_cts_ancestor &amp;lt;- function(phy, data, ancestral){  
    plot(phy) # just to get treelength 
    treelen &amp;lt;- max(axisPhylo() )
    plot(compare$phy, cex=1, x.lim=1.3*treelen, edge.width=2)
    mycol &amp;lt;- function(x){
    tmp = (x - min(data)) /max(x-min(data)) 
    rgb(blue = 1-tmp, green=0, red = tmp )
    }
    nodelabels(pch=19, col=mycol(ancestral$ace), cex=1.5  )
    tiplabels(pch=19, col=mycol(data), cex=1.5, adj=0.5) # add tip color code
    }
plot_cts_ancestor(compare$phy, compare$data, out)&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;This is essentially just at the proof of concept level. A couple obvious steps:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;This uses a single tree from the posterior distribution of trees, which we’ll eventually want to average over in the parameter estimation. Meanwhile should use a consensus MLE tree instead.&lt;/li&gt;
&lt;li&gt;Trees are resolved to genus level, so traits should be genus averages (instead of subsamples).&lt;/li&gt;
&lt;li&gt;Ancestral state reconstruction under the Brownian Motion model is the most preliminary treatment, will certainly be interesting to consider the various multi-peak OU models and identify potential transitions between peaks, as well as power analysis for the model fits.&lt;/li&gt;
&lt;li&gt;Multidimensional trait inference should also be interesting&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Possible bug? The Homo/Pan and Gorilla/Pan nodes would be expected to be in the Gorilla/Pan colour rather than the Homo colour.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;code-and-data-on-github&quot;&gt;Code and data on Github&lt;/h3&gt;
&lt;p&gt;New github repository for sharing code and data: &lt;strong&gt;&lt;a href=&quot;http://github.com/cboettig/sandbox&quot; title=&quot;http://github.com/cboettig/sandbox&quot;&gt;sandbox&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Grab this repository using git:&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; git clone git://github.com/cboettig/sandbox.git&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Revert to this edit’s version of code and data using git:&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; git checkout 77af6613db294ca068cf&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://github.com/downloads/cboettig/sandbox/sandbox_0.0-1.tar.gz&quot; title=&quot;http://github.com/downloads/cboettig/sandbox/sandbox_0.0-1.tar.gz&quot;&gt;Download&lt;/a&gt; the snapshot as an R package. More information on the &lt;a href=&quot;http://github.com/cboettig/sandbox/downloads&quot; title=&quot;http://github.com/cboettig/sandbox/downloads&quot;&gt;downloads page&lt;/a&gt; of repository.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Carl Boettiger 16:17, 5 May 2010 (EDT)&lt;/strong&gt;:&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Updated git version using R package is:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; git checkout b1a90ad97b90d9cbeaa7&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Alan Meeting</title>
	 <link href="/2010/05/04/Alan-Meeting.html"/>
   <updated>2010-05-04T00:00:00+00:00</updated>
   <id>/05/04/Alan-Meeting</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Goals next week: Bob &amp;amp; Brian beetle data: what an analysis would be with complete stochastic description.&lt;/li&gt;
&lt;li&gt;Compare models with different&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Full model: Parameter list from current code:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt; /* Biological Parameters.  eggs and pupa can get canibalized */
    double b = 5;                                                   /* Birth rate (per day) */
    double u_egg = 0, u_larva = 0.001, u_pupa = 0, u_adult = 0.003; /* Mortality rate (per day) */
    double a_egg = 3.8, a_larva = 3.8+16.4, a_pupa = 3.8+16.4+5.0;    /* age at which each stage matures, in days */
    double cannibal_larva_eggs = 0.01, cannibal_adults_pupa = 0.004, cannibal_adults_eggs = 0.01; /* cannibalism of x on y, per day */
    double a_larva_asym = 3.8+8.0;                                  /* age after which larval size asymptotes */&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Add &lt;strong&gt;individual heterogeneity&lt;/strong&gt; in egg and larva maturation age and in cannibalism of larva on eggs.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;outline-manuscript-draft&quot;&gt;Outline / manuscript draft&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.google.com/Doc?docid=0AR6sK_1tc7DZZGdmYnQyZzVfOTI5ams5NnRjMw&amp;amp;hl=en&quot; title=&quot;http://docs.google.com/Doc?docid=0AR6sK_1tc7DZZGdmYnQyZzVfOTI5ams5NnRjMw&amp;amp;hl=en&quot;&gt;Working copy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;likelihood-inference-for-time-series&quot;&gt;Likelihood inference for time series&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;All based on step-ahead predictions, from Markov property. Compare to deterministic skeleton’s minimization of sum of squares on step-ahead predictions (i.e. assumes normal deviates).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; See the monographs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Iacus, S. M. (2008). Simulation and Inference for Stochastic Differential Equations With R Examples. New York: Springer.&lt;/li&gt;
&lt;li&gt;Prakasa Rao, B.L.S. (1999) Statistical Inferences for Diffusion Type Processes, Oxford University Press, New York.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Exploring existing implementations of likelihood methods on SDEs through the R sde package accompanying the Iacus text.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Many nice methods for SDEs, general case is harder.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;conditions&quot;&gt;Conditions&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Large sample scheme&lt;/em&gt; Time interval gets longer with &lt;em&gt;n&lt;/em&gt;, while Δ is fixed time-step. Requires the additional assumptions of stationarity and/or ergodicity&lt;/li&gt;
&lt;li&gt;&lt;em&gt;High-frequency scheme&lt;/em&gt;: Δ shrinks as n increases, fixed window, need not assume ergodic.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Rapidly increasing design&lt;/em&gt;: hybrid combination with prescribed rate of mesh increase &lt;em&gt;k&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;underlying-model&quot;&gt;Underlying model&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;d&lt;strong&gt;X&lt;em&gt;&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt; = &lt;/em&gt;b&lt;em&gt;(&lt;/em&gt;X&lt;em&gt;&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt;,θ)&lt;/em&gt;d&lt;/strong&gt;t&lt;/em&gt; + σ(&lt;em&gt;X&lt;/em&gt;&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt;,θ)*d**W*&lt;sub&gt;&lt;em&gt;t&lt;/em&gt;&lt;/sub&gt;&lt;/p&gt;
&lt;h4 id=&quot;exact-likelihood-conditions&quot;&gt;Exact Likelihood conditions&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Linear growth assumption:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/f/0/f/f0fa18eefeb2fe80bd3f95ed6c6074a4.png&quot; alt=&quot;\exists \quad K \quad :: \quad \forall \quad x&quot; /&gt;&lt;figcaption&gt;\exists \quad K \quad :: \quad \forall \quad x&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/2/8/228467066aa1ebca79a987e2b36fecb4.png&quot; alt=&quot;|b(x,\theta)| + |\sigma(x,\theta)| \leq K(1+|x|)&quot; /&gt;&lt;figcaption&gt;|b(x,\theta)| + |\sigma(x,\theta)| \leq K(1+|x|)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Global Lipshitz assumption:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;b&lt;/em&gt;(&lt;em&gt;x&lt;/em&gt;,θ) − &lt;em&gt;b&lt;/em&gt;(&lt;em&gt;y&lt;/em&gt;,θ) | + σ(&lt;em&gt;x&lt;/em&gt;,θ) − σ(&lt;em&gt;y&lt;/em&gt;,θ) &amp;lt; &lt;em&gt;K&lt;/em&gt; | &lt;em&gt;x&lt;/em&gt; − &lt;em&gt;y&lt;/em&gt; |&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Positive diffusion coefficient&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Bounded moments&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Smooth coefficients (will use up to 3 times differentiable)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Convergence of diffusion part estimator usually &lt;img src=&quot;http://openwetware.org/images/math/3/3/f/33f89d8758a725273b6b80612bb65276.png&quot; alt=&quot;\sqrt n&quot; /&gt;, with &lt;img src=&quot;http://openwetware.org/images/math/4/3/2/432462b0b23ad64c9a1b29f761adb36f.png&quot; alt=&quot;n \Delta_n^3 \to 0&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;numerical-methods&quot;&gt;Numerical methods&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Exact likelihood inference (conditional density of process must be known)&lt;/li&gt;
&lt;li&gt;Euler approximation: discretization can assume linearity over small Δt&lt;/li&gt;
&lt;li&gt;Elerian method (Milstein scheme)&lt;/li&gt;
&lt;li&gt;Kessler (higher order Ito/Taylor expansion)&lt;/li&gt;
&lt;li&gt;Simulated likelihood (approximate cdf with subdivisions in timestep over which Euler is accurate).&lt;/li&gt;
&lt;li&gt;Hermite polynomial expansion of likelihood.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; #### Steps&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Evaluate the conditional density function&lt;/li&gt;
&lt;li&gt;Evaluate the likelihood function (will be used as single step predictor)&lt;/li&gt;
&lt;li&gt;maximum likelihood estimation&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;code-updates&quot;&gt;Code updates&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Swapped out my original linked list library for a more intelligent one. Not sure why pointer pointers are so useful but valgrind is happy.&lt;/li&gt;
&lt;li&gt;beetle simulator now creates step-ahead realizations.&lt;/li&gt;
&lt;li&gt;Considerations: replicates in C or R? would be better if R preserved the openmp code, but can always use parallel R to loop over timesteps and benefit from compiled speed on replicates.&lt;/li&gt;
&lt;li&gt;Kernel density estimation for assigning probabilities? Probably reserve at R level at the moment.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Misc Reading &amp;amp; Notes ——————–&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/05/04/Adaptive-Dynamics.html"/>
   <updated>2010-05-04T00:00:00+00:00</updated>
   <id>/05/04/Adaptive-Dynamics</id>
   <content type="html">&lt;h3 id=&quot;wide-gap-flat-landscape&quot;&gt;Wide gap, flat landscape&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Waiting times on a flatter landscape: sigma_c ~ sigma_k. Waiting times are dominated by the number of times phase 3 collapses: the established invader in a dimorphic population (right panels). Collapse of phase 2: collapse of the dimorphism before third population can establish is much rarer (about an order of magnitude).&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/0/06/Distribution3.png/400px-Distribution3.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;from the run3 dataset, with parameters.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;narrower-gap-steeper-landscape&quot;&gt;Narrower gap, steeper landscape&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;with sigma_c &amp;lt;&amp;lt; sigma_k, branching is easy, neither phase is particularly limiting, though single collapses from both phases are very common.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/4/48/Distribution4.png/400px-Distribution4.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;from the run4 dataset.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;slower-mutation-bigger-steps&quot;&gt;Slower mutation, bigger steps&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Trying flat landscape with smaller mu, larger sigma_mu, see if phase 2 becomes limiting. (run5 dataset). Pars: mu = 5e-4, sigma_mu = .05, sigma_c2 = .8,&lt;/li&gt;
&lt;li&gt;Just finished running, very few achieved branching! Should repeat with narrower competition kernel.&lt;/li&gt;
&lt;li&gt;Mean number of failures from phase 2: 240, from phase 3: 330, so not order of magnitude different anymore but phase 3 still limiting.&lt;/li&gt;
&lt;li&gt;Very interesting, seems the stdev of failures is much smaller for both! (24, 30 respectively)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/8/8e/Distribution5.png&quot; alt=&quot;Image:Distribution5.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Run6: as before, but mu=.0001, sigma_c2 = .3. Phase 2 is truly more limiting. A different mechanism to branching – rare large jump vs series of rapid small steps.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/6/65/Distribution6.png&quot; alt=&quot;Image:Distribution6.png&quot; /&gt;&lt;figcaption&gt;Image:Distribution6.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/05/03/Adaptive-Dynamics.html"/>
   <updated>2010-05-03T00:00:00+00:00</updated>
   <id>/05/03/Adaptive-Dynamics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Working on simulation based approach to summarize distribution of waiting times across different phases.&lt;/li&gt;
&lt;li&gt;What to do about zeros in phase two (when first dimorphism survives long enough to be invaded…)&lt;/li&gt;
&lt;li&gt;Quantify number/distribution of failed attempts at each phase? How to represent these distributions across a parameter space in sigma_c, sigma_k, sigma_mu, and mu?&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/1e/Distribution.png/180px-Distribution.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;library(BranchingTime)
sim &amp;lt;- branching_time(rep=1000, cpu=8)
save(file = &amp;quot;run1.Rdat&amp;quot;)
pdf(&amp;quot;distribution.pdf&amp;quot;)
m &amp;lt;- max(sim$data)
plot(density(sim$data[1,]), xlim = c(0,m), col=&amp;quot;black&amp;quot; )
lines(density(sim$data[2,] ), col = &amp;quot;blue&amp;quot;)
lines(density(sim$data[3,] ), col = &amp;quot;green&amp;quot;)
lines(density(sim$data[4,] ), col = &amp;quot;red&amp;quot;)
legend(&amp;#39;topright&amp;#39;, c(&amp;quot;1&amp;quot;, &amp;quot;2&amp;quot;, &amp;quot;3&amp;quot;, &amp;quot;4&amp;quot;), col=c(&amp;quot;black&amp;quot;, &amp;quot;blue&amp;quot;, &amp;quot;green&amp;quot;, &amp;quot;red&amp;quot;), pch = 15)
dev.off()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;http://dl.dropbox.com/u/3982238/run1.Rdat&quot; title=&quot;http://dl.dropbox.com/u/3982238/run1.Rdat&quot;&gt;data output&lt;/a&gt; for plot, parameters, etc in dropbox.&lt;/p&gt;
&lt;h2 id=&quot;michael-eisen-visit&quot;&gt;Michael Eisen Visit&lt;/h2&gt;
&lt;p&gt;11pm-noon&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Excellent &lt;a href=&quot;http://twitpic.com/1kpdfm&quot; title=&quot;http://twitpic.com/1kpdfm&quot;&gt;talk&lt;/a&gt; &amp;amp; discussion with Michael Eisen and the Davis Open Science group today. Video of the discussion to be posted shortly. We’ll be discussing the talk and potential for activism among the open science group at the social on Wednesday.&lt;/li&gt;
&lt;li&gt;Talk got me thinking about lots of things. Strong examples of the how broken the current system is: not only in the frequency of errors but the difficulty in correcting them – a paper in high impact journal that has been contradicted repeatedly in other literature remains the most cited. Also the credibility assigned to the accuracy of peer review out of proportion with the rigor of the process – most papers are published sooner or later. Better if another standard assured credibility than publication in a peer reviewed journal alone. Goal of review process is to reject papers, makes novel papers harder to publish than more traditional ones. Much of the advice you hear about making successful publications has little to do with the science. (And how about everything is miscellaneous approach to science?)&lt;/li&gt;
&lt;li&gt;simply pointing out how flawed the system is wasn’t solving anything, even though most tended to agree. So started PLoS. Next year PLoS ONE will be the biggest journal and is financially self-supporting, Other evidence of successful open access models: biomed central sold for (some large amount) to Elsevier.&lt;/li&gt;
&lt;li&gt;Commenting system on papers does not seem to be working. Interesting discussion of anonymous/signed versions, and filtering/validating comments, and provocative view of being able to know what everyone in your field thought of each thing they read – custom view/lens of a paper, choose your own reviewers style reading.&lt;/li&gt;
&lt;li&gt;Best place for Open Science Group to take a role: Challenging Intellectual Property policy at UC. Berkeley example: IP department costs more to maintain than IP generates in revenue, and resources are not available to the public – at a time when UC is most in need of public support. Meanwhile private universities such as Harvard are doing much better in open policies. More stats on this would be great.&lt;/li&gt;
&lt;li&gt;Situation isn’t as bad as you think – data does not support the myth that you need Science/Nature papers to get a job. Getting high profile papers isn’t necessarily the reason for getting the job, correlation doesn’t imply causation. More data on this would be great as well.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Reading ——-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://hdl.handle.net/10.1016/j.cell.2010.04.019&quot; title=&quot;doi:10.1016/j.cell.2010.04.019&quot;&gt;Cell article&lt;/a&gt; on Social Networks in science&lt;/li&gt;
&lt;li&gt;Alex has me thinking about &lt;a href=&quot;http://www.office-ergo.com/setting.htm&quot; title=&quot;http://www.office-ergo.com/setting.htm&quot;&gt;ergonomics / light levels&lt;/a&gt; for office&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Phase1</title>
	 <link href="/2010/05/01/phase1.html"/>
   <updated>2010-05-01T00:00:00+00:00</updated>
   <id>/05/01/phase1</id>
   <content type="html">&lt;p&gt;&lt;strong&gt;editorial note&lt;/strong&gt;: These notes pre-date the formal start of my online laboratory notebook, &lt;a href=&quot;http://carlboettiger.info/2010/02/02/The-Lab-Notebook-Goes-Open-.html&quot;&gt;Feb 2 2010: The Lab Notebook Goes Open&lt;/a&gt; and were adapted from a LaTeX document in which I kept notes on this topic during my summer at &lt;a href=&quot;http://www.iiasa.ac.at/&quot;&gt;IIASA&lt;/a&gt;. Lacking a proper notebook then, documents like this one were updated periodically and occassionally branched into new ones. The post date represents the last time the LaTeX document was edited in the course of that research.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;We consider the classic adaptive dynamics model for evolutionary branching under competition for a limiting resource by Dieckmann and Doebeli (1999). The population dynamics of &lt;span class=&quot;math&quot;&gt;\(N(x,t)\)&lt;/span&gt; individuals each with focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; are given by a continuous time birth-death process with rates&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
b(N) = &amp;amp; r \nonumber \\
d(N) = &amp;amp; r \frac{\sum_yN(y,t)C(x,y)}{K(x)} .\label{general_logistic}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; can be thought of as some continuous phenotypic variable, such as beak size, which affects resource consumption. Niche differences driving speciation arise from differences in this trait. In the model, &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; is the resource kernel which determines the equilibrium population density and &lt;span class=&quot;math&quot;&gt;\(C(x,y)\)&lt;/span&gt; is a the competition kernel, describing the relative change in death rate of individuals of type &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; due to competition by individuals of type &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;. Given &lt;span class=&quot;math&quot;&gt;\(C(x,x)=1\)&lt;/span&gt;, the equilibrium density of a monomorphic population is &lt;span class=&quot;math&quot;&gt;\(N^{\ast}(x)=K(x)\)&lt;/span&gt;. We assume the following Gaussian forms,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[K(x)=K_0e^{-x^2/(2\sigma_k^2)}, \label{K}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[C(x,y)=e^{-(x-y)^2/(2\sigma_c^2)}, \label{C}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\sigma_k\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; are scale factors for the resource distribution and competition kernels respectively. &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; can be though of as the niche size. We focus on the case &lt;span class=&quot;math&quot;&gt;\(\sigma_k&amp;gt;\sigma_c\)&lt;/span&gt;, for which the model has an evolutionary branching point at &lt;span class=&quot;math&quot;&gt;\(x=0\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The evolutionary dynamics are specified only at the phenotypic level: We assume that with probability &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt; an individual birth results in a mutant offspring, and that the mutant trait is chosen from a Gaussian distribution centered at the trait value of the parents and with a variance &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}^2\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Classically, the approach to the branching point is governed by the canonical equation of adaptive dynamics. To account for branching we have to revisit the original derivation of this equation where we relax the limit of small mutational steps sufficiently to allow mutants to enter the coexitence region, &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt;. The derivation of the canonical equation integrates only over those mutants that fall into the invasion-substitution region, &lt;span class=&quot;math&quot;&gt;\(P_1\)&lt;/span&gt;. However, since the derivation is done in the limit of small mutational step sizes, this encompasses essentially all of the weight of the mutational kernel, and to good approximation can thus be replaced with the entire &lt;span class=&quot;math&quot;&gt;\(P_1 \cup P_2\)&lt;/span&gt; region. Recall that in the derivation of the canonical equation, deleterious mutations are given zero probability of fixing (from the branching process approximation), and hence this corresponds to integrating over half of the real line &lt;span class=&quot;math&quot;&gt;\(\mathbb{R}\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\mathrm{d}\bar x}{\mathrm{d}t} = \mu N^*(x) \phantom \cdot \partial_y s(y,x) \Big|_x \int_{P_1} [y-x]^2 M(y-x) \mathrm{d}[y-x]
\label{canonical}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The probability of such a mutant occurring in our monomorphic population of trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; is given by the probability that any mutant occurs (given by the population size, approximately &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; at equilibrium, times the birth rate &lt;span class=&quot;math&quot;&gt;\(b(x)\)&lt;/span&gt; times the mutation rate &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt;) times the probability that the mutation lies on the opposite side of the coexistence boundary, which we denote as &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\psi(x)\)&lt;/span&gt;, which is &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; reflected across the line &lt;span class=&quot;math&quot;&gt;\(y=x\)&lt;/span&gt;. This depends on the mutational kernel, &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; which gives the probability that a mutant arising from a resident population of trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; bears trait &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt; that falls withing the coexistance region as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\int_{-\infty}^{\phi(x)} M(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) \mathrm{d}y\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Without loss of generality let us assume that the singular strategy &lt;span class=&quot;math&quot;&gt;\(x^* = 0\)&lt;/span&gt; and that we start from some trait value &lt;span class=&quot;math&quot;&gt;\(x_0 &amp;gt; x^*\)&lt;/span&gt;. Additionally, let us we assume &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; is Gaussian in &lt;span class=&quot;math&quot;&gt;\(y-x\)&lt;/span&gt; with mean 0 and variance &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}^2\)&lt;/span&gt;. However, we do not wish to consider all such mutants &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;, but only those that survive. We multiply the probability of a mutant having trait &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;, &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt;, times the probability that is survives drift. This probability we quote from the Galton-Watson branching process, &lt;span class=&quot;math&quot;&gt;\(1-\tfrac{d(y,x)}{b(y,x)}\)&lt;/span&gt;. Using our model for birth and death rates , the probability of surviving branching is&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[1-\frac{C(y,x)K(x)}{K(y)} := S(y,x)
\label{S}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;which we denote as &lt;span class=&quot;math&quot;&gt;\(S(y,x)\)&lt;/span&gt; as indicated. Hence we modify our integral to consider all mutants &lt;span class=&quot;math&quot;&gt;\(y &amp;lt; x^*\)&lt;/span&gt; which occur with probability &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; and then survive with probability &lt;span class=&quot;math&quot;&gt;\(S(y,x)\)&lt;/span&gt;, and write down the rate &lt;span class=&quot;math&quot;&gt;\(P(x)\)&lt;/span&gt; at which a mutant which leads to branching occurs from our monomorphic population with trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[P(x) := r \mu K(x)\left( \int_{-\infty}^{\phi(x)} M(y,x) S(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) S(y,x) \mathrm{d}y  \right)
\label{MSerf}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Though a little cumbersome, this can be written in nearly closed form (using the error function). For our particular model &lt;span class=&quot;math&quot;&gt;\(s(y,x)\)&lt;/span&gt;, we can write the boundaries &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\psi(x)\)&lt;/span&gt; as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\phi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}+1}{\frac{\sigma_k^2}{\sigma_c^2}-1} \nonumber \\
\psi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}-1}{\frac{\sigma_k^2}{\sigma_c^2}+1}
\label{phipsi}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then, given a starting condition &lt;span class=&quot;math&quot;&gt;\(x_0\)&lt;/span&gt;, we can determine the expected trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; at time &lt;span class=&quot;math&quot;&gt;\(t\)&lt;/span&gt; of a monomorphic resident population by integrating the canonical equation,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{1}{2} \mu \sigma_{mu}^2 N^*(x) \partial_y s(y,x)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;which for our model is&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{-x}{2\sigma_k^2} r \mu \sigma_{\mu}^2 K(x)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;While no closed form solution exists for &lt;span class=&quot;math&quot;&gt;\(x(t)\)&lt;/span&gt; in this case, if we assume &lt;span class=&quot;math&quot;&gt;\(x_0 \ll \sigma_k\)&lt;/span&gt; then to good approximation we can view &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; to be constant over the interval and take our path to be:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[x(t) = x_0 \exp\left( -r \mu \sigma_{\mu}^2 K_0 t/\sigma_k^2\right)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Using this mean path, we can write down an approximation for the rate of a branching mutant occurring as a function of time, &lt;span class=&quot;math&quot;&gt;\(P(x(t))\)&lt;/span&gt;. Using this time dependent rate, the probability of not branching after time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt; is simply &lt;span class=&quot;math&quot;&gt;\(\exp\left( - \int_0^T P(t)\mathrm{d}t \right)\)&lt;/span&gt;. One minus this is the probability branching by time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt;; i.e. the cumulative density function, hence the probability density function for the waiting time is:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\Pi(T) = P(x(T)) \exp\left( -\int_0^T P(x(t)) \right)
\label{pdf}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the expected time to complete phases 1 and 2 is &lt;span class=&quot;math&quot;&gt;\(\int_0^{\infty} T \Pi(T) \mathrm{d}T\)&lt;/span&gt;. This is our first analytic approximation.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Coexistence Of The Early Dimorphism</title>
	 <link href="/2010/05/01/coexistence-of-the-early-dimorphism.html"/>
   <updated>2010-05-01T00:00:00+00:00</updated>
   <id>/05/01/coexistence-of-the-early-dimorphism</id>
   <content type="html">&lt;p&gt;&lt;strong&gt;editorial note&lt;/strong&gt;: These notes pre-date the formal start of my online laboratory notebook, &lt;a href=&quot;http://carlboettiger.info/2010/02/02/The-Lab-Notebook-Goes-Open-.html&quot;&gt;Feb 2 2010: The Lab Notebook Goes Open&lt;/a&gt; and were adapted from a LaTeX document in which I kept notes on this topic during my summer at &lt;a href=&quot;http://www.iiasa.ac.at/&quot;&gt;IIASA&lt;/a&gt;. Lacking a proper notebook then, documents like this one were updated periodically and occassionally branched into new ones. The post date represents the last time the LaTeX document was edited in the course of that research.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;We consider the classic adaptive dynamics model for evolutionary branching under competition for a limiting resource by Dieckmann and Doebeli (1999). The population dynamics of &lt;span class=&quot;math&quot;&gt;\(N(x,t)\)&lt;/span&gt; individuals each with focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; are given by a continuous time birth-death process with rates&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
b(N) = &amp;amp; r \nonumber \\
d(N) = &amp;amp; r \frac{\sum_yN(y,t)C(x,y)}{K(x)} .\label{general_logistic}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; can be thought of as some continuous phenotypic variable, such as beak size, which affects resource consumption. Niche differences driving speciation arise from differences in this trait. In the model, &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; is the resource kernel which determines the equilibrium population density and &lt;span class=&quot;math&quot;&gt;\(C(x,y)\)&lt;/span&gt; is a the competition kernel, describing the relative change in death rate of individuals of type &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; due to competition by individuals of type &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;. Given &lt;span class=&quot;math&quot;&gt;\(C(x,x)=1\)&lt;/span&gt;, the equilibrium density of a monomorphic population is &lt;span class=&quot;math&quot;&gt;\(N^{\ast}(x)=K(x)\)&lt;/span&gt;. We assume the following Gaussian forms,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[K(x)=K_0e^{-x^2/(2\sigma_k^2)}, \label{K}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[C(x,y)=e^{-(x-y)^2/(2\sigma_c^2)}, \label{C}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\sigma_k\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; are scale factors for the resource distribution and competition kernels respectively. &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; can be though of as the niche size. We focus on the case &lt;span class=&quot;math&quot;&gt;\(\sigma_k&amp;gt;\sigma_c\)&lt;/span&gt;, for which the model has an evolutionary branching point at &lt;span class=&quot;math&quot;&gt;\(x=0\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The evolutionary dynamics are specified only at the phenotypic level: We assume that with probability &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt; an individual birth results in a mutant offspring, and that the mutant trait is chosen from a Gaussian distribution centered at the trait value of the parents and with a variance &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}^2\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Consider a population of two coexisting types, characterized by traits &lt;span class=&quot;math&quot;&gt;\(x_1\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(x_2\)&lt;/span&gt; respectively. The birth and death rates of each population are then given by expression  . We’ll assume that the populations can coexist, that is &lt;span class=&quot;math&quot;&gt;\((x_1, x_2)\)&lt;/span&gt; falls into the coexistence region &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt;; &lt;em&gt;i.e.&lt;/em&gt; that $C(x_1,x_2)K(x_2) /K_1(x_1) &amp;lt; 1 $ and &lt;span class=&quot;math&quot;&gt;\(C(x_1, x_2) K(x_1)/K(x_2) &amp;lt; 1\)&lt;/span&gt;. This guarentees that each population has a positive expected growth rate when rare. However, because the population is composed of finitely many discrete individuals, there is still a chance that either type will be lost to chance; to demographic stochasticity. We whish to characterize the expected waiting time for such an event to occur.&lt;/p&gt;
&lt;p&gt;To do so, we will switch first into density and then frequency, to obtain a one-dimensional expression we can solve exactly. We will then use the Arhennius approximation to obtain a closed form solution. First, we will replace the discrete number of individuals &lt;span class=&quot;math&quot;&gt;\(N\)&lt;/span&gt; with the macroscopic, continuous variable &lt;span class=&quot;math&quot;&gt;\(n\)&lt;/span&gt;, representing the mean &lt;em&gt;density&lt;/em&gt; of individuals; &lt;span class=&quot;math&quot;&gt;\(N/A\)&lt;/span&gt;, where &lt;span class=&quot;math&quot;&gt;\(A\)&lt;/span&gt; is the area in which &lt;span class=&quot;math&quot;&gt;\(N\)&lt;/span&gt; individuals are found. For suitably large &lt;span class=&quot;math&quot;&gt;\(A\)&lt;/span&gt;, we will be able to accurately describe &lt;span class=&quot;math&quot;&gt;\(n\)&lt;/span&gt; with a coupled stochastic differential equation for each population. By changing variables once more into the frequency of one type, &lt;span class=&quot;math&quot;&gt;\(p = n_1/(n_1+n_2)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(n = n_1 + n_2\)&lt;/span&gt;, we are able to do a timescale seperation to focus on the dynamics in a single variable, &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The master equation that describes the probability of observing &lt;span class=&quot;math&quot;&gt;\(N_i\)&lt;/span&gt; individuals of type &lt;span class=&quot;math&quot;&gt;\(i\)&lt;/span&gt; is given by,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\mathrm{d}}{\mathrm{d}t} P(N_1,t) &amp;amp;= (\text{E}_1 - 1) r N_1 \frac{N_1 + C(x_1, x_2) N_2}{K(x_1) }P(N_1) + (\text{E}_1^{-1} - 1)r N_1 P(N_1) \nonumber \\
\frac{\mathrm{d}}{\mathrm{d}t} P(N_2,t) &amp;amp;= (\text{E}_2 - 1) r N_2 \frac{N_2 + C(x_2, x_1) N_1}{K(x_2) }P(N_2) + (\text{E}_2^{-1} - 1)r N_2 P(N_2)
\label{mastereq}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\text{E}_i^k\)&lt;/span&gt; is the step operator taking &lt;span class=&quot;math&quot;&gt;\(f(N_i) \to f(N_{i+k})\)&lt;/span&gt;. We apply van Kampen’s expansion of the master equation to linear order to recover the following stochastic differential equation (Itô equation)&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\mathrm{d}n_1 = r n_1 \left(1 -  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o} } \sqrt{r n_1 \left(1 +  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) } \mathrm{d}W_1
\label{sde}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and &lt;span class=&quot;math&quot;&gt;\(n_2\)&lt;/span&gt; similarly. Switching into the variables for frequency, &lt;span class=&quot;math&quot;&gt;\(p = n_1/n\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(n = n_1+n_2\)&lt;/span&gt; and simplying notation by &lt;span class=&quot;math&quot;&gt;\(C(x_1, x_2) = c_{12}\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(K(X_i) = k_i\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\mathrm{d}p &amp;amp;= r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o n(p)} } \sqrt{r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right) } \mathrm{d}W_1  \label{freq_sde} \\
n(p) &amp;amp;=  \frac{k_1 k_2}{k_2 p^2 + (k_1+k_2) c_{12} p (1-p) + k1 (1-p)^2 }, \end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where we have set the dynamic equation for &lt;span class=&quot;math&quot;&gt;\(n(p)\)&lt;/span&gt; to equilibrium. The extinction probability &lt;span class=&quot;math&quot;&gt;\(u(p,t)\)&lt;/span&gt; for this expression is given by the Backwards equation for the generator,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \underbrace{r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right)}_{A(p)} \partial_p u(p,t) + \tfrac{1}{2} \underbrace{\frac{1}{K_o n(p) } r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right)}_{B(p)} \partial_p^2 u(p,t) 
\label{u}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;with the boundary conditions &lt;span class=&quot;math&quot;&gt;\(u(0,t) = 1\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(u(1,t) = 1\)&lt;/span&gt; being absorbing.&lt;/p&gt;
&lt;p&gt;Assuming that type 1 is the rare mutant invader, we can solve this explicitly for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;, and particularly for the case of exactly one new mutant. After some rearrangement we can rewrite this as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{gathered}
\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \left( rp \left( 1-\frac{n c_{12}}{k_1} \right) - \frac{r n}{k_1} p^2 (1 - c_{12} )\right)  \partial_p u(p,t) \\
+ \left( rp \left(1+\frac{n c_{12}}{k_1}\right)  + \frac{r n }{k_1} p^2 (1 - c_{12} ) \right) \frac{\partial_p^2 u(p,t)}{2K_0 n}\end{gathered}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Note then for &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; small we can neglect the terms quadratic in &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; and we are left with the backwards equation from the density independent case,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) =  rp \left( 1-\frac{n c_{12}}{k_1} \right)   \partial_p u(p,t) + rp \left(1+\frac{n c_{12}}{k_1}\right)   \frac{\partial_p^2 u(p,t)}{2K_0 n}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Setting equal to zero we have a simple ordinary differential equation for the stationary extinction probability:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
u(p) &amp;amp;= 1 - e^{-2sp K_0 n} \\
s &amp;amp;= \frac{r\left( 1-\frac{n c_{12}}{k_1} \right) }{ r\left(1+\frac{n c_{12}}{k_1}\right)} \end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and particularly for a frequency &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; corresponding to a single individual, a frequency of &lt;span class=&quot;math&quot;&gt;\(p=1/(N_1+N_2) =(1/K_0)/(n_1+n_2) = 1/(K_0 n)\)&lt;/span&gt;, this reduces to&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[u = 1-e^{-2s}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Assuming $ rp ( 1- ) 0$, the time-dependent solution&lt;a href=&quot;#fn1&quot; class=&quot;footnoteRef&quot; id=&quot;fnref1&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; is:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
u(p,t) &amp;amp;= 1-e^{-p \psi(t) } \\
\psi(t) &amp;amp;= \frac{2 s K_0 n}{1-e^{ r\left( 1-\frac{k_2 c_{12}}{k_1} \right) t } }
\label{timedep}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Larger population (system size) &lt;span class=&quot;math&quot;&gt;\(K_o\)&lt;/span&gt; results in longer persistance.&lt;/p&gt;
&lt;p&gt;This tells us nothing about the survival of the resident, as it is only valid for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;. In most applications of this approach, it is assumed the resident quickly goes extinct once &lt;span class=&quot;math&quot;&gt;\(p \sim o(1)\)&lt;/span&gt;. If we consider the asymptotic behavior of the nonlinear PDE, Eq. , we see sure absorbtion at one boundary or the other. The asymptotic behavior needn’t concern us; as we really want to know how the expected lifetime of this dimporphic state compares with the rate at which mutants are entering this population. To do so we need the time dependent solution to the nonlinear backwards equation .&lt;/p&gt;
&lt;p&gt;While a direct solution to the nonlinear PDE is not available, we can solve for the moments analytically. As &lt;span class=&quot;math&quot;&gt;\(u(p,t)\)&lt;/span&gt; is the probability of non-extinction, that is, that the exit time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt; is greater than the current time &lt;span class=&quot;math&quot;&gt;\(t\)&lt;/span&gt;; e.g. &lt;span class=&quot;math&quot;&gt;\(u\)&lt;/span&gt; is the cumululative probability density. Consequently the mean exit time &lt;span class=&quot;math&quot;&gt;\(T(p)\)&lt;/span&gt; is given by,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[T(p) = - \int_0^\infty t \partial_t u(p,t) \mathrm{d}t = \int_0^\infty u(p,t) \mathrm{d}t \label{simple}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where we have integrated by parts to get the second expression. Meanwhile, we can integrate the left-hand side of ,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\int_0^{\infty} \partial_t u(p,t) \mathrm{d}t = u(p,\infty) - u(p,0) = -1\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and integrate the right hand side using  to get&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[A(p) \partial_p T(p) + \tfrac{1}{2} B(p) \partial_p^2 T(x) = -1\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This can be integrated directly to solve for the mean time starting from &lt;span class=&quot;math&quot;&gt;\(p=x\)&lt;/span&gt; to be absorbed at either boundary &lt;span class=&quot;math&quot;&gt;\(a=0\)&lt;/span&gt; or &lt;span class=&quot;math&quot;&gt;\(b=1\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
T(x) &amp;amp;= \frac{2 \left[\left(\int_a^x\frac{\mathrm{d}y}{\psi(y)}\right)\int_x^b \frac{\mathrm{d}y&amp;#39;}{\psi(y&amp;#39;)} \int_a^{y&amp;#39;} \frac{\mathrm{d}z \psi(z)}{B(z)} - \left(\int_x^b\frac{\mathrm{d}y}{\psi(y)}\right)\int_a^x \frac{\mathrm{d}y&amp;#39;}{\psi(y&amp;#39;)} \int_a^{y&amp;#39;} \frac{\mathrm{d}z \psi(z)}{B(z)}\right]}{\int_a^b \frac{\mathrm{d}y}{\psi(y)}}
\label{7integrals} 
\intertext{where}
\psi(x) &amp;amp;= \exp\left( \int_0^x \mathrm{d}x&amp;#39; \frac{2A(x&amp;#39;)}{B(x&amp;#39;)} \right)\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Though these integrals can be computed numerically, a small noise limit (large populations) allows us to make an additional approximation by mapping this problem onto the familiar question of escape over a potential energy barrier. This question arises in basic chemistry, and is described by a similar stochastic differential equation where the &lt;span class=&quot;math&quot;&gt;\(A(x)\)&lt;/span&gt; coefficent represents the gradient of the energy surface and &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; the temperature. The analogy initially appears to fail, since in the chemical context the diffusion coefficent is determined by the temperature alone, and is independent of the state, while our &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; term depends on the frequency &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;. However, as it is not explicitly time dependent, there is always a transform to change variables into a context where &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; is constant. The relevant transformation for us is known as the Lamperti Transform. Switching variables from &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; to &lt;span class=&quot;math&quot;&gt;\(q\)&lt;/span&gt; by means of the transform:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[q = F(p) = \int_z^{p} \frac{1}{\sqrt{B(u)}} \mathrm{d}u
\label{p_to_q}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;we can rewrite  as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\partial u(q,t)}{\partial t} = \underbrace{\left(\frac{4 A(p)- \partial_p B(p) }{4\sqrt{B(p)}}  \right)}_{\nabla V(p)} \frac{\partial u(q,t)}{\partial q} + \frac{1}{2} \frac{\partial^2 u(q,t)}{\partial q^2}.
\label{new_u}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The mean first passage time in this transformed variable is still solved by . However, interpreting the coefficent of the drift term as the gradient of the energy landscape, &lt;span class=&quot;math&quot;&gt;\(\nabla V(p)\)&lt;/span&gt;, we can approximate that this time will scale as the exponent of the depth of the energy well defined by that landscape:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\exp{- (\min(V(0), V(1)) - V(p^*) )}\]&lt;/span&gt;&lt;/p&gt;
&lt;section class=&quot;footnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot;&gt;&lt;p&gt;note that &lt;span class=&quot;math&quot;&gt;\(n(p) \approx k_2\)&lt;/span&gt; for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;.&lt;a href=&quot;#fnref1&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/04/30/Adaptive-Dynamics.html"/>
   <updated>2010-04-30T00:00:00+00:00</updated>
   <id>/04/30/Adaptive-Dynamics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Modified code phase definitions: phasetime[0] is the first time dimorphism is established. Dimorphism may be lost and restablished, last (most recent) time it establishes is phasetime[1] (used to be phasetime[0]). Other times are still the most recent time at which the phase was accomplished.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fiddling with analytic approximations. These shouldn’t integrate to evaluate at each value, but should be done in a fully discretized system. Prototyping in R, the discrete version is probably fast enough to handle in scripted code alone.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/04/29/Adaptive-Dynamics.html"/>
   <updated>2010-04-29T00:00:00+00:00</updated>
   <id>/04/29/Adaptive-Dynamics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Manuscript writing.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;phylogenetics&quot;&gt;Phylogenetics&lt;/h2&gt;
&lt;p&gt;Submitted Lightning talk to iEvoBio&lt;/p&gt;
&lt;p&gt;PDG group will be discussing&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=18611849&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Rabosky DL and Lovette IJ. .&lt;/a&gt; pmid:18611849. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=18611849&quot; title=&quot;PMID 18611849&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=18611849&quot; title=&quot;PMID 18611849&quot;&gt;HubMed&lt;/a&gt; [1]&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;tomorrow, along with &lt;a href=&quot;http://hdl.handle.net/10.1098/rspb.2008.1249&quot; title=&quot;doi:10.1098/rspb.2008.1249&quot;&gt;critique&lt;/a&gt; and &lt;a href=&quot;http://hdl.handle.net/10.1098/rspb.2008.1584&quot; title=&quot;doi:10.1098/rspb.2008.1584&quot;&gt;response&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Waiting to hear back from Peter on manuscript.&lt;/li&gt;
&lt;li&gt;Should follow up with Ralph on likelihood ratio discussion with Ethan.&lt;/li&gt;
&lt;li&gt;Transcluding exploratory work on primate phylogeny data:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Embedded:&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Primate Phylogeny —————–&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Carl Boettiger 00:37, 30 April 2010 (EDT)&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Simon sent me the tree data from their paper:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=19860891&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Chatterjee HJ, Ho SY, Barnes I, and Groves C. .&lt;/a&gt; pmid:19860891. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=19860891&quot; title=&quot;PMID 19860891&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=19860891&quot; title=&quot;PMID 19860891&quot;&gt;HubMed&lt;/a&gt; [primates]&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;This is the first calibrated ultrametric tree I’ve been able to couple to the primate data Daniel provided. I’ve preformed a quick ancestral state reconstruction on log brain weight (warmer colors are more massive).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;img src=&quot;http://openwetware.org/images/9/96/Primates.png&quot; alt=&quot;Image:Primates.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### R code to create figure&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;library(ape)
library(geiger)
genera_set &amp;lt;- read.nexus(&amp;quot;mt.genera.ucld.trees&amp;quot;)
nuc_set &amp;lt;- read.nexus(&amp;quot;nuc.ucld.trees&amp;quot;)
genera &amp;lt;- genera_set[[1]]
nuc &amp;lt;- nuc_set[[1]]
nuc_names &amp;lt;- nuc$tip.label
genera_names &amp;lt;- genera$tip.label
traits &amp;lt;- read.csv(&amp;quot;Primate_brain_comparisons.csv&amp;quot;)
 
dups &amp;lt;- duplicated(traits[[&amp;#39;Genus&amp;#39;]])
trait_names &amp;lt;- as.character(traits$Genus[!dups])
x &amp;lt;- traits$log_brain.weight[!dups]
names(x) &amp;lt;- trait_names
 
 
compare &amp;lt;- treedata(nuc, x)
plot(compare$phy)
out &amp;lt;- ace(compare$data, compare$phy)
 
# a similar function but for the continuous ancestral state 
plot_cts_ancestor &amp;lt;- function(phy, data, ancestral){  
    plot(phy) # just to get treelength 
    treelen &amp;lt;- max(axisPhylo() )
    plot(compare$phy, cex=1, x.lim=1.3*treelen, edge.width=2)
    mycol &amp;lt;- function(x){
    tmp = (x - min(data)) /max(x-min(data)) 
    rgb(blue = 1-tmp, green=0, red = tmp )
    }
    nodelabels(pch=19, col=mycol(ancestral$ace), cex=1.5  )
    tiplabels(pch=19, col=mycol(data), cex=1.5, adj=0.5) # add tip color code
    }
plot_cts_ancestor(compare$phy, compare$data, out)&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;This is essentially just at the proof of concept level. A couple obvious steps:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;This uses a single tree from the posterior distribution of trees, which we’ll eventually want to average over in the parameter estimation. Meanwhile should use a consensus MLE tree instead.&lt;/li&gt;
&lt;li&gt;Trees are resolved to genus level, so traits should be genus averages (instead of subsamples).&lt;/li&gt;
&lt;li&gt;Ancestral state reconstruction under the Brownian Motion model is the most preliminary treatment, will certainly be interesting to consider the various multi-peak OU models and identify potential transitions between peaks, as well as power analysis for the model fits.&lt;/li&gt;
&lt;li&gt;Multidimensional trait inference should also be interesting&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Possible bug? The Homo/Pan and Gorilla/Pan nodes would be expected to be in the Gorilla/Pan colour rather than the Homo colour.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;code-and-data-on-github&quot;&gt;Code and data on Github&lt;/h3&gt;
&lt;p&gt;New github repository for sharing code and data: &lt;strong&gt;&lt;a href=&quot;http://github.com/cboettig/sandbox&quot; title=&quot;http://github.com/cboettig/sandbox&quot;&gt;sandbox&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Grab this repository using git:&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; git clone git://github.com/cboettig/sandbox.git&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Revert to this edit’s version of code and data using git:&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; git checkout 77af6613db294ca068cf&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://github.com/downloads/cboettig/sandbox/sandbox_0.0-1.tar.gz&quot; title=&quot;http://github.com/downloads/cboettig/sandbox/sandbox_0.0-1.tar.gz&quot;&gt;Download&lt;/a&gt; the snapshot as an R package. More information on the &lt;a href=&quot;http://github.com/cboettig/sandbox/downloads&quot; title=&quot;http://github.com/cboettig/sandbox/downloads&quot;&gt;downloads page&lt;/a&gt; of repository.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Carl Boettiger 16:17, 5 May 2010 (EDT)&lt;/strong&gt;:&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Updated git version using R package is:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- --&gt;
&lt;pre&gt;&lt;code&gt; git checkout b1a90ad97b90d9cbeaa7 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; Meetings ——–&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.math.ualberta.ca/~mlewis/&quot; title=&quot;http://www.math.ualberta.ca/~mlewis/&quot;&gt;Mark Lewis&lt;/a&gt; visiting UC Davis:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lunch w/ Graduate students, 12-1:30p&lt;/li&gt;
&lt;li&gt;Mark speaking in the Ecology and Evolution Seminar series today at 4pm.&lt;/li&gt;
&lt;li&gt;Dinner w/ Hastings lab, 6:30p&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;readingmisc&quot;&gt;Reading/Misc&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.tiddlywiki.com/&quot; title=&quot;http://www.tiddlywiki.com/&quot;&gt;TiddlyWiki&lt;/a&gt; option for a lab notebook. &lt;a href=&quot;http://deferentialgeometry.org/&quot; title=&quot;http://deferentialgeometry.org/&quot;&gt;Differential Geometry example&lt;/a&gt;. Might be a good option for an electronic notebook not intended to be completely open.&lt;/li&gt;
&lt;li&gt;Also Mario has &lt;a href=&quot;http://pineda-krch.com/2008/08/12/distributed-open-notebook-science/&quot; title=&quot;http://pineda-krch.com/2008/08/12/distributed-open-notebook-science/&quot;&gt;interesting thoughts&lt;/a&gt; about a distributed approach combining TiddlyWiki with git.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Meetings</title>
	 <link href="/2010/04/28/Meetings.html"/>
   <updated>2010-04-28T00:00:00+00:00</updated>
   <id>/04/28/Meetings</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Theory Coffee 10-11a: Varied discussion, including NEON project and future of large data.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hastings Lab Meeting 2-3p: David Kling presents bioeconomic model on assisted migration. Model focuses on dynamic and spatial aspects, reflects pattern of dispersal common in ideal free distribution with dynamic carrying capacity, adds linear and quadratic costs.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(Fire alarms in Wickson Hall don’t make for a productive day).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>iEvoBio lightning talk</title>
	 <link href="/2010/04/27/iEvoBio-lightning-talk.html"/>
   <updated>2010-04-27T00:00:00+00:00</updated>
   <id>/04/27/iEvoBio-lightning-talk</id>
   <content type="html">&lt;p&gt;Submitting a five minute lighting talk on open science. &lt;a href=&quot;/images/8/89/Lightning.pdf&quot; title=&quot;Lightning.pdf&quot;&gt;Submitted version here&lt;/a&gt;, final text below. See the page revision history for earlier drafts and the original &lt;a href=&quot;#Call_For_Lightning_Talks&quot;&gt;call&lt;/a&gt; below. Special thanks to Sam, Alistair, Betta, Shaun, and Alex for feedback.&lt;/p&gt;
&lt;h3 id=&quot;my-experiment-with-open-science-why-the-benefits-of-sharing-go-beyond-source-code&quot;&gt;My experiment with open science: Why the benefits of sharing go beyond source code&lt;/h3&gt;
&lt;p&gt;The practice and philosophy of open source run deep within the iEvoBio community. Sharing source code has made software development faster and more reliable. Reuse helps catch errors, develop standards, provide more extensible platforms and ensure scientific reproducibility. It has helped foster a community that can tackle problems that would be impossible for single labs. Can an “open-source” approach benefit other elements of research? I discuss how I am fostering open science throughout my research process from my reading, through code development, my lab notebook to feedback and conversation. I highlight three themes that I have found most valuable: (1) Facilitating access and reuse. Content that is legally and practically accessible makes for more reproducible science, better error checking, and farther impact as more people may see or build upon it. (2) Linking data. In a web-native environment, everything can be archived, linked, tagged with keywords and searched. In this way, my content can connect to that of other researchers working on similar questions, data, articles or algorthms. (3) Networking people. The most successful tools not only link data but link people. This provides a network of expertise, a filter of exponentially growing amounts of information, and a source of inspiration and collaboration. I will briefly describe four tools that embrace this approach in different elements of my own research.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Literature&lt;/strong&gt; (using &lt;a href=&quot;http://www.mendeley.com/profiles/carl-boettiger&quot; title=&quot;http://www.mendeley.com/profiles/carl-boettiger&quot;&gt;Mendeley&lt;/a&gt;): My bibliographies for each topic become publicly visible collections. When other researchers do the same, the content is automatically linked to see how many people in my field are reading what articles, authors, journals and also generates recommendations. This tool also provides a network of contacts, following other public collections or collaboratively adding to one.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Code Development&lt;/strong&gt; (using &lt;a href=&quot;http://www.github.com/cboettig&quot; title=&quot;http://www.github.com/cboettig&quot;&gt;Github&lt;/a&gt;): My code development is regularly committed to a public version management repository. One can follow line by line changes, view my commit log and visualize branches and merges in the project. The code can be downloaded in the state it was at any point in its history to replicate my work and be reused in other projects. Github’s social coding tools connects me to similar researchers whose work I can follow, pose questions or begin a direct collaboration.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Lab Notebook&lt;/strong&gt; (using &lt;a href=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics&quot; title=&quot;http://openwetware.org/wiki/User:Carl_Boettiger/Notebook/Comparative_Phylogenetics&quot;&gt;OpenWetWare&lt;/a&gt;): I keep a daily online lab notebook on a community wiki. This binds and shares all elements of my work, from readings and meetings to mathematical derivations and simulations. Graphs, code snippets, spreadsheets, references, and even conversations can be embedded directly into the notebook. I can search the complete text, and organize by tags, links, and the automatic versioning archive. This facilitate sharing my work with collaborators, and has helped me discover new datasets and collaborations from other users on the site.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Feedback&lt;/strong&gt; (using &lt;a href=&quot;http://phylogenetics.uservoice.com/forums/43843-general?lang=en&amp;amp;utm_campaign=Widgets&amp;amp;utm_content=tab-widget&amp;amp;utm_medium=widget&amp;amp;utm_source=phylogenetics.uservoice.com&quot; title=&quot;http://phylogenetics.uservoice.com/forums/43843-general?lang=en&amp;amp;utm_campaign=Widgets&amp;amp;utm_content=tab-widget&amp;amp;utm_medium=widget&amp;amp;utm_source=phylogenetics.uservoice.com&quot;&gt;uservoice&lt;/a&gt; and &lt;a href=&quot;http://stackoverflow.com/questions/2134583/looking-for-fast-algorithm-to-find-distance-between-two-nodes-in-binary-tree&quot; title=&quot;http://stackoverflow.com/questions/2134583/looking-for-fast-algorithm-to-find-distance-between-two-nodes-in-binary-tree&quot;&gt;stackoverflow&lt;/a&gt;): Before forums, asking a question meant knowing someone who knows the answer. Online tools make it possible to ask questions to particular expertise groups. Questions and replies can be tagged, linked, and searched; cites automatically search for existing similar questions. They can also be rated, drawing more focus to those with more value to the community, and contributions can be tracked and rewarded, while profiles help identify contributors and provide elements of a human network. This is also well adapted to feedback between users and developers.&lt;/p&gt;
&lt;p&gt;I find this approach saves time as it integrates naturally into my workflow. It reduces errors through greater transparency and review. It increases quality through better access to expert advice and building on established work. It increases impact by connecting to other data and being amplified by other researchers in the network. The more researchers adopt these approaches, the more effective they’ll become.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Call For Lightning Talks&lt;/p&gt;
&lt;p&gt;“Lightning talks are short presentations of 5 minutes. They are ideal for drawing the attention of the audience to new developments, tools, and resources, or to subsequent events where more in-depth information can be obtained. Please also see our FAQ for more information (&lt;a href=&quot;http://ievobio.org/faq.html#lightning&quot; class=&quot;uri&quot; title=&quot;http://ievobio.org/faq.html#lightning&quot;&gt;http://ievobio.org/faq.html#lightning&lt;/a&gt;). Lightning talks will be part of the more interactive afternoon program on both conference days.&lt;/p&gt;
&lt;p&gt;Submitted talks should be in the area of informatics aimed at advancing research in phylogenetics, evolution, and biodiversity, including new tools, cyberinfrastructure development, large-scale data analysis, and visualization.&lt;/p&gt;
&lt;p&gt;Submissions consist of a title and an abstract at most 1 page long. The abstract should provide an overview of the talk’s subject. Reviewers will judge whether a submission is within scope of the conference (see above). If applicable, the abstract must also state the license and give the URL where the source code is available so reviewers can verify that the open-source requirement(*) is met.&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://ievobio.org/ocs/index.php/ievobio/2010/schedConf/cfp&quot; title=&quot;http://ievobio.org/ocs/index.php/ievobio/2010/schedConf/cfp&quot;&gt;From iEvoBio Conference&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;reading-notes&quot;&gt;Reading / Notes&lt;/h2&gt;
&lt;p&gt;Excellent article on organizing computational projects:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=19649301&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Noble WS. .&lt;/a&gt; pmid:19649301. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=19649301&quot; title=&quot;PMID 19649301&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=19649301&quot; title=&quot;PMID 19649301&quot;&gt;HubMed&lt;/a&gt; [Noble]&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Referenced in &lt;a href=&quot;http://biostar.stackexchange.com/&quot; title=&quot;http://biostar.stackexchange.com/&quot;&gt;Biostar&lt;/a&gt; Bioinformatics forum.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.americanscientist.org/issues/id.3473,y.0,no.,content.true,page.2,css.print/issue.aspx&quot; title=&quot;http://www.americanscientist.org/issues/id.3473,y.0,no.,content.true,page.2,css.print/issue.aspx&quot;&gt;article&lt;/a&gt; on software carpentry idea&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://scholarlykitchen.sspnet.org/2010/02/08/science-and-web-2-0-talking-about-science-versus-doing-science/&quot; title=&quot;http://scholarlykitchen.sspnet.org/2010/02/08/science-and-web-2-0-talking-about-science-versus-doing-science/&quot;&gt;Talking about Science vs Doing Science&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/04/26/Teaching.html"/>
   <updated>2010-04-26T00:00:00+00:00</updated>
   <id>/04/26/Teaching</id>
   <content type="html">&lt;h2 id=&quot;gtc-assessment&quot;&gt;GTC: Assessment&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Today I’m facilitating the GTC session discussing Assessment. Here’s our VUE map of the activity.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/7/7f/Assessment-copy.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; What better way to begin a discussion about assessment than with an assessment? We began with a somewhat tongue-in-cheek quiz about the “right” way to conduct an assessment, modelling some common faults in poor assessments while also serving as a brainstorm to get some ideas out there. We presented some background theory on assessment, drawing from the excellent text: Handelsman, J., Miller, S., &amp;amp; Pfund, C. &lt;a href=&quot;http://www.amazon.com/Scientific-Teaching-Jo-Handelsman/dp/1429201886&quot; title=&quot;http://www.amazon.com/Scientific-Teaching-Jo-Handelsman/dp/1429201886&quot;&gt;&lt;em&gt;Scientific Teaching&lt;/em&gt;&lt;/a&gt;, highlighting three reasons for assessment:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Quantifying student performance, measure students as learners&lt;/li&gt;
&lt;li&gt;Measuring our own effectiveness as instructors&lt;/li&gt;
&lt;li&gt;Motivate students&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Handelsman offers a particular focus on the third with their concept enGauge, tools that both measure performance and motivate engagement with the material, often in real-time setting rather than waiting to the final exam. From here we moved into general discussion that visited various challenges in assessment, particularly in teaching and assessing &lt;em&gt;process&lt;/em&gt; rather than factual knowledge. &lt;a href=&quot;http://hdl.handle.net/10.1080/09500690010016030&quot; title=&quot;doi:10.1080/09500690010016030&quot;&gt;Moss (2001)&lt;/a&gt; also has an excellent discussion of this challenge.&lt;/p&gt;
&lt;h3 id=&quot;supplemental-materials&quot;&gt;Supplemental materials&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://dl.dropbox.com/u/3982238/Assessment.vue&quot; title=&quot;http://dl.dropbox.com/u/3982238/Assessment.vue&quot;&gt;VUE map&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://dl.dropbox.com/u/3982238/Assessment-copy.pdf&quot; title=&quot;http://dl.dropbox.com/u/3982238/Assessment-copy.pdf&quot;&gt;VUE map as pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Introductory activity: &lt;a href=&quot;http://dl.dropbox.com/u/3982238/assessment_exam.doc&quot; title=&quot;http://dl.dropbox.com/u/3982238/assessment_exam.doc&quot;&gt;assessment quiz&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/04/26/Adaptive-Dynamics.html"/>
   <updated>2010-04-26T00:00:00+00:00</updated>
   <id>/04/26/Adaptive-Dynamics</id>
   <content type="html">&lt;p&gt;Matching theoretical approximations to simulation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Implemented the first analytic approximation, calculating the waiting time to complete phase 1.&lt;/li&gt;
&lt;li&gt;Established dimophisms are often still lost, hence the first successful completion of phase 1 (dimorphic population in coexistence region with each above threshold size) doesn’t match the time of the last completion of phase 1. Phase 2, an established third population seems to happen soon after the last successful phase 1, giving the illusion this step is easy rather than the reality that this process requires fast traversal to persist past the coexistence time.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;computing-notes&quot;&gt;Computing notes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Making sure to export the library using useDynLib(file) in the NAMESPACE and using sfLibrary eliminates the need to load the dynamic library onto each node using the method from earlier .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### News&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;My previous AD paper (preprint) now openly accessible on &lt;a href=&quot;http://www.arxiv.org/abs/1004.4233&quot; title=&quot;arxiv:1004.4233&quot;&gt;arXiv:1004.4233&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;evolution-ievobio&quot;&gt;Evolution: iEvoBio&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Resubmitting proposal for lightning talk focusing on the open science aspects of the proposal.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://biostar.stackexchange.com/questions/857/any-open-notebook-science-in-bioinformatics/874&quot; title=&quot;http://biostar.stackexchange.com/questions/857/any-open-notebook-science-in-bioinformatics/874&quot;&gt;Discussion&lt;/a&gt; on stackoverflow-style site for examples of open notebook science in bioinformatics.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;misc-notes&quot;&gt;Misc Notes&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/04/23/Adaptive-Dynamics.html"/>
   <updated>2010-04-23T00:00:00+00:00</updated>
   <id>/04/23/Adaptive-Dynamics</id>
   <content type="html">&lt;h3 id=&quot;computing-challenges&quot;&gt;Computing Challenges&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;10 - 1p Adding solutions to yesterday’s puzzles, see Yesterday’s Entry&lt;/li&gt;
&lt;li&gt;The random number generator solution is imperfect, as it limits the total number of seeds to 1e9 since coercing to an integer will create NAs with larger numbers.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; seeds &amp;lt;- 1e9*runif(reps) out &amp;lt;- sfSapply(1:reps, function(i){ branch_simulation(seed=seeds[i]) })&lt;/p&gt;
&lt;h3 id=&quot;analytic-solutions&quot;&gt;Analytic Solutions&lt;/h3&gt;
&lt;h2 id=&quot;git-log&quot;&gt;Git Log&lt;/h2&gt;
&lt;p&gt;&lt;syntax\&gt; Created commit da58a6e: random number seeds now set to avoid parallel cores running with same seed&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;2 files changed, 19 insertions(+), 9 deletions(-)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;cboettig@wiglaf:~/Documents/ucdavis/research/adaptiveDynamics/code/branchingtime$ git log commit da58a6eb079a8ff9c2c28a2e5e1c27fe484f43fc Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Fri Apr 23 13:05:30 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   random number seeds now set to avoid parallel cores running with same seed&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit 6e5363559f602d1dd2e2f8addec0716e8a5c842a Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Fri Apr 23 11:46:42 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   solution for exporting .C call to parallel cores&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; &lt;/syntax\&gt;&lt;/p&gt;
&lt;h2 id=&quot;other-work&quot;&gt;Other Work&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Completed review for Theoretical Ecology.&lt;/li&gt;
&lt;li&gt;Still finishing review for JTB&lt;/li&gt;
&lt;li&gt;PDG group reading &lt;a href=&quot;http://hdl.handle.net/10.1146/annurev.ecolsys.37.091305.110035&quot; title=&quot;doi:10.1146/annurev.ecolsys.37.091305.110035&quot;&gt;Nee et. al. (2006)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/04/22/Adaptive-Dynamics.html"/>
   <updated>2010-04-22T00:00:00+00:00</updated>
   <id>/04/22/Adaptive-Dynamics</id>
   <content type="html">&lt;h3 id=&quot;compiling-with-r-and-c-and-parallel-computing&quot;&gt;compiling with R and C and parallel computing&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Problem:&lt;/strong&gt; cannot get the R code to take advantage of parallelization via openMP.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;C++ file mangles names in .so, changing the .C call. to get the object name:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;objdump -x file.so&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Carl Boettiger 03:01, 25 May 2010 (EDT)&lt;/strong&gt;: More standard solution: enclose cpp code in&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; extern C {&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; - &lt;strong&gt;Problem:&lt;/strong&gt; Trouble getting R to export the C library to all nodes. (Sol’n thanks to Vinh on R-sig-hpc!) - Also, locating the .so file in a way that is independent of package installation, needs to find the package install. (Sol’n thanks to Vince on statcompsci). (Updated on 2010-04-23). - &lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;    loc &amp;lt;- system.file(package=&amp;quot;BranchingTime&amp;quot;)
    lib &amp;lt;- paste(loc, &amp;quot;/libs/BranchingTime.so&amp;quot;, sep=&amp;quot;&amp;quot;)
    sfExport(&amp;quot;lib&amp;quot;)
    sfClusterEval(dyn.load(lib) )&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Problem&lt;/strong&gt; Random number generator needs to be specified above the parallel computation loop. Easy to do in C, but won’t work for R where the random number generator is from GSL but the parallelization is at the R level. Will need to figure out how to generate different random seeds on each thread and pass that down to the C code…&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now R generates and passes a random seed to the C function. (2010-04-23).&lt;/p&gt;
&lt;h2 id=&quot;git-log&quot;&gt;Git Log&lt;/h2&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;commit 9c4167b1943d8713ce179f48432fcb750fbda26d
Author: Carl Boettiger &amp;lt;cboettig@gmail.com&amp;gt;
Date:   Thu Apr 22 19:03:09 2010 -0700
 
    removing unused C files integrate.c png
 
commit 73f389abbe53eb923f1aea49bc9f110cfa5531a7
Author: Carl Boettiger &amp;lt;cboettig@gmail.com&amp;gt;
Date:   Thu Apr 22 19:01:52 2010 -0700
 
    minor mods
 
commit a8ca40ef883b1dd33e1b7ab27f8a215e7c2746f9
Author: Carl Boettiger &amp;lt;cboettig@gmail.com&amp;gt;
Date:   Thu Apr 22 18:55:32 2010 -0700
 
    Working R calls
 
commit 7c565bef0a378a68ce2c0a2a1ad73c6039871431
Author: Carl Boettiger &amp;lt;cboettig@gmail.com&amp;gt;
Date:   Thu Apr 22 15:31:10 2010 -0700
 
    rng initialized in outer loop
 
commit 60192d74b45c64423994b451aad6a7627e2a56b8
Author: Carl Boettiger &amp;lt;cboettig@gmail.com&amp;gt;
Date:   Thu Apr 22 14:37:36 2010 -0700
 
    streamlining parallelization
 
commit a4de1d11a2a9ce0179636770246707b18c8d8c06
Author: Carl Boettiger &amp;lt;cboettig@gmail.com&amp;gt;
Date:   Thu Apr 22 13:03:03 2010 -0700
 
    reorganizing files by functions&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Adaptive Dynamics</title>
	 <link href="/2010/04/21/Adaptive-Dynamics.html"/>
   <updated>2010-04-21T00:00:00+00:00</updated>
   <id>/04/21/Adaptive-Dynamics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Wrapping up paper on waiting time to branching in adaptive dynamics.&lt;/li&gt;
&lt;li&gt;Cleaning up code from summer. Now in a local git repository in adaptiveDynamics/code&lt;/li&gt;
&lt;li&gt;Moved ensemble parallelization to higher level, so parallelization can be performed in R or C.&lt;/li&gt;
&lt;li&gt;Adding documentation&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;current-status&quot;&gt;Current status&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Calculates the waiting time to complete phase 1, phase 2, and phase 3 successfully from individual-based simulation.&lt;/li&gt;
&lt;/ul&gt;
&lt;dl&gt;
&lt;dt&gt;Phase 1&lt;/dt&gt;
&lt;dd&gt;Completed when 2 branches exist over threshold Phase 2
&lt;/dd&gt;
&lt;dd&gt;Completed when a third population has established over threshold exterior to a stable pair Phase 3
&lt;/dd&gt;
&lt;dd&gt;Completed when two populations over threshold are separated in traitspace by more than finishline units
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;&lt;br /&gt; Notes —–&lt;/p&gt;
&lt;h3 id=&quot;thoughts-on-notebook-separation&quot;&gt;Thoughts On Notebook separation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Wrapping up the adaptive dynamics project from this summer at IIASA. Not really a comparative phylogenetics topic but it’s evolution and I’ve got to write it down somewhere, there are advantages and disadvantages of maintaining separate notebooks for separate projects. Since this is something I’ve been thinking about lately will take a moment to write it down.
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Advantages&lt;/strong&gt;: Provides a clearer progression of a single body of work. Particularly when two projects are entirely unrelated, interleaving them would be very frustrating. A very good search/tag/aggregation system would alleviate this. I should start using categories&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Disadvantages&lt;/strong&gt;: Selecting the division level for notebook. At what level does a project become an independent idea? i.e. is the stochastic population dynamics in structured populations independent of the warning signals work? There’s also content that isn’t directly relevant to one notebook or another. I think if I didn’t work in two separate labs (Hastings and Wainwright) everything would be one notebook.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;backup-and-local-editing&quot;&gt;backup and local editing&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Experimenting with &lt;a href=&quot;http://search.cpan.org/~markj/WWW-Mediawiki-Client/bin/mvs&quot; title=&quot;http://search.cpan.org/~markj/WWW-Mediawiki-Client/bin/mvs&quot;&gt;mvs&lt;/a&gt; commandline client to download and upload pages to the wiki, as &lt;a href=&quot;http://wiki.freegeek.org/index.php/Www-mediawiki-client&quot; title=&quot;http://wiki.freegeek.org/index.php/Www-mediawiki-client&quot;&gt;described here&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Waiting Time</title>
	 <link href="/2010/04/20/waiting-time.html"/>
   <updated>2010-04-20T00:00:00+00:00</updated>
   <id>/04/20/waiting-time</id>
   <content type="html">&lt;p&gt;&lt;strong&gt;editorial note&lt;/strong&gt;: These notes pre-date the formal start of my online laboratory notebook, &lt;a href=&quot;http://carlboettiger.info/2010/02/02/The-Lab-Notebook-Goes-Open-.html&quot;&gt;Feb 2 2010: The Lab Notebook Goes Open&lt;/a&gt; and were adapted from a LaTeX document in which I kept notes on this topic during my summer at &lt;a href=&quot;http://www.iiasa.ac.at/&quot;&gt;IIASA&lt;/a&gt;. Lacking a proper notebook then, documents like this one were updated periodically and occassionally branched into new ones. The post date represents the last time the LaTeX document was edited in the course of that research.&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;abstract&quot;&gt;Abstract&lt;/h1&gt;
&lt;p&gt;The theory of Adaptive Dynamics has recieved much attention for its analysis of evolutionary branching points. While the asymptotic dynamics of such branching points has been well studied, little is known about the timescale of the process or its behaviour away from the asymptotic limits of large populations and rare, small mutational steps. We provide several estimates of the waiting time for evolutionary branching to occur when different assumptions are relaxed. This approach demonstrates how adaptive branching can be characterized by four seperate phases and also identifies the most likely rate-limiting process in the course of adaptive branching. Our analytic approximations are compared to exact numerical simulation of the branching process.&lt;/p&gt;
&lt;h1 id=&quot;introduction&quot;&gt;Introduction&lt;/h1&gt;
&lt;p&gt;In adaptive dynamics theory, an evolutionary branching point is a singular strategy that is globally convergent but locally unstable.&lt;/p&gt;
&lt;p&gt;A population approaches by discrete jumps.&lt;/p&gt;
&lt;p&gt;Almost all quantitative theories of evolution have relied on stochastic models to address the impacts of chance events - such as mutations, births, deaths, and environmental changes - that affect the evolutionary process (Fisher 1937; Lande 1979; Coyne &amp;amp; Orr 2004). Adaptive dynamics theory typically considers two sources of stochasticity: random mutations and the loss of advantageous mutants to chance extinction while their numbers are small. What these models typically do not consider is demographic stochasticity of resident populations (resulting from intrinsic fluctuations through stochastic birth and death events in finite populations of discrete individuals) and environmental stochasticity (resulting from external fluctuations in the environmental conditions a population experiences).&lt;/p&gt;
&lt;p&gt;Several recent studies have tried to overcome these limitations. Claessen et al. (2007, 2008) explore simulations of evolutionary branching in small populations and found that demographic stochasticity can delay or halt diversification. Johansson and Ripa (2006) explored the impact that correlated environmental stochasticity has on diversification. They assume that as populations diverge, the environmental influences upon them become less similar. They demonstrate that this correlation can facilitate coexistence early in the process of branching, and as it weakens, the chance that a branch is lost increases. While these studies make an excellent start, a more general theory and mathematical framework is needed to untangle and quantify the multitude of effects stochasticity has on evolutionary branching.&lt;/p&gt;
&lt;h1 id=&quot;methods&quot;&gt;Methods&lt;/h1&gt;
&lt;h2 id=&quot;model&quot;&gt;Model&lt;/h2&gt;
&lt;p&gt;We consider the classic adaptive dynamics model for evolutionary branching under competition for a limiting resource by Dieckmann and Doebeli (1999). The population dynamics of &lt;span class=&quot;math&quot;&gt;\(N(x,t)\)&lt;/span&gt; individuals each with focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; are given by a continuous time birth-death process with rates&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
b(N) = &amp;amp; r \nonumber \\
d(N) = &amp;amp; r \frac{\sum_yN(y,t)C(x,y)}{K(x)} .\label{general_logistic}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; can be thought of as some continuous phenotypic variable, such as beak size, which affects resource consumption. Niche differences driving speciation arise from differences in this trait. In the model, &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; is the resource kernel which determines the equilibrium population density and &lt;span class=&quot;math&quot;&gt;\(C(x,y)\)&lt;/span&gt; is a the competition kernel, describing the relative change in death rate of individuals of type &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; due to competition by individuals of type &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;. Given &lt;span class=&quot;math&quot;&gt;\(C(x,x)=1\)&lt;/span&gt;, the equilibrium density of a monomorphic population is &lt;span class=&quot;math&quot;&gt;\(N^{\ast}(x)=K(x)\)&lt;/span&gt;. Following  we assume the following Gaussian forms,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[K(x)=K_0e^{-x^2/(2\sigma_k^2)}, \label{K}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[C(x,y)=e^{-(x-y)^2/(2\sigma_c^2)}, \label{C}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\sigma_k\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; are scale factors for the resource distribution and competition kernels respectively. &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; can be though of as the niche size. We focus on the case &lt;span class=&quot;math&quot;&gt;\(\sigma_k&amp;gt;\sigma_c\)&lt;/span&gt;, for which the model has an evolutionary branching point at &lt;span class=&quot;math&quot;&gt;\(x=0\)&lt;/span&gt; .&lt;/p&gt;
&lt;p&gt;The evolutionary dynamics are specified only at the phenotypic level: We assume that with probability &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt; an individual birth results in a mutant offspring, and that the mutant trait is chosen from a Gaussian distribution centered at the trait value of the parents and with a variance &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}^2\)&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id=&quot;the-adaptive-dynamics-of-branching&quot;&gt;The Adaptive Dynamics of Branching&lt;/h2&gt;
&lt;p&gt;Evolutionary branching occurs in this model when the resource kernel is wider than the competition kernel, &lt;span class=&quot;math&quot;&gt;\(\sigma_k &amp;gt; \sigma_c\)&lt;/span&gt; as discussed in . It is straight forward to show that the invasion fitness &lt;span class=&quot;math&quot;&gt;\(s(y,x) := b(K(x),x,y) -d(K(x), x,y)\)&lt;/span&gt; of a rare mutant &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt; in a population &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; at equilibrium has a singular point at &lt;span class=&quot;math&quot;&gt;\(x^*=0\)&lt;/span&gt;, the peak of the resource distribution. This is easily confirmed by taking the second derivatives or observing the pairwise invasibility plot.&lt;/p&gt;
&lt;h2 id=&quot;phases-of-branching&quot;&gt;Phases of branching&lt;/h2&gt;
&lt;p&gt;Evolutionary branching through this mechanism can be divided into four phases. In the first phase, the population approaches the branching point by repeated invasions that completely replace the monomorphic population. This rate is governed by the canonical equation of adaptive dynamics, a rate proportional to the size of mutational jumps relative to the size of the resource kernel, &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}/\sigma_k\)&lt;/span&gt;. Mathematically, this phase can be defined by the &lt;span class=&quot;math&quot;&gt;\(P_1\)&lt;/span&gt; region of the pairwise invasibility plot. In this region, dimoprhisms are always transient.&lt;/p&gt;
&lt;p&gt;In the second phase, the population is near enough to the branching point that mutations begin occuring in the coexistence region. More precisely, any dimorphism that occurs in the &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; region but where one of the populations is too small to contribute to density-dependent effects can be considered to be in this phase. The dynamics of this phase are thus governed by the fixation probabilities of rare mutants occuring in the coexistence region. This phase may often fail when a rare mutant occurs in the coexistence region but is soon lost to drift.&lt;/p&gt;
&lt;p&gt;The third phase begins when mutations in the coexistence region survive the initial genetic drift to establish as significant frequencies in the population. In this stage the density-dependent contribution of each population is relevant. This stage may fail due to the loss of either population, more often the one farther from the branching point. As this is usually (but not necessarily) the resident population that gave rise to the other population through mutation, the failure of this phase can be thought of in terms of loss of the resident population, while the second phase is governed primarily by the loss of the invader population.&lt;/p&gt;
&lt;p&gt;In the fourth phase, subsequent mutations farther from the branching point invade and the populations move apart. Each time a mutant exterior to the branching point successfully invades the probability the coexistence becomes exponentially more stable, as we will demonstrate. While the expected coexistence time for the two populations remains similar to the evolutionary timescale over which new mutants enter and establish, the coexistence may be lost, collapsing back to the second phase. However, as the coexistence of the first pair (phase 3) is much more likely to collapse than the subsequently more stable coexisting pairs that arise from it, we will have a good approximation by considering only the probabilty that the initial pair survives long enough to enter phase four. This is justified by the Ahrennius approximation result and confirmed by numerical simulation.&lt;/p&gt;
&lt;h3 id=&quot;overview-of-the-approach&quot;&gt;Overview of the approach&lt;/h3&gt;
&lt;p&gt;The division into phases provides both a conceptual and mathematical framework to address the branching process. Analyzing the first two phases essentially consists of partitioning the space of possible mutants: considering all the mutants that lie in the &lt;span class=&quot;math&quot;&gt;\(P_1\)&lt;/span&gt; region that are expected to invade and replace the resident (moving the population closer to the branching point as per phase 1), and mutants that reach the coexistence region &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; in phase 2. This is done by partitioning the domain of integration for an integral over mutant traits &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt; for each resident &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;. The closer &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; is to &lt;span class=&quot;math&quot;&gt;\(x^*\)&lt;/span&gt; the more of this integral lies in &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; and entering phase two becomes increasingly probable. This treatment follows along similar lines as the original derivation of the canonical equation of adaptive dynamics .&lt;/p&gt;
&lt;p&gt;The crux of the remaining third and fourth phases settles around predicting the coexistence time. This is done through a diffusion approximation approach to individual dynamics, which remains quite technical to solve. To provide both an effective approximation and a useful intuition, we demonstrate how this coexistence problem can be construed as an escape from a potential energy well, as in classical chemical kinetics. Understanding the depth of this well tells us most of what we need to know about the coexistence time. Relating the coexistence timescale to the evolutionary timescale wraps up the calculation for how long branching will take.&lt;/p&gt;
&lt;p&gt;The deterministic theory applies both the limit of rare mutations (small &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt;) and small mutational steps (small &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}\)&lt;/span&gt;). In our treatment, either one of these can become the limiting factor and correspond to different regimes of adaptive branching. If mutations are very rare, we’ll see that the population must essentially survive phase 3 in a single mutational step. In this regime recieving a single mutation far enough into the &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; region to survive the coexistence balance (phase 3 to 4). This corresponds to a single mutational step that is on the order of the width of the competition kernel, &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt;. Here branching is accomplished essentially by the single unlikely event being “rolled,” and transitions between phases are slow but rarely collapse to an earlier stage. When mutational step size is limiting, many mutational steps are required to get any population a distance of order &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; away - to escape the shadow of competition. In this regime, successful branching appears as a lucky string of mutations, like a long series of flipping a coin and coming up heads rather than the singular improbable event. This regime is characterized by many aborted branching attempts before one succeeds. The smaller &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt; becomes, the smaller the chances of seeing this lucky run within the coexistence time. The smaller &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}\)&lt;/span&gt; becomes the smaller the chances of seing the rare large jump within the coexistence time. When both are too small relative to the coexistence time, the population will fail to branch.&lt;/p&gt;
&lt;h2 id=&quot;approaching-the-branching-point&quot;&gt;Approaching the branching point&lt;/h2&gt;
&lt;p&gt;Classically, the approach to the branching point is governed by the canonical equation of adaptive dynamics . To account for branching we have to revisit the original derivation of this equation where we relax the limit of small mutational steps sufficiently to allow mutants to enter the coexitence region, &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt;. The derivation of the canonical equation integrates only over those mutants that fall into the invasion-substitution region, &lt;span class=&quot;math&quot;&gt;\(P_1\)&lt;/span&gt;. However, since the derivation is done in the limit of small mutational step sizes, this encompasses essentially all of the weight of the mutational kernel, and to good approximation can thus be replaced with the entire &lt;span class=&quot;math&quot;&gt;\(P_1 \cup P_2\)&lt;/span&gt; region. Recall that in the derivation of the canonical equation, deleterious mutations are given zero probability of fixing (from the branching process approximation), and hence this corresponds to integrating over half of the real line &lt;span class=&quot;math&quot;&gt;\(\mathbb{R}\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\mathrm{d}\bar x}{\mathrm{d}t} = \mu N^*(x) \phantom \cdot \partial_y s(y,x) \Big|_x \int_{P_1} [y-x]^2 M(y-x) \mathrm{d}[y-x]
\label{canonical}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The probability of such a mutant occurring in our monomorphic population of trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; is given by the probability that any mutant occurs (given by the population size, approximately &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; at equilibrium, times the birth rate &lt;span class=&quot;math&quot;&gt;\(b(x)\)&lt;/span&gt; times the mutation rate &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt;) times the probability that the mutation lies on the opposite side of the coexistence boundary, which we denote as &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\psi(x)\)&lt;/span&gt;, which is &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; reflected across the line &lt;span class=&quot;math&quot;&gt;\(y=x\)&lt;/span&gt;. This depends on the mutational kernel, &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; which gives the probability that a mutant arising from a resident population of trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; bears trait &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt; that falls withing the coexistance region as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\int_{-\infty}^{\phi(x)} M(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) \mathrm{d}y\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Without loss of generality let us assume that the singular strategy &lt;span class=&quot;math&quot;&gt;\(x^* = 0\)&lt;/span&gt; and that we start from some trait value &lt;span class=&quot;math&quot;&gt;\(x_0 &amp;gt; x^*\)&lt;/span&gt;. Additionally, let us we assume &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; is Gaussian in &lt;span class=&quot;math&quot;&gt;\(y-x\)&lt;/span&gt; with mean 0 and variance &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}^2\)&lt;/span&gt;. However, we do not wish to consider all such mutants &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;, but only those that survive. We multiply the probability of a mutant having trait &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;, &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt;, times the probability that is survives drift. This probability we quote from the Galton-Watson branching process, &lt;span class=&quot;math&quot;&gt;\(1-\tfrac{d(y,x)}{b(y,x)}\)&lt;/span&gt;. Using our model for birth and death rates , the probability of surviving branching is&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[1-\frac{C(y,x)K(x)}{K(y)} := S(y,x)
\label{S}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;which we denote as &lt;span class=&quot;math&quot;&gt;\(S(y,x)\)&lt;/span&gt; as indicated. Hence we modify our integral to consider all mutants &lt;span class=&quot;math&quot;&gt;\(y &amp;lt; x^*\)&lt;/span&gt; which occur with probability &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; and then survive with probability &lt;span class=&quot;math&quot;&gt;\(S(y,x)\)&lt;/span&gt;, and write down the rate &lt;span class=&quot;math&quot;&gt;\(P(x)\)&lt;/span&gt; at which a mutant which leads to branching occurs from our monomorphic population with trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[P(x) := r \mu K(x)\left( \int_{-\infty}^{\phi(x)} M(y,x) S(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) S(y,x) \mathrm{d}y  \right)
\label{MSerf}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Though a little cumbersome, this can be written in nearly closed form (using the error function). For our particular model &lt;span class=&quot;math&quot;&gt;\(s(y,x)\)&lt;/span&gt;, we can write the boundaries &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\psi(x)\)&lt;/span&gt; as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\phi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}+1}{\frac{\sigma_k^2}{\sigma_c^2}-1} \nonumber \\
\psi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}-1}{\frac{\sigma_k^2}{\sigma_c^2}+1}
\label{phipsi}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then, given a starting condition &lt;span class=&quot;math&quot;&gt;\(x_0\)&lt;/span&gt;, we can determine the expected trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; at time &lt;span class=&quot;math&quot;&gt;\(t\)&lt;/span&gt; of a monomorphic resident population by integrating the canonical equation,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{1}{2} \mu \sigma_{mu}^2 N^*(x) \partial_y s(y,x)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;which for our model is&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{-x}{2\sigma_k^2} r \mu \sigma_{\mu}^2 K(x)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;While no closed form solution exists for &lt;span class=&quot;math&quot;&gt;\(x(t)\)&lt;/span&gt; in this case, if we assume &lt;span class=&quot;math&quot;&gt;\(x_0 \ll \sigma_k\)&lt;/span&gt; then to good approximation we can view &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; to be constant over the interval and take our path to be:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[x(t) = x_0 \exp\left( -r \mu \sigma_{\mu}^2 K_0 t/\sigma_k^2\right)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Using this mean path, we can write down an approximation for the rate of a branching mutant occurring as a function of time, &lt;span class=&quot;math&quot;&gt;\(P(x(t))\)&lt;/span&gt;. Using this time dependent rate, the probability of not branching after time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt; is simply &lt;span class=&quot;math&quot;&gt;\(\exp\left( - \int_0^T P(t)\mathrm{d}t \right)\)&lt;/span&gt;. One minus this is the probability branching by time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt;; i.e. the cumulative density function, hence the probability density function for the waiting time is:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\Pi(T) = P(x(T)) \exp\left( -\int_0^T P(x(t)) \right)
\label{pdf}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the expected time to complete phases 1 and 2 is &lt;span class=&quot;math&quot;&gt;\(\int_0^{\infty} T \Pi(T) \mathrm{d}T\)&lt;/span&gt;. This is our first analytic approximation.&lt;/p&gt;
&lt;h2 id=&quot;coexistence&quot;&gt;Coexistence&lt;/h2&gt;
&lt;p&gt;Consider a population of two coexisting types, characterized by traits &lt;span class=&quot;math&quot;&gt;\(x_1\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(x_2\)&lt;/span&gt; respectively. The birth and death rates of each population are then given by expression  . We’ll assume that the populations can coexist, that is &lt;span class=&quot;math&quot;&gt;\((x_1, x_2)\)&lt;/span&gt; falls into the coexistence region &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt;; &lt;em&gt;i.e.&lt;/em&gt; that $C(x_1,x_2)K(x_2) /K_1(x_1) &amp;lt; 1 $ and &lt;span class=&quot;math&quot;&gt;\(C(x_1, x_2) K(x_1)/K(x_2) &amp;lt; 1\)&lt;/span&gt;. This guarentees that each population has a positive expected growth rate when rare. However, because the population is composed of finitely many discrete individuals, there is still a chance that either type will be lost to chance; to demographic stochasticity. We whish to characterize the expected waiting time for such an event to occur.&lt;/p&gt;
&lt;p&gt;To do so, we will switch first into density and then frequency, to obtain a one-dimensional expression we can solve exactly. We will then use the Arhennius approximation to obtain a closed form solution. First, we will replace the discrete number of individuals &lt;span class=&quot;math&quot;&gt;\(N\)&lt;/span&gt; with the macroscopic, continuous variable &lt;span class=&quot;math&quot;&gt;\(n\)&lt;/span&gt;, representing the mean &lt;em&gt;density&lt;/em&gt; of individuals; &lt;span class=&quot;math&quot;&gt;\(N/A\)&lt;/span&gt;, where &lt;span class=&quot;math&quot;&gt;\(A\)&lt;/span&gt; is the area in which &lt;span class=&quot;math&quot;&gt;\(N\)&lt;/span&gt; individuals are found. For suitably large &lt;span class=&quot;math&quot;&gt;\(A\)&lt;/span&gt;, we will be able to accurately describe &lt;span class=&quot;math&quot;&gt;\(n\)&lt;/span&gt; with a coupled stochastic differential equation for each population. By changing variables once more into the frequency of one type, &lt;span class=&quot;math&quot;&gt;\(p = n_1/(n_1+n_2)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(n = n_1 + n_2\)&lt;/span&gt;, we are able to do a timescale seperation to focus on the dynamics in a single variable, &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The master equation that describes the probability of observing &lt;span class=&quot;math&quot;&gt;\(N_i\)&lt;/span&gt; individuals of type &lt;span class=&quot;math&quot;&gt;\(i\)&lt;/span&gt; is given by,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\mathrm{d}}{\mathrm{d}t} P(N_1,t) &amp;amp;= (\text{E}_1 - 1) r N_1 \frac{N_1 + C(x_1, x_2) N_2}{K(x_1) }P(N_1) + (\text{E}_1^{-1} - 1)r N_1 P(N_1) \nonumber \\
\frac{\mathrm{d}}{\mathrm{d}t} P(N_2,t) &amp;amp;= (\text{E}_2 - 1) r N_2 \frac{N_2 + C(x_2, x_1) N_1}{K(x_2) }P(N_2) + (\text{E}_2^{-1} - 1)r N_2 P(N_2)
\label{mastereq}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\text{E}_i^k\)&lt;/span&gt; is the step operator taking &lt;span class=&quot;math&quot;&gt;\(f(N_i) \to f(N_{i+k})\)&lt;/span&gt;. We apply van Kampen’s expansion of the master equation to linear order to recover the following stochastic differential equation (Itô equation)&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\mathrm{d}n_1 = r n_1 \left(1 -  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o} } \sqrt{r n_1 \left(1 +  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) } \mathrm{d}W_1
\label{sde}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and &lt;span class=&quot;math&quot;&gt;\(n_2\)&lt;/span&gt; similarly. Switching into the variables for frequency, &lt;span class=&quot;math&quot;&gt;\(p = n_1/n\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(n = n_1+n_2\)&lt;/span&gt; and simplying notation by &lt;span class=&quot;math&quot;&gt;\(C(x_1, x_2) = c_{12}\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(K(X_i) = k_i\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\mathrm{d}p &amp;amp;= r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o n(p)} } \sqrt{r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right) } \mathrm{d}W_1  \label{freq_sde} \\
n(p) &amp;amp;=  \frac{k_1 k_2}{k_2 p^2 + (k_1+k_2) c_{12} p (1-p) + k1 (1-p)^2 }, \end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where we have set the dynamic equation for &lt;span class=&quot;math&quot;&gt;\(n(p)\)&lt;/span&gt; to equilibrium. The extinction probability &lt;span class=&quot;math&quot;&gt;\(u(p,t)\)&lt;/span&gt; for this expression is given by the Backwards equation for the generator,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \underbrace{r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right)}_{A(p)} \partial_p u(p,t) + \tfrac{1}{2} \underbrace{\frac{1}{K_o n(p) } r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right)}_{B(p)} \partial_p^2 u(p,t) 
\label{u}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;with the boundary conditions &lt;span class=&quot;math&quot;&gt;\(u(0,t) = 1\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(u(1,t) = 1\)&lt;/span&gt; being absorbing.&lt;/p&gt;
&lt;p&gt;Assuming that type 1 is the rare mutant invader, we can solve this explicitly for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;, and particularly for the case of exactly one new mutant. After some rearrangement we can rewrite this as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{gathered}
\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \left( rp \left( 1-\frac{n c_{12}}{k_1} \right) - \frac{r n}{k_1} p^2 (1 - c_{12} )\right)  \partial_p u(p,t) \\
+ \left( rp \left(1+\frac{n c_{12}}{k_1}\right)  + \frac{r n }{k_1} p^2 (1 - c_{12} ) \right) \frac{\partial_p^2 u(p,t)}{2K_0 n}\end{gathered}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Note then for &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; small we can neglect the terms quadratic in &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; and we are left with the backwards equation from the density independent case,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) =  rp \left( 1-\frac{n c_{12}}{k_1} \right)   \partial_p u(p,t) + rp \left(1+\frac{n c_{12}}{k_1}\right)   \frac{\partial_p^2 u(p,t)}{2K_0 n}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Setting equal to zero we have a simple ordinary differential equation for the stationary extinction probability:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
u(p) &amp;amp;= 1 - e^{-2sp K_0 n} \\
s &amp;amp;= \frac{r\left( 1-\frac{n c_{12}}{k_1} \right) }{ r\left(1+\frac{n c_{12}}{k_1}\right)} \end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and particularly for a frequency &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; corresponding to a single individual, a frequency of &lt;span class=&quot;math&quot;&gt;\(p=1/(N_1+N_2) =(1/K_0)/(n_1+n_2) = 1/(K_0 n)\)&lt;/span&gt;, this reduces to&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[u = 1-e^{-2s}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Assuming $ rp ( 1- ) 0$, the time-dependent solution&lt;a href=&quot;#fn1&quot; class=&quot;footnoteRef&quot; id=&quot;fnref1&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; is:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
u(p,t) &amp;amp;= 1-e^{-p \psi(t) } \\
\psi(t) &amp;amp;= \frac{2 s K_0 n}{1-e^{ r\left( 1-\frac{k_2 c_{12}}{k_1} \right) t } }
\label{timedep}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Larger population (system size) &lt;span class=&quot;math&quot;&gt;\(K_o\)&lt;/span&gt; results in longer persistance.&lt;/p&gt;
&lt;p&gt;This tells us nothing about the survival of the resident, as it is only valid for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;. In most applications of this approach, it is assumed the resident quickly goes extinct once &lt;span class=&quot;math&quot;&gt;\(p \sim o(1)\)&lt;/span&gt;. If we consider the asymptotic behavior of the nonlinear PDE, Eq. , we see sure absorbtion at one boundary or the other. The asymptotic behavior needn’t concern us; as we really want to know how the expected lifetime of this dimporphic state compares with the rate at which mutants are entering this population. To do so we need the time dependent solution to the nonlinear backwards equation .&lt;/p&gt;
&lt;p&gt;While a direct solution to the nonlinear PDE is not available, we can solve for the moments analytically. As &lt;span class=&quot;math&quot;&gt;\(u(p,t)\)&lt;/span&gt; is the probability of non-extinction, that is, that the exit time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt; is greater than the current time &lt;span class=&quot;math&quot;&gt;\(t\)&lt;/span&gt;; e.g. &lt;span class=&quot;math&quot;&gt;\(u\)&lt;/span&gt; is the cumululative probability density. Consequently the mean exit time &lt;span class=&quot;math&quot;&gt;\(T(p)\)&lt;/span&gt; is given by,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[T(p) = - \int_0^\infty t \partial_t u(p,t) \mathrm{d}t = \int_0^\infty u(p,t) \mathrm{d}t \label{simple}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where we have integrated by parts to get the second expression. Meanwhile, we can integrate the left-hand side of ,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\int_0^{\infty} \partial_t u(p,t) \mathrm{d}t = u(p,\infty) - u(p,0) = -1\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and integrate the right hand side using  to get&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[A(p) \partial_p T(p) + \tfrac{1}{2} B(p) \partial_p^2 T(x) = -1\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This can be integrated directly to solve for the mean time starting from &lt;span class=&quot;math&quot;&gt;\(p=x\)&lt;/span&gt; to be absorbed at either boundary &lt;span class=&quot;math&quot;&gt;\(a=0\)&lt;/span&gt; or &lt;span class=&quot;math&quot;&gt;\(b=1\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
T(x) &amp;amp;= \frac{2 \left[\left(\int_a^x\frac{\mathrm{d}y}{\psi(y)}\right)\int_x^b \frac{\mathrm{d}y&amp;#39;}{\psi(y&amp;#39;)} \int_a^{y&amp;#39;} \frac{\mathrm{d}z \psi(z)}{B(z)} - \left(\int_x^b\frac{\mathrm{d}y}{\psi(y)}\right)\int_a^x \frac{\mathrm{d}y&amp;#39;}{\psi(y&amp;#39;)} \int_a^{y&amp;#39;} \frac{\mathrm{d}z \psi(z)}{B(z)}\right]}{\int_a^b \frac{\mathrm{d}y}{\psi(y)}}
\label{7integrals} 
\intertext{where}
\psi(x) &amp;amp;= \exp\left( \int_0^x \mathrm{d}x&amp;#39; \frac{2A(x&amp;#39;)}{B(x&amp;#39;)} \right)\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Though these integrals can be computed numerically, a small noise limit (large populations) allows us to make an additional approximation by mapping this problem onto the familiar question of escape over a potential energy barrier. This question arises in basic chemistry, and is described by a similar stochastic differential equation where the &lt;span class=&quot;math&quot;&gt;\(A(x)\)&lt;/span&gt; coefficent represents the gradient of the energy surface and &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; the temperature. The analogy initially appears to fail, since in the chemical context the diffusion coefficent is determined by the temperature alone, and is independent of the state, while our &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; term depends on the frequency &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;. However, as it is not explicitly time dependent, there is always a transform to change variables into a context where &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; is constant. The relevant transformation for us is known as the Lamperti Transform. Switching variables from &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; to &lt;span class=&quot;math&quot;&gt;\(q\)&lt;/span&gt; by means of the transform:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[q = F(p) = \int_z^{p} \frac{1}{\sqrt{B(u)}} \mathrm{d}u
\label{p_to_q}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;we can rewrite  as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\partial u(q,t)}{\partial t} = \underbrace{\left(\frac{4 A(p)- \partial_p B(p) }{4\sqrt{B(p)}}  \right)}_{\nabla V(p)} \frac{\partial u(q,t)}{\partial q} + \frac{1}{2} \frac{\partial^2 u(q,t)}{\partial q^2}.
\label{new_u}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The mean first passage time in this transformed variable is still solved by . However, interpreting the coefficent of the drift term as the gradient of the energy landscape, &lt;span class=&quot;math&quot;&gt;\(\nabla V(p)\)&lt;/span&gt;, we can approximate that this time will scale as the exponent of the depth of the energy well defined by that landscape:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\exp{- (\min(V(0), V(1)) - V(p^*) )}\]&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&quot;results&quot;&gt;Results&lt;/h1&gt;
&lt;section class=&quot;footnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot;&gt;&lt;p&gt;note that &lt;span class=&quot;math&quot;&gt;\(n(p) \approx k_2\)&lt;/span&gt; for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;.&lt;a href=&quot;#fnref1&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</content>
 </entry>
 
 <entry>
   <title>R-sig-phylo</title>
	 <link href="/2010/04/20/R-sig-phylo.html"/>
   <updated>2010-04-20T00:00:00+00:00</updated>
   <id>/04/20/R-sig-phylo</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;A couple &lt;a href=&quot;https://mailman.stat.ethz.ch/pipermail/r-sig-phylo/2010-April/&quot; title=&quot;https://mailman.stat.ethz.ch/pipermail/r-sig-phylo/2010-April/&quot;&gt;interesting discussions&lt;/a&gt; on R-sig-phylo&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;estimating alpha and sigma reliably, knowing when you hit a likelihood ridge. See discussion.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stat.ethz.ch/pipermail/r-sig-phylo/2009-June/000393.html&quot; title=&quot;https://stat.ethz.ch/pipermail/r-sig-phylo/2009-June/000393.html&quot;&gt;strange&lt;/a&gt; behavior in ace. Tried &lt;a href=&quot;http://ape.mpl.ird.fr/ace/ace.R&quot; title=&quot;http://ape.mpl.ird.fr/ace/ace.R&quot;&gt;new ace function&lt;/a&gt;, same problem.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt; Research ——–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Working on logs paper&lt;/li&gt;
&lt;li&gt;Waiting on Primate data&lt;/li&gt;
&lt;li&gt;Waiting on feedback on Labrids paper&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; DoE Conference Registration —————————&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Submitted Poster title and abstract corresponding to my iEvoBio proposal.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;reading&quot;&gt;Reading&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.c2cbio.com/2010/04/18/episode-31-genes-patents-and-open-science/&quot; title=&quot;http://www.c2cbio.com/2010/04/18/episode-31-genes-patents-and-open-science/&quot;&gt;podcast&lt;/a&gt; on the Science Careers story.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nytimes.com/2010/04/18/education/edlife/18open-t.html?pagewanted=4&amp;amp;sq=Education&amp;amp;st=cse&amp;amp;scp=6&quot; title=&quot;http://www.nytimes.com/2010/04/18/education/edlife/18open-t.html?pagewanted=4&amp;amp;sq=Education&amp;amp;st=cse&amp;amp;scp=6&quot;&gt;NY Times on Open Education&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://jopm.org/index.php/jpm/article/view/11/21&quot; title=&quot;http://jopm.org/index.php/jpm/article/view/11/21&quot;&gt;reputation systems&lt;/a&gt; in &lt;a href=&quot;http://jopm.org/index.php/jpm/article/viewArticle/12/25&quot; title=&quot;http://jopm.org/index.php/jpm/article/viewArticle/12/25&quot;&gt;peer review&lt;/a&gt;, two articles in &lt;a href=&quot;http://participatorymedicine.org/journal/&quot; title=&quot;http://participatorymedicine.org/journal/&quot;&gt;Journal of Participatory Medicine&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://weblog.jamisbuck.org/2010/1/26/there-is-no-magic-there-is-only-awesome-part-4&quot; title=&quot;http://weblog.jamisbuck.org/2010/1/26/there-is-no-magic-there-is-only-awesome-part-4&quot;&gt;piece&lt;/a&gt; on good programming&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;education&quot;&gt;Education&lt;/h3&gt;
&lt;p&gt;Fantastic collections on education&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cc.gatech.edu/aimosaic/faculty/nersessian/&quot; title=&quot;http://www.cc.gatech.edu/aimosaic/faculty/nersessian/&quot;&gt;Nancy Nersessian&lt;/a&gt;’s publications&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.citeulike.org/user/jsvoboda&quot; title=&quot;http://www.citeulike.org/user/jsvoboda&quot;&gt;Julia’s cite-u-like&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Also learned about &lt;a href=&quot;http://home.cc.gatech.edu/dil/18&quot; title=&quot;http://home.cc.gatech.edu/dil/18&quot;&gt;Ashok Goel&lt;/a&gt;’s group at intersection of cognitive science, computer science and education at GA Tech.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Alan Meeting</title>
	 <link href="/2010/04/20/Alan-Meeting.html"/>
   <updated>2010-04-20T00:00:00+00:00</updated>
   <id>/04/20/Alan-Meeting</id>
   <content type="html">&lt;p&gt;&lt;em&gt;From 03/31, see &lt;a href=&quot;#Updated_Outline&quot;&gt;below&lt;/a&gt; for more!&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&quot;outline&quot;&gt;Outline&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Title&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;On the ability to detect leading indicators of catastrophe in unreplicated time series&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Introduction&lt;/strong&gt; Background on Warning Signals&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://www.mendeley.com/research-papers/collections/1374711/EarlyWarningSigns/&quot; title=&quot;http://www.mendeley.com/research-papers/collections/1374711/EarlyWarningSigns/&quot;&gt;literature&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Saddle Node bifurcation&lt;/li&gt;
&lt;li&gt;Detecting decreasing stabilization – gradual vs changepoint estimation&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Reasons detection can fail:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Ergodicity: ensembles vs single instances&lt;/li&gt;
&lt;li&gt;Sufficient statistical power&lt;/li&gt;
&lt;li&gt;Appropriate dynamics&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Methods&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Defining an indicator – significant Kendall rank correlation coefficient τ as in &lt;a href=&quot;http://hdl.handle.net/10.1073/pnas.0802430105&quot; title=&quot;doi:10.1073/pnas.0802430105&quot;&gt;doi:10.1073/pnas.0802430105&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Simulation approach&lt;/li&gt;
&lt;li&gt;Analytic limits&lt;/li&gt;
&lt;li&gt;accounting for delay?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Figures&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Saddle node bifurcation example – should discuss difference between stochastic and deterministic edge?&lt;/li&gt;
&lt;li&gt;Single replicates using standard detection statistics&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Results/Discussion&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Misleading indicators&lt;/li&gt;
&lt;li&gt;Need for further exploration&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Towards a better approach&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Estimating the linear system directly:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;estimating the exponential coefficient λ of the autocorrelation function directly. Contrast to the autocorrelation. Estimating spectral width.&lt;/li&gt;
&lt;li&gt;estimating variance directly: &lt;img src=&quot;http://openwetware.org/images/math/2/f/e/2fed1c2e179a9874a35108bdcbfdbd48.png&quot; alt=&quot;\frac{\sigma^2}{2\lambda }&quot; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Compare to ARMA approach of&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=19849710&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Ziebarth NL, Abbott KC, and Ives AR. .&lt;/a&gt; pmid:19849710. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=19849710&quot; title=&quot;PMID 19849710&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=19849710&quot; title=&quot;PMID 19849710&quot;&gt;HubMed&lt;/a&gt; [Ives2010]&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Changepoint analysis vs gradual trends.
&lt;ul&gt;
&lt;li&gt;i.e. &lt;a href=&quot;http://www.variation.com/cpa/tech/changepoint.html&quot; title=&quot;http://www.variation.com/cpa/tech/changepoint.html&quot;&gt;web example&lt;/a&gt;,&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.gbv.de/dms/goettingen/230144551.pdf&quot; title=&quot;http://www.gbv.de/dms/goettingen/230144551.pdf&quot;&gt;book&lt;/a&gt;,&lt;/li&gt;
&lt;li&gt;Bayesian / Dirchelet Process Prior analysis,&lt;/li&gt;
&lt;li&gt;model selection.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Examples from software:
&lt;ul&gt;
&lt;li&gt;correlation C executable&lt;/li&gt;
&lt;li&gt;R: source(“warning_signals.R”) example.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;other-topics&quot;&gt;Other topics&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;F1000&lt;/li&gt;
&lt;li&gt;Workstation order&lt;/li&gt;
&lt;li&gt;Adaptive Dynamics manuscript&lt;/li&gt;
&lt;li&gt;Labrids Manuscript&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;updated-outline&quot;&gt;Updated Outline&lt;/h2&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Warning Signals intro (Alan)&lt;/li&gt;
&lt;li&gt;Scope &amp;amp; previous work -&amp;gt; 1D (Alan)&lt;/li&gt;
&lt;li&gt;Reasons Detection can fail (Carl)&lt;/li&gt;
&lt;li&gt;Methods -&amp;gt; defining an indicator (Carl)&lt;/li&gt;
&lt;li&gt;Simulation approach (Carl)&lt;/li&gt;
&lt;li&gt;Analytic limits (Carl – still to do)&lt;/li&gt;
&lt;li&gt;Accounting for delay (Carl – still to do)&lt;/li&gt;
&lt;li&gt;Results – saddle node (Carl – still to do)&lt;/li&gt;
&lt;li&gt;Results – single replicate (Carl – still to do)&lt;/li&gt;
&lt;li&gt;Conclusions (Alan / both)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&quot;http://www.sciencemag.org/about/authors/prep/prep_init.dtl&quot; title=&quot;http://www.sciencemag.org/about/authors/prep/prep_init.dtl&quot;&gt;style guidelines&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/19/Research.html"/>
   <updated>2010-04-19T00:00:00+00:00</updated>
   <id>/04/19/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Sent Peter updated draft of Labrids manuscript&lt;/li&gt;
&lt;li&gt;Writing up logarithms manuscript finally…&lt;/li&gt;
&lt;li&gt;Contacting Helen re. primates data&lt;/li&gt;
&lt;li&gt;Created Labrid Functional Morphology literature collection:&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com&quot;&gt;Research&lt;/a&gt; collected using Mendeley&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Started stochastic methods and model inference collection:&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com&quot;&gt;Research&lt;/a&gt; collected using Mendeley&lt;/p&gt;
&lt;h2 id=&quot;various-to-do&quot;&gt;Various To Do&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Add Peter’s bootstrap references and books to stochastic methods and model inference library.&lt;/li&gt;
&lt;li&gt;Add Science of Science papers to Future of Science collection.&lt;/li&gt;
&lt;li&gt;Adding tags, abstracts, etc to Mendeley public Library&lt;/li&gt;
&lt;li&gt;Personal/extended task view (and opinion?) on R comparative methods?&lt;/li&gt;
&lt;li&gt;Summarize existing methods on notebook coverpage.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes&quot;&gt;Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Reviewing ways to collaborate on LaTeX – hmm, converting into open office format may make the most sense for manuscripts, as layout isn’t important anyway. Mendeley plugin for references in openoffice is quite nice.&lt;/li&gt;
&lt;li&gt;Converting my LaTeX files to document format:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;latex2rtf simple, reliable for text, ok for figures, seems to fail on equations/symbols and formating.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cse.ohio-state.edu/~gurari/TeX4ht/&quot; title=&quot;http://www.cse.ohio-state.edu/~gurari/TeX4ht/&quot;&gt;tex4ht&lt;/a&gt; seems the best way if the tex document is configured to produce dvi. Still need a pdflatex solution. i.e.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;htlatex filename &amp;quot;xhtml,ooffice&amp;quot; &amp;quot;ooffice/! -cmozhtf&amp;quot; &amp;quot;-coo -cvalidate&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;An &lt;a href=&quot;http://en.wikibooks.org/wiki/LaTeX/Collaborative_Writing_of_LaTeX_Documents&quot; title=&quot;http://en.wikibooks.org/wiki/LaTeX/Collaborative_Writing_of_LaTeX_Documents&quot;&gt;excellent guide&lt;/a&gt; here on collaborating on latex, basically through version management methods though.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.scribtex.com/&quot; title=&quot;http://www.scribtex.com/&quot;&gt;Scribtex&lt;/a&gt;, an online tex editor looks particularly promising.&lt;/li&gt;
&lt;li&gt;The openwetware page on LaTeX is also quite useful, and the OWW LaTeX extension makes OWW another LaTeX collaborative solution.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>MATICCE</title>
	 <link href="/2010/04/18/MATICCE.html"/>
   <updated>2010-04-18T00:00:00+00:00</updated>
   <id>/04/18/MATICCE</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Testing out &lt;a href=&quot;http://redwood.mortonarb.org/lab_pages/hipp/&quot; title=&quot;http://redwood.mortonarb.org/lab_pages/hipp/&quot;&gt;Andrew Hipp’s&lt;/a&gt; &lt;a href=&quot;http://cran.r-project.org/web/packages/maticce/index.html&quot; title=&quot;http://cran.r-project.org/web/packages/maticce/index.html&quot;&gt;maticce&lt;/a&gt; package, &lt;a href=&quot;http://hdl.handle.net/10.1093/bioinformatics/btp625&quot; title=&quot;doi:10.1093/bioinformatics/btp625&quot;&gt;doi:10.1093/bioinformatics/btp625&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Goal of package is to model-average over trees and regimes. Takes a brownie approach to regimes, identifying nodes at which a transition may have occurred.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### The Approach&lt;/p&gt;
&lt;p&gt;Takes a brute force approach to avoid user-defined paintings in the ouch framework. Users identify nodes of interest, software tries combinations of possible shifts.&lt;/p&gt;
&lt;h4 id=&quot;runbatchhansen&quot;&gt;runBatchHansen()&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;User identifies a set of nodes of interest, and optionally a maximum number of transitions.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;What models/regimes are tested?&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;You choose a set of candidate nodes and a maximum number of transitions that can occur (defaults to all nodes). For instance, you may specify four candidate nodes but set a max at 2 changes (three peaks). Then the batch will evaluate 12 models: the 4 choose 2 = 6 three-peak models, the 4 choose 1 = 4 two peak models, a single peak, and a brownian motion model. If you didn’t specify a max, it would allow the 1 five-peak (4 choose 4), and the 4 four-peak (4 choose 3) models, for a total of 17 models.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Has summary function. Model averaging is a weighted average by BIC&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;characterStates – the trait data, currently must be one-dimensional, seems like it can be in ape or ouch format.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;nodes of interest have to be specified by listing all the species descendants. somewhat cumbersome.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Takes an ouchtree or list of ouchtrees.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Output&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;See loglik, sigma and alpha values of the models tested (doesn’t include brownian motion by default)&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;trialBayesConsensus &amp;lt;- runBatchHansen(ape2ouch(carex$ovales.tree), carex$ovales.data, carex$ovales.nodes[1:4], maxNodes = 2)
&amp;gt; trialBayesConsensus$hansen
[[1]]
     loglik dof sigma.squared theta / alpha
1  52.72744   5    5.31005363    331.626872
2  50.54000   5    5.86424413    337.252821
3  50.21561   5    6.04474990    343.369492
4  49.95720   4    5.14354118    289.387746
5  51.75330   5    5.12434568    308.473054
6  51.81077   5    4.84664447    292.440242
7  51.75142   4    5.16258108    310.762680
8  44.31518   5    6.55448190    297.993592
9  44.17736   4    8.49647580    384.329498
10 42.89766   4    6.87292796    296.238909
11 39.57676   3    0.09810907      3.341806
 
 
## See which nodes involved a shift:
 
&amp;gt; trialBayesConsensus$regMatrix
[[1]]
   1 2 3 4
1  1 1 0 0
2  1 0 1 0
3  1 0 0 1
4  1 0 0 0
5  0 1 1 0
6  0 1 0 1
7  0 1 0 0
8  0 0 1 1
9  0 0 1 0
10 0 0 0 1
11 0 0 0 0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Where the four nodes are shown as separate columns, and there numbers correspond to their indices specified in ovales.nodes.&lt;/p&gt;
&lt;h4 id=&quot;multimodel&quot;&gt;multiModel()&lt;/h4&gt;
&lt;p&gt;For a focal node, there are 5 hypotheses we want to distinguish:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;BM&lt;/li&gt;
&lt;li&gt;OU&lt;/li&gt;
&lt;li&gt;Two OU&lt;/li&gt;
&lt;li&gt;Two BM, censored as separate sub trees (data of non-descendants is not considered)&lt;/li&gt;
&lt;li&gt;Two OU, censored.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Note that the first three of these cases are among the cases covered in a runBatchHansen() over the node.&lt;/p&gt;
&lt;h4 id=&quot;other-functions&quot;&gt;Other functions&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;paintBranches() turns a maticce specification of a focal node into an OUCH regimes list, identifying the regime of each branch.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Other Notes&lt;/p&gt;
&lt;h3 id=&quot;evaluation&quot;&gt;Evaluation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;A useful package for batch runs of hansen hypotheses, reasonably polished. Two chief drawbacks:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Method of specifying which nodes are of interest seems very annoying. Should require only two tips, and hence specify their common ancestor as the node. Should have an option to identify the node merely by id number.&lt;/li&gt;
&lt;li&gt;Having to specify nodes doesn’t really get around the painting problem.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;The parameter space of paintings is too big!!&lt;/em&gt; A new approach is needed to thinking about this; one that does not consider all possible outcomes as different models. (but of course I’d say that).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes-reading&quot;&gt;Notes / Reading&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.slideshare.net/juansequeda/introduction-to-linked-data-2341398&quot; title=&quot;http://www.slideshare.net/juansequeda/introduction-to-linked-data-2341398&quot;&gt;Linked Data&lt;/a&gt; a new approach to semantic web ideas.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.newsweek.com/id/235084&quot; title=&quot;http://www.newsweek.com/id/235084&quot;&gt;Newsweek&lt;/a&gt; on why scientists are losing PR battle.&lt;/li&gt;
&lt;li&gt;Recently started wikipedia page on &lt;a href=&quot;http://en.wikipedia.org/wiki/Science_2.0&quot; title=&quot;http://en.wikipedia.org/wiki/Science_2.0&quot;&gt;Science 2.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackexchange.com/directory/list?sort=4&quot; title=&quot;http://stackexchange.com/directory/list?sort=4&quot;&gt;lots&lt;/a&gt; of Stack Overflow models. Came across: &lt;a href=&quot;http://www.semanticoverflow.com/questions/744/what-is-a-good-elevator-pitch-for-linked-data/767#767&quot; title=&quot;http://www.semanticoverflow.com/questions/744/what-is-a-good-elevator-pitch-for-linked-data/767#767&quot;&gt;Semantic Overflow&lt;/a&gt; (thanks Rod Page).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Headline text ————-&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>iEvoBio Submission</title>
	 <link href="/2010/04/16/iEvoBio-Submission.html"/>
   <updated>2010-04-16T00:00:00+00:00</updated>
   <id>/04/16/iEvoBio-Submission</id>
   <content type="html">&lt;h3 id=&quot;quantifying-information-in-a-phylogenetic-tree-the-robustness-of-phylogenetic-signal&quot;&gt;Quantifying Information in a Phylogenetic Tree: The Robustness of Phylogenetic Signal&lt;/h3&gt;
&lt;p&gt;Since Felsenstein (1985)’s influential paper on phylogenetic contrasts, phylogenetically-based inferences of evolutionary patterns have gotten increasingly more complex (Hansen, 1997; Butler and King, 2004; Freckleton and Harvey, 2006; O’Meara et al., 2006; Pagel and Meade, 2006). More and more sophisticated models are applied to datasets of species mean traits on a phylogenetic tree in an attempt to answer such questions as reconstructing ancestral states, identify changes in rates of character evolution across time and across clades, identify the number and location of evolutionary optima or the strength of stabilizing selection. In each of these analyses, an ultrametric phylogenetic tree is the only source of temporal information to quantify these intrinsically temporally-based questions.&lt;/p&gt;
&lt;p&gt;The extent to which a phylogenetic tree can reliably shed light into the evolution of traits in the past depends not only on its size but on its structure. For instance, an unresolved or star phylogeny contains no information and renders phylogenetic techniques uninformative, regardless of the number of taxa. While the question of phylogenetic signal is not new (Price, 1997; Losos, 1996), there has been insufficient analysis of when a phylogenetic signal is substantial enough to inform the kinds of inferences we now routinely perform.&lt;/p&gt;
&lt;p&gt;I will present examples of how typical phylogenetic analyses are applied to trees that are insufficiently informative to choose between models. I will discuss ways to detect and quantify the power of a phylogenetic tree relative to common methods. I will introduce an actively developing open source software package for addressing these issues. In the spirit of the conference, this research and code are being developed and released in the open under GPL-v3.0 and Creative Commons by-sa licenses.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;NESCent proposal style topics:&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;possible-topics&quot;&gt;Possible topics&lt;/h3&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Comparative Methods Workflow hackathon&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Interfaces between programs&lt;/li&gt;
&lt;li&gt;Extensibility of existing software&lt;/li&gt;
&lt;li&gt;Redundancy of approaches&lt;/li&gt;
&lt;li&gt;User / developer dialog and interface&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Reliability: evaluating the robustness of current methods&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Model choice criteria&lt;/li&gt;
&lt;li&gt;Robustness to assumptions in tree, etc&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot; type=&quot;1&quot;&gt;
&lt;li&gt;Future of methods&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Bayesian implementations&lt;/li&gt;
&lt;li&gt;High-dimensional data&lt;/li&gt;
&lt;li&gt;databases, standards&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;research&quot;&gt;Research&lt;/h2&gt;
&lt;h2 id=&quot;seminars&quot;&gt;Seminars&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Discussing &lt;a href=&quot;http://hdl.handle.net/10.1126/science.1084786_Harmon_et_al._%282003%29&quot; title=&quot;doi:10.1126/science.1084786_Harmon_et_al._(2003)&quot;&gt;doi:10.1126/science.1084786 Harmon et al. (2003)&lt;/a&gt; in PDG today.&lt;/li&gt;
&lt;li&gt;Considering how best to set up a Mendeley or Cite-U-Like collection for PDG. Ideally find a system where we might share individual comments or a collective rating of the paper.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Mendeley Public Collection&lt;/li&gt;
&lt;li&gt;Mendeley Shared Collection&lt;/li&gt;
&lt;li&gt;Cite-U-Like group&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;notes&quot;&gt;Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;inclusion embedding (of Nescent ideas) done using curly brace transclusion, and&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;onlyinclude&amp;gt; &amp;lt;/onlyinclude&amp;gt;
&amp;lt;noinclude&amp;gt; &amp;lt;/noinclude&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;See &lt;a href=&quot;http://en.wikipedia.org/wiki/Wikipedia:Transclusion&quot; title=&quot;http://en.wikipedia.org/wiki/Wikipedia:Transclusion&quot;&gt;wikimedia information&lt;/a&gt; for more details.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Branching Paper</title>
	 <link href="/2010/04/15/branching-paper.html"/>
   <updated>2010-04-15T00:00:00+00:00</updated>
   <id>/04/15/branching-paper</id>
   <content type="html">&lt;p&gt;&lt;strong&gt;editorial note&lt;/strong&gt;: These notes pre-date the formal start of my online laboratory notebook, &lt;a href=&quot;http://carlboettiger.info/2010/02/02/The-Lab-Notebook-Goes-Open-.html&quot;&gt;Feb 2 2010: The Lab Notebook Goes Open&lt;/a&gt; and were adapted from a LaTeX document in which I kept notes on this topic during my summer at &lt;a href=&quot;http://www.iiasa.ac.at/&quot;&gt;IIASA&lt;/a&gt;. Lacking a proper notebook then, documents like this one were updated periodically and occassionally branched into new ones. The post date represents the last time the LaTeX document was edited in the course of that research.&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;abstact&quot;&gt;Abstact&lt;/h1&gt;
&lt;p&gt;While empirical evidence leans almost entirely in favor of allopatric speciation, theoretical evolutionary models continue to suggest that sympatric speciation should be possible, even common. We show stochastic effects due to finite population sizes can pose a significant impediment to the evolutionary branching. Early in branching, coexistence of the diverging populations is protected by a very weak stabilizing force, as trait differences are still small. Consequently stochastic collapse of this weak coexistence is common on the evolutionary timescale required for mutation-limited divergence. Sympatric branching mechanisms require an evolutionary divergence to occur fast enough to prevent this eventual collapse. Either rapid mutations or mutations of large effect are required to traverse this branching point successfully - or otherwise a population that begins to diverge in allopatry can find its branching reinforced upon second contact by these sympatric effects.&lt;/p&gt;
&lt;p&gt;Evolution demographic stochasticity branching adaptive dynamics&lt;/p&gt;
&lt;h1 id=&quot;introduction&quot;&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Speciation is evolution at the grandest scale. Speciation is the mechanism responsible for generating the astounding biodiversity that is the most salient feature of life on Earth, and one of our most threatened and irreplaceable resources. Speciation is also one of the greatest mysteries of evolution, occurring primarily on scales of space and time beyond our experimental reach, and through a delicate interplay of events from the molecular shifting of nucleotides to the geologic shifting of mountains and rivers. For organisms with sexual reproduction, the process of speciation must account for the genetic isolation of incipient species, and speciation models must therefore embrace genetic dynamics (Coyne &amp;amp; Orr 2004). Accounting for this genetic dimension of speciation has been achieved largely at the expense of simplifying, or ignoring altogether, speciation’s ecological dimension. The latter results from the complex features and interactions that distinguish species from one another and that enable a rich diversity of species to persist.&lt;/p&gt;
&lt;p&gt;The importance of ecological interactions in speciation has been acknowledged for some time (the concept of reinforcement goes back to Dobzhansky and Wallace), yet few studies have had more influence in highlighting the ecological basis for speciation then that by Dieckmann and Doebeli (1999), which brought the nascent theory of mutation-limited long-term phenotypic evolution known as ‘adaptive dynamics’ to the attention of empirical and theoretical evolutionary ecologists. While genetic dynamics are addressed in this study, at its heart lies an ecological model for the evolutionary branching of a phenotypic trait describing competitive interactions: in the course of adaptation, this trait approaches an evolutionary branching point, i.e., an attractor of the evolutionary dynamics of a single morph that, once reached through directional selection, naturally leads to the emergence of a diverging dimorphism through frequency-dependent disruptive selection. In this project, we will focus on the dynamics around such evolutionary branching points. While ignoring genetic details for a start, we will extend previous work by focusing on the impacts of stochastic processes on the evolutionary dynamics leading to biological diversification.&lt;/p&gt;
&lt;p&gt;Almost all quantitative theories of evolution have relied on stochastic models to address the impacts of chance events - such as mutations, births, deaths, and environmental changes - that affect the evolutionary process (Fisher 1937; Lande 1979; Coyne &amp;amp; Orr 2004). Adaptive dynamics theory typically considers two sources of stochasticity: random mutations and the loss of advantageous mutants to chance extinction while their numbers are small. What these models typically do not consider is demographic stochasticity of resident populations (resulting from intrinsic fluctuations through stochastic birth and death events in finite populations of discrete individuals) and environmental stochasticity (resulting from external fluctuations in the environmental conditions a population experiences).&lt;/p&gt;
&lt;p&gt;Several recent studies have tried to overcome these limitations. Claessen et al. (2007, 2008) explore simulations of evolutionary branching in small populations and found that demographic stochasticity can delay or halt diversification. Johansson and Ripa (2006) explored the impact that correlated environmental stochasticity has on diversification. They assume that as populations diverge, the environmental influences upon them become less similar. They demonstrate that this correlation can facilitate coexistence early in the process of branching, and as it weakens, the chance that a branch is lost increases. While these studies make an excellent start, a more general theory and mathematical framework is needed to untangle and quantify the multitude of effects stochasticity has on evolutionary branching.&lt;/p&gt;
&lt;h1 id=&quot;methods&quot;&gt;Methods&lt;/h1&gt;
&lt;h2 id=&quot;model&quot;&gt;Model&lt;/h2&gt;
&lt;p&gt;We consider the classic adaptive dynamics model for evolutionary branching under competition for a limiting resource by Dieckmann and Doebeli (1999). The population dynamics of &lt;span class=&quot;math&quot;&gt;\(N(x,t)\)&lt;/span&gt; individuals each with focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; are given by a continuous time birth-death process with rates&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
b(N) = &amp;amp; r \nonumber \\
d(N) = &amp;amp; r \frac{\sum_yN(y,t)C(x,y)}{K(x)} .\label{general_logistic}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The focal trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; can be thought of as some continuous phenotypic variable, such as beak size, which affects resource consumption. Niche differences driving speciation arise from differences in this trait. In the model, &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; is the resource kernel which determines the equilibrium population density and &lt;span class=&quot;math&quot;&gt;\(C(x,y)\)&lt;/span&gt; is a the competition kernel, describing the relative change in death rate of individuals of type &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; due to competition by individuals of type &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;. Given &lt;span class=&quot;math&quot;&gt;\(C(x,x)=1\)&lt;/span&gt;, the equilibrium density of a monomorphic population is &lt;span class=&quot;math&quot;&gt;\(N^{\ast}(x)=K(x)\)&lt;/span&gt;. Following  we assume the following Gaussian forms,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[K(x)=K_0e^{-x^2/(2\sigma_k^2)}, \label{K}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[C(x,y)=e^{-(x-y)^2/(2\sigma_c^2)}, \label{C}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\sigma_k\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; are scale factors for the resource distribution and competition kernels respectively. &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; can be though of as the niche size. We focus on the case &lt;span class=&quot;math&quot;&gt;\(\sigma_k&amp;gt;\sigma_c\)&lt;/span&gt;, for which the model has an evolutionary branching point at &lt;span class=&quot;math&quot;&gt;\(x=0\)&lt;/span&gt; .&lt;/p&gt;
&lt;p&gt;The evolutionary dynamics are specified only at the phenotypic level: We assume that with probability &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt; an individual birth results in a mutant offspring, and that the mutant trait is chosen from a Gaussian distribution centered at the trait value of the parents and with a variance &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}^2\)&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id=&quot;the-adaptive-dynamics-of-branching&quot;&gt;The Adaptive Dynamics of Branching&lt;/h2&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm4.staticflickr.com/3711/9624789620_a3f439eace_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Evolutionary branching occurs in this model when the resource kernel is wider than the competition kernel, &lt;span class=&quot;math&quot;&gt;\(\sigma_k &amp;gt; \sigma_c\)&lt;/span&gt; as discussed in . It is straight forward to show that the invasion fitness &lt;span class=&quot;math&quot;&gt;\(s(y,x) := b(K(x),x,y) -d(K(x), x,y)\)&lt;/span&gt; of a rare mutant &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt; in a population &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; at equilibrium has a singular point at &lt;span class=&quot;math&quot;&gt;\(x^*=0\)&lt;/span&gt;, the peak of the resource distribution. This is easily confirmed by taking the second derivatives or observing the pairwise invasibility plot [fig:pip].&lt;/p&gt;
&lt;h2 id=&quot;phases-of-branching&quot;&gt;Phases of branching&lt;/h2&gt;
&lt;p&gt;Evolutionary branching through this mechanism can be divided into four phases. In the first phase, the population approaches the branching point by repeated invasions that completely replace the monomorphic population. This rate is governed by the canonical equation of adaptive dynamics, a rate proportional to the size of mutational jumps relative to the size of the resource kernel, &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}/\sigma_k\)&lt;/span&gt;. Mathematically, this phase can be defined by the &lt;span class=&quot;math&quot;&gt;\(P_1\)&lt;/span&gt; region of the pairwise invasibility plot. In this region, dimoprhisms are always transient.&lt;/p&gt;
&lt;p&gt;In the second phase, the population is near enough to the branching point that mutations begin occuring in the coexistence region. More precisely, any dimorphism that occurs in the &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; region but where one of the populations is too small to contribute to density-dependent effects can be considered to be in this phase. The dynamics of this phase are thus governed by the fixation probabilities of rare mutants occuring in the coexistence region. This phase may often fail when a rare mutant occurs in the coexistence region but is soon lost to drift.&lt;/p&gt;
&lt;p&gt;The third phase begins when mutations in the coexistence region survive the initial genetic drift to establish as significant frequencies in the population. In this stage the density-dependent contribution of each population is relevant. This stage may fail due to the loss of either population, more often the one farther from the branching point. As this is usually (but not necessarily) the resident population that gave rise to the other population through mutation, the failure of this phase can be thought of in terms of loss of the resident population, while the second phase is governed primarily by the loss of the invader population.&lt;/p&gt;
&lt;p&gt;In the fourth phase, subsequent mutations farther from the branching point invade and the populations move apart. Each time a mutant exterior to the branching point successfully invades the probability the coexistence becomes exponentially more stable, as we will demonstrate. While the expected coexistence time for the two populations remains similar to the evolutionary timescale over which new mutants enter and establish, the coexistence may be lost, collapsing back to the second phase. However, as the coexistence of the first pair (phase 3) is much more likely to collapse than the subsequently more stable coexisting pairs that arise from it, we will have a good approximation by considering only the probabilty that the initial pair survives long enough to enter phase four. This is justified by the Ahrennius approximation result and confirmed by numerical simulation.&lt;/p&gt;
&lt;h3 id=&quot;overview-of-the-approach&quot;&gt;Overview of the approach&lt;/h3&gt;
&lt;p&gt;The division into phases provides both a conceptual and mathematical framework to address the branching process. Analyzing the first two phases essentially consists of partitioning the space of possible mutants: considering all the mutants that lie in the &lt;span class=&quot;math&quot;&gt;\(P_1\)&lt;/span&gt; region that are expected to invade and replace the resident (moving the population closer to the branching point as per phase 1), and mutants that reach the coexistence region &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; in phase 2. This is done by partitioning the domain of integration for an integral over mutant traits &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt; for each resident &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;. The closer &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; is to &lt;span class=&quot;math&quot;&gt;\(x^*\)&lt;/span&gt; the more of this integral lies in &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; and entering phase two becomes increasingly probable. This treatment follows along similar lines as the original derivation of the canonical equation of adaptive dynamics .&lt;/p&gt;
&lt;p&gt;The crux of the remaining third and fourth phases settles around predicting the coexistence time. This is done through a diffusion approximation approach to individual dynamics, which remains quite technical to solve. To provide both an effective approximation and a useful intuition, we demonstrate how this coexistence problem can be construed as an escape from a potential energy well, as in classical chemical kinetics. Understanding the depth of this well tells us most of what we need to know about the coexistence time. Relating the coexistence timescale to the evolutionary timescale wraps up the calculation for how long branching will take.&lt;/p&gt;
&lt;p&gt;The deterministic theory applies both the limit of rare mutations (small &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt;) and small mutational steps (small &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}\)&lt;/span&gt;). In our treatment, either one of these can become the limiting factor and correspond to different regimes of adaptive branching. If mutations are very rare, we’ll see that the population must essentially survive phase 3 in a single mutational step. In this regime recieving a single mutation far enough into the &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt; region to survive the coexistence balance (phase 3 to 4). This corresponds to a single mutational step that is on the order of the width of the competition kernel, &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt;. Here branching is accomplished essentially by the single unlikely event being “rolled,” and transitions between phases are slow but rarely collapse to an earlier stage. When mutational step size is limiting, many mutational steps are required to get any population a distance of order &lt;span class=&quot;math&quot;&gt;\(\sigma_c\)&lt;/span&gt; away - to escape the shadow of competition. In this regime, successful branching appears as a lucky string of mutations, like a long series of flipping a coin and coming up heads rather than the singular improbable event. This regime is characterized by many aborted branching attempts before one succeeds. The smaller &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt; becomes, the smaller the chances of seeing this lucky run within the coexistence time. The smaller &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}\)&lt;/span&gt; becomes the smaller the chances of seing the rare large jump within the coexistence time. When both are too small relative to the coexistence time, the population will fail to branch.&lt;/p&gt;
&lt;h2 id=&quot;approaching-the-branching-point&quot;&gt;Approaching the branching point&lt;/h2&gt;
&lt;p&gt;Classically, the approach to the branching point is governed by the canonical equation of adaptive dynamics . To account for branching we have to revisit the original derivation of this equation where we relax the limit of small mutational steps sufficiently to allow mutants to enter the coexitence region, &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt;, in Fig. [fig:pip]. The derivation of the canonical equation integrates only over those mutants that fall into the invasion-substitution region, &lt;span class=&quot;math&quot;&gt;\(P_1\)&lt;/span&gt;. However, since the derivation is done in the limit of small mutational step sizes, this encompasses essentially all of the weight of the mutational kernel, and to good approximation can thus be replaced with the entire &lt;span class=&quot;math&quot;&gt;\(P_1 \cup P_2\)&lt;/span&gt; region. Recall that in the derivation of the canonical equation, deleterious mutations are given zero probability of fixing (from the branching process approximation), and hence this corresponds to integrating over half of the real line &lt;span class=&quot;math&quot;&gt;\(\mathbb{R}\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\mathrm{d}\bar x}{\mathrm{d}t} = \mu N^*(x) \phantom \cdot \partial_y s(y,x) \Big|_x \int_{P_1} [y-x]^2 M(y-x) \mathrm{d}[y-x]
\label{canonical}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The probability of such a mutant occurring in our monomorphic population of trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; is given by the probability that any mutant occurs (given by the population size, approximately &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; at equilibrium, times the birth rate &lt;span class=&quot;math&quot;&gt;\(b(x)\)&lt;/span&gt; times the mutation rate &lt;span class=&quot;math&quot;&gt;\(\mu\)&lt;/span&gt;) times the probability that the mutation lies on the opposite side of the coexistence boundary, which we denote as &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\psi(x)\)&lt;/span&gt;, which is &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; reflected across the line &lt;span class=&quot;math&quot;&gt;\(y=x\)&lt;/span&gt;. This depends on the mutational kernel, &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; which gives the probability that a mutant arising from a resident population of trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; bears trait &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt; that falls withing the coexistance region as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\int_{-\infty}^{\phi(x)} M(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) \mathrm{d}y\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Without loss of generality let us assume that the singular strategy &lt;span class=&quot;math&quot;&gt;\(x^* = 0\)&lt;/span&gt; and that we start from some trait value &lt;span class=&quot;math&quot;&gt;\(x_0 &amp;gt; x^*\)&lt;/span&gt;. Additionally, let us we assume &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; is Gaussian in &lt;span class=&quot;math&quot;&gt;\(y-x\)&lt;/span&gt; with mean 0 and variance &lt;span class=&quot;math&quot;&gt;\(\sigma_{\mu}^2\)&lt;/span&gt;. However, we do not wish to consider all such mutants &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;, but only those that survive. We multiply the probability of a mutant having trait &lt;span class=&quot;math&quot;&gt;\(y\)&lt;/span&gt;, &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt;, times the probability that is survives drift. This probability we quote from the Galton-Watson branching process, &lt;span class=&quot;math&quot;&gt;\(1-\tfrac{d(y,x)}{b(y,x)}\)&lt;/span&gt;. Using our model for birth and death rates , the probability of surviving branching is&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[1-\frac{C(y,x)K(x)}{K(y)} := S(y,x)
\label{S}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;which we denote as &lt;span class=&quot;math&quot;&gt;\(S(y,x)\)&lt;/span&gt; as indicated. Hence we modify our integral to consider all mutants &lt;span class=&quot;math&quot;&gt;\(y &amp;lt; x^*\)&lt;/span&gt; which occur with probability &lt;span class=&quot;math&quot;&gt;\(M(y,x)\)&lt;/span&gt; and then survive with probability &lt;span class=&quot;math&quot;&gt;\(S(y,x)\)&lt;/span&gt;, and write down the rate &lt;span class=&quot;math&quot;&gt;\(P(x)\)&lt;/span&gt; at which a mutant which leads to branching occurs from our monomorphic population with trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[P(x) := r \mu K(x)\left( \int_{-\infty}^{\phi(x)} M(y,x) S(y,x) \mathrm{d}y + \int_{\psi(x)}^{\infty} M(y,x) S(y,x) \mathrm{d}y  \right)
\label{MSerf}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Though a little cumbersome, this can be written in nearly closed form (using the error function). For our particular model &lt;span class=&quot;math&quot;&gt;\(s(y,x)\)&lt;/span&gt;, we can write the boundaries &lt;span class=&quot;math&quot;&gt;\(\phi(x)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(\psi(x)\)&lt;/span&gt; as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\phi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}+1}{\frac{\sigma_k^2}{\sigma_c^2}-1} \nonumber \\
\psi(x) = x\frac{\frac{\sigma_k^2}{\sigma_c^2}-1}{\frac{\sigma_k^2}{\sigma_c^2}+1}
\label{phipsi}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Then, given a starting condition &lt;span class=&quot;math&quot;&gt;\(x_0\)&lt;/span&gt;, we can determine the expected trait &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt; at time &lt;span class=&quot;math&quot;&gt;\(t\)&lt;/span&gt; of a monomorphic resident population by integrating the canonical equation,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{1}{2} \mu \sigma_{mu}^2 N^*(x) \partial_y s(y,x)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;which for our model is&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}x}{\mathrm{d}t} = \frac{-x}{2\sigma_k^2} r \mu \sigma_{\mu}^2 K(x)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;While no closed form solution exists for &lt;span class=&quot;math&quot;&gt;\(x(t)\)&lt;/span&gt; in this case, if we assume &lt;span class=&quot;math&quot;&gt;\(x_0 \ll \sigma_k\)&lt;/span&gt; then to good approximation we can view &lt;span class=&quot;math&quot;&gt;\(K(x)\)&lt;/span&gt; to be constant over the interval and take our path to be:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[x(t) = x_0 \exp\left( -r \mu \sigma_{\mu}^2 K_0 t/\sigma_k^2\right)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Using this mean path, we can write down an approximation for the rate of a branching mutant occurring as a function of time, &lt;span class=&quot;math&quot;&gt;\(P(x(t))\)&lt;/span&gt;. Using this time dependent rate, the probability of not branching after time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt; is simply &lt;span class=&quot;math&quot;&gt;\(\exp\left( - \int_0^T P(t)\mathrm{d}t \right)\)&lt;/span&gt;. One minus this is the probability branching by time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt;; i.e. the cumulative density function, hence the probability density function for the waiting time is:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\Pi(T) = P(x(T)) \exp\left( -\int_0^T P(x(t)) \right)
\label{pdf}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and the expected time to complete phases 1 and 2 is &lt;span class=&quot;math&quot;&gt;\(\int_0^{\infty} T \Pi(T) \mathrm{d}T\)&lt;/span&gt;. This is our first analytic approximation.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm8.staticflickr.com/7306/9621553187_8bf5340eef_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5544/9621553385_dc4d6750fa_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5549/9624790208_a866e5f8f1_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;coexistence&quot;&gt;Coexistence&lt;/h2&gt;
&lt;p&gt;Consider a population of two coexisting types, characterized by traits &lt;span class=&quot;math&quot;&gt;\(x_1\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(x_2\)&lt;/span&gt; respectively. The birth and death rates of each population are then given by expression  . We’ll assume that the populations can coexist, that is &lt;span class=&quot;math&quot;&gt;\((x_1, x_2)\)&lt;/span&gt; falls into the coexistence region &lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt;; &lt;em&gt;i.e.&lt;/em&gt; that $C(x_1,x_2)K(x_2) /K_1(x_1) &amp;lt; 1 $ and &lt;span class=&quot;math&quot;&gt;\(C(x_1, x_2) K(x_1)/K(x_2) &amp;lt; 1\)&lt;/span&gt;. This guarentees that each population has a positive expected growth rate when rare. However, because the population is composed of finitely many discrete individuals, there is still a chance that either type will be lost to chance; to demographic stochasticity. We whish to characterize the expected waiting time for such an event to occur.&lt;/p&gt;
&lt;p&gt;To do so, we will switch first into density and then frequency, to obtain a one-dimensional expression we can solve exactly. We will then use the Arhennius approximation to obtain a closed form solution. First, we will replace the discrete number of individuals &lt;span class=&quot;math&quot;&gt;\(N\)&lt;/span&gt; with the macroscopic, continuous variable &lt;span class=&quot;math&quot;&gt;\(n\)&lt;/span&gt;, representing the mean &lt;em&gt;density&lt;/em&gt; of individuals; &lt;span class=&quot;math&quot;&gt;\(N/A\)&lt;/span&gt;, where &lt;span class=&quot;math&quot;&gt;\(A\)&lt;/span&gt; is the area in which &lt;span class=&quot;math&quot;&gt;\(N\)&lt;/span&gt; individuals are found. For suitably large &lt;span class=&quot;math&quot;&gt;\(A\)&lt;/span&gt;, we will be able to accurately describe &lt;span class=&quot;math&quot;&gt;\(n\)&lt;/span&gt; with a coupled stochastic differential equation for each population. By changing variables once more into the frequency of one type, &lt;span class=&quot;math&quot;&gt;\(p = n_1/(n_1+n_2)\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(n = n_1 + n_2\)&lt;/span&gt;, we are able to do a timescale seperation to focus on the dynamics in a single variable, &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The master equation that describes the probability of observing &lt;span class=&quot;math&quot;&gt;\(N_i\)&lt;/span&gt; individuals of type &lt;span class=&quot;math&quot;&gt;\(i\)&lt;/span&gt; is given by,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\mathrm{d}}{\mathrm{d}t} P(N_1,t) &amp;amp;= (\text{E}_1 - 1) r N_1 \frac{N_1 + C(x_1, x_2) N_2}{K(x_1) }P(N_1) + (\text{E}_1^{-1} - 1)r N_1 P(N_1) \nonumber \\
\frac{\mathrm{d}}{\mathrm{d}t} P(N_2,t) &amp;amp;= (\text{E}_2 - 1) r N_2 \frac{N_2 + C(x_2, x_1) N_1}{K(x_2) }P(N_2) + (\text{E}_2^{-1} - 1)r N_2 P(N_2)
\label{mastereq}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&quot;math&quot;&gt;\(\text{E}_i^k\)&lt;/span&gt; is the step operator taking &lt;span class=&quot;math&quot;&gt;\(f(N_i) \to f(N_{i+k})\)&lt;/span&gt;. We apply van Kampen’s expansion of the master equation to linear order to recover the following stochastic differential equation (Itô equation)&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\mathrm{d}n_1 = r n_1 \left(1 -  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o} } \sqrt{r n_1 \left(1 +  \frac{n_1 + C(x_1, x_2) n_2}{K(x_1) } \right) } \mathrm{d}W_1
\label{sde}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and &lt;span class=&quot;math&quot;&gt;\(n_2\)&lt;/span&gt; similarly. Switching into the variables for frequency, &lt;span class=&quot;math&quot;&gt;\(p = n_1/n\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(n = n_1+n_2\)&lt;/span&gt; and simplying notation by &lt;span class=&quot;math&quot;&gt;\(C(x_1, x_2) = c_{12}\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(K(X_i) = k_i\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\mathrm{d}p &amp;amp;= r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right) \mathrm{d}t + \frac{1}{\sqrt{K_o n(p)} } \sqrt{r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right) } \mathrm{d}W_1  \label{freq_sde} \\
n(p) &amp;amp;=  \frac{k_1 k_2}{k_2 p^2 + (k_1+k_2) c_{12} p (1-p) + k1 (1-p)^2 }, \end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where we have set the dynamic equation for &lt;span class=&quot;math&quot;&gt;\(n(p)\)&lt;/span&gt; to equilibrium. The extinction probability &lt;span class=&quot;math&quot;&gt;\(u(p,t)\)&lt;/span&gt; for this expression is given by the Backwards equation for the generator,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \underbrace{r p \left(1 -  n(p) \frac{p + c_{12}(1-p) }{k_1 } \right)}_{A(p)} \partial_p u(p,t) + \tfrac{1}{2} \underbrace{\frac{1}{K_o n(p) } r p \left(1 +  n(p)\frac{p + c_{12} (1-p) }{k_1 } \right)}_{B(p)} \partial_p^2 u(p,t) 
\label{u}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;with the boundary conditions &lt;span class=&quot;math&quot;&gt;\(u(0,t) = 1\)&lt;/span&gt; and &lt;span class=&quot;math&quot;&gt;\(u(1,t) = 1\)&lt;/span&gt; being absorbing.&lt;/p&gt;
&lt;p&gt;Assuming that type 1 is the rare mutant invader, we can solve this explicitly for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;, and particularly for the case of exactly one new mutant. After some rearrangement we can rewrite this as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{gathered}
\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) = \left( rp \left( 1-\frac{n c_{12}}{k_1} \right) - \frac{r n}{k_1} p^2 (1 - c_{12} )\right)  \partial_p u(p,t) \\
+ \left( rp \left(1+\frac{n c_{12}}{k_1}\right)  + \frac{r n }{k_1} p^2 (1 - c_{12} ) \right) \frac{\partial_p^2 u(p,t)}{2K_0 n}\end{gathered}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Note then for &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; small we can neglect the terms quadratic in &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; and we are left with the backwards equation from the density independent case,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\frac{\mathrm{d}}{\mathrm{d}t} u(p,t) =  rp \left( 1-\frac{n c_{12}}{k_1} \right)   \partial_p u(p,t) + rp \left(1+\frac{n c_{12}}{k_1}\right)   \frac{\partial_p^2 u(p,t)}{2K_0 n}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Setting equal to zero we have a simple ordinary differential equation for the stationary extinction probability:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
u(p) &amp;amp;= 1 - e^{-2sp K_0 n} \\
s &amp;amp;= \frac{r\left( 1-\frac{n c_{12}}{k_1} \right) }{ r\left(1+\frac{n c_{12}}{k_1}\right)} \end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and particularly for a frequency &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; corresponding to a single individual, a frequency of &lt;span class=&quot;math&quot;&gt;\(p=1/(N_1+N_2) =(1/K_0)/(n_1+n_2) = 1/(K_0 n)\)&lt;/span&gt;, this reduces to&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[u = 1-e^{-2s}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Assuming $ rp ( 1- ) 0$, the time-dependent solution&lt;a href=&quot;#fn1&quot; class=&quot;footnoteRef&quot; id=&quot;fnref1&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; is:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
u(p,t) &amp;amp;= 1-e^{-p \psi(t) } \\
\psi(t) &amp;amp;= \frac{2 s K_0 n}{1-e^{ r\left( 1-\frac{k_2 c_{12}}{k_1} \right) t } }
\label{timedep}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Larger population (system size) &lt;span class=&quot;math&quot;&gt;\(K_o\)&lt;/span&gt; results in longer persistance.&lt;/p&gt;
&lt;p&gt;This tells us nothing about the survival of the resident, as it is only valid for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;. In most applications of this approach, it is assumed the resident quickly goes extinct once &lt;span class=&quot;math&quot;&gt;\(p \sim o(1)\)&lt;/span&gt;. If we consider the asymptotic behavior of the nonlinear PDE, Eq. , we see sure absorbtion at one boundary or the other. The asymptotic behavior needn’t concern us; as we really want to know how the expected lifetime of this dimporphic state compares with the rate at which mutants are entering this population. To do so we need the time dependent solution to the nonlinear backwards equation .&lt;/p&gt;
&lt;p&gt;While a direct solution to the nonlinear PDE is not available, we can solve for the moments analytically. As &lt;span class=&quot;math&quot;&gt;\(u(p,t)\)&lt;/span&gt; is the probability of non-extinction, that is, that the exit time &lt;span class=&quot;math&quot;&gt;\(T\)&lt;/span&gt; is greater than the current time &lt;span class=&quot;math&quot;&gt;\(t\)&lt;/span&gt;; e.g. &lt;span class=&quot;math&quot;&gt;\(u\)&lt;/span&gt; is the cumululative probability density. Consequently the mean exit time &lt;span class=&quot;math&quot;&gt;\(T(p)\)&lt;/span&gt; is given by,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[T(p) = - \int_0^\infty t \partial_t u(p,t) \mathrm{d}t = \int_0^\infty u(p,t) \mathrm{d}t \label{simple}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where we have integrated by parts to get the second expression. Meanwhile, we can integrate the left-hand side of ,&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\int_0^{\infty} \partial_t u(p,t) \mathrm{d}t = u(p,\infty) - u(p,0) = -1\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and integrate the right hand side using  to get&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[A(p) \partial_p T(p) + \tfrac{1}{2} B(p) \partial_p^2 T(x) = -1\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This can be integrated directly to solve for the mean time starting from &lt;span class=&quot;math&quot;&gt;\(p=x\)&lt;/span&gt; to be absorbed at either boundary &lt;span class=&quot;math&quot;&gt;\(a=0\)&lt;/span&gt; or &lt;span class=&quot;math&quot;&gt;\(b=1\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
T(x) &amp;amp;= \frac{2 \left[\left(\int_a^x\frac{\mathrm{d}y}{\psi(y)}\right)\int_x^b \frac{\mathrm{d}y&amp;#39;}{\psi(y&amp;#39;)} \int_a^{y&amp;#39;} \frac{\mathrm{d}z \psi(z)}{B(z)} - \left(\int_x^b\frac{\mathrm{d}y}{\psi(y)}\right)\int_a^x \frac{\mathrm{d}y&amp;#39;}{\psi(y&amp;#39;)} \int_a^{y&amp;#39;} \frac{\mathrm{d}z \psi(z)}{B(z)}\right]}{\int_a^b \frac{\mathrm{d}y}{\psi(y)}}
\label{7integrals}
\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\psi(x) &amp;amp;= \exp\left( \int_0^x \mathrm{d}x&amp;#39; \frac{2A(x&amp;#39;)}{B(x&amp;#39;)} \right)\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Though these integrals can be computed numerically, a small noise limit (large populations) allows us to make an additional approximation by mapping this problem onto the familiar question of escape over a potential energy barrier. This question arises in basic chemistry, and is described by a similar stochastic differential equation where the &lt;span class=&quot;math&quot;&gt;\(A(x)\)&lt;/span&gt; coefficent represents the gradient of the energy surface and &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; the temperature. The analogy initially appears to fail, since in the chemical context the diffusion coefficent is determined by the temperature alone, and is independent of the state, while our &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; term depends on the frequency &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;. However, as it is not explicitly time dependent, there is always a transform to change variables into a context where &lt;span class=&quot;math&quot;&gt;\(B\)&lt;/span&gt; is constant. The relevant transformation for us is known as the Lamperti Transform. Switching variables from &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt; to &lt;span class=&quot;math&quot;&gt;\(q\)&lt;/span&gt; by means of the transform:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[q = F(p) = \int_z^{p} \frac{1}{\sqrt{B(u)}} \mathrm{d}u
\label{p_to_q}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;we can rewrite  as&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\begin{aligned}
\frac{\partial u(q,t)}{\partial t} = \underbrace{\left(\frac{4 A(p)- \partial_p B(p) }{4\sqrt{B(p)}}  \right)}_{\nabla V(p)} \frac{\partial u(q,t)}{\partial q} + \frac{1}{2} \frac{\partial^2 u(q,t)}{\partial q^2}.
\label{new_u}\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The mean first passage time in this transformed variable is still solved by . However, interpreting the coefficent of the drift term as the gradient of the energy landscape, &lt;span class=&quot;math&quot;&gt;\(\nabla V(p)\)&lt;/span&gt;, we can approximate that this time will scale as the exponent of the depth of the energy well defined by that landscape:&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[\exp{- (\min(V(0), V(1)) - V(p^*) )}\]&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&quot;results&quot;&gt;Results&lt;/h1&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm6.staticflickr.com/5445/9625166692_cedb531293_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;http://farm3.staticflickr.com/2814/9621930087_57533b9105_o.png&quot; /&gt;
&lt;/figure&gt;
&lt;section class=&quot;footnotes&quot;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&quot;fn1&quot;&gt;&lt;p&gt;note that &lt;span class=&quot;math&quot;&gt;\(n(p) \approx k_2\)&lt;/span&gt; for small &lt;span class=&quot;math&quot;&gt;\(p\)&lt;/span&gt;.&lt;a href=&quot;#fnref1&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</content>
 </entry>
 
 <entry>
   <title>Wednesday</title>
	 <link href="/2010/04/14/Wednesday.html"/>
   <updated>2010-04-14T00:00:00+00:00</updated>
   <id>/04/14/Wednesday</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;10-2p Finish preparing for EDG talk.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;2-3p. Talk went pretty well. Could still polish slides up for them to be useful, likewise for outline.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;3-4 OA meeting&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;4-9p awesome talk in &lt;a href=&quot;http://daviswiki.org/Education_For_Sustainable_Living_Program&quot; title=&quot;http://daviswiki.org/Education_For_Sustainable_Living_Program&quot;&gt;ESLP&lt;/a&gt; with &lt;a href=&quot;http://sustainability.ucsb.edu/academics/staff.php&quot; title=&quot;http://sustainability.ucsb.edu/academics/staff.php&quot;&gt;Katie Maynard&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tuesday</title>
	 <link href="/2010/04/13/Tuesday.html"/>
   <updated>2010-04-13T00:00:00+00:00</updated>
   <id>/04/13/Tuesday</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Preparing for EDG talk&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/04/13/Teaching.html"/>
   <updated>2010-04-13T00:00:00+00:00</updated>
   <id>/04/13/Teaching</id>
   <content type="html">&lt;h2 id=&quot;misc-notes&quot;&gt;Misc / Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Starting to prepare for GTC sections&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;technology-and-education&quot;&gt;Technology and Education&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Open courses backed by learning research: &lt;a href=&quot;http://oli.web.cmu.edu/openlearning/&quot; title=&quot;http://oli.web.cmu.edu/openlearning/&quot;&gt;Carnegie Mellon&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.wallwisher.com/&quot; title=&quot;http://www.wallwisher.com/&quot;&gt;Wallwisher&lt;/a&gt; online notice board &lt;a href=&quot;http://www.wallwisher.com/wall/states-of-matter&quot; title=&quot;http://www.wallwisher.com/wall/states-of-matter&quot;&gt;example&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Open education featured in &lt;a href=&quot;http://www.nytimes.com/2010/04/18/education/edlife/18open-t.html?ref=edlife&quot; title=&quot;http://www.nytimes.com/2010/04/18/education/edlife/18open-t.html?ref=edlife&quot;&gt;NY Times&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;assessment&quot;&gt;Assessment&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;XP instead of grades? &lt;a href=&quot;http://terranova.blogs.com/terra_nova/2010/03/build-your-own-sheldon-syllabus.html&quot; title=&quot;http://terranova.blogs.com/terra_nova/2010/03/build-your-own-sheldon-syllabus.html&quot;&gt;Lee Sheldon system&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;another &lt;a href=&quot;http://www.switched.com/2010/03/26/prof-subs-grades-for-experience-points-presentations-with-quest/&quot; title=&quot;http://www.switched.com/2010/03/26/prof-subs-grades-for-experience-points-presentations-with-quest/&quot;&gt;Sheldon method post&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/04/12/Teaching.html"/>
   <updated>2010-04-12T00:00:00+00:00</updated>
   <id>/04/12/Teaching</id>
   <content type="html">&lt;p&gt;Notes potentially for my EDG talk.&lt;/p&gt;
&lt;h2 id=&quot;keeping-up-a-talk-to-edg&quot;&gt;“Keeping Up” – a talk to EDG?&lt;/h2&gt;
&lt;p&gt;Science is growing. Fast. Number of papers published. Genomes on Genbank. Software on CRAN. Everyone’s felt the pressure. So what do we do? Keeping with tradition, I’ll present my own work in developing comparative phylogenetic methods to identify niche differentiation in Labrid fish. I will try and use this context to pose the question – what do we do about this information explosion?? I’ll review some data to frame the rate of this change and highlight three particular challenges: (1) Big Science - Big Collaborations, (2) Evaluating Science: Quality, Reproducibility, Impact, (3) Rising Demand for Broader Impacts. I’ll review literature evaluating what is and isn’t effective, present a few examples and tools with which some hope to face these challenges and opportunities.&lt;/p&gt;
&lt;p&gt;I’m not really qualified to give an opinion on all this, but I’m interested to give it a try. Bring questions and opinions or maybe we’ll hear a lot more about multitype OU processes.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Exponential growth of science&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Publications&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://hdl.handle.net/10.1371/journal.pcbi.1000204&quot; title=&quot;doi:10.1371/journal.pcbi.1000204&quot;&gt;digital archive sizes&lt;/a&gt; 19 million articles in PubMed, search 60 million times/month.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://poeticeconomics.blogspot.com/2009/07/dramatic-growth-of-plos-one-soon-to-be.html&quot; title=&quot;http://poeticeconomics.blogspot.com/2009/07/dramatic-growth-of-plos-one-soon-to-be.html&quot;&gt;Open access growth&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;How many table of contents do you receive? Read?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Databases&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.ncbi.nlm.nih.gov/genbank/genbankstats.html&quot; title=&quot;http://www.ncbi.nlm.nih.gov/genbank/genbankstats.html&quot;&gt;Genbank&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://datadryad.org/repo/factSheet&quot; title=&quot;http://datadryad.org/repo/factSheet&quot;&gt;Dryad&lt;/a&gt;, &lt;a href=&quot;http://www.sp2000.org/&quot; title=&quot;http://www.sp2000.org/&quot;&gt;species2000&lt;/a&gt;,&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://hdl.handle.net/10.1371/journal.pbio.1000309&quot; title=&quot;doi:10.1371/journal.pbio.1000309&quot;&gt;VertNet&lt;/a&gt;, &lt;a href=&quot;http://www.itis.gov/&quot; title=&quot;http://www.itis.gov/&quot;&gt;itis&lt;/a&gt;,&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.nbii.gov/portal/server.pt?cached=false&amp;amp;space=Login&amp;amp;redirect=http%3A%2F%2Fwww.nbii.gov%2Fportal%2Fserver.pt%3F&quot; title=&quot;https://www.nbii.gov/portal/server.pt?cached=false&amp;amp;space=Login&amp;amp;redirect=http%3A%2F%2Fwww.nbii.gov%2Fportal%2Fserver.pt%3F&quot;&gt;NBII&lt;/a&gt;,&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www3.imperial.ac.uk/cpb/research/patternsandprocesses/gpdd&quot; title=&quot;http://www3.imperial.ac.uk/cpb/research/patternsandprocesses/gpdd&quot;&gt;GPDD&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nature.com/authors/editorial_policies/availability.html&quot; title=&quot;http://www.nature.com/authors/editorial_policies/availability.html&quot;&gt;&lt;em&gt;Nature&lt;/em&gt; list&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Software&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Felsenstein’s 379 and &lt;a href=&quot;http://evolution.genetics.washington.edu/phylip/software.html&quot; title=&quot;http://evolution.genetics.washington.edu/phylip/software.html&quot;&gt;given up&lt;/a&gt;?&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://cran.r-project.org/web/packages/&quot; title=&quot;http://cran.r-project.org/web/packages/&quot;&gt;CRAN&lt;/a&gt; 2326 packages, &lt;a href=&quot;http://blog.revolution-computing.com/2010/01/rs-exponential-package-growth-ctd.html&quot; title=&quot;http://blog.revolution-computing.com/2010/01/rs-exponential-package-growth-ctd.html&quot;&gt;R’s exp growth&lt;/a&gt;, and adoption in &lt;a href=&quot;http://www.nytimes.com/2009/01/07/technology/business-computing/07program.html&quot; title=&quot;http://www.nytimes.com/2009/01/07/technology/business-computing/07program.html&quot;&gt;NY Times&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Public repositories: Github, google code, Sourceforge.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://hdl.handle.net/10.1038/440413a&quot; title=&quot;doi:10.1038/440413a&quot;&gt;Nature commentary&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Luckily this is paralleled by the exponential growth of &lt;a href=&quot;http://www.slideshare.net/CameronNeylon/science-in-the-open&quot; title=&quot;http://www.slideshare.net/CameronNeylon/science-in-the-open&quot;&gt;your capacity&lt;/a&gt; and free time… whoops.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;big-science&quot;&gt;Big Science&lt;/h3&gt;
&lt;h4 id=&quot;collaborating-across-barriers&quot;&gt;&lt;strong&gt;Collaborating across barriers&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;Which is harder: research &lt;a href=&quot;http://dx.doi.org/10.1177/0306312705055535&quot; title=&quot;http://dx.doi.org/10.1177/0306312705055535&quot;&gt;across institutes or across disciplines&lt;/a&gt;?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Geographic distance&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Who has worked with someone at another institution? Multiple institutions?&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nescent.org/index.php&quot; title=&quot;http://www.nescent.org/index.php&quot;&gt;National Evolutionary Synthesis Center&lt;/a&gt;. who has attended working groups, catalysis meetings?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Collaborating across disciplines&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Rise of interdisciplinary centers, initiatives, and &lt;a href=&quot;http://hdl.handle.net/10.1126/science.1095480&quot; title=&quot;doi:10.1126/science.1095480&quot;&gt;education&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Effectiveness and Challenges&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.nescent.org/science/sos.php&quot; title=&quot;https://www.nescent.org/science/sos.php&quot;&gt;Science of Science&lt;/a&gt;, &lt;a href=&quot;http://www.nsf.gov/funding/pgm_summ.jsp?pims_id=501084&quot; title=&quot;http://www.nsf.gov/funding/pgm_summ.jsp?pims_id=501084&quot;&gt;New NSF funding&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://portal.acm.org/citation.cfm?id=1460563.1460633&quot; title=&quot;http://portal.acm.org/citation.cfm?id=1460563.1460633&quot;&gt;Who collaborates successfully&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://dx.doi.org/10.1287/mnsc.1030.0134&quot; title=&quot;http://dx.doi.org/10.1287/mnsc.1030.0134&quot;&gt;Successful working groups share knowledge externally&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;What makes these effective / ineffective? &lt;a href=&quot;http://csz.csu.edu.tw/pp/MISQ/2007/Vol.31_Issue.3/THE%20SPATIAL,%20TEMPORAL,%20AND%20CONFIGURATIONAL%20CHARACTERISTICS%20OF%20GEOGRAPHIC%20DISPERSION%20IN%20TEAMS,MIS%20Quarterly,2007.pdf&quot; title=&quot;http://csz.csu.edu.tw/pp/MISQ/2007/Vol.31_Issue.3/THE%20SPATIAL,%20TEMPORAL,%20AND%20CONFIGURATIONAL%20CHARACTERISTICS%20OF%20GEOGRAPHIC%20DISPERSION%20IN%20TEAMS,MIS%20Quarterly,2007.pdf&quot;&gt;Research on geographic distance&lt;/a&gt; and &lt;a href=&quot;http://scholar.google.com/scholar?as_q=&amp;amp;num=100&amp;amp;btnG=Search+Scholar&amp;amp;as_epq=Leading+Groups+from+a+Distance&amp;amp;as_oq=&amp;amp;as_eq=&amp;amp;as_occt=title&amp;amp;as_sauthors=&amp;amp;as_publication=&amp;amp;as_ylo=&amp;amp;as_yhi=&amp;amp;as_allsubj=all&amp;amp;hl=en&quot; title=&quot;http://scholar.google.com/scholar?as_q=&amp;amp;num=100&amp;amp;btnG=Search+Scholar&amp;amp;as_epq=Leading+Groups+from+a+Distance&amp;amp;as_oq=&amp;amp;as_eq=&amp;amp;as_occt=title&amp;amp;as_sauthors=&amp;amp;as_publication=&amp;amp;as_ylo=&amp;amp;as_yhi=&amp;amp;as_allsubj=all&amp;amp;hl=en&quot;&gt;more&lt;/a&gt; from &lt;a href=&quot;http://netvis.fuqua.duke.edu/papers/&quot; title=&quot;http://netvis.fuqua.duke.edu/papers/&quot;&gt;Prof. Cummings, NESCent&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;really-really-big-collaborations-informal-groups&quot;&gt;&lt;strong&gt;Really really big collaborations, informal groups?&lt;/strong&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Coordinate simultaneous development of a project with hundreds of collaborators? Regularly happens in software development&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://lumberjaph.net/blog/index.php/2010/03/25/github-explorer/&quot; title=&quot;http://lumberjaph.net/blog/index.php/2010/03/25/github-explorer/&quot;&gt;Computer Scientists work in huge groups&lt;/a&gt;,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://quaid.fedorapeople.org/TOS/Practical_Open_Source_Software_Exploration/html/sn-Foreword-Why_Traditional_Student_Projects_Are_Ineffective.html&quot; title=&quot;http://quaid.fedorapeople.org/TOS/Practical_Open_Source_Software_Exploration/html/sn-Foreword-Why_Traditional_Student_Projects_Are_Ineffective.html&quot;&gt;not often taught how&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Informal collaborations. Mailing lists, stackoverflow, social networks.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;evaluating-science-quality-reproducibility-impact&quot;&gt;Evaluating science? Quality? Reproducibility? Impact?&lt;/h3&gt;
&lt;h4 id=&quot;quality&quot;&gt;Quality&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Peer review/nature comments vs Amazon.com model… Cultural barriers. New solutions.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;reproducibility&quot;&gt;Reproducibility&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.bepress.com/sagmb/vol4/iss1/art2/&quot; title=&quot;http://www.bepress.com/sagmb/vol4/iss1/art2/&quot;&gt;Reproducibility&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;impact&quot;&gt;Impact&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Article level metrics. Data contribution. software contribution.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rising demands for broader impacts. Science in the eye of the public. Communicating science.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;Paper vs package. push button reproducibility. Open science&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;Mailing lists. &lt;a href=&quot;http://stackoverflow.com/questions/2134583/looking-for-fast-algorithm-to-find-distance-between-two-nodes-in-binary-tree&quot; title=&quot;http://stackoverflow.com/questions/2134583/looking-for-fast-algorithm-to-find-distance-between-two-nodes-in-binary-tree&quot;&gt;stack overflow.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Social networks&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;Picnic Day, Obama’s NAS speech, educational outreach, who should communicate science and how?&lt;/li&gt;
&lt;li&gt;Open = Impact&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt; - What is the minimum unit of science? A p-value? An equation? Definition? Hypothesis? A page or edit on a wiki? A paper. - What moves science forward in comparative phylogenetics. Lots of kinds of contributions: data, methods, software, technical support. - Synthetic science and linking big.&lt;/p&gt;
&lt;h3 id=&quot;ways-science-is-changing-to-face-these-challenges&quot;&gt;Ways Science is changing to face these challenges&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Generative Science, Synthetic Science, Open Science&lt;/li&gt;
&lt;li&gt;New thinking – google mindset vs yahoo. tags. &lt;a href=&quot;http://www.youtube.com/watch?v=x3wOhXsjPYM&quot; title=&quot;http://www.youtube.com/watch?v=x3wOhXsjPYM&quot;&gt;Everything is miscellaneous.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Crowd sourcing&lt;/li&gt;
&lt;li&gt;Tools waste time / save time&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; From the eyes of a young college student, this is fantastic. This is the dawn of a golden era of science. From the eyes of an aging graduate student looking ahead on an uncertain career trajectory, this is terrifying.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Solutions&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.slideshare.net/CameronNeylon/now-about-that-filter&quot; title=&quot;http://www.slideshare.net/CameronNeylon/now-about-that-filter&quot;&gt;filter&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;survey&quot;&gt;Survey&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Use a social networking site&lt;/li&gt;
&lt;li&gt;have joined a scientific social networking site&lt;/li&gt;
&lt;li&gt;subscribe to a help mailing list&lt;/li&gt;
&lt;li&gt;have asked a question to a mailing list&lt;/li&gt;
&lt;li&gt;have answered a question on a list&lt;/li&gt;
&lt;li&gt;collaborated with someone at another institution&lt;/li&gt;
&lt;li&gt;have collaborated with someone they’ve never met&lt;/li&gt;
&lt;li&gt;read articles as pdfs&lt;/li&gt;
&lt;li&gt;keep pdfs in a database system&lt;/li&gt;
&lt;li&gt;used an encyclopedia in the past 5 years&lt;/li&gt;
&lt;li&gt;used wikipedia in the past 48 hours&lt;/li&gt;
&lt;li&gt;used software for analysis / calculations / figures yesterday&lt;/li&gt;
&lt;li&gt;how long would it take for you to reproduce that analysis now?&lt;/li&gt;
&lt;li&gt;how long to reproduce the computational analysis/figures in a paper you’ve published?&lt;/li&gt;
&lt;li&gt;how do you find most articles you read? ToC? recommendation? citation?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;notes&quot;&gt;Notes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Post to friendfeed for input before presentation&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Primate chronogram</title>
	 <link href="/2010/04/12/Primate-chronogram.html"/>
   <updated>2010-04-12T00:00:00+00:00</updated>
   <id>/04/12/Primate-chronogram</id>
   <content type="html">&lt;p&gt;From User:Daniel Mietchen/Notebook/Evolutionary MRI/2010/04/12:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://sites.google.com/site/chuanchuaner/&quot; title=&quot;http://sites.google.com/site/chuanchuaner/&quot;&gt;Jinchuan Xing&lt;/a&gt; recommended &lt;a href=&quot;http://www.pnas.org/content/107/11/4797&quot; title=&quot;http://www.pnas.org/content/107/11/4797&quot;&gt;New perspectives on anthropoid origins&lt;/a&gt; whose &lt;a href=&quot;http://www.pnas.org/content/107/11/4797/F2.expansion.html&quot; title=&quot;http://www.pnas.org/content/107/11/4797/F2.expansion.html&quot;&gt;Fig. 2&lt;/a&gt; goes into our direction.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Effective warning signals</title>
	 <link href="/2010/04/11/Effective-warning-signals.html"/>
   <updated>2010-04-11T00:00:00+00:00</updated>
   <id>/04/11/Effective-warning-signals</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Predicting variance of variance by direct calculation – still need to crunch some math for the expected convergence.
&lt;ul&gt;
&lt;li&gt;Still, the approach should be able to do more than describe single points as unexpected deviates.&lt;/li&gt;
&lt;li&gt;Still need to address gradual change vs change point analysis.&lt;/li&gt;
&lt;li&gt;Essentially the same as the phyolgenentic problem – one rate vs two rates. Model selection approaches?&lt;/li&gt;
&lt;li&gt;So far theory is essentially built on a model selection between linear models.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Calculate the eigenvalue directly rather than ratio of eigenvalue to noise:
&lt;ul&gt;
&lt;li&gt;Estimate the eigenvalue from the correlation function and from power spectrum, rather than the lag-1 autocorrelation, or variance.&lt;/li&gt;
&lt;li&gt;Proper signal processing techniques for detecting bifurcations?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;coding-progress&quot;&gt;Coding Progress&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Added a proper autocorrelation function calculation, log transform and linear regression gives the eigenvalue and the variance.&lt;/li&gt;
&lt;li&gt;Tested using the Langevin model&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/a/4/b/a4b7d6a34ddae316029729bd7c1b9303.png&quot; alt=&quot;x_{t+1} = x_t \left(1- \frac{\kappa}{\gamma} \Delta t \right) + \Delta t \sqrt{\frac{2 K_B T}{\gamma} } \xi_t&quot; /&gt;&lt;figcaption&gt;x_{t+1} = x_t \left(1- \frac{\kappa}{\gamma} \Delta t \right) + \Delta t \sqrt{\frac{2 K_B T}{\gamma} } \xi_t&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Whose correlation function is given by&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/7/8/1/7811817fde052d555cadbfd36a77d213.png&quot; alt=&quot;\frac{K_BT}{\gamma} e^{-\kappa t / \gamma}&quot; /&gt;&lt;figcaption&gt;\frac{K_BT}{\gamma} e^{-\kappa t / \gamma}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/09/Research.html"/>
   <updated>2010-04-09T00:00:00+00:00</updated>
   <id>/04/09/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Working on bootstrapping theta parameters&lt;/li&gt;
&lt;li&gt;bootstrapping multiple parameters doesn’t seem effective in the context of the boot package, despite claiming it can use a vector of stats. Certainly part of challenge is that different models have different numbers of parameters, so this isn’t a fixed size vector. Approaching manually for the moment, inhibits use of bootstrap confidence intervals function from the boot package.&lt;/li&gt;
&lt;li&gt;Some irregular behavior in bootstrapping parameters – have to load package and then reload likelihood_bootstrap library source file or else bootstraps are NAs, needs further investigation.&lt;/li&gt;
&lt;li&gt;formatting bootstrapping meaningfully – following the ouch style for the moment&lt;/li&gt;
&lt;li&gt;Sent Peter Wainwright a rough draft of Bio Let. manuscript.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;goals-todo&quot;&gt;Goals / ToDo&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Add bootstraps of parameters to manuscript,&lt;/li&gt;
&lt;li&gt;Function to bootstrap all parameters given list of all models. Plotting function also.&lt;/li&gt;
&lt;li&gt;Write up &lt;em&gt;Evolution&lt;/em&gt; note on AIC.&lt;/li&gt;
&lt;li&gt;Conference registrations&lt;/li&gt;
&lt;li&gt;NESCent whitepaper&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;primates&quot;&gt;Primates&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Graham pointed out a rather promising looking chronogram from a supermatrix for &lt;a href=&quot;http://hdl.handle.net/10.1186/1471-2148-9-259&quot; title=&quot;doi:10.1186/1471-2148-9-259&quot;&gt;Primate phylogenetic trees&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Contacted &lt;a href=&quot;http://www.ucl.ac.uk/biology/academic-staff/chatterjee/chatterjee.htm&quot; title=&quot;http://www.ucl.ac.uk/biology/academic-staff/chatterjee/chatterjee.htm&quot;&gt;Helen Chatterjee&lt;/a&gt; re: primate phylogenies.&lt;/li&gt;
&lt;li&gt;Also see project details in Daniel’s notebook&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;reading-notes&quot;&gt;Reading &amp;amp; Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Embedding google spreadsheets sounds much more promising than formatting tables in OWW/html: Example from Anthony / Koch Lab&lt;/li&gt;
&lt;li&gt;OWW Stats&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://friendfeed.com/sciencecommons/1416691d/hi-everyone-today-i-m-here-discussing-my&quot; title=&quot;http://friendfeed.com/sciencecommons/1416691d/hi-everyone-today-i-m-here-discussing-my&quot;&gt;FF discussion&lt;/a&gt; on Chelsea’s Open Science article&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Embedding/Transclusion in &lt;a href=&quot;http://en.citizendium.org/wiki/CZ:Transclusion&quot; title=&quot;http://en.citizendium.org/wiki/CZ:Transclusion&quot;&gt;OWW/mediawiki&lt;/a&gt; and &lt;a href=&quot;http://en.citizendium.org/wiki/User:Daniel_Mietchen#Research_areas&quot; title=&quot;http://en.citizendium.org/wiki/User:Daniel_Mietchen#Research_areas&quot;&gt;examples&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Exploring gist for code fragments. Embeddable gist:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/08/Research.html"/>
   <updated>2010-04-08T00:00:00+00:00</updated>
   <id>/04/08/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Reviewed timescales manuscript.&lt;/li&gt;
&lt;li&gt;Revisiting&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;meeting&quot;&gt;Meeting&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Basically I want to apply central limit theorem for stationary processes (accounts for covariances), assuming mean zero&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/1/4/1/141abb117709d04302d240f2cbbf2df6.png&quot; alt=&quot;\frac{X_1 + … + X_n}{\sqrt{\sigma^2 n}} \propto N(0,1)&quot; /&gt;&lt;figcaption&gt;\frac{X_1 + … + X_n}{\sqrt{\sigma^2 n}} \propto N(0,1)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/b/7/2b7baf7dc6d72616ccd1a5d72d4323cf.png&quot; alt=&quot;\sigma^2 = E X^2 + 2 \sum_{i,j}^n Cov(X_i, X_j)&quot; /&gt;&lt;figcaption&gt;\sigma^2 = E X^2 + 2 \sum_{i,j}^n Cov(X_i, X_j)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Discussion of &lt;a href=&quot;http://en.wikipedia.org/wiki/Freidlin%E2%80%93Wentzell_theorem&quot; title=&quot;http://en.wikipedia.org/wiki/Freidlin%E2%80%93Wentzell_theorem&quot;&gt;Freidlin-Wentzell&lt;/a&gt; theory in connection to Arrhenius law and the well-defined stochastic tipping point which occurs before the branch point.&lt;/li&gt;
&lt;li&gt;Kurtz results don’t really help in the case of ergodicity, can make statements about the (even non-stationary) ensemble limit.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Goals / To Do&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;send Alan manuscript outline on ergodicity problem&lt;/li&gt;
&lt;li&gt;Finish both reviews&lt;/li&gt;
&lt;li&gt;variance of variance calculation!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Comparative Phylogenetics Notebook</title>
	 <link href="/2010/04/08/Comparative-Phylogenetics-Notebook.html"/>
   <updated>2010-04-08T00:00:00+00:00</updated>
   <id>/04/08/Comparative-Phylogenetics-Notebook</id>
   <content type="html">&lt;h2 id=&quot;research&quot;&gt;Research&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Wrote summary function using bootstrap confidence intervals for the bootstraps of the likelihoods directly.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;On interpreting&lt;/strong&gt; the bootstraps of likelihoods directly:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;The extent to which the distributions themselves are distinct provides an indication of the ability to distinguish between models on the given phylogenetic tree and the actual data. For instance, if the tree was a star tree and the data produced by either BM or OU1, then all distributions would fall on top of one another.&lt;/li&gt;
&lt;li&gt;The extent to which the observed likelihood matches those produced by the bootstraps under that model gives an indication of how well that model is fitting the actual data.&lt;/li&gt;
&lt;li&gt;May also be interesting to look at the bootstrap confidence intervals around theta parameters, to see if they are distinct.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;labrids&quot;&gt;Labrids&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAADIAAAAyADrSnyWAABaRElEQVR42u29Z5Ac95nm+cvM8t609wbohjckBIIAKIISjShRtKJEiZJmZnUbcYq5nZidudXtxZjQzsxqNXMxihntfpiQdKuQ9kjKgEb0FEHQgAThG64J0432vru8zaw096HUBba6G2iH7oZYD0NBsbqy6l+Z+eT/tc8rGIZhUEQRRcwIsXgKiiiiSJAiiigSpIgiigQpoogiQYoookiQIoooEqSIIooEKaKIP1CYiqfg2lBVlZ6eHjKZDMFgkMrKSgRBmPG9siyjqipOp7PwWiqVwmQyYbVaF7UOXdcZGRmhrKwMk8nEyMgINpuNbDaLJEnYbDbcbveUY8bHxzGbzWQyGaxWK4Ig4Pf75/R9siwTDoeprKz8RF9/6bvf/e53izSYHSMjI3z7299mZGSEF198kXXr1tHR0UF/fz/l5eW0t7dz/PhxXC4X7733Hm+++SYNDQ0cPXoUk8nEU089xfj4OKIocunSJVRV5ejRo2iahqqqnD59mv7+fmw2G+3t7bS3t2M2m0mlUhw9ehSn00k8Hufdd9/lhz/8IXfccQdOp5Pvfve7aJrGyZMnOXLkCNFoFI/HQzab5ciRIwiCwE9/+lNCoRAnTpzg0qVLvPnmm0iShM/n48qVKxw7dgyHwwHAu+++SyaTwefzceLECQ4dOsQvfvELmpubaWtrw+FwTCNgcQcpAk3TyGazuN1uJiYmeOeddzhy5AiGYbBr1y4+/PBDamtrefXVVwkGg4yOjvLDH/6Q8+fPs2XLFoaHh5FlmRMnTjA8PMymTZs4cuQIdrudPXv28Prrr+P1eqmurubkyZPs2rWLp556CpvNhiRJvPLKK2iahmEYDA4OMlkZlEqliMfj9Pb2YrVaef755xkbGyMSidDV1YUgCBiGQWVlJd3d3dTW1nLx4kV6enpoamqiq6uLmpoaXn31VWpra7ly5QqqqnL77bdz/PhxvF4vfX19/P3f/z2pVIpdu3bxn/7Tf0IUP1lWedEHmQOsViu1tbXkcjna29vZvHkz69at4+jRo3i9Xp588kmi0Sh1dXWUlZWxc+dOqquruXz5MqIo0tLSgtVq5Ytf/CKlpaWIokg0GiWdTrNp0yY2btzIlStXqKio4Ktf/SpDQ0O0tbVhtVoJh8P09PTwwAMP4PV6+XjpnKqqJBIJDMPg2LFjAFy5cgWz2YyiKGQyGXRdJ5FIoOs6+/bt48477+TChQs4HA6+8Y1vMDExwdmzZ7nvvvuw2+0cOXKEzZs3c++992Kz2di1axcul4uOjg5kWS6aWEVMRTab5Z133iEWi+FyuXjkkUc4dOgQqVSKf//v/z1dXV389re/5c4772TDhg1cuXIFu91OIpGgtLSUuro6YrEYDoeDxsZGUqkUfX19NDU14XA4eO211zCbzdx2220cOHCArq4u9u7dy86dOwmHw9x5553U1dXx+uuvEwgEuO+++7DZbJw+fZr6+noURaGkpITdu3czMTHBli1bmJiYYNu2bXg8Hmpqashms1RXV+P1enE4HJSUlKDrOq+88gp79+5l3759PPvss9TW1vLkk0/y1ltv0d7eTn19PV6vl0wmQ319Pbt370aSpE/U9ReK1bzXd46TySS5XA673Y7D4SCVSiEIAg6Hg2w2WzDBBEEgk8lgMplIpVI4HA4kSUKWZSRJwmQyIQgC2WwWm83G008/TSQS4U//9E/58MMPefnll/mrv/qrgl+QTCZxOp0IgkA6ncZisRSc7UwmgyRJaJqGIAiIooiqqpjNZtLpdCEoIIoimqYhiuKU4IJhGGQymcK6k8kkVqsVq9VKKpVC13WsViu6rpPJZHC5XJjN5k/c9S8SZAURjUbRdZ1AIEA6nSaRSFBeXl48MUWCFFFE0UkvoogiQYoookiQIoooEqSIIoooEqSIIuaBG1pqksvlUFV11uK+IoqYK5Yi2CoIAhaLZV7lMqYbSY6DBw8iCMInLvtaxNJBlmUGBgbweDyLIokgCMRiMe68807WrVu38gRRVRWA3bt3Y7FYluVkCggYGIV/ryYs1ZomixCXbF1L/HlLes4EgYmJCex2O7fffvui1ilJEocPHyYaja4OE0sQBEwmExaLZVkIoqISI4YfP5FcBI/Jg1lYHaURmqERyUQI2AOIwsLdPk3TiKaiBNyBJTFbFUUhkUgQCARW7Q4yWV5js9kW/VmTZTqfSCd9ggme4RkyRoanx55mIjexataWVJI8c/4ZMmpmUZ8TSoT4X2/+L1RNXZJ1dXd38+yzzxbtuE8CQXR0kiTR0EhqSTRDW1UOZjqXXrQpo+s6yUxySf3EVCp1U13nJEmGGSZKtGCyZjIZjh8/fkO+7w+mYcqPnzBhfiL8hMdKH6PEXLJq1ua0OPnShi9hN9kX9xvdfp6464klC3o0NDTw0EMP3VTX+Sme4p/5Zx7gAf6Rf8SMGVVVeeuttxgdHaW1tZXe3l6i0ShOp5Pdu3fj9XqLBAkR4mVeJkeOx+yPYcO2atZmFs00+5sXb0ObraypXrNk63K5XLhcrpvuOnfQwRBDU4IeFouFYDDI/v37cblcGIZBWVkZfX19bN68uUiQfvoZZBANjYPpgzxpexKLaFkVa8tpOTojnawNrMUkLvyUyzmZ7uFuWmpbFuXsTyIejzM2NsaaNWtumuv8OI+zkY1UU43pd7fvZF6jq6uL+vp6fD4fVqsVj8ez6B6WPxiCXOEKZszYDTv/c+J/cn/5/VRYK1bF2lK5FL+5+Bv+j53/By7Lwp/YkUSEZ997lu888R1E0+IJ0t/fz5tvvsmf//mf3zTXee3v/vk4HA4H/+7f/TtyuVwhXyIIQqGRrEiQ3+0gVVRhwoQiKUjC6klOioKI2+pedGhWFEVc9qUziUwm0xSJopsVgiDg8/lmDURMEmbZCBKLxUgmk/T29tLa2kowGFzxk9RHH2tZiyqolJSXUCKtHifdZXHx5OYnr+ukG4bBQGIAt8WNzzb9ggc9Qf7ovj/CJC3Nc62pqYmKioqbigwdmQ4upC5Qba1mu3s74u8CsYqiFNqidV1HEASi0Si/+c1veOSRR+asBzbtobSQgw4ePMizzz5LMpnk4MGDK56JVVAYYYRmmqmhhrQpjSasnjCvKIj4bL7r+g3nxs7x8C8e5u/f+3tyem7a3yVRwufyLVltm9lsXlSEZyXwy7Ff8tDZh/h+3/dRdbWwS7zyyivs37+fEydOcOrUKQ4fPlzQEsjlcgu/dgs5yOl0FsJodrt9xYsRM2QYZxwZmRJKODl+kn/s+0euZK6siouaUTO83fM2iqZc832vdLzC2ZGzvHjpRQbiA9P+nswkefv022j60pB/bGyMDz744KYiSJmljHWuddTZ6gr3naIoJJNJPB4Pg4OD9Pb20tXVhd1up7y8fFEP8AURxOfz0djYyJUrVzCZTNe0DZcDMjJhwowyijPrpKuni+/3fJ//1vffUAxlxS9qVs3yft/71ySIrMl80PcB+xr3IQoil0OXp70nkU7wXtt76Lq+JOsaHR3lyJEjNxVBvlb2Nd7a9hZ/Xf/XmARTwUlvbW0t1GxZLBaqqqrweDy0trYuys9akDGbTCZxuVxYLBay2ewUJ2hwcJDx8XGy2SyDg4PLctKSJIkTp4YaRkZGqKSSb9V/i2dGnqEr08U6x7oVvahm0czawFokcfbAwWB8kO5IN3+680/5+Zmf0xnu5L7m+6a8x2qxsqZ2zZI9eDweD5XVlZy5coa6sjr8bv+qJ4hLcuGSXNMexDt37iz898eTn+vXr1+cebyQg+644w62bdvG2rVrufPOO6dcMLvdjt/vx+VyEQqFluxpdy1MMIEDB7uV3bw78S5ihcid5XciCRJnkmdWhZN+vUz6hYkLyJrM3rq9VLoruRKebh763X6+ctdXlsxJr6+vx1Rm4r7/dB/ff+b7S1bjtZqgqurym1iSJBEIBHC5XPT19U1ZQCAQoL6+nrq6Oux2+7I48CFC2LBxOX6ZTq0Tza/hsDiot9ZzPnV+xS+S8bt/roUP+j6g3ldPo6+RGk8NA4mB6fVkS3wqVU3ltaOvoWoqL77/Ij0jPav+hn+7523+rwP/F0+ff3rK+clkMsTjcTRNKzjmJ0+e5Oc//zkHDx5cXoIcP36cN954g8OHDzMyMrLiTnqYMGnS/Dr2a7w2L9aklayWZY19DR2ZDnT0FV1fSknx7EfPzlrNG5fjfNj/IbfX3I7b6qbaXc1wYhhZnaqFG01G+fW7v16yJ31fXx+HDx3mj+//Y8wmM++fe3/VE+T93vf5p4P/xHPtzxWCFblcjldffZXnnnuOY8eOcfLkST744AN0XWfLli2EQqHlJcikvKbVai34ICuJECE0XSOSjHC7+3bsWTtZI0uzvZl+uZ+kmlzR9eX0HB3hjlmjTyeHT9Ib6y34HJXuSpJKkpgcm+rsK1ku915esvM9Oj5KJprh3h33ckvLLRw8dXDJImQ3CpvLN/P49se5o+GOQthcURTS6TRut5uxsTF6e3vp7u5mYGCA9vZ2br311uV10vfu3cvg4CCqqlJdXb3iO8gYY5gUE4ZicLvrdjqsHcSlOLXWWhJqgoiab6BaKdhMNu6ouwOLZJnR/Hrh4gusDa5le+V2AEqdpciqTDwbp9J1dYCNy+Hijm13LNkIgoSawOQ30VzVzGe2f4Z/euafGBgfoL68ftUS5OF1D/PwuoenvOZwONi0aROhUIitW7dy/PhxysvL0XWdXC5HKBSiubl5+QhiMpmor18dJ9HAYJxxBFnIb6n2LZjcJqJE2WrdSlpPE1Wj1LNy67Wb7Oxr2Dfj30aSIxzqO8SfbPuTQp1Wib0ERVNIKIkp73Xb3Xxm+2eWbF0DsQE8VR58Lh97N+/lvz393zhw8gDf+vy3bipHXBAEtm/fXvjvz3/+80v22Td9w5SGRpgwSlbBKTppsDZg1+yECVNqKUVAYEQZWdE16oZOJBtBN6b7Qh2hDqLZKLtrdxdeK3WUggAT6aldkZquEU1Gl8zEGhwbpMRZgtVspbGykc/t/Bz/89X/yXBoeNVeb13XyWm5OZmCsViMs2fPLr8PspqQI8cYY6SyKfwWPw7RgWXUQlgJ45AceEweBpXBFV1jUknyzLmZW27Pj50nYAtQ66m9ajKYHbgtbkZSU4kdjoeXtOV2aHCIEqUEm8WGIAj87w/+7yTTSf5l/7+gaavTF/nF27/g3v/zXr731PemnIcLFy7w4YcfMj4+zvDwMAMDA7S1tXH8+HFee+215fVBVhMSJEiRIiWn8Jq92EQb5pyZuBHHZrLhkTyMKWMrvoPE5NiMT/5LoUvUeGumFCdaTVbcVjfhdHjKe1VdJZqILsmaVF1lPDxOmb2skFdprW3lPzz2H/jeU9/jq5/9KtvWbFt117trsIt3jrxDibuksCOn02lOnDiB1WplfHwcl8tFMplkzZo1mM1mrly58skmSEbPYFbMNNub8YpeqkuriZljOAQHfpOfIWVoRdfoNDt5dP2j2ExTuxxlVaY32kuTv2mKA28z2fBYPdNMLL/Lz5f2fWlJWm4zcoZILsLG1o1TXn9w94P86OUfceDkgVVJkHs+dQ82q411desKlQmT6jnpdJqamhrOnDlTkDOajG59ogmS0BOYVTN1ljoEBMod5ZzgBBISZZYyxpVxckZuxWSAzJKZ1mDrtNfTapqx1Bh3Nd41Lerls/oYT49Pfd1iY33d+iVZk6zIpHIpquqqprxe5i9j57qdHD5/GPlRGavZuqqu923rb+O29bdNec1isXD//feTzWYJBoM0NTVhsViw2WyEQqFFtWPc9D5IjBgxPYaiKqjmvE1qzpiJ63FkZKosVYTVMIq+ckWLk3mQyfLsj/smoUyIOm/dtGNKnaWEM+EpBY5yTqZzqHNGZ3++yCpZwtEwRnq62bejdQeXBy4TiodumvvA4/FQVlaGJElUVFQQCARwOBzU1tYWRtp9IgkyyiiGbpDUkpy2nEZGpne8l2QuSZo0peZSImqEnJFbsTWmlBTPX3ierJqd8vp4ahzd0Cl3Th+7FrQHicvxKQSJJCL86u1fLYkDncwmCY+HudR2adrfWmtbUXIK/WP9q+56j4yMcOrUKXp6eqZN/JVlGcMw0HW9UAN46tQpzp49+8klyDjjWHNWHDhwm/O2plW0khbSZMhQaakkpsZIaSun/yQIAjaTbVpCdTw9jlk0z9g96LP5SCrJKY1ToiBisyyNWkskEcn7R47ppeDVpdVIkkTfaN+qu95PPfUU+/bt4+/+7u8KjVCqqvLaa6/xq1/9ira2Ntra2jhy5Ahnzpzh1KlTDA0t3Ae96X2QMcbQVZ1KsZJvSt/EipXPln+Wt0xvkSFDwBzAMAwiaoRqa/WKrNFlcfHkluktt6F0CJNkmpEgJY6S/A6iXt1BAp4A37z3m0tSzRtNRCmpKOGhR6brYgU9Qcp8ZXQOdq666y2KIiaTacrU3mw2SzQaxe1209PTgyAIpFKpgmrLpE70J5IgI4yQU3M4BSc1Yg0ADeYGNDRSpPCZ8q2uETWyYmuUBImgfbqjOJYaw2l24rV6ZySIrMrElTjl5E0wk2SixLs0vfaJTAKbzUZF2fSedKvZSnVpNb2jvavuen/961/nnnvuwev1Fpr1HA4HTU1NhEIhduzYwYcffojP5+OLX/wi0Wh0UeqRNzVBsmQJEUJURXJCjnPSOWqooT3WTswVIybFaJAakASJmBpbuXWqWU4MnWBn9c4p4dzBxCBlzrIZa7TcVjeiKBLJXiV2KpvidOdpdm3Ydc3mqzntIMkoiViCC+cvUPuZ2qk3hWSiuqSai30XUTV1yfpPlgKlpaWUlpZO21X27NlT+O/HH3+88P8X23Mv3uwECRPGnXOjiApHpaNkjAwfRj5EU/MlKF6TFxOmFRWzzqgZ3ul5Z4rDbRgGoXSIgD0w483uNDuRBImEfLUeK56Kc+DEgSVpQosmo0QmIpw8dnLGv9eU1hCKh0ikE3yScdMTZIIJrDkrFaYKGoVGJCRa7C34RB8hQthFOx6Th1FldMXWaRbNNPgapmh1aYbGaGqUcmf5jGonTosTk2giqSSnmD71lfVLUj0dToSprqimrq5uxr+X+8tJZVNLKpa9EBiGsaLtFDe1iRUlSpIkkirRZGriq3wVm2Djj8r+iJeElwgTxiSYCJqDjOVWrtzEaXHy5Y1fxiyZp+wqkUyEMmfZrI69JEhEMldNLL/bz9c++7VFmzy6oROKhdi6cStfeuxLM76nIlBBOptecYJYLBbC4fCi1VdEUeTixYts2LBh+QiSTqex2WxL1p+wkAiWaIiYNTNuk7uQKXfixIOHCSbyDrI5SCgXKkyfWm4ICEiCNOW743KcjJqZlSBOsxO72T7FBxEEYdG+B+QrYhPpBH63f1ZVmlJfKZquMR4bZz3rV4wgbrebffv2LUrbapIgoihit9tvPEFOnz7NRx99xOXLl7nrrru48847V+TkjTOOCROiJmLYDV7iJT5nfI7XJl5D9+mEzCEQoNRcyrnUOTRDK0jFLCdSSorXOl/jgZYHCvVYKSWFoin47TMriZhEE36bn1AmNMVvOHDyAA/vfXhRu4hhGKTkFFbdyuuvv84XvvCF6Tem3Y3T5mQ0snKm6eRDYTG1VB+H1+udd8h3QY/+yspKvF4vZrOZpqamFTt5QwxhMSyYVBNmycwlLpEjx0epj3DrbiJE0NAot5QTVaMrlixUdIULExemlJok5ARZNTvrDiIKIh6rh2g2etUskzO0d7Uv2ibXdI1YMoau6HRc7pjxPXabHafNyUR09UzqWgl/ZsG2USaTIZ1Ok0yunI3aTz9OzYmhG1SZqriN27BgYZd3F3VSHVGiKCiUmcvIaJkVI4hNsrGrZtcUH2QiM4GAMGN+ZJIgTouTeDZeqL1y2p3s2rRr0SZtKpsilU2xtnEtO3bsmNnEszpx2V2Mx8aLUaz54ujRo3g8Hr7whS9w8uTJKaycbKBPpVKLymBe145GZ5hh/LofDKg31bOPfVgFK5/1f5a1prVEiCAj4zP5kA2ZtJ5ekZNsN9u5p+kerNLVytjh5DBemxeH2TErQQL2AJFspHB+PQ4P933qvkX7IRk5g6qptK5pZe8de2des9WO3+3/g9pBlo0gO3fuRNM0JiYm2L1795SwY29vL0eOHOH48eNEIpEbJuigoDDIIKV6KRj5p3SGDAYGGS1DmVFGkiQJElRYKshoGeJafEVOsm7oxOX4lAfJRHoCp8U5rUfk4wjYA8TleKEea9K5Xuw46bScRtVUbGYb2Ux2Vtu/1FfKRHziD1JQ7oYSpKKigvvvv5/Pfe5z0+y65uZmPv3pT7Nnzx6CweANi2FHiBAnToVekXc6xdTVKbejT6PmVERExhknYAogCRITyso8DWeacjuSGMFv88+6gwB4rV4yaoZ0Lr/zhRNh/r8D/9+id+askpdqGh0aZf/+/bMT1B0gloqR03KfWIIsKBQyNDTEqVOnkGWZmpqaKZIqk+E0s9l8Q8O/IUKkSRPUg+joOEwO+ulHQ2MsN0aNUYMJE2HC1Eg1uCU3I7mVEW/QDZ1QOlTwJSaThCWOkhnLTCbhs/lQNIV0Lk3AHiCn5RiPLN4nyCpZDAysJisTQ7M/NAKeAJFEhJyaw26xFwkyV0z2//p8Pjo7O9m5c+eya2MNM4yKSkAPkNWz1Iq1tNCCXbDzYMmD2Ew2JCTGGMMhOnBIjhUrN3GYHTzY+mDBnJJVmVAmxPaK7dc8zmV1oekaspZXWPS5fDxyxyOL9kFSmRRKTmF9y3q8G2avVSr3lxNLxZAVGRyfSH4szMTatWsXANFolD179qyIcFw33QQJIqkSgiBQZipjAxswYWKjcyMVUgVu3AwzjF204zV5GZFXZgexSBY2lW0qDPBUNOWaWfRJeCweFE0hk8ubZnaLnc1Nmxe9M0eTUSRRorqimtZ1rbO+z+/2o2oqsXSMTyoWtIOUlZVx3333rejCu+iilFIETcApOdEFnQEGqKSSwewgfoufMrGMQQaRRIkycxljuTF0Q1+SCbHzgaqrDMQHqPXUIokS6VyaSCZClbvqmsd93MQCUFSF4dAwdWV1i3ooxVIx3A43OSXH4OAg1dUz98l4nV4EBGLJTy5BbspiRRWVHnqoow5ZlbGJNuJCnF/xKzJGhl+O/5JYLkYllQyTF0GrsFQQyoVWZKBOUkmy/6P9BSc9lAnN2mo7ZQexehAFsZAsjCQiPHPwmUVHlaLJKE67k6GBIV54/oVZ3+e0OUHIm2RFgtxESJNmhBEaaSSrZ7GLdsyCuTDQUULCjJlqqhliKD+azVxCVI2uSG/6ZA3VZC3WRHoiP29whk7Cj8NqsuK0OKeIWC9FLVYyk8RmtmGSTIjS7LeA1+kt7DhFE+smQpIkY4xRTz2XtcuYBTMVQgVf42s4BAdPlj9JmbmMaqoL06cm1U2yeha35F7W9bosLr62+WvYzflIUCQTKZSSXNN3ES3YTLZCwWLQE1ySlttkJonD5qC1pZXGusbZdzCnB7NkJpqKFneQmwkjjJAjRy21JLUkTsmJQ3BQRhkiIuWWcgRBoIIK0qSJE6fUUkpOzxHOhZd9vZIgTen7GE2N5rWvrrODmCUzNslGPJtPcJokE+X+8kUHRSKJCHaLHZfTNa07bwpBzRbcDvcnOpt+0xLEjJkgQaJqFLtoRxZlTnCCHDmOJ46T1tLUUIOMzCijBEwBREEkrC4/QWRV5ujg0ULCbTg5TNAevGYWfdLEclldBZX3dDbNsQvHFtVRqBs6iUwCr9NLIpagra1tdvNCNOF1em8qfawiQchrYVmx4jbcxNQYLslFkiS/5bdkjSxvhN8gqkYpoQQ3brrpLphVcXX5y00yaoYDXQcK+YxQOkTQESyEfa9lYtlN9kLTVCwV47Vjry1qyE1OzZHOpvG5fQwNDV1zPJkkSbjsrk+0D3JTEmSIIXz4sGNHNmS8Ji9WrFRSiYRElbUKk2DChYsAAXrpxW/yYxJMhHLL/zSURIlqdzWiIGIYBhPpCYL24HUdbkmU8iXvchQDA4vZQnXJ4gYWKTmFZCaJ1+nF4XBQUVFxTRPP7/YTToQ/sQS5KZ30EUYopRRd14mrcRySgwCBQsvt18q+hkW0ICBQSSU99GCVrLgk14q03rosLp7Y9AQ2kw1ZkxlPj7OxdOOcuhv9Nj+9sV4UTSHgDvD1e76+KCdd1VXknIzT5qShsYHKqsprRt+CniCD44OrTt2kuIPMZkOjM8EEZZQhIKAaasF8spIvJ7eKVkREBASaaGKQQXJCjoApsCIEERAKNVcpJUVaSVPimJu+ldfmJakkUXUVQRAWLSatqipZJYvbnj9nFovl2t/v9JKW02SVbNHEuhmgoTHOOKXky9zTehq7aCdOnJd5mayR5aXQS4VoVTPNDDKILMj4Tf4ViWKlcileuvwSiqaQUlJk1MysrbYz7T6ZXAZN14in4vzm8G8WlShUcgrxdByf28fI8AhvvPHGtXcwt5+0nCYjZ4oEuRmQIkWSZN7EMnQUQ8Fv8pMmzVnOkiPHmcSZQnNUAw2kSDEhTFBqLmUiN7Hofop535SawtnRs6i6SkbN5HvRbXMjSMAeyO8ghkpaTnPm8plFtRBkc1lUVSXgDhAOh2lvb7/m+90ON7IiI+fkIkFuBiRIkCVLgACKrpBQEzglJy5cbGc7Fizc4r4Fp5QXZS6nvFDVW2ouJapGkfXlvdhWycqtVbdikSykc+lrijX8Pnw2H6lcClnN+w23rrt1UbVksVQMQRCwW+0Eg0G2bNly7e93+VBU5RNLkJvO68qQQUHBi5e0nkY3dDwmDy5c3M/9CILAF4JXVToqqMCOnV56CZqDpLU0aS2NTbQt25odZgefX5OfvDrZQjvXHcRtcaPqKrFsjMqSSh64/YFFrSWeimOSTNgtdsoryrmn4p5r72DuABk5UzSxbhakSaOg4MdPSkshCiJW0Vogj4FBWktfFTrASQ01XOEKHpOHjJ5Z9t503dBJKfmCv3AmjNPivGYn4e8TxCSaCsnCVDa1KBMxlU0hSRI2iw1Dz48ouxY8Dg8Cwic21HvTESRJEg2NAAGSWhJJkHCIDsKE+QW/IGNkeGbsGcZz+c47CxZqqc0nC01uZF0mqy9vRCalpHjm/DMomkI0G8Vhdlyzk/DjsJvtiIJIOpcmmojy9IGnF+Wkp7IpJFHCbrXT09PDc889d+3vt9qx2+xEk9GiiTVX9Pb2cvr0aXRdp6WlhY0bNy7bgiNEsGDBiZMBfQBJkLCJNmRkRhhBQ2NYGS5U7QoINNDAq7yaFynQs6S15d1BJltsNUMjLsexStY5E8RmshUIklNzDE0MsZgYQzwVx2wy47A7GBodYnT02sJwFrMFq9lKPBX/RBJkQTvIqVOnCIVCWK1WTpw4sSRq43NFmDAOHFixktbTGBhIgoQfP/dzPzbBxheCX8Bn8hWOqaaaOHEw5QsHl3tWiN1s5/NrP49NshHOhHFYHFhNc8tnuCwuBEEgmo3ic/l4YPcDiyp5T6QTWM1W7BY71dXV3HPPtX0Qq9mKxWQhnv5kEmRBO0hTUxM2m41MJoPL5VpWbd4ECezYsWAho2ewClYcogMbNraT7/He7pra611JJSlSqKKaN8eWuWDRKlkL/efRbBS3xT1FI+tacFqcWEQLCTmB2Wzm1pZbF/eASYRx2/N+jd/vx+/3X9/Esn5yTawF3dk2m40zZ87Q3t4+bzHgpSCIAwcWLMTUWF6dQ7SiojLEEDo6Q/LQlKm2lVSioxMTY9hE27InCydbbhVNISbH8Fq9cw7VWiQLLquLcDaMrusMTgwuKg8SSUTwOD2Iokgmk2F4ePja19piw2lzfmLbbhdEkM7OTlwuF1VVVXR2dk65YMPDw5w9e5bz588Tj8eXXNAhTLiwg0x2EzolJxNM8Et+SdpI88zYM1MUTDzkw8ARMZLPui+zgFxKSfGr9l+RUBLE5Tg+u2/Ox0qChN/mJ5KJMBGfWJSTrhs6qWwKj8ODJEr09PTw/PPPX/v7RQmfy0ckGVnROR0rTpDx8XHefvttenp6UJRr921/+tOfpqSkBEmS2LFjxxQSSJKE1WrFYrHcENMrSRIPHkREwrkwFtGChISBgU7eF9LRp4RC7dhx4iQhJvImVm5lQpaqrpLOpXFb5t7RKAoiLouLpJLMjzhexIx0XdeJp+N4XflW2smRydeD3+0nlop9IhUWC3ew3W5nZGSEH/zgB/zsZz+jr2/2EcBut5sdO3YUhI8//mQpKyujtbWVlpYWXC7Xkj51NDTixHGSz5Kn9TR+kx9BECihhCd4It9yW/YkpearnXIOHLhxExWjeEweoury2tNOi5Ovbv5qIZN+vVbb399BXBYXsWwMv9u/qGpeXdcJx8OFXvPGxkYee+yx6wcK7C7S2fSi+lBuaifdMAza29tJJpM88MADlJWVXfPpf+HCBc6dO4dhGDQ1NS2bLlaOHEmSVJOXqYmrcRyiAxERCanwepV1qpyODRtBgkwwgcfsIaJGUA112WaFmEQTla5KQpkQCTlx3Vbbj0MQBHw2H/2xfiRJorpk4aOss7ks6Wy6MCnXbrfPyYf0uXwkM8lFEySXy2EymVZER21RO0g6nebChQuoqko0GqWqqoqamppZD+ru7sbhcFBSUjLNB7mR0NDIkMGNu7CD2KXfJdJIc5rT5MhxOnl62qiDUkoJEcJhcpBQE6jG8pkLsibTNtJGUkkiq/KsIw9mNXFsfpK5JNFUlLaOtgWH1VOZFIqq4HPlCRqJRDh37tz1v9/lJ5qMLsrEeu+99/jmN7/JT37yk0VPi1p2gkxMTLBt2zYCgQBmsxmz2XzNg+68804qKytxuVzcd999y/ZEUFFJk86bWL8rdXdJLgQEIkR4lVfJGlleCb0yLdcRJJg3z0xOknoSzVg+cyGTy/BG5xtMpCfQDb2gbjJngtj9KJrCcHSYlz98ecognnkRJJsip+Zw2V0ADA4O8uabb87JB8kqWVLZhelj9fb28p3vfIcLFy7wX//rf+Wdd965uQhSX1+P3++noiKvlK5p1755nE4nt956K7fddhuBQGD5nFxUMmTw4cPAKPSjA5gxU0opEhKlltLCvMJJlFBCnDhuU76PfTn1sSRBotxVTkpJIYp5p3s+8Fg9yJpMzsgtStUkq2RRdRW3I78D22w2Skqu37jlcrgKBFsInnvuOZLJJD//+c+55ZZbeOqpp27o7Jgb4qQnk0nOnj3L+Pg4Y2Njq3KxKiopUnjwoBkaGS2D3+QvEOBJnsQu2Pl6+denOOmTJlaKFHaznbSWJqMvX3XqpC4WQr70xW6a3w7iNDvz5e4O56J0sZKZJDk1h9/lLzjpX/rSl66/fpsrr4aygJnpsViMF198kQceeIAtW7bw6KOPcvToUfr7+28ugjidTlRVRVEUvF7vqlxsmjQqKh6uVuXaRfvvfoiIAwcCQt5x/71E3OSuY5iMgoO/XBAEAatkLYhQz7XM5PdNrKyaxWa1LXhS76Q6yaQPIkkSDsf1q4rtVjsCwoLabs+dO0dvb29hUOjOnTvRdf2ackOrkiDRaJSysjLuvffeZTWb5mVDk0JCwomTjJ5BN3S8pjyZo0R5ndeRDZnXwq9N80HcuDEw0MS8+bicycJ0Ls1vr/yWUDqEJErzNrH8Nj+6rjMcHeaNY29c1wSeDROxCVw2F3Zr/qEyNDTEgQMHrnvcpEm2kJnp77zzDtXV1WzevBmA2tpaGhsbOXr06M1FkNraWmw2G5cvX0aWV2f3WJz8TW3DRkbPoBgKDslRIM9JTqKgcCJ+YloUa3J3MaT8rPTlHOgpazInh08SyUby5fnm+Q3bcFlcWE1W+iP9HL9wfMHJwlA8hNvhLgg/hEIhzpw5M2eCzNfESqfTfPDBB+zcuROfL79r2e12tm/fTltbG9ls9uYhiKIoxONxLBbLdTPpKwUZGQkpr4ely2iGVjCxHDjYxCbMmNni2oJDnHoTesg3/ogmERFxWXcQi2RhS/kWEkoCq2Sdc6Hix4+3mfIPhS1rtizYSY8mozhsDsymfADD7/ezfv366x7nsDqwW+3zbprq7++ns7OTO+64Y8rrW7duZXh4+Lql9quKIKOjo1y+fJmjR48yPr46R/+myZe3W7CgGAo6ekHyx4+fL/JFbIKNB0seJGAOTDOxTJjQJA2TYCKmLl/xndPs5Atrv0BOy+Gz+a6rqDgbQSSzxIN7Hlywkz4RncDr9GKz5NuNa2pquP/++697nEnKS5DOt6L3zJkzmEymgnk1ifXr15NOp+np6bl5CBIIBPD7/VRVVbFmzZpVSxAzZly4SGkpFF0phHl1dBQUDAxkXS7UZRVuMix48JASU7hN7mVVWDQMg6yaLXQTzld0wWay4bQ4iWTy8wIXAk3XmIhNEPQECwTTNG1O5rQkSjjtznlLkB49epT6+vppSefKykqCwSAXLly4OQhy4cIF3n33XTZt2oTdbieRSKzKxaZIISBgw0ZCSyAKYsFJDxG6OkBn7JfTJtpKSLhxExNiuCX3ss4rTOaS/OL8L5hIT+CwLIwgLouLzrFOnnlrYQN0skqWcDJMmf/q2Lfe3l5eeOGF6xNEyrfozscHSafTnDp1ih07dmC1TjUpA4EANTU1nD9//uYgSEdHB7fddhuf//znKSsru2ah4koiRgwLFuzYian53g6LkG9dVVAKU277s/3TJklNEiQjZHCb3MtasKjqKv3x/nxXoM03745Ak2jCZ/Mxkhiha6hrQaU9iqqQTCcJeK6anqlUisHBwTmZWD6nj0hi7p2Yvb29DA0NsXPnzumfZzLR0tLClStXrisasSoI4nK5ePfdd/nlL3/J5cuXcblcq3Kxk0lCEZGIGsEhOrCIeYL48HEP92DDxr2Bews7y8cJ4sFDSkjhM/mW1cRymBzc03RPodR9IXmMgC2ALuncteOuBbXcyopMJBmhMnBVi7eqqop9+/Zd/yYRRLxOL/FUfM4RtEuXLgGwYcOGGf++fv16BgYGVq21UiAzwL59+7j99tsxDANRFKdtiasFESI4cSIiktSS2ERboSLXiZOd7AQBdnp2zvAkEPHiZZRRasw19GR7UAylsAPdSFhNVraUb0HRFLzWhSVhvTYvhmCwo3XHgvpsoskoWTlLme+qiRUMBgkG51Y46XF6SGaTZJUsDuv1w9RtbW3U1dXNqh7f3NyMLMsMDg5SXl6+uncQURSx2+04HA5sNtuqLUeerOQVEUloCRySo3CD58gxxhg6OmPK2Iy1Vn7yEqVOs7MgILcc0A2d3lgvsibjtS2MIEFHkHAmzEBoYEHHj0XHMJlM+N1Xe9Cz2eycI5Z+l59MNjOnbLosy5w5c4b169fPao1UVVUhiiK9vb03RxRrtcPAIEkSC/mxBuFcGIfowCyaC076MzxD2kjz9NjTBV2sj8OHjwwZHCYHGT2zbPVYKSXFT9t+SiQTmXcWfRIljhJ6xnv46Rs/XZCTHo6HsZgseJxXm7V6enp49tln53S82+lGURWU3PVzZKFQiK6uLrZv3z7re0pLSwkGg3R0dBQJslQESZHChy/vsKsxPCZPYQfR0ZHJhyxlXZ7RkfXgQUbGYXYs6w5iYJDMJVE0ZcEECdgC+ZbZzMISnKORUSxmS6EOC/Jh3rkmhd12N1klOyeCdHd3k8lkpuU/Pg673U59ff0fJkEymQy9vb2F7PtyNEwZGMSI4caNZmgktEShkhfy1bxf4SvYBTtPlD1BiXl6GbcTZ1621OInq2dJasllOckui4uH1z2MWTTPq912yg1qdeP3+Lnn9nsWlCgcHB8k4A7gsl0laENDA4888sjcCOr5nUavcv1d98KFC7hcLmpra2d3fk0mmpub6enpWdUlJwsiyHvvvcc777zDsWPHePPNNxdcPDdf/yNNGjd5Mee4Fp8SqbJgoZ56JCTqbfUFvd7f90GyZLFKVsyCedmG6YiCSKmjFEVXFkwQp9mJ1Wwl4J9/IalhGAyHh6kMViJJVyNgTqdzyk2sKAr79+/nX//1XxkZGZlKEHcATdeumwsxDIO2tjYaGxuvGwBYs2YNoVCIcDj8h0UQwzDYvn07mUyG0dHRZRGOU1DQ0PDgQTVUMlpmCkEyZGinHRWV9lT7jOaTHz85chiSgVNyzuin3AhohsbxwXyRoc/qW/AupGs6bZ3zLxPXdI3h0DAV/oopIeJYLDYlm/3SSy/xF3/xF/zjP/4j3//+96e0xtqtdixmy3VnpmezWS5evMiWLVswma690zU2NhKLxZiYmPjDIsj27dsZGRnBMAx27969LATJkCFLNm8mGQoJLUHQdPUJFSbMi7xIxsjwm4nfzKie6MCBCRM5KYdLcjGqLE+xXDqX5qXLL2EWzdjMCxu74LF6EFWRN4+9ia7Nr5o3nU0zEZugunSq4EN/fz+vv/46APF4nB/96Ed88Ytf5J/+6Z946aWXOH36dOG9kxKk10sWDg8PMzw8PGv+4+Oorq7GbDbT1dX1h0WQEydOoGkaFouFixcvTvFBNE1DVVVyudySavbmyKGh4cJV8B+C5qsEMWHCjx8REb/ZP6NiiQ0bduzkpBw+k48heWjZTCybyYbT7JyzaPU0p9Zsx2Pz5HNU84zCR5IR0nKaisDUnITFYik0x50+fZqOjg6eeOIJHnjgASoqKnj11VevEsRixWq2XrcnpLu7G1mW51Ql7Pf7CQaDq7pocUFloWvXruXs2bPE43HWrFkzJW/S1dVFf38/qVSKUCi0ZDkVGZkcOVy4iKr5scgfN7FKKeVJnsQhOPh6+denlbtDfsinDRuyIFNpqWREGVkW+R+n2cnO6p0MxAcWTBCTaKLEW0JDfcO8d+x4Ko6ck6ckCSGvsVxVlZdIevvtt6mqqmLLli14vV7uuusu3n33XRKJBG63G7vFjs1iu67Ke3t7OyUlJYXPvRa8Xi8VFRWrOpK1oDujpaWFlpYWstksXV352qBJIjQ3N9PU1EQsFmNwcHDJIlxZsuTI4cFDWA3nBdUk18e2QrEgBzRZAj8bQWLEqLZW8378fXJGbln0sWRVxmlxYjMtzMSSBAmPzUOW+Ud8QokQOTU3bQcxmUy4XC4ymQxHjx5l165dhR3lzjvv5JlnnqGjo4NbbrkFuzVPkGuZWIZhcO7cOZqamubUti1JEk1NTVy8eJFsNovNZlt1BFmQiRWLxfjggw/48MMPcblcU3YJURSRJGnJBcIyZNDQ8OIlrsYxCabCHELIFzK+xVvIhsyByIEZixEnTawIEeqsdYwqo8uSC1E0hbaRNlxmFzZpYTeBSTQRMAcY7Rudt+k6MD6A2+6ekgMBGBkZ4dChQwwMDNDd3c2ePXsKf9u0aRNer5cTJ07kzTGTBa/LSyQ5O0ESiQQdHR1s3rz5ug76xx+2AwMDpFIpViMWRJBDhw4Rj8cRRZFDhw4tSx4kQqTQTRhRI5gEE17p6lMqSZIjHEFB4cPYhzPmOKxY8eIlQoRKWyVZPcto7sY76hk1Q1+sb0GVvB9H0BIkPhafty7WSGgEr8tb6EWfxPj4OCdPnqSjowNN06b4DaWlpbS0tHDs2DF0XUcQBIKeIJFEZFaFxdHRUQYHB687GPT3I1mpVGpaWPmmJshkR9jo6CgbN25cltqtOHFcuLBiZTw3jkN0TDGx7NhppRUzZtY71xdacafdZASJECFoDmJgMKaMLcNJFrFKVgL2xYlhlLhLSFqSpHLze9oOh4fxu/3Tigy9Xi9r1qzh9OnTVFZWTvEbTCYTO3fu5Ny5c8Ri+UYpr9NLPB2ftdSls7OzYDbNFZM1WUNDQ384BGlubuaRRx7hscceY9u2bcuy0DhxLFgQERlWhik1lxbqsAACBHiER7AJNh4tfXRay23hpsBLnDgllhIsgoV++cbrM4miiN1sX3ChYuE3ugNk/VnSubmbhZquMRoepdxfjsU8NUBQV1fHvffey+nTp2lpacHtnuq7bd++nUgkUigo9Lv9xJPxWXeQc+fOFZqh5orKykqcTidXrlz5wyHIx32N5UKCBDZsmDARyoXwm/1IXP1+AwMNDQPjmrq7AQLEiGGTbFRaKulI3/gIiqqpxOU4JY6SRX2Oz+ZDySlk1LkXWWaVLBOxCSqDlTM61aFQiL6+PrZu3TrNEmhubsZkMtHe3p7fwbwlRJIzt/3qus6ZM2fYuHHjvPqJHA7Hqq7JummKFSNE8ok+w8SoMkqpuRRJuEqQECH2s5+skeXXY7+etaW2lNK8PyPlS1K6sl2LGqs8p5tUyy4JQUotpWSGMiTludeQyYpMOBGeFuKFfKLwRz/6ERMTE6xbt27a38vKymhubi446n63Hzknz5gLiUajBQd9PmFoq9VKbW0tnZ2dq1KO9KYhSJw4btzous5EboIqy9Q4u4xMN92oqHRlupB1edYdREYmS5YWewsD8gAJ7cZ2tUUyEXRDn7eq+zTz0OzFyBiE0nPvhkxlU0STUaqC0/MSqVSKAwcOYLFYqKurmx71s9nYsmUL58+fR5HzqvCGYcwo3tDX10c4HGbTpk3z/l1r165lZGSEaDRaJMhCoKMTJYoHD0k1SVpPU26Z2oXmwcM+9mHFymf8n8Fjmrko0IcPAYEoURptjUzkJojkbuzU22g2iiAICy5ULAQibHYcZQ7GM3OvIRuPjWMYxhSxhklUVFRQXl6Oz+ebtavvlltuYXBwkOHhYTxOD7qhz7iDnD9/HpvNRktLy4J82kgkQigUKhJkIciRI06cIEGSWpKsnp0mTu3GzR72YBEs7PHuwSPNfDNOJhPjxGm2N5PW0jc81BuX4wgIuK3uRX2Ow+bAXeYmnJ179WsoHsqLLvxeDgTA5/MRCARoamqa5qB/PGKZy+W4eOlioRtxporekydP0tTUNCe1+N9HY2NjYRcqEmQhTu7vVN19+Ajnwii6QqW1ctp7QoTQ0QnlQrOON/j4DlJmLsMpOenOdN/Q9U+kJ5AEadFhXqtkxWbYmEjNvfo1FAshSRIex/QHRjKZ5OLFi7S0tMzqN1RXV1NRUcGJEyfwOX2Igjgtm55IJDh79izbtm1bUDY8GAwSCARWZSTrptlBEiQIEGBAHsApOQmYpt5sE0zwDM+QMTI8Pfb0rE66Fy8WLIwyit/sx2fy0Zu9sX3Rw8lhrCYrDpNjUZ+jZBWSfcl5+SBj0TEcVseUXvRJdHd309PTQ2tr6+x+j9fLtm3bOHnyJIZm4LK7GI1M3XEHBgbo6+ubUeJnLvD7/ZSXl3Px4sUiQRZ0Y6AQI0aQIIPyIH6Tf0qZyaSfkiSZ/7c2+wSpyXmFAwzgkBxUWivpyfbc0EjWaHIUi2RZdELVMAzQYSw1Rk6fm8LiSHiEUm8pFtP0IslYLIYgCNTX11/zMz71qU/R0dFBNBIl4AkwEZv68Glra8NsNrNx48YF/S6TycSaNWvo6upadcLpNwVBYsTIkcNH/mlfYi6ZkkWHfIb8cR7HITj4cumXZ2y5hXxZfIAAE+Qvcr21ngF5AEW/cYLdw8lhmvxNCy5ULJiHbh+333I74WyYnJabE6HGo+OU+EpmzFmNjIxM6yqcCdu2bSObyXL54mWC3iDheHjKd7z77ru0trZSXb3wAaOtra309/eTTCaLBJl3FIgoEhJW3cqgMkidrW5aBa4VK800IyHRbG/GJs58M1qwUEYZwwwD0GBrYEgZIqvfmL5oWZMZSY6wJrBm3qLV08gtmdhQt4FIJoKiXZ/Qk52E5b7yGWvALl26REVFBR7PtaNrTU1N1NbVcuL4Cfwu/xQTa7Ke66677sJiWbjG2Jo1a0ilUgwMDBQJMu8oEHEkJCRdYkQZodY6/YmXJcslLqGicil96ZqSPtVUM8EEMjJ1tjpSWuqGafXGsjEi2ciCZ3pMueE1jUgoQjQbnVM9VkbOEElEZs2iX7p0iZqaGpxO5zU/x+VysXv3bj54/wMsWIgmo2Tk/Pk9ceIEkUiEvXv3Luq31dXVIQjCqotk3RQECRNGRETQBMaUMRptjTO+5wVeIGNkeG7iuWtKi1ZSSZQoMWKUm8vR0W8YQRJygon0BBcmLsyrRGQmRBIR3j7+NjktNydHPZaKkZJTlAfKZ4xg9fX14fV655T5vvvuu+nr62N0YJSUnCItpzEMgxdffJH169fPmImfD8rKyigtLS1IlhYJMg+MM44DB0k574RXW6fbuhISLlyIiLgk15QylN9HFVUkSRInToWlAgxuWH/6WHqMlJKi3Fm+4NmCkxAEgWp/NaIgEs1Gr0/OdIKsnCXomZ7Bj8fjDA4OXnf3mMT27dupr6/n2PvHSKQSKKrChQsXePvtt3nsscfmNOvwWnA4HDQ2Nq66SNZNQZBhhimjjLASxiyYZ3TAJ6fcOgQH3yj/xrRE4sdRQw0aGoMMEjAF8Jl9N6yqtzvSTYWrgm/v+PainfSAJ8BfPPwXWE1WQpnr7yDRZBQ5J1Pun76DDA4Oouv6nAboQD7c+/iXH2fwwiCj/aOEYiF+8uOfEAgE+PznP7/o8zSp+N7Z2bmqBK1vCoKMMUYJJQxmB3FKzhlvfgmpkAT0mXzXbKP148eDhz76sIpWysxl9Mk3xva9ErlCiaOEBl/Doj9LEAQaShpwWpwMJ4av/2AJD2Oz2GbcQbq6unA6nTQ0zH1djz76KJ++7dPEzsT427/6W5577jn+/M//fMnEp9etW8f4+PiqKjlZ9QTR0BhmuECQGmsNdsk+oyP/Hu+hGArvRt+95og1Hz78+OmhB7NopsJSwYC89NETTdfoDHdS5izj+NDxOUWeroVkJskH5z4gYAswmLj+XI/h0DA+lw+Hbbr509HRgaqqXL58ec7fX1JSwt/+3d/i9Xu5cO4Cf/O3f8Ojjz66ZOdrUudgNQlaz5sghmFw6NAhfv7zn/Pcc89x/PjxG7rAJElChCg3yhmUB6m11WIWzNPtbRIc4hAyMu9F37tmha4TJ3XU0UlnPoJiy/enL/Xk27SapivSRYOvgQ/7P1w0QRLpBB+e/ZASRwlDiet34A2FhvIE+b1OQk3TuHLlCg6HY05Tbj+O9RvWU39nPd/6z9/iW9/6FmazecnOV0VFBYFAYF6kvdGYd2BeEATKysrIZrPU1dVRVlZ2QxcYI0aKFG7NzZA8xG2e22Z8nw0bzTRjwsQax5oZpUc/jlZaeYM3yJKlylJFTI2R1JLTMvSLwWhylPHUOFvLt2KRLIvqR4e8NtWGhg0omsKp0VMomjKrjJBu6AyOD1LmL5vWi57NZunu7mbHjh3znkfpcXgI+oLzqgebK4LBIFVVVYUGrZvWxIrH40SjUc6dO8epU6du6AKjREmTxqE6SGgJam0zZ30DBPgSX8Iu2Hm89PFZM+kFe5d1jDDCKKPUWmuJqtElHw3dFelCR2dL+RYeW/8YdpN9UZ/nd/t54q4nqPXVEsvGiMmzm5FZOctIZISakuntr6Ojo0xMTHD33Xfz8MMPz++JKpmoDFYyMDGwoDEM13PU161bR0dHx6oRtF4QQZLJJJIkYbPZSCQSU1RNBgYGaGtr48yZM0Sj0UXXHw0wgISEJWchpaVmTBIuBA00oKHRSy+11loMDIbl4SU9uR+Nf4TP5qPaUz1rbdj87Nt8a3GNp4aEkiAuz07orJIlFAtRWzb9fA0NDSHLMk1NTQtSpKkKVjEaHp1Tuct8sWXLFnp7e1eNo74gguzdu5dbb72V1tZW7rzzzikkcDqdlJSUEAgEFlV6MIluugkQICEnCg71TAgT5jmeI2NkeHb82evOIKyjDjduLnIRr8mLS3IxoCydo25gcHr0NC3BFgQE9n+0f9GJwmgyyq/f+TVVriqyuew1k4XRVJRoMjojQS5fvozX60XXdV588cX5P1wqGhiLjpHOLr2m2Jo1a1AUZdVk1BdEEEmS8Hg8OBwO+vr6pjyF/H4/tbW11NbW4nA4Fq2ZdYUrlFFGXI4XbuQZn5hk6aADFZXL6cvXra1y46aJJtpow21y45bc9GeXLhcSy8boDHeypWwLkiDREe6YVQ1krsgqWS71XiJgC+CyuOiNzR7tGQmP5P3FGToJL1y4QE1NDYZhLKgHo6qkCiWnMBZZesmkhoYGbDbbqhkRvaDquWPHjtHX14coirhcLrZu3XpDFicj00UXTTQxmh2lxFxyzU7BPezBipU7fHfMKj86CQsWtrCFgxxEl/LZ+cmy98VmvAFGU6OMpcbYWLYRm8nGHXV3LFiXdxIuh4u9W/fit/vx2Xz0RHuuSRCzZKbEM9UXk2WZy5cvs2bNGhobG+c8YerjqAxWomka49Fx1tevX9Jr7vP5WLt2LefOnbt5dxBZlpEkCYvFgqIoN0xZMU2aAQaoN+oZlAeptlYXxj5Pi678rifdIljY59s3bQz0TNjMZoYZZoKJJS97vxK+goDA2sBazJKZfQ37Fk0Qt93NXdvvwmf3Uemu5Er4yqx9LL0jvbgdbkq8UwkSjUbp6+tjw4YNlJaWLqjIsCJQgcVsoW9s6c0gq9XKhg0b+Oijj1ZF6fuCCLJnzx527tzJ5s2buffee2+YsuIggyRIUK/XM6KMUG+bvbFHQyNKXvU9qkavqY01iQ1swMDgEpdosbcwKA+S0pcmF3Jx4iJBe5ASRwmGYSxJRa+ma0STUURBpDnQTG+sl2xuZlOyZ7SH6tJqbJap5S19fX0kEgk2btyIrusF1cT5wGlzUhGo4MrQjWmR3bp1K4ODg4yNjd2cBDGZTNTW1tLY2HhDFbl76MmXkGg+RpSRGat4JzHZcps20jw9+vScqnMrqaSCCs5whnpbPWk9vSSRLMMwuBi6SIOvAb/dT0JJ8My5ZxbtpIfjYf7Xm/8LQzdoDbbSH++fMdSr6Rq9I73UltZiNpmn+R8Oh4O6ujq6urrYv3//vNfhsDqoLaule/jG9PJv2LABTdNWRcJwVZeafMRHlFKKoAjkjBw11tklLVVUokTR0YmokTntIB48bGITZzhDibUEzdAYUhavEZtRM3RFulhXsg4BAd3QicmxRZuiqq4STeR3yTWBNeS0HAPx6ZG3eCrOSHiEpqrpGrmnTp2ivr6e8vJystnsgnYQURRZU72GvrG+684sXAiqqqooKSnh7NmzRYJcK0zaTjtrWUtcjucHYV6jQjdIkEd4BLtg50ulX5oyfepa2MY2LnEJq8WK1+SlM9O56LWHM2GG4kO0luTFEJxmJ4+uf3TR1bx+l58v7fsSoiBS561DEvPRsWnfnwiTSCeoK5sqBpfJZDh37hzbtm1DkiTq6ur44he/uKC1rK1Zy2h49Loj2RbqqG/YsIETJ05MmZNYJMjHECNGJ51sZCOD2UEckoMyy+xlLTZsrGMdJky0OlpnVXf/fWxiEwkSjEqjNFmbuJRefMNOf7yfnJ6j1pPPQZglM63B1kW33NosNtbXrQcBShwl1HnqODs6/Sk7Fhkjo2Sor5jqsw0MDDA0NMT27dvzO6jHw9q1axe0ltbaVhRVoXvkxphZu3bt4uLFiyueMFy1BBlllAkmWMc6rmSuUGetu2ad1GRIWEOjK9M15x7ztazFhYtOsZO1jrVczlxedH96X6wPk2gqECSn5+gId8x7rse035iT6RzqxDAM7CY7G8s2cmbkDFl16nq7hrtw293T9HjPnTuHrusFedBkMrng+YCVgUq8Ti8X+25Mg9PmzZvJZDIrrpW1agnSSScCAg1GA53ZTprsTViE2cOkIUI8y7NkjAy/Hv/1dTPpk/DipYUW2mijxdHCkDw044Tc+eBy6DJV7ioCjrx2V0pJ8fyF56fdyPNFJBHhV2//qlADtbN6Jz3Rnmml793D3QS9wWlicYcPH6a5ubkwnqC3t3dBmXSAoDdIY2UjbR1tNyTMv2bNGvx+P0ePHi0SZCac4xxllCHlJAbkAdba117nh4hYsSIgYBWtcw49W7BwC7fQTjtVziqSWpK+7OLi+53hTuq99YXiREEQsJlsiw6Hi4I4JWx7S8Ut6IbOqeFTUyJoXcNdVJdU43JcrTqIxWIcP36c22+/vdAeK0lSfmruAiCJEp9a9ynOXDkzo5j1YuH3+9m6dSuHDx9eUT9kVRJEReUsZ1nPerK5LBE1Qovj2qLIJZTwNb6GXbBft+X297Gd7QwxhGEx8EreRfkhcTlOT7SHtcG1iEL+9LosLp7c8uSiq3kDngDfvPebmKS8L1Pnq2ND6QZe73y9UAyZltMMjA/QWNk4pSKgvb2d/v5+Pv3pTxdea2xs5PHHH1/wej7V+inGo+N0DCz9bA9RFNm7dy8XL15keHi4SJApNxlxLnOZbWzjcuoyVtFKs635mseYMFFCCSIiQXNwxqaq2bCOdVixMmQZosHWwMnkyQWvPZQJMZYaY23w6o4nCRJBe7BAmIXCJOVHQU/uRFbJygMtD3C4/zDdkbyzHE/HGZwYZE311D6PAwcOUFFRMWV+oNVqJRBYuF7wpsZN+F1+3j3z7g25D3bu3ImiKLS1tRUJMsWGppsYMTawgVOJU9Raa68ZwYJ85+GHfIhiKByOHZ5Xb0cllTTSyGnhNJtdmzmXPLfg7sK+WB+KprA2cJUgWTXL+33vL7qjMJVN8cH5D6YUPd7ddDdm0cwrHa8A+YGdOTVHU2XTFPPqrbfeYt++ffj9VzV6JyYmOHbs2ILXU+orZd/2fbx69NXrzk9fCBoaGli7di0HDx4sEuTjOM95rFgp18o5njzODveO64ZtY8Q4yEFkZA5GDhJX537BLFjYxS7aaKPJ1cSIMrLgHvXJHpBy51Uhg4ya4Z2edxZNkHgqzoETB6aMga7z1vGFli/w7EfPksglGBgfKDQ1TeL48eP09/fzuc99bsrnDQ8Pc+jQoUWt6aE9D9E91M3h9sNLfh/Y7Xb27dvHhx9+yPj4eJEgkzjCEdaznlgmRne2m73e6xfUWbFSRx0mTNTb62ctapwNe9jDCCOYnWZERE4nTy9o7e3j7dR6awk6riYqzaKZBl/DNbW65gKr2Up9Zf00Z//R9Y8ymBjkUO8hOgc78bl8hRCvpmns37+f9evXc+utt045zuVyzWvg5ky4peUWtjRv4Zdv/3LJOwwBPvvZzxIKhVYsmrXqCBImzGlOcxu3cSR6BK/Jy3bX9uuHHQnyFb6CXbDzRNkT83LSATayEQ8euq3dbHBs4K3IW+jMr7gwqSQ5P3qereVbp0zgdVqcfHnjl7GZF5lJd/v52me/VnDSJ7GlbAvbKrbx6/Zfc6brDM1VzQWhhvb2dg4ePMhXvvKVaSJx9fX1i1YlcVgdPHn3kxw6e4j2nqXvJd+wYQObNm3ihRdeQNO0IkHOcY4xxtisbeaN8Bvs9e69rv9RcIZ/N/X249Nv54ogQW7ndg6Lh9kd2M2H8Q/nHe7tj/czlBhiR9WOKa8LCEiCtCTKijMJP1hNVh5qfYh3r7zLuxfeZX3deiRJwtANfvaznxEMBmcUiBMEYUkmFd+1/S5KfaU8f+j5Jb8fbDYbjz32GO+///6KqC6uKoIoKDzDM7TQQi6Z41L6Eg8GH5zTjRUhwou8SNbI8sLEC4Rz80v2CQh8gS9wkYtUBioxYeLZ8Wfn9RnHBo9hkkxsLts81blWUjx/cfGJwmgyyvOHnp/RlNnXuA+H4WA4MszGhvycjlNtp3jhhRf4kz/5E0pLp++oAwMDvPLKK4u+bqW+Uh7a8xAvHX6JoYmhJb8v7r33XlwuF7/61a9uDoJM9hFEIpElGd07wAB/w9/wEA/xKq/yx/wxB8YO0GRvYqdnblOLMmT4iI/IkaM91X5NdffZcBu3UUstR2xH+Er5V/jJ8E84lZibaousyrxy+RV2VO6gxjPVrld0hQsTFxZdapKRM7R3tc+Yua711HJP5T04JAeN1Y3IWZkf/vCHNDY28thjj81MuGh0yUrKH7njEdLZNC8feXnJb9KKigq+8Y1v8Itf/GLZOw0XRJCTJ0/yxhtvcODAAd59d3Ex8ChR/pK/5HmeZy1r+R/8D1pSLbwafpUnyp64butsweHExU52YsHCbd7bZu1dvxZ8+PgG3+BFXmRT5SbW2dfx191/zXju+hGU16+8zrHBY3x545enFSXaJBu7anZhlhYnsua0O9m1adeMauwCAq6sixgxDgwd4Kc/+ynvvPMO3/nOdwgGZ65sLikp4ZZbblmSG6mltoWH9j7E//vy/8vA+NKrVD7xxBOUl5fzz//8z6RSqeVjiLEAHDx40Hj++eeNV155xXjhhRcMXdenvScWixn/9m//ZqTT6Wt+1g+MHxiNRqPxvvG+YRiGkdEyxv928X8z9p7aa4zKo8ZyI2JEjIeMh4x7jXuNFxMvGluObTH+svMvjayWnfH93ZFu4/8+8H8b9f9Sb3z7lW8baSV9w9c44/lOxoy7//JuY/1frjeq/n2VUVZVZvzDP/yDoWnasp27y/2Xjc3/brPxZ//9z4yMnFnyz3/99deNuro647/8l/9iZDLz//yPPvrIOHv27LyOkb773e9+d97bjihy/PhxhoeH2bFjBxUV06V4ZFnm/PnzbN26dVZ5ysMc5q/5a77Nt/kKX6Ev28f3+r7HS6GX+H7z99nm2jbnNWlopEhhwUJSS2ISTAvKXNuwsZGNPM3TXLRc5A7zHTw98DQ20cZ29/ZCqNYwDN7vf59vv/xtzo+f5z/c9h/4j7v+44yjnnVDJ6EkFjWn0DAMLvZf5Mcv/5gXPngBzdCoLqkudAy+cfQNfvzrH9OYaqTvzT7ktTLbHt/G9trtOMwzjyZQVZV0Or0k8kwAQU+QymAl/7r/X0llU9zacitWs3XJHuZNTU14PB5+8IMfMDAwQHNzM36/f87ndGJiAl3X5yW2vaAGhTNnzrBu3TqcTidnz55l06ZNhW1flmVUVSWZTKKqKoZhFP4nIKCg0EYbZ4Wz/A/lf0AazIqZP0/8OW9F3kIwBL7f+H3u9d1bOO76dqLIuDDOi7zI14yv8fTI0zxY8iCVlsoF9YFvZjM/5sf8Z+E/s79kP8jwV/1/xanEKT5r+Sxm2UzbUBu//ujXfKrqU/zDXf/AmuAaDMOYksSbjBQl5ATPnH+Gr2/+Ok6Lc06/SRAEcmqOts42+kf7OX7iOPvf2k/faB+o8GPzj7lr811sqNpAaCLE2x+8TXwgTqg+xD/8zT9gvtXMv5z6F94feZ8H1z1Ia7CVGk8NW8u2IokSgiDQ1dXF4cOH+eM//uNp615olO2Lt3+RaDLK3/387zh5+SSP3vEozdXN3Lr2VuxW+6IqfwVB4I/+6I/w+/1873vf47e//S07d+5k48aNVFVV4fF4sNvzCeXJ1ya/b/L+nO8DakEEue2222hrayMUCrFnz54pNnFfXx/9/f1kMpl8qNEwCo68gECIED/khwwySH20np7+Hn5k/Ih6Wz3fqvgWD/geoMHWgKEZqMzNqdXRyZJlVBxF0RRG5VGyuSyqqC5oeq2Gxla28jN+xqu8ypvlb3LBeoH3R97n0IlDqFGVOncd//G2/8gTG5/Ab/Nfs+JUySmMp8bJqTlUcW6/SUAgmozyL/v/hdMXTqNd1NBiGgElgN/pR1RFek/3cuXsFQyzwac//Wnu/8z9fOpTnyok/3Y17OKp80/x7EfPEpfj7K7dzQ/u/gEOswNRFEmlUoyPjxceZEuFJz/7JPVl9fzby//G//OL/4ea0hr++5/9d5oqm5bkex5++GFuueUWDhw4wPvvv89LL71EJJLvbDSbzQiCwHe+8x2+/OUvF4g/08NrTtfBWMSKJxXwmpubC8zUdR3DMMhkMhw5coRPf/rTU7ZwHZ0xxpCQsOt2IrkIZsGMz+SbdfDmXKNYV7jCOtZxMXWRJlsTDsmxJBc8Q4YwYQzdIJfKoagKlc5K3Bb3nELQiqZwOXSZdSXr5tVVaBgG47FxZEXGpJlIpVMMh4epLc2L8tnsNhRVwRAMfG7fjEEA3dBJyAmichSX2TUlwx+NRhkeHmb9+qXVtir8blUhHA9jGAZl/rJFi3fPZibKskwymSzo+QqCQGlpaWE3mcSFCxdQVZXNmzffWIIMDg5y6tQpZFmmtraW226brriezWb54IMPuOOOO5bMxi2iiMVgIQRZcJjXYrFQUVFBZ2fnDROOm9fTCoU++tDQ6Mv2IeurZyC9qqv0RHsWLT2qqAq9o71Ldr5X49jl1YYFEeT2229HFEXi8Th79+69YcJx80GIEPvZT8bI8KvxX92wqbULQVJJsv/C/iWZcvuLg79YsqLA3t5eXnjhhSILltpJLy0t5Z577rluxCEajXLixIl5TyESBIFcLkc8Hp/bsQaEbWF6K3p5t/9d+oQ+DncepsQoWZCTPidHXtPQNG1O5mNKTdE/0c97yfewSQv3s6KpKP19/bz99tvTChZnss11XZ91fZMzyXt6elak3yKXy+FyubBarctigYiiyODgIM3NzcvnpF/PwQyFQgsSRxZFkeHhYbq7u+eW6TXAMBngAiEuYDgMyICgCXADNjdBEBgZGWFkZITt27dfPzoigGExEOTFLcbAAOl3v+s66+vr6yMSibB169ZZb8DJ15fbAhBFkY8++gifz0dDQ8OShJjnet0CgcC8+vBNN3IxJSUliyJYJpOZ1xRWAPzLc5HNZjOiKFJXV7cqTQNd17Hb7dTX16/K9UWjUVwu14xJ5pveB1muG9Dtdq/aE2exWHC5XKt2fTabbVr/x2qCw+G4obrOS/agN1ZDCGqWHUTX9SXpVyiub3XucJPmVpEgRRRxk0IsnoIiilgBJ30xyGQyJBIJ/H4/ly5dorq6mmw2y8TEBK2trSuamVcUhYsXL+JyufB6vXR0dFBdXY0oiiSTSdauXbuiZkM6nebSpUtUVlbidDrp7u6mpaWFWCxGKBSitbV1Rc2uRCLBpUuXqKmpIZfLMTQ0xJo1a0gkEmQyGVpaWlaVWbgqCXLixAn6+vrYsmULZ8+e5ezZswiCgMPhIJFIsHv37hVb28TEBBcvXmRsbAyfz8epU6e45557iMfj5HI5HA4HtbW1K7a+sbEx2tvbOXXqFLW1tYyNjRGNRgmFQiSTSSwWC2vWrFmx9XV1dTEwMMC5c+eIx+OEQiHuuusuxsfHEUURXdfZuHFjkSC/77B1d3eTzWYLNVySJOFyuWhtbeWDDz6gsrKSbdu2cfr06RVxeHt7e0kmk9hsNm655RZefvllGhsb2bRpE4cOHaKkpISqqiqi0eiyEySbzdLT04Ou6/h8Pnbs2MGJEyfo7e1lx44ddHR0IIoiDQ0NhMPhZT9/iqLQ3d2Nqqq43W78fj/l5eXYbDZkWeadd95h586dBIPBVTMffdX5IBaLBYvFQklJCbt378bv99PQ0MDp06cL2c+33npr/nmRJYLZbMZmsxGJRDhy5Ah+vx/DMPjoo4+oq6vDbDbT19dHZWXl8kdaBAGLxYLNZmNoaIjjx48jiiKVlZWcPHmSlpYWHA4Hly9fXrQO1mLXd/r0aU6ePIlhGMRiMTo7O9m+fTvDw8OcOnVq1eWVVmUUS9d1crkcFouFSCSCy+VCVVVSqRTBYHBFbXxd1wmHw1itVqxWK5FIBL/fj6qqKIqCz+db0XOnaVphfQ6Hg1gsht/vR1EUMpkMPp9vRWvnkskk8Xgcm82G1WotXNNUKoWqqvPqEPzEEqSIIoomVhFFFAlSRBFFghRRRJEgRRRRJEgRRRRRJMhCkUqlCIVC6LpONBqd9X2T3YaGYRQk+3Vdn1G+P51O097ezpUrV64p759KpchkrrbsqqpKLJYfnpnNZkkmkxiGQTQavW6HXjabLbxH1/WCLJOqqoV153K5FRk3sNpgKt72c8fp06d5+eWX+bM/+zOOHDnCI488Mu090WiUV155BYfDQWlpKb29vXzmM5/h3LlzpFIpPve5z02Ro7l48SJtbW1YLBZkWaa6uhqrNT+lN5VK4Xa7kWWZw4cPEwgE2L59eyEnNDQ0hMVi4fTp04yMjODxeBgdHeXuu+8mGAzOWNPU2dnJG2+8wbe+9S1MJhOvv/46kUiEbdu2cfbsWTweDz6fj8OHD3P33XdPG7pTJEgRs2Kyievtt9/GZMqfung8TjgcxmazUVFRwcjICB0dHfh8PiKRCC0tLYU5gBaLhaGhoSl90ZqmEY1GsdvtRKNRjh49it1uR5IkwuFwoSnrypUr+Hw+enp6iMViWK1WNE3jzJkzDAwM4HA40DSNZDLJ008/zV133cXWrVsZHR0tJAh9Ph9erxdRFNE0DVEU6enpIRwOU19fz9q1a3nnnXeor6/H5XIxMjKSV8RcRYm7oom1ynHHHXcwMTFBb28vAP39/Rw8eJC2tjY0TaOvr49bbrkFl8uFYRhEIhFsNhuKopBOp6eJUAiCQE1NDcFgkAsXLiCKIkNDQ8iyzO7du+np6SEQCNDU1ITX66WtrY3+/n5kWWZsbAyLxcK6devw+/2UlpayZs0adu/eTSKRAPIysQcPHqS7Oz8FNxgMFjLr4XAYp9PJjh07OHfuHLqu43a7aWhoYM+ePUQikU+8mVXMpM8DQ0NDSJKELMv09/ezZ8+eQunEZB3ZyMgIx48fp6qqCrfbTU9PD7fffjuXL18mnU5z++23F3afyc98//338fl8VFZW0tHRgdPppKSkhPr6ekZHRxkdHSUej7Np0yYmJiYKZSSTZSXj4+O0trYSiUTweDyUlpaiqio1NTWEQiFkWcbtduN2uzEMg0uXLlFeXk44HCaZTNLX10d9fT0DAwP4/X5KSkpob29n8+bN81YBKRKkiCKKJlYRRRRRJEgRRRQJUkQRRYIUUUSRIEUUUSRIEUWsIvz/Y/nyYsU947wAAAAuelRYdGNyZWF0ZS1kYXRlAAB42jMyMDTQNTDRNbAMMTCzMjCzMrTQNjCwMjAAAEFxBQ2p1QpNAAAALnpUWHRtb2RpZnktZGF0ZQAAeNozMjA00DUw0TWwDDEwszIwszI00TYwsDIwAABBVQUJyAu+7wAAACl6VFh0cGRmOkhpUmVzQm91bmRpbmdCb3gAAHjaMzUwqTA1MNE20DYAAA8fAmFqyfi2AAAAHXpUWHRwZGY6VmVyc2lvbgAAeNoLcHHTNdQzUQAACL8Bu3R9uVkAAAAASUVORK5CYII=&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;200 reps, bootstraps that refit painting&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;observed likelihoods of BM &amp;amp; OU1 are indistinguishable from one another but outside the 95% confidence interval of the other distributions. The observed likelihoods lie easily within the distribution produced by those models for both BM &amp;amp; OU1.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Observed likelihood for OU2 falls within the bootstrap likelihoods produced under OU2.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Observed likelihood for OU3 and OU4 fall significantly below the likelihoods expected by data simulated under these models, suggesting that OU2 is indeed the best fit.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;anoles&quot;&gt;Anoles&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;data:image/png;base64,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&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;2000 reps, painting fixed, refit hansen pars&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The observed likelihood scores of the first three models (BM, OU1, OU3) lie within the 95% confidence intervals for those models.&lt;/li&gt;
&lt;li&gt;The observed likelihood scores of OU4 and OU(LP) lie within the 95% confidence intervals of all models.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; NESCent ——-&lt;/p&gt;
&lt;h3 id=&quot;possible-topics&quot;&gt;Possible topics&lt;/h3&gt;
&lt;p&gt;. Comparative Methods Workflow in R – hackathon&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Interfaces between programs&lt;/li&gt;
&lt;li&gt;Extensibility of existing software&lt;/li&gt;
&lt;li&gt;Redundancy of approaches&lt;/li&gt;
&lt;li&gt;User / developer dialog and interface&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;. Reliability: evaluating the robustness of current methods&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Model choice criteria&lt;/li&gt;
&lt;li&gt;Robustness to assumptions in tree, etc&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;. Future of methods&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bayesian implementations&lt;/li&gt;
&lt;li&gt;High-dimensional data&lt;/li&gt;
&lt;li&gt;databases, standards&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### People&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nescent.org/science/awards_summary.php?id=66&quot; title=&quot;http://www.nescent.org/science/awards_summary.php?id=66&quot;&gt;Marc Lajeunesse&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nescent.org/science/awards_summary.php?id=184&quot; title=&quot;http://www.nescent.org/science/awards_summary.php?id=184&quot;&gt;Liam Revell&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.linkedin.com/in/hlapp&quot; title=&quot;http://www.linkedin.com/in/hlapp&quot;&gt;Hilmar Lapp&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://visionlab.bio.unc.edu/&quot; title=&quot;http://visionlab.bio.unc.edu/&quot;&gt;Todd Vision&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Sam Price&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.brianomeara.info/&quot; title=&quot;http://www.brianomeara.info/&quot;&gt;Brian O’Meara&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes-and-reading&quot;&gt;Notes and Reading&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.arl.org/sparc/advocacy/frpaa/index.shtml&quot; title=&quot;http://www.arl.org/sparc/advocacy/frpaa/index.shtml&quot;&gt;Federal Research Public Access Act&lt;/a&gt;, mentioned in &lt;a href=&quot;http://www.nature.com/news/2010/100407/full/464822a.html&quot; title=&quot;http://www.nature.com/news/2010/100407/full/464822a.html&quot;&gt;Nature&lt;/a&gt; article on rise of open access.&lt;/li&gt;
&lt;li&gt;another &lt;a href=&quot;http://www.nature.com/nature/journal/v464/n7290/full/464813a.html&quot; title=&quot;http://www.nature.com/nature/journal/v464/n7290/full/464813a.html&quot;&gt;Nature article&lt;/a&gt;. on open access.&lt;/li&gt;
&lt;li&gt;I’m mentioned in &lt;a href=&quot;http://sciencecareers.sciencemag.org/career_magazine/previous_issues/articles/2010_04_09/caredit.a1000036&quot; title=&quot;http://sciencecareers.sciencemag.org/career_magazine/previous_issues/articles/2010_04_09/caredit.a1000036&quot;&gt;&lt;em&gt;Science Careers&lt;/em&gt;&lt;/a&gt; on Open Notebook Science.
&lt;ul&gt;
&lt;li&gt;Article discussed by &lt;a href=&quot;http://usefulchem.blogspot.com/2010/04/scientists-embrace-openness-article-in.html&quot; title=&quot;http://usefulchem.blogspot.com/2010/04/scientists-embrace-openness-article-in.html&quot;&gt;Jean-Claude Bradley&lt;/a&gt;, &lt;a href=&quot;http://bit.ly/aV94bp&quot; title=&quot;http://bit.ly/aV94bp&quot;&gt;friendfeed&lt;/a&gt;, &lt;a href=&quot;http://blogs.nature.com/stories/2590&quot; title=&quot;http://blogs.nature.com/stories/2590&quot;&gt;Nature blogs&lt;/a&gt;, &lt;a href=&quot;http://timestopsnow.blogspot.com/2010/04/science-moves-toward-becoming-more-open.html&quot; title=&quot;http://timestopsnow.blogspot.com/2010/04/science-moves-toward-becoming-more-open.html&quot;&gt;qbit&lt;/a&gt;, &lt;a href=&quot;http://duncan.hull.name/2010/04/08/ons/&quot; title=&quot;http://duncan.hull.name/2010/04/08/ons/&quot;&gt;Duncan Hull&lt;/a&gt;, &lt;a href=&quot;http://gradness.blogspot.com/2010/04/kochlab-and-other-labs-in-news.html&quot; title=&quot;http://gradness.blogspot.com/2010/04/kochlab-and-other-labs-in-news.html&quot;&gt;Anthony&lt;/a&gt;, &lt;a href=&quot;https://www.lib.uwo.ca/blogs/digitalscholarly/2010/04/openness-in-sci.html&quot; title=&quot;https://www.lib.uwo.ca/blogs/digitalscholarly/2010/04/openness-in-sci.html&quot;&gt;library&lt;/a&gt;, &lt;a href=&quot;http://mndoci.com/2010/04/09/the-open-guys-hit-the-big-time/&quot; title=&quot;http://mndoci.com/2010/04/09/the-open-guys-hit-the-big-time/&quot;&gt;Deepak&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/07/Research.html"/>
   <updated>2010-04-07T00:00:00+00:00</updated>
   <id>/04/07/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Goal: complete outline for tomorrow’s meeting.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes&quot;&gt;Notes&lt;/h2&gt;
&lt;h3 id=&quot;theory-coffee&quot;&gt;Theory Coffee&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Two more days before eve speaker nominations are due. Potentially nominating:
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.fish.washington.edu/people/rayh/&quot; title=&quot;http://www.fish.washington.edu/people/rayh/&quot;&gt;Brice Kendall&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.fish.washington.edu/people/rayh/&quot; title=&quot;http://www.fish.washington.edu/people/rayh/&quot;&gt;Ray Hillborn&lt;/a&gt; Model choice (Ecological Detective).&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Discussion of post-doc / job application process.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;education&quot;&gt;Education&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;NIMBioS Computational Biology &lt;a href=&quot;http://www.nimbios.org/tutorials/TT_curriculum&quot; title=&quot;http://www.nimbios.org/tutorials/TT_curriculum&quot;&gt;Curriculum Development&lt;/a&gt; July 6-9&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Towards a meaningful warning signal metric</title>
	 <link href="/2010/04/06/Towards-a-meaningful-warning-signal-metric.html"/>
   <updated>2010-04-06T00:00:00+00:00</updated>
   <id>/04/06/Towards-a-meaningful-warning-signal-metric</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Most papers do not give a statistical approach, but merely argue for the existence of a trend.&lt;/li&gt;
&lt;li&gt;Kendall’s tau approach proved very unreliable. While the preliminary de-trending approach is unjustified in that the simulated data is known to be absent from trends, as a kind of windowed averaging it may sense as a way to detect changes.&lt;/li&gt;
&lt;li&gt;Should distinguish between the gradual slow changes and change-point estimation. Perhaps change-point provides a more rigorous starting point.&lt;/li&gt;
&lt;li&gt;need to predict the expected variance in the various warning signals, this entry&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/06/Research.html"/>
   <updated>2010-04-06T00:00:00+00:00</updated>
   <id>/04/06/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Seem to have successfully fixed the behavior when getting over parameterized models. See diffs against the git log for details.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Will work on acceleration of code (avoiding refitting), meanwhile a little more trouble shooting and queuing some long runs.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ace function fails on certain data sets for unknown reasons. Think rewriting this from scratch will be an important step.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;mixture-models-in-bayesian-context&quot;&gt;Mixture Models in Bayesian context&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Josh sent me this &lt;a href=&quot;http://www.jstor.org/stable/3085902&quot; title=&quot;http://www.jstor.org/stable/3085902&quot;&gt;paper&lt;/a&gt; regarding our discussion on model choice in Bayesian context last Friday.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;workstation&quot;&gt;Workstation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Settled on workstation, completed final pricing adjustments. Now seeking &lt;a href=&quot;/images/e/e7/Myworkstation.pdf&quot; title=&quot;Myworkstation.pdf&quot;&gt;approval&lt;/a&gt; from Krell / CSGF.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;misc-reading&quot;&gt;Misc / Reading&lt;/h2&gt;
&lt;h4 id=&quot;mcelreaths-class&quot;&gt;&lt;a href=&quot;http://xcelab.net/rm/?p=432&quot; title=&quot;http://xcelab.net/rm/?p=432&quot;&gt;McElreath’s Class&lt;/a&gt;&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Looks like a fantastic class on model choice, should sit in. Read through the slides for weeks 1 &amp;amp; 2 so far. Every practicing ecologist should read the &lt;a href=&quot;http://xcelab.net/rm/wp-content/uploads/2010/03/week2.pdf&quot; title=&quot;http://xcelab.net/rm/wp-content/uploads/2010/03/week2.pdf&quot;&gt;week 2 presentation&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;in-science-today&quot;&gt;In &lt;em&gt;Science&lt;/em&gt; today&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://hdl.handle.net/10.1126/science.1167742&quot; title=&quot;doi:10.1126/science.1167742&quot;&gt;Computational Social Science&lt;/a&gt; Exciting stuff, interesting what these approaches can tell us about the way we do science.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://hdl.handle.net/10.1126/science.1185745&quot; title=&quot;doi:10.1126/science.1185745&quot;&gt;Empowering Young Scientists&lt;/a&gt; an international NAS for young scientists. Interesting motivation but why exclusive membership? How about &lt;a href=&quot;http://ways.org/&quot; title=&quot;http://ways.org/&quot;&gt;ways&lt;/a&gt; as a better model.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;web&quot;&gt;Web&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Excellent &lt;a href=&quot;http://michaelnielsen.org/blog/the-future-of-science-2/&quot; title=&quot;http://michaelnielsen.org/blog/the-future-of-science-2/&quot;&gt;science-2.0&lt;/a&gt; / future of science post. Forwarded to openscience discussion group. favorite quote:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;“If shoestores operated like scientists trading ideas, first Alice and Bob would need to get to know one another, maybe go for a few beers in a nearby bar. Only then would Alice finally say “you know, I’m looking for some shoes”. After a pause, and a few more beers, Bob would say “You know what, I just happen to have some shoes I’m looking to sell”. Every working scientist recognizes this dance; I know scientists who worry less about selling their house than they do about exchanging scientific information.”&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/05/Research.html"/>
   <updated>2010-04-05T00:00:00+00:00</updated>
   <id>/04/05/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Bootstrapping procedures should have the option to refit the painting. Currently use the fixed painting but refit parameters.&lt;/li&gt;
&lt;li&gt;wrote the function peaks_update() which update the painting as well as the OU peak parameters.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/e1/Bootstrap_painting.png/600px-Bootstrap_painting.png&quot; alt=&quot;20 replicates, bootstraps the painting step as well&quot; /&gt;&lt;figcaption&gt;20 replicates, bootstraps the painting step as well&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;20 replicates, bootstraps the painting step as well&lt;/p&gt;
&lt;h2 id=&quot;computing-package&quot;&gt;Computing / Package&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;LR_bootstrap and model_bootstrap should be the same function call with an optional second model for the LR bootstrapping. Similarly the LR_bootstrap_all and model_bootstrap_all() should be the same function call. Will simplify documentation, error handling, redundancy etc.
&lt;ul&gt;
&lt;li&gt;Will need to combine the return object types: model_boots object or an LR_boots object though. Will need an indicator for their type, and combine a plot function that can handle both.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The fit_k_peaks can’t actually take an ouchtree, though it will try, due to the strange behavior of the ape package in tree pruning discussed earlier. Will eventually need a better work around than writing out and reading back in the nexus file. Should post this issue to r-sig-phylo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The refit painting bootstrap needs the original ape-format (phylo class) tree, due to the above problem. It’s been added as an argument to the bootstrapping calls.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;troubleshooting&quot;&gt;Troubleshooting&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The partitions function may assign all points to only three regimes even though it is given four regimes to fit to. This has been causing a rather subtle bug in bootstrapping the ou4 model in the labrid dataset. Trying to address by modifying the function infer_painting(), a function child of fit_k_peaks() function, to calculate k as the maximum value in the factor list, rather than the length of the factor list. Still leads to other errors…&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;also tried modifying so that factor matching is explicit, lines 54, 55 of infer_niches.R Still get NAs in regime inference when its failed to use all the peaks.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ways to force utilizing all peaks??&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;speed-concerns&quot;&gt;Speed concerns&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Refitting is much slower. Will need to explore parallelizing each of the bootstrapping fits. Should also perform profiling and start moving slowest parts into C code. Will also need to avoid any redundant bootstrapping.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;Shouldn’t refit the true model in each row.&lt;/em&gt; Should be able to reuse the simulated data and the fit of the true model, and just refit each comparison model to that simulated dataset. Doesn’t seem fit naturally in the framework of the bootstrap package, however.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Profiling Results&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Profiling with Rprof(), summaryRprof()&lt;/li&gt;
&lt;li&gt;fit_k_peaks() is 90% of computational time
&lt;ul&gt;
&lt;li&gt;it’s member function, fit_k_partitions() is 65% total time&lt;/li&gt;
&lt;li&gt;it’s member function, infer_painting() is 10% of total time&lt;/li&gt;
&lt;li&gt;optim function, called by fit_k_partitions() (also called by hansen) is 71% of total time&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;misc-notes&quot;&gt;Misc / Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Following phylogenetics discussion group Friday, Samantha passed on new suggestions to Brian, now on the &lt;a href=&quot;http://code.google.com/p/brownie/issues/list&quot; title=&quot;http://code.google.com/p/brownie/issues/list&quot;&gt;planned updates&lt;/a&gt; for Brownie.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;talks&quot;&gt;Talks&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Need to prepare Evolution Discussion Group talk for next week.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Survey for CSGF&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Computing tool&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Teaching with technology – GTC&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Effective Assessment – GTC&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ievobio?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;meetings-etc&quot;&gt;Meetings, etc&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Grad Teaching Community – tonight&lt;/li&gt;
&lt;li&gt;Open Science Meeting – Weds&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/04/Research.html"/>
   <updated>2010-04-04T00:00:00+00:00</updated>
   <id>/04/04/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Trouble-shooting on parameter refitting version of LR bootstraps.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;a href=&quot;http://www.nescent.org/index.php&quot; title=&quot;http://www.nescent.org/index.php&quot;&gt;NESCent&lt;/a&gt; ——————————————————————————&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Considering a visit to NESCent, meet researchers and learn about programs, post-docs, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;people&quot;&gt;People&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://visionlab.bio.unc.edu/index.ptml&quot; title=&quot;http://visionlab.bio.unc.edu/index.ptml&quot;&gt;Todd Vision&lt;/a&gt;, UNC – Ass. Director &lt;a href=&quot;http://www.nescent.org/informatics/&quot; title=&quot;http://www.nescent.org/informatics/&quot;&gt;Informatics&lt;/a&gt;. Contact Re: Dryad project. Consider a &lt;a href=&quot;http://www.nescent.org/informatics/whitepapers.php&quot; title=&quot;http://www.nescent.org/informatics/whitepapers.php&quot;&gt;white paper&lt;/a&gt; on interdisciplinary evolutionary synthesis.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www4.ncsu.edu/unity/users/b/bwiegman/public_html/labweb/index.html&quot; title=&quot;http://www4.ncsu.edu/unity/users/b/bwiegman/public_html/labweb/index.html&quot;&gt;Brian Weigmann&lt;/a&gt; NCSU Diptera Systematics. Ass. Director Outreach NESCent&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://fds.duke.edu/db/aas/Biology/faculty/rodrigo&quot; title=&quot;http://fds.duke.edu/db/aas/Biology/faculty/rodrigo&quot;&gt;Allen Rodrigo&lt;/a&gt; Director NESCent. (Computational evolutionary biology). Discuss possible catalysis meeting, working group, visiting scholar.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://fds.duke.edu/db/aas/Biology/alberts&quot; title=&quot;http://fds.duke.edu/db/aas/Biology/alberts&quot;&gt;Susan Alberts&lt;/a&gt; Director of Science and Synthesis. (Marcrofauna behavior). Discuss possible catalysis meeting, working group, visiting scholar.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://anolis.oeb.harvard.edu/~liam/&quot; title=&quot;http://anolis.oeb.harvard.edu/~liam/&quot;&gt;Liam Revell&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://hdl.handle.net/10.1111/j.1558-5646.2009.00892.x&quot; title=&quot;doi:10.1111/j.1558-5646.2009.00892.x&quot;&gt;Linking Big&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;activities&quot;&gt;Activities&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Would be fantastic to explore the potential for a &lt;a href=&quot;http://www.nescent.org/science/meetings.php&quot; title=&quot;http://www.nescent.org/science/meetings.php&quot;&gt;Catalysis Meeting&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;“Typically, proposals that have been selected for support by NESCent are those that explicitly capitalize on NESCent’s in-house community, its linkages locally, nationally, and internationally, and the IT and logistic resources that are available”&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“We greatly encourage synergy between sabbatical scholars, short-term visitors, working groups, catalysis groups, and postdoctoral fellows.”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.nescent.org/science/sos.php&quot; title=&quot;http://www.nescent.org/science/sos.php&quot;&gt;Science of Science&lt;/a&gt;&lt;/strong&gt; Project, Professor Cummings on Science Collaboration. Fascinating set of &lt;a href=&quot;http://netvis.fuqua.duke.edu/papers/&quot; title=&quot;http://netvis.fuqua.duke.edu/papers/&quot;&gt;papers&lt;/a&gt;. Also contact &lt;a href=&quot;http://www.nescent.org/science/chris_shields.php&quot; title=&quot;http://www.nescent.org/science/chris_shields.php&quot;&gt;Chris Shields&lt;/a&gt;. These ideas are also attracting strong &lt;a href=&quot;http://www.nsf.gov/funding/pgm_summ.jsp?pims_id=501084&quot; title=&quot;http://www.nsf.gov/funding/pgm_summ.jsp?pims_id=501084&quot;&gt;NSF support&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.nescent.org/science/workinggroup.php&quot; title=&quot;http://www.nescent.org/science/workinggroup.php&quot;&gt;Working Group&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fantastic Open Science &lt;a href=&quot;http://www.nescent.org/informatics/data_software_policy.php&quot; title=&quot;http://www.nescent.org/informatics/data_software_policy.php&quot;&gt;Policy&lt;/a&gt; on data and code.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Misc —-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.hackademe.com/2010/03/turn-an-old-laptop-into-a-multi-purpose-office-door-sign/&quot; title=&quot;http://www.hackademe.com/2010/03/turn-an-old-laptop-into-a-multi-purpose-office-door-sign/&quot;&gt;Laptop into a door sign?&lt;/a&gt; The things you find on the &lt;a href=&quot;http://kaboodle.nescent.org/?q=taxonomy/term/4&amp;amp;page=1&quot; title=&quot;http://kaboodle.nescent.org/?q=taxonomy/term/4&amp;amp;page=1&quot;&gt;NESCent website blogs&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals Research</title>
	 <link href="/2010/04/03/Warning-Signals-Research.html"/>
   <updated>2010-04-03T00:00:00+00:00</updated>
   <id>/04/03/Warning-Signals-Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Deuterium early warning signal used for Glaciation I-IV presented in &lt;a href=&quot;http://hdl.handle.net/10.1073/pnas.0802430105&quot; title=&quot;doi:10.1073/pnas.0802430105&quot;&gt;Dakos 2008&lt;/a&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/ec/DeuteriumCore.png/600px-DeuteriumCore.png&quot; alt=&quot;Deuterium signal over past 4 glaciations&quot; /&gt;&lt;figcaption&gt;Deuterium signal over past 4 glaciations&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Deuterium signal over past 4 glaciations&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Does smoothing to remove trends – longer-scale fluctuations? Seems unnatural, many of those are part of the signal. Also applied to simulated time series – even those these are at stationarity! Bandwidth chosen by visual inspection.&lt;/li&gt;
&lt;li&gt;Get the CaCO3 presented in &lt;a href=&quot;http://hdl.handle.net/10.1038/nature08227&quot; title=&quot;doi:10.1038/nature08227&quot;&gt;Scheffer 2010&lt;/a&gt; and &lt;a href=&quot;http://hdl.handle.net/10.1073/pnas.0802430105&quot; title=&quot;doi:10.1073/pnas.0802430105&quot;&gt;Dakos 2008&lt;/a&gt;. – Done: &lt;a href=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/contributions_by_author/tripati2005/tripati2005.txt&quot; title=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/contributions_by_author/tripati2005/tripati2005.txt&quot;&gt;CaCO3&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Warning Signals</title>
	 <link href="/2010/04/02/Warning-Signals.html"/>
   <updated>2010-04-02T00:00:00+00:00</updated>
   <id>/04/02/Warning-Signals</id>
   <content type="html">&lt;h3 id=&quot;current-puzzles-goals&quot;&gt;Current Puzzles &amp;amp; Goals&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/c/cb/Warning.png/150px-Warning.png&quot; alt=&quot;1 rep&quot; /&gt;&lt;figcaption&gt;1 rep&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;1 rep&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/d/df/Warning100.png/150px-Warning100.png&quot; alt=&quot;100 reps&quot; /&gt;&lt;figcaption&gt;100 reps&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;100 reps&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kendall’s tau unreliable, exploring alternatives. Sliding window for identifying when warning is first detected? Goal is to detect any decrease in stability or distance from critical point?&lt;/li&gt;
&lt;li&gt;Chasing down data from &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/19727193&quot; title=&quot;pmid:19727193&quot;&gt;Scheffer&lt;/a&gt;. Climate data reuses the CaCO3 from Dakos.&lt;/li&gt;
&lt;li&gt;Chasing down data from &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/18787119&quot; title=&quot;pmid:18787119&quot;&gt;Dakos&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://www.ncdc.noaa.gov/paleo/pubs/hughen2000/hughen2000.html&quot; title=&quot;http://www.ncdc.noaa.gov/paleo/pubs/hughen2000/hughen2000.html&quot;&gt;Fig. 1 M&lt;/a&gt; Cariaco Basin, &lt;a href=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/contributions_by_author/hughen2000/cariaco2000_pc56_greyscale.txt&quot; title=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/contributions_by_author/hughen2000/cariaco2000_pc56_greyscale.txt&quot;&gt;data file&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.ncdc.noaa.gov/paleo/metadata/noaa-icecore-2453.html&quot; title=&quot;http://www.ncdc.noaa.gov/paleo/metadata/noaa-icecore-2453.html&quot;&gt;Vostok&lt;/a&gt; &lt;a href=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/icecore/antarctica/vostok/deutnat.txt&quot; title=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/icecore/antarctica/vostok/deutnat.txt&quot;&gt;deuterium&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/contributions_by_author/tripati2005/tripati2005.txt&quot; title=&quot;ftp://ftp.ncdc.noaa.gov/pub/data/paleo/contributions_by_author/tripati2005/tripati2005.txt&quot;&gt;CaCO3 data&lt;/a&gt; Tropical Pacific core 1218&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Warning signals examples with actual tipping points (Figures left).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;more-reviews&quot;&gt;More reviews&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;JTB, but can’t comment in an open notebook.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Misc Notes ———-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog-di-j.blogspot.com/2007/12/role-of-bioinformatics-in-open-notebook.html&quot; title=&quot;http://blog-di-j.blogspot.com/2007/12/role-of-bioinformatics-in-open-notebook.html&quot;&gt;open source / open notebook?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.scientificamerican.com/article.cfm?id=science-2-point-0-great-new-tool-or-great-risk&amp;amp;page=1&quot; title=&quot;http://www.scientificamerican.com/article.cfm?id=science-2-point-0-great-new-tool-or-great-risk&amp;amp;page=1&quot;&gt;Science 2.0&lt;/a&gt; in Scientific American&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/02/Research.html"/>
   <updated>2010-04-02T00:00:00+00:00</updated>
   <id>/04/02/Research</id>
   <content type="html">&lt;h3 id=&quot;graham-peter-meeting&quot;&gt;Graham &amp;amp; Peter Meeting&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/22/Simulated_LR.png/100px-Simulated_LR.png&quot; alt=&quot;Fig 1&quot; /&gt;&lt;figcaption&gt;Fig 1&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Fig 1&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/12/Simulated_2_LR_fitpar.png/100px-Simulated_2_LR_fitpar.png&quot; alt=&quot;Fig 2&quot; /&gt;&lt;figcaption&gt;Fig 2&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Fig 2&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Decided that bootstrapping against fixed model parameters would be more difficult to interpret, Fig 1.&lt;/li&gt;
&lt;li&gt;Simulated data results with refitting seem strange (Fig. 2), perhaps related to fitting of the tree. Observed LR for data should at least remain symmetric, so something has gone wrong.&lt;/li&gt;
&lt;li&gt;Expected pattern should be deducible simply by upper left triangle of graphs, should accept the first model where the data becomes typical.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/04/01/Research.html"/>
   <updated>2010-04-01T00:00:00+00:00</updated>
   <id>/04/01/Research</id>
   <content type="html">&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/7/7a/False_warning.png/200px-False_warning.png&quot; alt=&quot;Single replicate. Almost all warning signals have significant correlation despite the constant environment.&quot; /&gt;&lt;figcaption&gt;Single replicate. Almost all warning signals have significant correlation despite the constant environment.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Single replicate. Almost all warning signals have significant correlation despite the constant environment.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/a/a8/False_warning_with_replicates.png/200px-False_warning_with_replicates.png&quot; alt=&quot;False warning signals remain just as common when signals are averaged across 100 replicates?&quot; /&gt;&lt;figcaption&gt;False warning signals remain just as common when signals are averaged across 100 replicates?&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;False warning signals remain just as common when signals are averaged across 100 replicates?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Exploring statistical qualification of early warning signals. &lt;a href=&quot;http://hdl.handle.net/10.1073/pnas.0802430105&quot; title=&quot;doi:10.1073/pnas.0802430105&quot;&gt;Dakos et. al. (2008)&lt;/a&gt; use a correlation significance test (based on Kendall’s tau) on the autocorrelation to detect the warning signals.&lt;/li&gt;
&lt;li&gt;Correlation significance test seems a very poor estimate of signal, high false positive rate at any threshold p-value for sufficiently frequent sampling. Carpenter [&lt;a href=&quot;#bibkey_Carpenter&quot;&gt;1&lt;/a&gt;] Fits a dynamic linear model of the SD and argues it appears to trend up visually.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=16958897&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Carpenter SR and Brock WA. .&lt;/a&gt; pmid:16958897. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=16958897&quot; title=&quot;PMID 16958897&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=16958897&quot; title=&quot;PMID 16958897&quot;&gt;HubMed&lt;/a&gt; [Carpenter]&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Detecting switch points vs gradual change? See change point estimation?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Data from Dakos et. al. study available from &lt;a href=&quot;http://www.ncdc.noaa.gov/paleo/data.html&quot; title=&quot;http://www.ncdc.noaa.gov/paleo/data.html&quot;&gt;NOAA&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;computing&quot;&gt;Computing&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Just wrote the R interface. Faster than running the C code, generating a text file and reading it into Python (though could spend time with swig at some point).&lt;/li&gt;
&lt;li&gt;added a minimal version, popdyn.c, that just reads out raw data without all the on-the-fly statistics the full function does.&lt;/li&gt;
&lt;li&gt;Kendall statistics on metrics to determine warning signals. R function.&lt;/li&gt;
&lt;li&gt;Fixed the gillespie interface. Gillespie function does get passed the parameter structure, just makes an actual copy, allocating new memory, in the gillespie function rather than calling alloc for the first time.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;next-steps&quot;&gt;Next Steps&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Will want to be able to adjust the rate of change in the environment from the R commandline.&lt;/li&gt;
&lt;li&gt;The parallelization compiler flags are included in makevars and called by R CMD SHLIB, but the .C call doesn’t seem to engage all processors. Exploring this with the r-sig-hpc list.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;alan-meeting&quot;&gt;Alan Meeting&lt;/h2&gt;
&lt;p&gt;Goals:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Purchase workstation by/before Sept 1st&lt;/li&gt;
&lt;li&gt;demonstrate simulations: Arbitrarily sensitive false alarms to oversampling&lt;/li&gt;
&lt;li&gt;review manuscript outline&lt;/li&gt;
&lt;li&gt;Discuss the bootstrapping model comparisons example from the Labrid dataset.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;further-reading&quot;&gt;Further Reading&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Regarding the references, the statement about the “genericity” of the saddle-node bifurcation can be found in section 4.2 of Perko’s “Differential equations and dynamical systems” book. The CLT for stationary, ergodic sequences can be found in Durrett’s book “Probability: Theory and Examples”. (from Sebastian)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;workstation-choices&quot;&gt;Workstation choices&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Sizing up options for our new computer server. Would be nice to be able to explore &lt;a href=&quot;http://en.wikipedia.org/wiki/CUDA#Supported_GPUs&quot; title=&quot;http://en.wikipedia.org/wiki/CUDA#Supported_GPUs&quot;&gt;CUDA GPU&lt;/a&gt; computing, considering &lt;a href=&quot;http://www.nvidia.com/object/product_tesla_c1060_us.html&quot; title=&quot;http://www.nvidia.com/object/product_tesla_c1060_us.html&quot;&gt;tesla&lt;/a&gt; and fermi (better double-precision performance) options. Other option, AMD released a 12 core chip, could possibly setup a 24 processor machine on two sockets. Getting comparisons from &lt;a href=&quot;http://www.siliconmechanics.com/&quot; title=&quot;http://www.siliconmechanics.com/&quot;&gt;silicon mechanics&lt;/a&gt;. Ok, options under $5000 (after educational discount) are in:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;2x Xeon Quad 2.4GHz, 12Mb Cache, 24GB RAM + Tesla C1060 active cooled&lt;/li&gt;
&lt;li&gt;2x Opteron 6128 8-core, 2 GHz, 32GB RAM + Tesla C1060 active cooled&lt;/li&gt;
&lt;li&gt;2x Opteron 12-core, 1.9 GHz, 32 GB RAM&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Available on 4U and 1U forms. the 24 core machine could add 1-2 GPUs later. The Tesla C2050 GPU is $1888 and is much better at double precision, while the Tesla C1060 is $950.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Double precision vs single precision&lt;/strong&gt; &lt;a href=&quot;http://en.wikipedia.org/wiki/Nvidia_Tesla&quot; title=&quot;http://en.wikipedia.org/wiki/Nvidia_Tesla&quot;&gt;comparisons&lt;/a&gt;. C1060 does order of magnitude worse (933 vs 78 gigaflops) on single vs double precision. The C2050 gets (1040 GFLOPS single, 520 GFLOPS double). Looking into C2050 options…&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nvidia.com/object/product_tesla_C2050_C2070_us.html&quot; title=&quot;http://www.nvidia.com/object/product_tesla_C2050_C2070_us.html&quot;&gt;C2050, next gen/Fermi&lt;/a&gt; Release April 20th, we’ll see.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/03/31/Research.html"/>
   <updated>2010-03-31T00:00:00+00:00</updated>
   <id>/03/31/Research</id>
   <content type="html">&lt;p&gt;Writing up work just on ensemble vs single instance detection of regime shifts. See this entry&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Outline&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Title&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;On the ability to detect leading indicators of catastrophe in unreplicated time series&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Introduction&lt;/strong&gt; Background on Warning Signals&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://www.mendeley.com/research-papers/collections/1374711/EarlyWarningSigns/&quot; title=&quot;http://www.mendeley.com/research-papers/collections/1374711/EarlyWarningSigns/&quot;&gt;literature&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Saddle Node bifurcation&lt;/li&gt;
&lt;li&gt;Detecting decreasing stabilization – gradual vs changepoint estimation&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Reasons detection can fail:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Ergodicity: ensembles vs single instances&lt;/li&gt;
&lt;li&gt;Sufficient statistical power&lt;/li&gt;
&lt;li&gt;Appropriate dynamics&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Methods&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Defining an indicator – significant Kendall rank correlation coefficient τ as in &lt;a href=&quot;http://hdl.handle.net/10.1073/pnas.0802430105&quot; title=&quot;doi:10.1073/pnas.0802430105&quot;&gt;doi:10.1073/pnas.0802430105&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Simulation approach&lt;/li&gt;
&lt;li&gt;Analytic limits&lt;/li&gt;
&lt;li&gt;accounting for delay?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Figures&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Saddle node bifurcation example – should discuss difference between stochastic and deterministic edge?&lt;/li&gt;
&lt;li&gt;Single replicates using standard detection statistics&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Results/Discussion&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Misleading indicators&lt;/li&gt;
&lt;li&gt;Need for further exploration&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Comparative Phylogenetics Notebook</title>
	 <link href="/2010/03/31/Comparative-Phylogenetics-Notebook.html"/>
   <updated>2010-03-31T00:00:00+00:00</updated>
   <id>/03/31/Comparative-Phylogenetics-Notebook</id>
   <content type="html">&lt;h2 id=&quot;research&quot;&gt;Research&lt;/h2&gt;
&lt;h3 id=&quot;labrid-paper-outline&quot;&gt;Labrid Paper Outline&lt;/h3&gt;
&lt;p&gt;Biology Letters &lt;a href=&quot;http://rsbl.royalsocietypublishing.org/site/misc/styleandpolicy.xhtml&quot; title=&quot;http://rsbl.royalsocietypublishing.org/site/misc/styleandpolicy.xhtml&quot;&gt;format&lt;/a&gt;, 2500 words, 2 figures.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;data:image/png;base64,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&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Fig 1?&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;data:image/png;base64,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&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Fig 2?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Title&lt;/strong&gt;: &lt;em&gt;Phylogenetic Evidence for Multiple Morphological Niches in Coral Reef Fish&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Summary&lt;/strong&gt; (&amp;lt; 200 words)
&lt;ul&gt;
&lt;li&gt;We present phylogenetic evidence for two distinct evolutionary optima in the fin morphology of Labrid Fish.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Keywords&lt;/strong&gt;: Evolution, Phylogenetics, Comparative Methods, Labrids, Multiple Niches&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Introduction&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Labrid Fin Morphology&lt;/li&gt;
&lt;li&gt;Is clustering in Trait space evidence of Selection or Phylogenetic Inertia?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Material and Methods&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;as in this entry&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Results&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Evidence for and significance of the two-peak model&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Figures&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;possibly fin morphology and data in single panel? Maybe bootstraps as well?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Discussion&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Understanding multiple niches within current methodology&lt;/li&gt;
&lt;li&gt;Novel methodology to approach this in a phylogenetic context&lt;/li&gt;
&lt;li&gt;Future questions&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Acknowledgements&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;References&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;computing&quot;&gt;Computing&lt;/h2&gt;
&lt;h3 id=&quot;r-package-to-do&quot;&gt;R Package – To Do&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Should move example scripts into a demo directory&lt;/li&gt;
&lt;li&gt;Should wrap as an R package&lt;/li&gt;
&lt;li&gt;Need function to automate the analysis of bootstrap data and recommend the right number of peaks&lt;/li&gt;
&lt;li&gt;Need prototype stochastic partition and stochastic reconstruction&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;misc-notes&quot;&gt;Misc / Notes&lt;/h2&gt;
&lt;h3 id=&quot;f1000-reviews&quot;&gt;F1000 reviews&lt;/h3&gt;
&lt;p&gt;﻿Constable, H. et al., 2010. VertNet: a new model for biodiversity data sharing. PLoS biology, 8(2), e1000309. Available at: &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20169109&quot; class=&quot;uri&quot; title=&quot;http://www.ncbi.nlm.nih.gov/pubmed/20169109&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/20169109&lt;/a&gt;. &lt;em&gt;Must read&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Summary:&lt;/strong&gt; Authors describe VertNet, a cloud-computing resource for vertibrate biodiversity data. Data is publicly accessible can be user annotated while remaining contributor-mediated, retaining primacy and expertise of the orignal contributor.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Opinion:&lt;/strong&gt; Scientists have long argued for the importance of openly accessible, standardized and georeferenced biodiversity data. This work represents a significant accomplishment in overcoming technological, sociological, and idiosynchratic barriers to make this a reality.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ﻿Cadotte, M.W. et al., 2010. Phylogenetic diversity metrics for ecological communities: integrating species richness, abundance and evolutionary history. Ecology Letters, 13(1), 96-105. Available at: &lt;a href=&quot;http://blackwell-synergy.com/doi/abs/10.1111/j.1461-0248.2009.01405.x&quot; class=&quot;uri&quot; title=&quot;http://blackwell-synergy.com/doi/abs/10.1111/j.1461-0248.2009.01405.x&quot;&gt;http://blackwell-synergy.com/doi/abs/10.1111/j.1461-0248.2009.01405.x&lt;/a&gt;. &lt;em&gt;Recommended&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Summary:&lt;/strong&gt; Existing phylogenetic diversity metrics do not account for relative abundance.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Opinion:&lt;/strong&gt; This work represents a significant improvement on existing approaches of phylogenetic diversity which are commonly used to evaluate species conservation value.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Ziebarth, N.L., Abbott, K.C. &amp;amp; Ives, A.R., 2010. Weak population regulation in ecological time series. Ecology letters, 13(1), 21-31. Available at: &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/19849710&quot; class=&quot;uri&quot; title=&quot;http://www.ncbi.nlm.nih.gov/pubmed/19849710&quot;&gt;http://www.ncbi.nlm.nih.gov/pubmed/19849710&lt;/a&gt;. &lt;em&gt;Recommended&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Summary:&lt;/strong&gt; Authors evaluate two large data collections of population dynamics to find that many long time series express only weak regulation using autoregressive moving average (ARMA) models. The variation of the stationary distribution relative to the variation in the moving average component is taken as the measure of population regulation (1 if strong, much larger under weaker regulation).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Opinion:&lt;/strong&gt; An intriguing paper that brings extensive analysis to a long-standing and fundamental question in population biology. These methods deserve further exploration for their ability to detect strong regulation, as it should be possible to establish confidence intervals on this estimate.&lt;/p&gt;
&lt;h3 id=&quot;mendeley&quot;&gt;Mendeley&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Can I get an rss feed of articles I’ve recently added to my Mendeley collection? Two-way cite-u-like integration? &lt;em&gt;To explore later&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;libraries-for-stochastic-simulation&quot;&gt;Libraries for stochastic simulation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;with various levels of course graining, different tau-leaping methods, sdes, etc. Will have to explore more at some point, should see if Arkin’s group uses any either. See:&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://synbioss.sourceforge.net/simulator/examples/&quot; title=&quot;http://synbioss.sourceforge.net/simulator/examples/&quot;&gt;SynBioSS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://cain.sourceforge.net/&quot; title=&quot;http://cain.sourceforge.net/&quot;&gt;Cain&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Came across more tau-leaping methods for &lt;a href=&quot;http://hdl.handle.net/10.1063/1.3310808&quot; title=&quot;doi:10.1063/1.3310808&quot;&gt;spatial dynamics&lt;/a&gt; and &lt;a href=&quot;http://hdl.handle.net/10.1073/pnas.0809340106&quot; title=&quot;doi:10.1073/pnas.0809340106&quot;&gt;another&lt;/a&gt; how to do tau-leaping when timescales vary widely (stiff dynamics).&lt;/li&gt;
&lt;li&gt;Mario has some interesting &lt;a href=&quot;http://pineda-krch.com/category/gillespie-algorithm/&quot; title=&quot;http://pineda-krch.com/category/gillespie-algorithm/&quot;&gt;entries on Gillespie methods&lt;/a&gt; as well.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;other&quot;&gt;Other&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.hypios.com/thinking/2010/03/18/facebook-for-scientists-a-scientist-weighs-in/&quot; title=&quot;https://www.hypios.com/thinking/2010/03/18/facebook-for-scientists-a-scientist-weighs-in/&quot;&gt;Interesting post&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://flowingdata.com/2010/03/31/mapping-the-github-community/#&quot; title=&quot;http://flowingdata.com/2010/03/31/mapping-the-github-community/#&quot;&gt;neat github collaboration map&lt;/a&gt; might be worth learning more about this kind of visualization.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/03/30/Research.html"/>
   <updated>2010-03-30T00:00:00+00:00</updated>
   <id>/03/30/Research</id>
   <content type="html">&lt;h3 id=&quot;current-situation-challenges&quot;&gt;Current Situation &amp;amp; Challenges&lt;/h3&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/22/Simulated_LR.png/200px-Simulated_LR.png&quot; alt=&quot;2000 bootstraps of models fitted to simulated ou2 data&quot; /&gt;&lt;figcaption&gt;2000 bootstraps of models fitted to simulated ou2 data&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;2000 bootstraps of models fitted to simulated ou2 data&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A single data set is produced by simulation under a specified ou2 model on the Labrid tree (actually one that was fitted to the original Labrid data).&lt;/li&gt;
&lt;li&gt;Each model (Brownian motion and 1 to 5 separate OU peaks (assigned by my partition function) is fitted to this dataset.&lt;/li&gt;
&lt;li&gt;Each fitted model is used to generate 2000 replicate datasets&lt;/li&gt;
&lt;li&gt;For each replicate dataset, the model used to generate it is compared to each other model in likelihood ratio test 2(log(&lt;em&gt;L&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt;) − log(&lt;em&gt;L&lt;/em&gt;&lt;sub&gt;2&lt;/sub&gt;)), where &lt;em&gt;L&lt;/em&gt;&lt;sub&gt;1&lt;/sub&gt; is the likelihood of the model that generated the data. In this version, the model likelihood is simply evaluated with its original parameter assignments, not refit to the data first.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The pattern&lt;/strong&gt; seems to be: each model fit the data it produced better than any other model, particularly for the more complicated models. Consequently, the bootstrap distributions are always positive.&lt;/li&gt;
&lt;li&gt;The more complicated models have higher likelihood scores on the original data, making the location of the red line marking the original data always fall in the negative region for the upper triangle of the graph matrix, where simulations coming from simpler models are compared against the more complicated ones. This seems to consistently reject the simpler model in favor of the complicated one.&lt;/li&gt;
&lt;li&gt;Meanwhile, the lower triangle compares data generated under the complicated against the simple. When the complex (ou2+) are compared against ou1 and bm in this way, the simple model does not reject the complex one – that is, data produced by the complex model scores an expected amount better than the simple one; the red line falls near the center of the bootstrap distribution.&lt;/li&gt;
&lt;li&gt;However, as the models get more complex, the data appears to fall at relatively unlikely small scores. (comparing ou2 vs ou3 for instance) This suggests while the more complex model is still performing better, one would actually suspect it to perform much better still than it actually is; and on the whole its performance is unexpectedly poor for it to be the correct model.&lt;/li&gt;
&lt;li&gt;The balance of rejecting one but not both comparisons might make an argument for ou2 being correct, though the case is not as clear as might hope with simulated data. Of course the power to distinguish depends on the tree as well.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;next-steps&quot;&gt;Next Steps&lt;/h3&gt;
&lt;h2 id=&quot;miscnotes&quot;&gt;Misc/Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Seminar nominations – submitted. &lt;a href=&quot;http://kinglab.eeb.lsa.umich.edu/&quot; title=&quot;http://kinglab.eeb.lsa.umich.edu/&quot;&gt;Aaron King&lt;/a&gt;, &lt;a href=&quot;http://evolution.genetics.washington.edu/&quot; title=&quot;http://evolution.genetics.washington.edu/&quot;&gt;Joe Felsenstein&lt;/a&gt;, &lt;a href=&quot;http://xcelab.net/rm/&quot; title=&quot;http://xcelab.net/rm/&quot;&gt;Richard McElreath&lt;/a&gt;, &lt;a href=&quot;http://www.webpages.uidaho.edu/~lukeh/index.html&quot; title=&quot;http://www.webpages.uidaho.edu/~lukeh/index.html&quot;&gt;Luke Harmon&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;F1000 Reviews&lt;/strong&gt; Need to submit evaluations&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;[1] Weak population regulation in ecological time series Nicolas L. Ziebarth, Karen C. Abbott, Anthony R. Ives &lt;a href=&quot;http://www3.interscience.wiley.com/journal/122659274/abstract&quot; class=&quot;uri&quot; title=&quot;http://www3.interscience.wiley.com/journal/122659274/abstract&quot;&gt;http://www3.interscience.wiley.com/journal/122659274/abstract&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[2] Field theory for biogeography: a spatially explicit model for predicting patterns of biodiversity James P. O’Dwyer, Jessica L. Green &lt;a href=&quot;http://www3.interscience.wiley.com/journal/122680792/abstract&quot; class=&quot;uri&quot; title=&quot;http://www3.interscience.wiley.com/journal/122680792/abstract&quot;&gt;http://www3.interscience.wiley.com/journal/122680792/abstract&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[3] Phylogenetic diversity metrics for ecological communities: integrating species richness, abundance and evolutionary history Marc W. Cadotte, T. Jonathan Davies, James Regetz, Steven W. Kembel, Elsa Cleland, Todd H. Oakley &lt;a href=&quot;http://www3.interscience.wiley.com/journal/122680036/abstract&quot; class=&quot;uri&quot; title=&quot;http://www3.interscience.wiley.com/journal/122680036/abstract&quot;&gt;http://www3.interscience.wiley.com/journal/122680036/abstract&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://ievobio.org/&quot; title=&quot;http://ievobio.org/&quot;&gt;ievobio conference&lt;/a&gt;&lt;/strong&gt; Registration&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Interesting seminar by &lt;a href=&quot;http://www.cs.ucdavis.edu/people/faculty/tagkopoulos.html&quot; title=&quot;http://www.cs.ucdavis.edu/people/faculty/tagkopoulos.html&quot;&gt;Ilias Tagkopoulos&lt;/a&gt; at CPB today. Good example of high performance computing for stochastic simulations. Latest versions are also explicitly spatial. Strange choice of birth death dynamics however – fixed population size, and when birth occurs, a weaker individual is replaced, when death occurs, a random individual replaces it. Resembles the Moran model, though other work has shown order is important here.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Still puzzling on LR</title>
	 <link href="/2010/03/26/Still-puzzling-on-LR.html"/>
   <updated>2010-03-26T00:00:00+00:00</updated>
   <id>/03/26/Still-puzzling-on-LR</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;The likelihood ratios when parameters are not held fixed, using data originally generated from a two peak model. Has 1000 bootstrap replicates per plot.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/1/12/Simulated_2_LR_fitpar.png/300px-Simulated_2_LR_fitpar.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;The likelihood ratios when parameters are held fixed, after being generated from a two-peak model. (2000 replicates each)&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/22/Simulated_LR.png/300px-Simulated_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;parameters held fixed, three peak model (200 replicates each)&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/0/00/Simulated_3_LR.png/300px-Simulated_3_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/03/25/Research.html"/>
   <updated>2010-03-25T00:00:00+00:00</updated>
   <id>/03/25/Research</id>
   <content type="html">&lt;h3 id=&quot;new-simulations&quot;&gt;New Simulations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Now have code to run partitioned models on the Anoles dataset, compare partitioned models to the paintings chosen by Butler and King. Preliminary figures below. Models with _s are partitioned by my algorithm, others are the the original ones from earlier.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/c/cb/Anoles_partition.png/300px-Anoles_partition.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Also have examples with simulated data with a known number of partitions, to check the method. Tested with data produced at two peaks on the Labrid tree, the pattern seems similar to that of the Labrids – comparisons involving any model with more than 2 peaks produce LR ratios that become very unlikely in either pairwise comparison. Still needs further exploration. Preliminary figures:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/2/22/Simulated_LR.png/300px-Simulated_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; ### Interpreting Results&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Pattern: In the bootstrapping, the model generating the data always scores substantially higher than the test model, making all distributions fall in the positive range. Note that parameters are fixed, hence the more complicated model does not have an advantage in this bootstrapping. Meanwhile, the more complicated model does substantially better at the real data than the simpler model, since in this case both have there parameters fit to the data. Consequently the red line falls deep in the negative for the bootstraps simulated under the simple model and makes it appear as though the more complicated model is always correct. Perhaps comparing models in which the parameters are allowed to vary may indeed be more meaningful.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Compare to parameter varying case.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Now simulating with parameter varying using simulated two-peak dataset.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;beating-bugs-and-improving-code&quot;&gt;Beating bugs and improving code&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Found a work-around in the bug that was preventing me from running the Anoles dataset under partitioning. The problem seems to be the reorder.phylo() by pruning order command, which is called by the ace() function on the phylogenetic tree. This function calls a C function to do the reordering, which somehow gets stuck on an infinite loop when given a file converted from ouch format to ape format using my function. Writing my converted tree out to a nexus file with write.nexus() and then reading it back in seems to solve this problem.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Made my convert() function build its “phylo” tree arguments in the same order (edge, Nnode, tip.label, edge.length) as they are assigned in the “phylo” objects created by read.nexus, though this doesn’t seem to matter as most calls are made with phy$edge rather than phy[1].&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Code now avoids bootstrapping a model against itself.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Could avoid re-simulating&lt;/strong&gt; datasets for each figure in the same row, but should profile the code first to make sure this is worth while.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;should start logging simulation runs directly and fixing seed.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;png and cairo devices haven’t been installed on the server, figures output in pdf and converted to png by imagemagick with bash:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;for i in *.pdf; do convert &amp;quot;$i&amp;quot; &amp;quot;${i/.pdf}&amp;quot;.png; done&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;see &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics/commits/master&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics/commits/master&quot;&gt;git log&lt;/a&gt; for more details.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;notes&quot;&gt;Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Google Summer of Code includes &lt;a href=&quot;https://www.nescent.org/wg/phyloinformatics/index.php?title=Phyloinformatics_Summer_of_Code_2010#Mentors&quot; title=&quot;https://www.nescent.org/wg/phyloinformatics/index.php?title=Phyloinformatics_Summer_of_Code_2010#Mentors&quot;&gt;NesCent “phyloinformatics” research&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www3.interscience.wiley.com/journal/123328987/abstract?CRETRY=1&amp;amp;SRETRY=0&quot; title=&quot;http://www3.interscience.wiley.com/journal/123328987/abstract?CRETRY=1&amp;amp;SRETRY=0&quot;&gt;obvious…&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;still reading: &lt;a href=&quot;http://blog.openwetware.org/scienceintheopen/2009/11/05/reflections-on-science-20-from-a-distance-part-i/&quot; title=&quot;http://blog.openwetware.org/scienceintheopen/2009/11/05/reflections-on-science-20-from-a-distance-part-i/&quot;&gt;open science&lt;/a&gt;, &lt;a href=&quot;http://blog.openwetware.org/scienceintheopen/2009/11/06/reflections-on-science-20-from-a-distance-part-ii/&quot; title=&quot;http://blog.openwetware.org/scienceintheopen/2009/11/06/reflections-on-science-20-from-a-distance-part-ii/&quot;&gt;part 2&lt;/a&gt;, and also enjoyed this&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;csgf-conference-hpc-survey&quot;&gt;CSGF Conference HPC Survey&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Not directly phylogentics, but also working on today:&lt;/li&gt;
&lt;li&gt;I was contacted by Mary Ann 3 days ago on doing another survey of CSGF fellows. &lt;a href=&quot;http://www.surveymonkey.com/s/VMTTFXS&quot; title=&quot;http://www.surveymonkey.com/s/VMTTFXS&quot;&gt;Last year’s survey&lt;/a&gt; was pretty basic (&lt;a href=&quot;http://www.surveymonkey.com/MySurvey_Responses.aspx?sm=SXNbpnWs3a%2blQnEwe%2bfNiKvBGCZEs/jdQhlVfunE9YI%3d&quot; title=&quot;http://www.surveymonkey.com/MySurvey_Responses.aspx?sm=SXNbpnWs3a%2blQnEwe%2bfNiKvBGCZEs/jdQhlVfunE9YI%3d&quot;&gt;results&lt;/a&gt;). Also interested to explore alternatives to surveymonkey, though it did make things quite easy and Krell can probably get the subscription. Possibly Google forms?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Some goals I have for the survey:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;Who knows/uses what.&lt;/strong&gt; Be able to see what languages, parallelization, and scale of computation fellows are computing on. The crucial goal for this year is to be able to break this down by subject area and by year in the fellowship.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Effective practices in computing.&lt;/strong&gt; Hugely important but too rarely taught (in sciences anyway). Version control, debugging, visualization, etc. A great example of this stuff is to see the quiz on &lt;a href=&quot;http://software-carpentry.org/intro.html&quot; title=&quot;http://software-carpentry.org/intro.html&quot;&gt;Software Carpentry&lt;/a&gt;(scroll down to #5)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://openwetware.org/wiki/Science_2.0/Brainstorming&quot; title=&quot;http://openwetware.org/wiki/Science_2.0/Brainstorming&quot;&gt;&lt;strong&gt;Science 2.0&lt;/strong&gt;&lt;/a&gt; This goes a little further afield and might deserve its own session. Computers and the internet continue to change many aspects in the way we do science and it makes sense that CSGFs should be at the forefront. Large-scale online collaborations. The benefits and risks of science blogging. Standardized and publicly accessible data, source code, publications, and notebooks. Social networking for scientists. There’s a wealth of rapidly emerging tools in this area that I think we should all know about. Two quick examples: Mendeley for organizing our collections of scientific papers and stackoverflow.com for solving programming problems collaboratively.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Entry title</title>
	 <link href="/2010/03/25/Entry-title.html"/>
   <updated>2010-03-25T00:00:00+00:00</updated>
   <id>/03/25/Entry-title</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Insert content here…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parallel R</title>
	 <link href="/2010/03/24/Parallel-R.html"/>
   <updated>2010-03-24T00:00:00+00:00</updated>
   <id>/03/24/Parallel-R</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Parallelized LR_bootstrap_all() and model_bootstrap_all() bootstrapping functions. Lets the bootstrapping of different models (or LRs between models) to be performed on different machines.&lt;/li&gt;
&lt;li&gt;Using the &lt;em&gt;snowfall&lt;/em&gt; package in R for easy parallel computing. The parallel loop is done through the sfLapply() function.&lt;/li&gt;
&lt;li&gt;Had to get libraries and functions exported to all loops using sfLibrary() and sfExportAll(). R-sig-hpc mailing list was very helpful at getting this up and running at 4am.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;references-for-parallel-r&quot;&gt;References for parallel R&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://cran.r-project.org/web/views/HighPerformanceComputing.html&quot; title=&quot;http://cran.r-project.org/web/views/HighPerformanceComputing.html&quot;&gt;Taskview on Parallel on HPC R&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://cran.r-project.org/web/packages/snowfall/vignettes/snowfall.pdf&quot; title=&quot;http://cran.r-project.org/web/packages/snowfall/vignettes/snowfall.pdf&quot;&gt;Snowfall Tutorial (vignette)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://stat.ethz.ch/mailman/listinfo/r-sig-hpc&quot; title=&quot;https://stat.ethz.ch/mailman/listinfo/r-sig-hpc&quot;&gt;R-sig-hpc mailing list&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Research ——–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Still exploring model comparisons. Trying labrid data with up to 5 partitions.&lt;/li&gt;
&lt;li&gt;Attempted partitioning on the Anoles data, but for some reason the ape ace() fn for discrete ancestral state reconstruction fails on this data (seems to get stuck in an infinite loop). Not obvious why this should occur; geiger’s fitDiscrete() works fine on the partitioned data. Well, was planning on rewriting the ancestral state reconstruction in simmap style anyway…&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;anoles&quot;&gt;Anoles&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/a/aa/Anoles_lik.png/400px-Anoles_lik.png&quot; alt=&quot;image&quot; /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/4/47/Anoles_LR.png/400px-Anoles_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;labrids&quot;&gt;Labrids&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/1/1b/Labrid_lik.png/400px-Labrid_lik.png&quot; alt=&quot;image&quot; /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/f/fc/Labrid_LR.png/400px-Labrid_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - Seems like the more complicated models continually perform better. However, the observed likelihood ratios become less and less likely themselves, even against simple models.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Recall I simulate the dataset under the model labeled “true” and then evaluate the likelihood ratio of that model vs the test model. So along a row data is produced by simulation of the same model. The pattern is basically that the upper triangle of the matrix (simulate simple, compare to complex) always has negative LR for the true data but a very positive distribution of LRs. It’s still a bit surprising to me that when data simulated under the simpler model that the simple model should always drastically outperform the complex one in LR, but it does.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;misc-notes&quot;&gt;Misc Notes&lt;/h2&gt;
&lt;p&gt;Listened to some talks while coding yesterday. Listing here in case I want to return to them.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.youtube.com/watch?v=khQ9BaXZAjM&quot; title=&quot;http://www.youtube.com/watch?v=khQ9BaXZAjM&quot;&gt;Richard Florida&lt;/a&gt; What’s your city? (excellent)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.youtube.com/watch?v=tke6X2eME3c&quot; title=&quot;http://www.youtube.com/watch?v=tke6X2eME3c&quot;&gt;Tony Schwartz&lt;/a&gt; Managing your time managing your energy&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.youtube.com/watch?v=43DZEy_J694&quot; title=&quot;http://www.youtube.com/watch?v=43DZEy_J694&quot;&gt;David Weinberger&lt;/a&gt; Everything is Miscellaneous&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Bootstrapping Likelihood ratios</title>
	 <link href="/2010/03/23/Bootstrapping-Likelihood-ratios.html"/>
   <updated>2010-03-23T00:00:00+00:00</updated>
   <id>/03/23/Bootstrapping-Likelihood-ratios</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Bootstraps of the likelihood ratio, holding the parameters fixed, finally completed.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Anoles: &lt;img src=&quot;http://openwetware.org/images/thumb/4/47/Anoles_LR.png/600px-Anoles_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Summary Anoles table:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; summary(anoles_boots)
            [,1]        [,2]       [,3]       [,4]        [,5]
[1,] 0.500000000 0.981399498 0.26514573 0.06668672 0.018154938
[2,] 0.009580545 0.500000000 0.15610274 0.04819938 0.011616566
[3,] 0.039233893 0.075349644 0.50000000 0.05699877 0.005443493
[4,] 0.004211230 0.004592917 0.01389950 0.50000000 0.006648916
[5,] 0.173457542 0.198303402 0.38893099 0.33891430 0.500000000
&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Labrids: &lt;img src=&quot;http://openwetware.org/images/thumb/f/fc/Labrid_LR.png/600px-Labrid_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt; 
&amp;gt; summary(labrid_boots)
          [,1]         [,2]      [,3] [,4]
[1,] 0.5000000 6.036842e-05 0.0000000  0.0
[2,] 0.5424613 5.000000e-01 0.0000000  0.0
[3,] 0.5546890 4.384114e-01 0.5000000  0.0
[4,] 0.4081957 3.488395e-01 0.0295128  0.5
&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; Note that the location of the red line now just flips sign in the pairwise comparison.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - Functions for bootstrapping of the likelihood directly also written. Currently running with 1000 replicates.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;model_bootstrap() bootstraps a single model&lt;/li&gt;
&lt;li&gt;model_bootstrap_all() applies this to a list of models&lt;/li&gt;
&lt;li&gt;plot.model_boots() plots the object returned by bootstrapping all models on a single plot axis.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Working on a summary function for both LR and likelihood bootstraps.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Phylogenetic Tree formats</title>
	 <link href="/2010/03/22/Phylogenetic-Tree-formats.html"/>
   <updated>2010-03-22T00:00:00+00:00</updated>
   <id>/03/22/Phylogenetic-Tree-formats</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Consider a tree with N nodes. has &lt;img src=&quot;http://openwetware.org/images/math/8/0/6/806f2a93c92cf6d7d9f090494e22ca5c.png&quot; alt=&quot;\frac{N+1}{2}&quot; /&gt; tips and &lt;img src=&quot;http://openwetware.org/images/math/b/2/9/b29839ea7c81cf5145ad5cc82365a8ed.png&quot; alt=&quot;\frac{N-1}{2}&quot; /&gt; internal nodes.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;ape-format-class-phylo&quot;&gt;ape Format: class “phylo”&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Elements of the data structure:&lt;/li&gt;
&lt;li&gt;phy$edge – Topology. 2 by N-1 matrix. First column has internal nodes only, each node appearing twice. Internal nodes range from 1+(N+1)/2 to N-1, while the tip numbers go from 1 to (N+1)/2. Each node appears once in the second column, and is a child of the node identified in the first column.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The order of the rows in the matrix doesn’t matter.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;phy&lt;span class=&quot;math&quot;&gt;\(edge.length -- the N-1 length numeric. Lengths of the edges in the same order as phy\)&lt;/span&gt;edge. Optional for plotting.&lt;/li&gt;
&lt;li&gt;phy$tip.label – &lt;img src=&quot;http://openwetware.org/images/math/8/0/6/806f2a93c92cf6d7d9f090494e22ca5c.png&quot; alt=&quot;\frac{N+1}{2}&quot; /&gt; length character vector. The index values correspond to the&lt;/li&gt;
&lt;li&gt;phy$Nnode – Number of internal nodes, equals &lt;img src=&quot;http://openwetware.org/images/math/b/2/9/b29839ea7c81cf5145ad5cc82365a8ed.png&quot; alt=&quot;\frac{N-1}{2}&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are the essential components of a phylo object. Optional parameter includes a list of names for internal nodes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;phy &amp;lt;- makeNodeLabel(phy) adds phy$node.label&lt;/li&gt;
&lt;li&gt;phy$node.label&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ape format is very picky. Any tree topology is completely specified by listing the ancestor for each node. If the nodes are identified as 1:n, then the topology is an ordered vector of length n. This is the representation used by ouch. The node numbers can be arbitrary identifiers. Ape chooses a more restrictive representation. Nodes are assigned numbers such that the numbers 1 to (n+1)/2 are assigned exclusively to tips, and those after are assigned exclusively to internal nodes. Topology is specified by listing the ancestor of each node. The identity is stored in edge[,2] and the ancestor in edge[,1]. However, it appears that the root node cannot be assigned as n. Whichever is the ancestor will be missing from the node list on the right (edge[,2]), as it has no corresponding ancestor on the left. It seems the (n+1)/2 + 1 does best assigned to the root. Ouch2ape conversion could easily preserve the node-numbering used in the ape representation, but for some reason the function chooses to renumber them anyway. Reversing is harder, as not all applicable codings of a tree in the ouch representation meet the additional constraints of the ape tree.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; #### ouch Format: class “ouchtree”&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Topology specified in tree@ancestors&lt;/li&gt;
&lt;li&gt;each node lists its ancestor&lt;/li&gt;
&lt;li&gt;fitted models have class “hansentree” or “browntree” and contain parameter fitting details.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/03/20/Research.html"/>
   <updated>2010-03-20T00:00:00+00:00</updated>
   <id>/03/20/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Bootstrap the fitted models (rather than allow the parameters to be refit, simply evaluate the likelihood of the model under each simulated dataset)&lt;/li&gt;
&lt;li&gt;Directly evaluate &lt;a href=&quot;http://en.wikipedia.org/wiki/Neyman%E2%80%93Pearson_lemma&quot; title=&quot;http://en.wikipedia.org/wiki/Neyman%E2%80%93Pearson_lemma&quot;&gt;Neyman-Pearson lemma&lt;/a&gt; for each pairwise model comparison.&lt;/li&gt;
&lt;li&gt;Also analyze the bootstrapped likelihoods directly (and without refitting) for each model.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;to-do&quot;&gt;To Do&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Add a summary function for the likelihood_ratio_bootstrap.R library&lt;/li&gt;
&lt;li&gt;final wrapper function for infer_niches.R partitioning library&lt;/li&gt;
&lt;li&gt;More error handling and documentation&lt;/li&gt;
&lt;li&gt;Example of partitioning Anoles then bootstrapping&lt;/li&gt;
&lt;li&gt;Bootstrapping likelihoods directly&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;references-on-thinking-about-bootstrapping-model-comparisons&quot;&gt;References on thinking about bootstrapping model comparisons&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.jstor.org/stable/91247&quot; title=&quot;http://www.jstor.org/stable/91247&quot;&gt;The original Neyman-Pearson paper&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.springerlink.com/content/r12g32/?p=10d7defb56d34e0d99143df5d6000f35&amp;amp;pi=2&quot; title=&quot;http://www.springerlink.com/content/r12g32/?p=10d7defb56d34e0d99143df5d6000f35&amp;amp;pi=2&quot;&gt;Testing Statistical Hypotheses&lt;/a&gt; Text by Lehmann &amp;amp; Romano&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.springerlink.com/content/978-0-387-20279-2&quot; title=&quot;http://www.springerlink.com/content/978-0-387-20279-2&quot;&gt;Permutation, Parametric and Bootstrap Tests of Hypotheses&lt;/a&gt; by Good&lt;/li&gt;
&lt;li&gt;Thanks to Peter on these; &lt;a href=&quot;http://www.bibsonomy.org/user/peter.ralph&quot; title=&quot;http://www.bibsonomy.org/user/peter.ralph&quot;&gt;Bibsonomy collection&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;ouch2ape.R function needs debugging!&lt;/em&gt;&lt;/strong&gt; Works only some of the time. Seems to error on converting back from an ape2ouch conversion.&lt;/p&gt;
&lt;h2 id=&quot;computing&quot;&gt;Computing&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Adding documentation and testing the new bootstrapping functions.&lt;/li&gt;
&lt;li&gt;New functions make up the bootstrapping likelihood ratio suite:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;BM_loglik&lt;/li&gt;
&lt;li&gt;my_update&lt;/li&gt;
&lt;li&gt;LR_bootstrap&lt;/li&gt;
&lt;li&gt;LR_bootstrap_all&lt;/li&gt;
&lt;li&gt;plot.LR_boots&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The function should be easy to call on a list of ouch models.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; plot(LR_bootstrap_all(model_list))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Inline documentation provides more details. Functions in this library are contained in the likelihood_ratio_bootstrap.R file.&lt;/p&gt;
&lt;h2 id=&quot;general-notes&quot;&gt;General Notes&lt;/h2&gt;
&lt;h4 id=&quot;break-reading&quot;&gt;Break Reading&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.sciencenews.org/view/feature/id/57091/title/Odds_Are%2C_Its_Wrong&quot; title=&quot;http://www.sciencenews.org/view/feature/id/57091/title/Odds_Are%2C_Its_Wrong&quot;&gt;P values&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://disqus.com/comments/&quot; title=&quot;http://disqus.com/comments/&quot;&gt;another commenting forum&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://ways.org/en/blogs/2010/mar/12/summary_of_the_open_science_session_at_eurodoc_2010&quot; title=&quot;http://ways.org/en/blogs/2010/mar/12/summary_of_the_open_science_session_at_eurodoc_2010&quot;&gt;on open science&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://scholarlykitchen.sspnet.org/2010/02/08/science-and-web-2-0-talking-about-science-versus-doing-science/&quot; title=&quot;http://scholarlykitchen.sspnet.org/2010/02/08/science-and-web-2-0-talking-about-science-versus-doing-science/&quot;&gt;Doing vs Discussing Science&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.google.com/present/edit?id=0ASQvcnWHnwgmZGR3aHFkNmtfMjEyZHo5YjNyZzI&amp;amp;hl=en#&quot; title=&quot;http://docs.google.com/present/edit?id=0ASQvcnWHnwgmZGR3aHFkNmtfMjEyZHo5YjNyZzI&amp;amp;hl=en#&quot;&gt;Cameron’s research cycle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://scienceblogs.com/geneticfuture/2009/06/nature_news_article_on_confere.php&quot; title=&quot;http://scienceblogs.com/geneticfuture/2009/06/nature_news_article_on_confere.php&quot;&gt;Nature’s position on pre-published blogging science&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/03/19/Research.html"/>
   <updated>2010-03-19T00:00:00+00:00</updated>
   <id>/03/19/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Bootstrapped against 2000 replicate simulations overnight on both the Anoles dataset and the Labrids dataset.&lt;/li&gt;
&lt;li&gt;Distributions that overlap zero represent replicates that choose the wrong model.&lt;/li&gt;
&lt;li&gt;The Anoles data below; the first column corresponds to the likelihood ratios shown in &lt;a href=&quot;http://www.journals.uchicago.edu/doi/abs/10.1086/426002&quot; title=&quot;http://www.journals.uchicago.edu/doi/abs/10.1086/426002&quot;&gt;Butler &amp;amp; King (2004)&lt;/a&gt;, comparing each model against BM.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/0/0f/Anoles_full_LR.png/600px-Anoles_full_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;The Labrid dataset:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/6/6c/Labrid_full_LR.png/600px-Labrid_full_LR.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Find matching figures for the case of parameters held fixed on more recent entry&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Recall I simulate the dataset under the model labeled “true” and then evaluate the likelihood ratio of that model vs the test model. So along a row data is produced by simulation of the same model. The pattern is basically that the upper triangle of the matrix (simulate simple, compare to complex) always has negative LR for the true data but a very positive distribution of LRs. It’s still a bit surprising to me that when data simulated under the simpler model that the simple model should always drastically outperform the complex one in LR, but it does.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;discussion-w-peter&quot;&gt;Discussion w/ Peter&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Bootstraps in this implementation refit the model to the simulated data each time.&lt;/li&gt;
&lt;li&gt;This largely comes from relying on the behavior of the built-in functions: the bootstrap call and the update call on ouch models both refit the model.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;computing&quot;&gt;Computing&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;R objects can have multiple classes. For instance, in ouch, a hansentree and a browntree are both also of class ouchtree. To check if an object is a member of a class, calling class(object) directly only returns the top class. use:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;is(object, &amp;quot;classname&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;to check if the object is a member of a class.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Was trying to figure out the best way for an R function to return multiple objects, particularly when those objects are complicated classes and not just things that can be concatenated into a data.frame, equivalent to an array of pointers to objects in C. A vector of type “list” does the trick:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;out &amp;lt;- vector(&amp;quot;list&amp;quot;, 5)
out[[1]] &amp;lt;- object 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;etc.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Trying to include more error handling in my codes. For instance, checking classes of objects&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;if (!is(tree,&amp;#39;ouchtree&amp;#39;))
  stop(sQuote(&amp;quot;tree&amp;quot;),&amp;quot; must be an object of class &amp;quot;,sQuote(&amp;quot;ouchtree&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Trying to start following Google’s literate programming &lt;a href=&quot;http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html#functiondefinition&quot; title=&quot;http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html#functiondefinition&quot;&gt;inline documentation for functions&lt;/a&gt; in R. The standard R documentation method really encourages writing documentation &lt;em&gt;after&lt;/em&gt; writing the code, rather antithetical to literate programming.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/03/18/Research.html"/>
   <updated>2010-03-18T00:00:00+00:00</updated>
   <id>/03/18/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;A some point I’ll want to think more seriously about incorporating geographic information into comparative analyses. At some level this data is more available than appropriate continuous traits, as illustrated in the &lt;a href=&quot;http://iphylo.org/treebase/Doi:10.1016/j.ympev.2008.02.021&quot; title=&quot;http://iphylo.org/treebase/Doi:10.1016/j.ympev.2008.02.021&quot;&gt;example phylogenetics wiki&lt;/a&gt; from Prof. Roderic Page that I just came across.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;todays-goals&quot;&gt;Today’s Goals&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Repeating last night’s bootstraps on the likelihood ratio. Need to clean up and incorporate my bootstrap codes first.&lt;/li&gt;
&lt;li&gt;Should also explore the bootstrapping of the partitioning functions from yesterday.&lt;/li&gt;
&lt;li&gt;Begin implementing stochastic partitioning and stochastic ancestral state painting/inference.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;bootstrapping-likelihood-ratios&quot;&gt;Bootstrapping Likelihood ratios&lt;/h4&gt;
&lt;p&gt;Preliminary bootstrap of the likelihood ratios of the Anoles data (click for larger). Red lines indicate where the true data falls.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/3f/LR_boots.png/480px-LR_boots.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Compare to the earlier bootstraps of likelihoods directly:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/7/71/Anoles_boot.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Research</title>
	 <link href="/2010/03/17/Research.html"/>
   <updated>2010-03-17T00:00:00+00:00</updated>
   <id>/03/17/Research</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Maximum likelihood assignment based on arbitrary number of partitions now completed. Working on stochastic assignment.&lt;/li&gt;
&lt;li&gt;Now have functions for:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;partitioning data into k groups,&lt;/li&gt;
&lt;li&gt;inferring an ancestral state painting based on this partition&lt;/li&gt;
&lt;li&gt;inferring a continuous model with k OU regimes based on this painting&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;need to add my function for the proper model-comparison bootstrap of likelihood ratio values rather than the likelihoods themselves. See my original entry on this approach.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Currently running the bootstraps on the inferred models for two peaks and three peaks compared to a single partition under either BM or OU.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/f/f7/Bootstrap_models.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;As three peaks includes 2 peaks as a subset, it necessarily performs better. However, the relative increase is much smaller. Comparing likelihood ratios should help tease this apart further.&lt;/p&gt;
&lt;h2 id=&quot;wainwright-meeting&quot;&gt;Wainwright Meeting&lt;/h2&gt;
&lt;p&gt;Discussed target papers for this research.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Target a short paper focusing on the biological aspects of identifying two peaks in the Labrid data. Working on with Peter. Will probably add the three peak comparison (running now).&lt;/li&gt;
&lt;li&gt;Develop a commentary on phylogenetic signal and bootstrapping methods&lt;/li&gt;
&lt;li&gt;Full manuscript with the complete inference of multiple niches that integrates over uncertainty&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Graham & Peter Meeting</title>
	 <link href="/2010/03/16/Graham-and-Peter-Meeting.html"/>
   <updated>2010-03-16T00:00:00+00:00</updated>
   <id>/03/16/Graham-and-Peter-Meeting</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Discussed inverse problem approach.&lt;/li&gt;
&lt;li&gt;Discussed bootstrapping likelihoods directly vs bootstrapping likelihood ratio&lt;/li&gt;
&lt;li&gt;Integrating over uncertainty in the likelihood assignment&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Research Progress —————–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Completed writing the bootstrapping function for the partition scheme,&lt;/li&gt;
&lt;li&gt;ouch2ape function completed for converting ouch tree formats back to ape. modifies code from &lt;a href=&quot;http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/trunk/misc/ouch2ape.R?rev=47&amp;amp;root=phyloc&amp;amp;view=log&quot; title=&quot;http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/trunk/misc/ouch2ape.R?rev=47&amp;amp;root=phyloc&amp;amp;view=log&quot;&gt;r-forge&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;More details and log on the &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics&quot;&gt;repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;goals-for-wainwright-meeting-tomorrow&quot;&gt;Goals for Wainwright meeting tomorrow&lt;/h4&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Repeat Labrid Fin analysis with tripartition&lt;/li&gt;
&lt;li&gt;Bootstrap likelihood ratio functions&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt; Misc —-&lt;/p&gt;
&lt;p&gt;Thinking about nominations for EVE Seminar speaker&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Aaron King&lt;/li&gt;
&lt;li&gt;Joe Felsenstein&lt;/li&gt;
&lt;li&gt;Marc Mangel&lt;/li&gt;
&lt;li&gt;Luke Harmon&lt;/li&gt;
&lt;li&gt;Richard McElreath&lt;/li&gt;
&lt;li&gt;co-sponsor &lt;a href=&quot;http://fds.duke.edu/db/aas/Biology/katia.koelle&quot; title=&quot;http://fds.duke.edu/db/aas/Biology/katia.koelle&quot;&gt;Katia Koelle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Computing</title>
	 <link href="/2010/03/15/Computing.html"/>
   <updated>2010-03-15T00:00:00+00:00</updated>
   <id>/03/15/Computing</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Exploring parallel computing options. &lt;a href=&quot;http://www.ecn.purdue.edu/ParaMount/publications/HIPS07-smin.pdf&quot; title=&quot;http://www.ecn.purdue.edu/ParaMount/publications/HIPS07-smin.pdf&quot;&gt;OpenMP for distributed memory applications&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;learning git – need to get used to the branch and merge, install on one.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;research&quot;&gt;Research&lt;/h2&gt;
&lt;p&gt;The failure of the Anoles data set to robustly select the more common model can easily be explained by the likelihood distribution: Not surprising since this dataset consists of only 23 taxa. The Labrid tree of 114 taxa clearly resolves the difference between the different models. Bootstrapping should be a more reliable guide than comparing AIC scores.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/7/71/Anoles_boot.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Compare to the Labrid data set:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/7/7b/6_boot.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;These use 200 bootstrap simulations, repeating with 2000 for better resolution.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Significance&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Breakthrough!&lt;/strong&gt; This approach has far greater implications than I first realized. This provides an inverse approach which solves the hardest part of my original problem, and then tests that under the phylogenetic context. Solving the partition problem independent of the phylogeny, reconstructing the ancestral states as a purely discrete problem, and then scoring the resulting continuous time model on the phylogeny is likely to be far more effective, efficient, and robust, then the direct calculation of the joint probability that I’ve been pursuing. While the three steps: partitioning, discrete inference, and continuous inference; all need refining, I think I’m very close to my first implementation of the full problem!&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Next Steps&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Compare likelihood scores under different levels of partitioning.&lt;/li&gt;
&lt;li&gt;Parametric bootstrapping of partitioning&lt;/li&gt;
&lt;li&gt;look at parametric bootstrap of parameter values inferred as well as the model likelihood.&lt;/li&gt;
&lt;li&gt;Stochastic Painting from ancestral state reconstruction on discrete traits&lt;/li&gt;
&lt;li&gt;Functionalize the three steps to inference&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Other Progress&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Working on implementing an ouch2ape function to get ouch trees back into ape.&lt;/li&gt;
&lt;li&gt;Begun functionalizing partitioning, discrete and continuous inference. Converting between formats without getting data misaligned is remarkably complicated.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;from-the-git-log&quot;&gt;From the git log&lt;/h2&gt;
&lt;p&gt;commit ddf6db6fca626c8f6ed31f4ab2a7cb78ed70f226 Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Mon Mar 15 09:40:08 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   Updated doxygen comments&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit 17dd3775004741c9c590828b498dacd75c5bfc49 Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Mon Mar 15 09:39:34 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   added license and multimin fn&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit 02b9bfc02cb830297fc7fad81cfcd05598d482f1 Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Mon Mar 15 09:22:21 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   mcmc is basics now implemented.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit 220ccae12fbbdf78cd5e082555c04b99af92c4af Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Sun Mar 14 20:51:50 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   adding the mcmc routine&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;commit 94642c8d406fb0d6e8970dc31cfd5304dda2c007 Author: Carl Boettiger &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+e+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#92;&lt;/noscript&gt; Date: Sun Mar 14 15:33:39 2010 -0700&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;   first commit&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Post-Workshop</title>
	 <link href="/2010/03/14/Post-Workshop.html"/>
   <updated>2010-03-14T00:00:00+00:00</updated>
   <id>/03/14/Post-Workshop</id>
   <content type="html">&lt;p&gt;Working on a couple new ideas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Multiple partitions&lt;/li&gt;
&lt;li&gt;Community phylogenetics nulls&lt;/li&gt;
&lt;li&gt;Diversification rates w/ stationary distributions&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;tools-exploration&quot;&gt;Tools exploration&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Finding &lt;a href=&quot;http://phylogenetics.uservoice.com/forums/43843-general&quot; title=&quot;http://phylogenetics.uservoice.com/forums/43843-general&quot;&gt;my forum&lt;/a&gt; a very useful tool for recording and organizing around idea. Nice complement to this notebook which helps me organize temporally instead.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Becoming convinced I should transition from svn to git. Created a &lt;a href=&quot;http://github.com/cboettig&quot; title=&quot;http://github.com/cboettig&quot;&gt;git-hub account&lt;/a&gt; and have started learning the basic git commands. The &lt;a href=&quot;http://book.git-scm.com/index.html&quot; title=&quot;http://book.git-scm.com/index.html&quot;&gt;Git community book&lt;/a&gt; and the &lt;a href=&quot;http://learn.github.com/p/setup.html&quot; title=&quot;http://learn.github.com/p/setup.html&quot;&gt;website video tutorials&lt;/a&gt; have been very helpful.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Meanwhile, &lt;a href=&quot;http://rabbitvcs.org/&quot; title=&quot;http://rabbitvcs.org/&quot;&gt;RabbitVCS&lt;/a&gt; is a very slick SVN manager integrated directly into the Nautilus browser. I’ve also added the svn commands to hotkeys through my vimrc script.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;listened to an interesting &lt;a href=&quot;http://cyber.law.harvard.edu/events/luncheon/2010/03/wilbanks&quot; title=&quot;http://cyber.law.harvard.edu/events/luncheon/2010/03/wilbanks&quot;&gt;talk by Willbanks&lt;/a&gt; on science commons and &lt;em&gt;Generative Science’.’&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;research&quot;&gt;Research&lt;/h2&gt;
&lt;p&gt;Working on the multiple partitions question for discretization of continuous data.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Maximum likelihood implementation in R for an arbitrary but fixed number of peaks.&lt;/li&gt;
&lt;li&gt;Writing the MCMC approach now to allow Bayesian partitioning.
&lt;ul&gt;
&lt;li&gt;Will be a good test case for the reversible jump process&lt;/li&gt;
&lt;li&gt;Potentially a good test case to explore Dirchlet Process Prior&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;project-now-has-a-code-repository&quot;&gt;Project now has a &lt;a href=&quot;http://github.com/cboettig/Comparative-Phylogenetics&quot; title=&quot;http://github.com/cboettig/Comparative-Phylogenetics&quot;&gt;code repository&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Hosting through github.&lt;/li&gt;
&lt;li&gt;Several advantages to the git system – no central repository, easier branching / merging, faster.&lt;/li&gt;
&lt;li&gt;github interface also seems to have several advantages relative to google code. In addition to supporting git, provides a more intuitive and visually appealing layout for the project.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Bodega Workshop Presentations</title>
	 <link href="/2010/03/12/Bodega-Workshop-Presentations.html"/>
   <updated>2010-03-12T00:00:00+00:00</updated>
   <id>/03/12/Bodega-Workshop-Presentations</id>
   <content type="html">&lt;p&gt;Final day of Bodega Phylogenetics workshop: a full day of student presentations. (High resolution images for the trees available by clicking on them)&lt;/p&gt;
&lt;p&gt;Principle figures from my investigation of the Labrid data. While morphospace doesn’t present an obvious clustering, it can be effectively divided by my maximum likelihood partitioning scheme on fin angle. A smoothed density plot of fin angle alone reveals two identifiable modes in the traitspace.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/7/71/2_data.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Based on the discretized partition, ancestral states are reconstructed under both the equal rates and independent rates model. Independent rates offers a negligible improvement in likelihood score (-loglik of 72 vs 73)&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/9/90/3_discrete.png/480px-3_discrete.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Without discretizing, I infer ancestral state based on Brownian motion. information is rapidly lost in the inference, and the ancestral states become simple averages of the observed traits.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/5/52/4_cts.png/480px-4_cts.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Using the discrete trait analysis, I assign nodes to their more likely reconstruction and use this as the painting scheme for the inference under continuous traits. A stochastic mapping reconstruction could assign nodes randomly based on the probability inferred by the reconstruction. The full simmap approach could also be taken. I doubt the results would differ much between the approaches, as most of the information is in the tips anyway.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/37/5_painted.png/480px-5_painted.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The likelihood distributions generated by bootstrapping 200 replicates shows strong confirmation of the more complex model. Very satisfying in light of the challenges in the Anoles data!&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/7/7b/6_boot.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Feedback from the results has been quite compelling and am beginning to write this up a small manuscript. We’ll need to reduce to two figures.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Phylogenetics Workshop Day 5</title>
	 <link href="/2010/03/11/Phylogenetics-Workshop-Day-5.html"/>
   <updated>2010-03-11T00:00:00+00:00</updated>
   <id>/03/11/Phylogenetics-Workshop-Day-5</id>
   <content type="html">&lt;p&gt;Last day of lectures: Lineage Diversification&lt;/p&gt;
&lt;h3 id=&quot;brian-moore-rates-of-lineage-diversification&quot;&gt;Brian Moore: Rates of Lineage Diversification&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Diversification_Rates_%28Moore%29&quot; title=&quot;http://bodegaphylo.wikispot.org/Diversification_Rates_%28Moore%29&quot;&gt;Bodega Wiki slides &amp;amp; tutorial&lt;/a&gt;&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Detecting significant diversification rate variation across tree&lt;/li&gt;
&lt;li&gt;locate shifts along branches&lt;/li&gt;
&lt;li&gt;and through time (niche-filling, density dep models?)&lt;/li&gt;
&lt;li&gt;correlates of differential rates&lt;/li&gt;
&lt;li&gt;parameter estimation speciation/extinction&lt;/li&gt;
&lt;/ol&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/7/c/27c62056e13cc9ba6d2455dd467aaf0a.png&quot; alt=&quot;P = \frac{2r}{n-1}&quot; /&gt;&lt;figcaption&gt;P = \frac{2r}{n-1}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h4 id=&quot;correlates-of-differential-rates&quot;&gt;correlates of differential rates&lt;/h4&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Apply Felsenstein pruning algorithm to calc likelihood and hence fit model this is just the definition of a joint probability!&lt;/li&gt;
&lt;li&gt;Use this to estimate the model, then do rejection sampling to create the tree painting. as in &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/12396587&quot; title=&quot;pmid:12396587&quot;&gt;Nielsen &amp;amp; Yang 2002&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This is applied to differential rates question in &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/pubmed/16396171&quot; title=&quot;pmid:16396171&quot;&gt;Ree et. al. 2005&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Simply ask if group A or B observed more branching events along the stochastic map. Compare to a null that randomizes the branch lengths as waiting times under pure yule model.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Methinks&lt;/em&gt; this creates null trees that violate the coalescent pattern of longer branches near the base, but guess Yule is the opposite of coalescent anyway…&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Comparison method: Moore’s cross-validation approach: split tree into two parts, generate background rate from one, use that rate to create a distribution, of possible outcomes and compare that distribution to the observed rate in the test clade. Also handle uncertainty in the time of the rate transition, (Bayesian). Good when traits fall out in clades.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Methinks&lt;/em&gt; should compare the two-rate directly to the single rate fitted to the entire tree, for completeness.&lt;/li&gt;
&lt;li&gt;Wonder where else we should start trying cross-validation approaches in comparative methods. Perhaps in comparison to the OU(LP) Anoles painting approach?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Trickle-down problem – one rapid clade can inflate the score farther down the tree.&lt;/li&gt;
&lt;li&gt;AIC comparison of assigning different shift points.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;r88s&quot;&gt;r88s&lt;/h4&gt;
&lt;p&gt;Parameter estimation Bayesian approach to explore shifts in diversification rate via DPP!&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Community Phylogenetics Sharon Strauss, Jean Burns&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Community_Phylogenetics&quot; title=&quot;http://bodegaphylo.wikispot.org/Community_Phylogenetics&quot;&gt;Details on Bodega Wiki&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Community assembly: Niche, History, or random?
&lt;ul&gt;
&lt;li&gt;(Janzen Connell hypothesis of diversity optimal radius in seed-shadow for recruitment)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;build a tree of a regional species pool&lt;/li&gt;
&lt;li&gt;build a tree of local community&lt;/li&gt;
&lt;li&gt;generate null comunities&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt; - &lt;em&gt;Methinks&lt;/em&gt; Not robust to incomplete sampling of the community phylogenetics null model vs comparative trait methods&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Null distribution should be generated by the non-interacting model!!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Phylocom tutorial&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;thoughts-ideas-scratch-pad&quot;&gt;Thoughts &amp;amp; Ideas scratch pad&lt;/h2&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Density dependent estimates&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Levins model (logistic) style: &lt;img src=&quot;http://openwetware.org/images/math/f/a/4/fa43e4271b9fd0673552b69b447d9860.png&quot; alt=&quot;\dot n = b n (S - n) - e n&quot; /&gt;&lt;/p&gt;
&lt;p&gt;calculate probability n conditional on non-extinction for remaining time. let’s start by assuming stationarity across whole tree. Then the number of lineages observed at time &lt;em&gt;t&lt;/em&gt; should decrease exponentially. This pattern looks just like the pure birth model or the constant rates model. When this pattern ceases to hold, we’re out of the realm of constant rates and we head into the dynamic model. What should be the signal? slower than exponential fall-off.&lt;/p&gt;
&lt;p&gt;ha, we often look for the other pattern – accelerating rates.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Community phylogenetics should generate nulls under evolutionary models, not random reshuffling.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;(Will develop this further. Also, evening session to focus on Labrid analysis, general research progress).&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Bodega Workshop Day 4</title>
	 <link href="/2010/03/10/Bodega-Workshop-Day-4.html"/>
   <updated>2010-03-10T00:00:00+00:00</updated>
   <id>/03/10/Bodega-Workshop-Day-4</id>
   <content type="html">&lt;p&gt;Morphological Evolution Day:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Peter Wainwright&lt;/li&gt;
&lt;li&gt;Sam Price&lt;/li&gt;
&lt;li&gt;Johnathan Eisen&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We have the afternoon session off for field trips and research.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### Peter Wainwright, Comparative Analysis of Morphological Diversity&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fantastic diversity in morphology, corresponds to niche! But morphological diversity isn’t evenly distributed across tree of life. (See slides, parallels Peter’s section on core and gives the best biological coverage we’ve had this week).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What changes morphological diversification rate&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Intrinsic factors&lt;/strong&gt; functional innovations (endothermy, flight), decoupling (gene duplication, pharangial jaws), increased complexity (new parts), loss in complexity (parasitoid/parasite examples – perhaps this hasn’t been well studied in phylogenetic context?)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Extrinsic factors:&lt;/strong&gt; change adaptive landscape, invade new geography, new community composition, sexual selection.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How about traits that constrain morphological diversification rate?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Disparity as a measure of diversity. Are Galapagos finches more diverse than mainland finches? Does disparity always increase?&lt;/li&gt;
&lt;li&gt;Brian Moore comments on interface between rates of lineage diversfication and increases in trait disparity.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;samantha-price-brownie-tutorial&quot;&gt;Samantha Price, brownie tutorial&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Does the one-rate or two-rate model fit the data best?&lt;/li&gt;
&lt;li&gt;My version of the question: can the data discriminate between a one-rate and two-rate model?
&lt;ul&gt;
&lt;li&gt;(based on Sam’s analogy explanation of OU, Justen jests: implementation of brownian motion is sort of like jumping of a bridge, minus the bungie cord (but assuming no ground). )&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Discusses the censored rate tests vs non-censored. (painted).&lt;/li&gt;
&lt;li&gt;Brownie implementation accomplishes hansen fits of ouch, and also brownian motion.&lt;/li&gt;
&lt;li&gt;Brownie and ouch make alpha and sigma globals, so can’t compare across trees. some other stuff out there has started to do that.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;jonathan-eisen-microbial-phylogenomics&quot;&gt;Jonathan Eisen, Microbial Phylogenomics&lt;/h3&gt;
&lt;p&gt;8p&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;No such thing as a core set of genes in bacteria. More genomes you look at, the smaller the overlap.&lt;/li&gt;
&lt;li&gt;16s: good but not perfect – comparisons to whole genome trees!&lt;/li&gt;
&lt;li&gt;Gene function as evolutionary character state, not distance (BLAST). Infer ancestral states on functions on &lt;em&gt;phylogram&lt;/em&gt; trees! Eisen 1998 Genome Res.&lt;/li&gt;
&lt;li&gt;Non-homology functional prediction methods, phylogenetic profiling.&lt;/li&gt;
&lt;li&gt;Michael Eisen assembled the complete wolbachia genome from within the drosphilia genome… Many assemblies of symbiont genomes from the host sequencing project.&lt;/li&gt;
&lt;li&gt;Kelly’s comment: many can’t be cultured do to dependence on other bacteria in the community. How can we measure ecological interactions? (Brilliant example of ecological thinking often missing from microbial research).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Research Progress —————–&lt;/p&gt;
&lt;h3 id=&quot;bodega-project&quot;&gt;Bodega Project&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Began basic data import and exploration. Some notes are available on my &lt;a href=&quot;http://bodegaphylo.wikispot.org/Users/Carl&quot; title=&quot;http://bodegaphylo.wikispot.org/Users/Carl&quot;&gt;Bodega page&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Wrote an R function using geiger’s name.check function that will take a tree and traits and return only a pruned tree and pruned dataset that contains only species that are both on the tree and have trait data.&lt;/li&gt;
&lt;li&gt;Divided continuous data into discrete categories based on my new maximum likelihood function. Ancestral state reconstruction on discretized fin angle:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/b/b7/Discrete.png/600px-Discrete.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;adaptive-landscapes-from-trees&quot;&gt;Adaptive landscapes from trees&lt;/h3&gt;
&lt;p&gt;Going after fitting the stationary distribution of the Discretizing a continuous trait involves an arbitrary threshhold. Should be able to fit a multi-regime model to the data, and estimate the number of regimes. Important that this uses the joint stationary distribution of the multiregime model, rather than first assigning points to regimes.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;specify the model&lt;/li&gt;
&lt;li&gt;evaluate density of the model at the location of each data point&lt;/li&gt;
&lt;li&gt;product of all these densities (sum the log densities)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;10am&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tried exploring packages on &lt;a href=&quot;http://cran.r-project.org/web/packages/&quot; title=&quot;http://cran.r-project.org/web/packages/&quot;&gt;CRAN&lt;/a&gt; for clustering an Bayesian clustering. There are several but none seem to take the approach I would like. Should be easy enough to write myself in R or C. Beginning the prototype in R.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;1:30pm&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Implemented the two regimes model in R using Nelder-Mead search for optimum thetas and sigmas.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;scratch-pad-random-thoughts-and-ideas&quot;&gt;Scratch pad: random thoughts and ideas&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Consider writeup/talk on evaluating a method (at least in comparative context) Why this should happen before and independent of testing with data.&lt;/li&gt;
&lt;li&gt;How well could we formulate Peter’s take on morphological diversification directly into models? Could we then derive approximations to those descriptions that resemble / disagree with Brownian motion?&lt;/li&gt;
&lt;li&gt;Picking units successfully is crucial to comparing diversification rates, particularly across broad phylogenies.&lt;/li&gt;
&lt;li&gt;Independence of traits / base-pairs in sequence alignment, things that create correlation, things that remove it. OU weakens the time/disparity correlation, introduces new reason for traits to be correlated (other than phylogeny).&lt;/li&gt;
&lt;li&gt;Rich Glor introduced me to &lt;a href=&quot;http://treethinkers.blogspot.com/&quot; title=&quot;http://treethinkers.blogspot.com/&quot;&gt;dechronization&lt;/a&gt;, excellent source of ideas in the field.&lt;/li&gt;
&lt;li&gt;Added several ideas, partly inspired by today’s lecture, onto my newly created &lt;a href=&quot;http://phylogenetics.uservoice.com/forums/43843-general&quot; title=&quot;http://phylogenetics.uservoice.com/forums/43843-general&quot;&gt;idea forum&lt;/a&gt; for phyologenetic comparative methods. Several have been started.&lt;/li&gt;
&lt;li&gt;Should be able to infer the painting under BM&lt;/li&gt;
&lt;li&gt;Simmap – a proprietary license, runs only on OSX, and only creates simulated output. Ought to translate this into R.&lt;/li&gt;
&lt;li&gt;MK1, Jukes-Cantor, can’t believe we use arbitrary names to specify different finite state continuous time Markov processes. Can’t we just specify the dimension and the level of symmetry imposed?&lt;/li&gt;
&lt;li&gt;Would be great to have the Bodega wiki hosted/mirrored locally to deal with the limited bandwidth here.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Bodega Phylogenetics Workshop Day 3</title>
	 <link href="/2010/03/09/Bodega-Phylogenetics-Workshop-Day-3.html"/>
   <updated>2010-03-09T00:00:00+00:00</updated>
   <id>/03/09/Bodega-Phylogenetics-Workshop-Day-3</id>
   <content type="html">&lt;h2 id=&quot;rich-glor-character-evolution&quot;&gt;Rich Glor, Character Evolution&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Discrete_Character_Evolution_%28Glor%29_2010&quot; title=&quot;http://bodegaphylo.wikispot.org/Discrete_Character_Evolution_%28Glor%29_2010&quot;&gt;Official slides and tutorial&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Weakness of ancestral state reconstruction
&lt;ul&gt;
&lt;li&gt;Cunningham 1999&lt;/li&gt;
&lt;li&gt;Losos 1999&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Testing hypotheses with ancestral reconstruction
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Parsimony&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Farris method. Downward/upward pass. Gives a maximum parsimony reconstruction. May miss other ones.&lt;/li&gt;
&lt;li&gt;Apparently this Parsimony analysis can be done for continuous traits as well, needs a measure of distance&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Likelihood&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Pagel 1994&lt;/li&gt;
&lt;li&gt;Schluter 1997&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;r-tutorial&quot;&gt;R tutorial&lt;/h3&gt;
&lt;p&gt;(see anolis_cheat.R)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Discrete trait ancestral state reconstruction
&lt;ul&gt;
&lt;li&gt;Wouldn’t it be nice to have functions that applied Rich’s awesome plots to any data? Segway to writing functions&lt;/li&gt;
&lt;li&gt;Wouldn’t a zoomable updatable plot interface be nice? update plot fn and cairo pdf.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Testing for phylogenetic signal
&lt;ul&gt;
&lt;li&gt;Lambda: rescale all internal branches by a factor of lambda.&lt;/li&gt;
&lt;li&gt;Compare likelihood of output under rescaled and original trees.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;The model for these is a single constant rate of transition between all states. Wondering what would happen if we didn’t refit the model to each tree but simply compared the likelihood of the model fit to the original tree when analyzed with the dataset on the modified tree.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;carl-boettiger-useful-software&quot;&gt;Carl Boettiger: useful software&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;I gave a 20 minute introduction to subversion and Mendeley.
&lt;ul&gt;
&lt;li&gt;Gave a demonstration on using subversion with MrBayes. Useful example, but should have emphasized the generality. Also didn’t have a chance to demonstrate the rapidsvn GUI.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;I’ve added information about &lt;strong&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Version_Management&quot; title=&quot;http://bodegaphylo.wikispot.org/Version_Management&quot;&gt;using subversion&lt;/a&gt;&lt;/strong&gt; to the Bodega wiki.
&lt;ul&gt;
&lt;li&gt;Settled on rapidsvn as the suggested GUI, even though I’m not totally happy with it. The kdesvn gui seems a better choice for linux, but rapidsvn works on all platforms and has an &lt;a href=&quot;http://www.rapidsvn.org/index.php/Main_Page&quot; title=&quot;http://www.rapidsvn.org/index.php/Main_Page&quot;&gt;excellent guide.&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; Justin Whittall: cts character traits ————————————-&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Continuous_Character_Evolution_%28Whittall%29_2010&quot; title=&quot;http://bodegaphylo.wikispot.org/Continuous_Character_Evolution_%28Whittall%29_2010&quot;&gt;Official slides and tutorial&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Check out the Charlie Nunn Papers.&lt;/li&gt;
&lt;li&gt;Compare incoperates uncertainty in the species means.&lt;/li&gt;
&lt;li&gt;Are contrasts standardized by branch length? Absolute value of contrast independent of standard deviation of contrast? If not, transform data..&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; My Thoughts and Explorations for the Day —————————————-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Many analyses are not explicit about the model used and the assumptions it involves!&lt;/li&gt;
&lt;li&gt;Not happy with the independence assumption on columns of the alignment in DNA data. We can quantify the predictive capacity of that information…&lt;/li&gt;
&lt;li&gt;Rich Glor’s likelihood test under Pagel’s lambda. seems a strange thing to do, what does it actually mean?&lt;/li&gt;
&lt;li&gt;Need to explore the later applications of independent contrasts further.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;research-progress&quot;&gt;Research Progress&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Figuring out strange behavior in ouch. the value kept at model@alpha is actually the &lt;a href=&quot;http://en.wikipedia.org/wiki/Cholesky_decomposition&quot; title=&quot;http://en.wikipedia.org/wiki/Cholesky_decomposition&quot;&gt;Cholesky decomposition&lt;/a&gt; of the alpha matrix, just as the values of sigma are the Cholesky decomposition of the σ&lt;sup&gt;2&lt;/sup&gt; matrix. This seems like a strange convention, surely the user would rather specify the matrices as full matrices and let the software do the decomposition? Because this decomposes matrix &lt;em&gt;M&lt;/em&gt; into &lt;em&gt;M&lt;/em&gt; = *L**L*&lt;sup&gt;&lt;em&gt;T&lt;/em&gt;&lt;/sup&gt;, for single trait value alpha is a scalar and this is the square root. sym.par() function in ouch is often called in the source to assemble M from the decomposition…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Bodega Phylogenetics Workshop Day 2</title>
	 <link href="/2010/03/08/Bodega-Phylogenetics-Workshop-Day-2.html"/>
   <updated>2010-03-08T00:00:00+00:00</updated>
   <id>/03/08/Bodega-Phylogenetics-Workshop-Day-2</id>
   <content type="html">&lt;p&gt;Marine lab researchers are back, and network speeds have just about given up (down to bytes/s). This post is composed offline and will be uploaded to the notebook. Details are well logged on the &lt;a href=&quot;http://bodegaphylo.wikispot.org&quot; title=&quot;http://bodegaphylo.wikispot.org&quot;&gt;Bodgea Phylogenetics Wiki&lt;/a&gt; so these are reasonably sketchy with my comments.&lt;/p&gt;
&lt;h3 id=&quot;my-updates-to-bodega-phylogenetics-wiki&quot;&gt;My Updates to Bodega Phylogenetics Wiki&lt;/h3&gt;
&lt;p&gt;Made several contributions to the Bodega Phylogenetics Wiki today:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Users/Carl&quot; title=&quot;http://bodegaphylo.wikispot.org/Users/Carl&quot;&gt;User page&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Phylogenetics_on_Linux&quot; title=&quot;http://bodegaphylo.wikispot.org/Phylogenetics_on_Linux&quot;&gt;Phylogenetics on Linux&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Becoming_a_programmer&quot; title=&quot;http://bodegaphylo.wikispot.org/Becoming_a_programmer&quot;&gt;Becoming a Programmer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Advice_for_Aspiring_Phylogeneticists&quot; title=&quot;http://bodegaphylo.wikispot.org/Advice_for_Aspiring_Phylogeneticists&quot;&gt;Edits on Advice for Aspiring Phylogeneticists&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;todays-agenda&quot;&gt;Today’s agenda&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;BEAST continued. (Brian Moore)&lt;/li&gt;
&lt;li&gt;Species Tree and Gene Trees (Bob Thompson)&lt;/li&gt;
&lt;li&gt;RAxML Tutorial (Greg Pauly)&lt;/li&gt;
&lt;li&gt;Model selection and MCMC diagnosis (Brian Moore)&lt;/li&gt;
&lt;li&gt;R tutorial (Rich Glor)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;brian-moore-beast&quot;&gt;Brian Moore: BEAST&lt;/h2&gt;
&lt;p&gt;8:30 - 9:30a Diving into the XML and actually running BEAST. &lt;a href=&quot;http://bodegaphylo.wikispot.org/Divergence_Time_Estimation_%28Moore%29&quot; title=&quot;http://bodegaphylo.wikispot.org/Divergence_Time_Estimation_%28Moore%29&quot;&gt;Wiki page.&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;bob-thompson-species-tree-vs-gene-tree&quot;&gt;Bob Thompson: Species Tree vs Gene Tree&lt;/h2&gt;
&lt;p&gt;9:45&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Coalescent! Why don’t species tree and gene tree agree?&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Incomplete Coalescence (&lt;strong&gt;Typically we focus on this.&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;Gene duplication&lt;/li&gt;
&lt;li&gt;Horizontal transfer&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Differences are common and Widespread! Pollard et. al. (2006), PMID:17132051&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Gene_Trees/Species_Trees_2010&quot; title=&quot;http://bodegaphylo.wikispot.org/Gene_Trees/Species_Trees_2010&quot;&gt;slides&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BEST&lt;/strong&gt;: Bayesian Estimation of Species Trees Works with MrBayes, build on MrBayes&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Generating_Species_Trees_with_BEST&quot; title=&quot;http://bodegaphylo.wikispot.org/Generating_Species_Trees_with_BEST&quot;&gt;Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;greg-pauly-raxml&quot;&gt;Greg Pauly, RAxML&lt;/h2&gt;
&lt;p&gt;Really large trees can be done no other way. (Garli works, but doesn’t permit partitions or amino acid based inference).&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/RAxML_Tutorial_%28Pauly%29&quot; title=&quot;http://bodegaphylo.wikispot.org/RAxML_Tutorial_%28Pauly%29&quot;&gt;Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;rich-glor-introduction-to-r&quot;&gt;Rich Glor, Introduction to R&lt;/h2&gt;
&lt;p&gt;1:30 p&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; “We’re going into combat, but we’re not the Marines. The Marines have this slogan &lt;em&gt;Leave no man behind.&lt;/em&gt; This isn’t like that.” -R. Glor&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Phylogenetics_and_Comparative_Methods_in_R&quot; title=&quot;http://bodegaphylo.wikispot.org/Phylogenetics_and_Comparative_Methods_in_R&quot;&gt;Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;brian-moore-model-selection-and-mcmc-diagnosis&quot;&gt;Brian Moore, Model Selection and MCMC diagnosis&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/Model_Selection&quot; title=&quot;http://bodegaphylo.wikispot.org/Model_Selection&quot;&gt;slides&lt;/a&gt; Estimation under the prior alone!&lt;/p&gt;
&lt;p&gt;Brian’s scripts for keeping track of what parameters he’s tried. Very interesting idea.&lt;/p&gt;
&lt;p&gt;(We didn’t actually get through all 181 slides…)&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Bodega Phylogenetics Workshop Day 1</title>
	 <link href="/2010/03/07/Bodega-Phylogenetics-Workshop-Day-1.html"/>
   <updated>2010-03-07T00:00:00+00:00</updated>
   <id>/03/07/Bodega-Phylogenetics-Workshop-Day-1</id>
   <content type="html">&lt;p&gt;Lecture notes for the phyolgenetics workshop. These are taken in real time, so may contain errors. I’ll see if I keep this up throughout the course. See &lt;a href=&quot;http://bodegaphylo.wikispot.org/2010_Workshop&quot; title=&quot;http://bodegaphylo.wikispot.org/2010_Workshop&quot;&gt;course website.&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;huelsenbeck&quot;&gt;Huelsenbeck&lt;/h3&gt;
&lt;p&gt;9a-11a&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Parameters θ&lt;/li&gt;
&lt;li&gt;Observation &lt;em&gt;X&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;p&lt;/em&gt;(&lt;em&gt;X&lt;/em&gt; | θ) is known as the &lt;em&gt;likelihood.&lt;/em&gt; Adjust parameter to maximize likelihood.&lt;/li&gt;
&lt;li&gt;Coin toss example&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;θ = prob of heads on a single toss of a coin, &lt;em&gt;X&lt;/em&gt; is # of heads observed on &lt;em&gt;n&lt;/em&gt; tosses. Choose a model: binomial:&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/0/8/8/08814f7faf92d830f210e2d233344ecd.png&quot; alt=&quot;p(x|\theta) = {n \choose{x}} \theta^x ( 1-\theta)^{n-x}&quot; /&gt;&lt;figcaption&gt;p(x|\theta) = {n \choose{x}} \theta^x ( 1-\theta)^{n-x}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Maximize likelihood, find &lt;img src=&quot;http://openwetware.org/images/math/d/9/3/d93b13daa45e31c971a3b81deedcbc22.png&quot; alt=&quot;\hat \theta = \frac{x}{n}&quot; /&gt;&lt;/li&gt;
&lt;li&gt;Bayesian&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/8/1/0/810d3eb56ca4c96ecbe28c931a57bdc0.png&quot; alt=&quot;p(\theta | x) = \frac{p(x|\theta)p(\theta)}{p(x)}&quot; /&gt;&lt;figcaption&gt;p(\theta | x) = \frac{p(x|\theta)p(\theta)}{p(x)}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;likelihood times prior over marginal equals the posterior. The prior is the source of controversy, though mathematically required if you want a posterior probability.&lt;/p&gt;
&lt;p&gt;The marginal can be hard to solve. &lt;img src=&quot;http://openwetware.org/images/math/c/2/e/c2ec8ba5b21c63d5aa3063012cd7ea2b.png&quot; alt=&quot;\int_0^1 p(x|\theta) p(\theta) d\theta&quot; /&gt;&lt;/p&gt;
&lt;p&gt;So Bayesians solved trivial problems or just estimated moments (mean, etc), until along came MCMC and they could do these integrals…&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Phylogenetic Model&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Parameters: Tree. (comments on notation). Life is more simple than you think: all phylogenetic models are continuous time Markov models&lt;/li&gt;
&lt;li&gt;“Observations:” could be:
&lt;ul&gt;
&lt;li&gt;Alignment (note that it’s not actually observed, it’s an inference from the chronogram from the sequencer! we’ll ignore that.)&lt;/li&gt;
&lt;li&gt;Character matrix&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Calculate the &lt;strong&gt;probability of alignment given a tree?&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(Lecture moves to &lt;a href=&quot;http://bodegaphylo.wikispot.org/Bayesian_Phylogenetics_(Huelsenbeck)_2010&quot; title=&quot;http://bodegaphylo.wikispot.org/Bayesian_Phylogenetics_(Huelsenbeck)_2010&quot;&gt;slides&lt;/a&gt;, will probably ve available on Bodega Wiki?)&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Summing over all possible combinations literally is crazy. Felsenstein Pruning algorithm (sum-product algorithm from graphical models) makes this much faster (many of those trees are related).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“This is the exponential distribution, it is the only distribution you’ll see/need in this course”&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;moments later…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;“This is the gamma distribution, it is the only distribution you’ll need”&lt;/li&gt;
&lt;li&gt;“Oh, and this is the Poisson distribution.”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; &lt;em&gt;Dice activity: Exact simulation of finite-state continuous time Markov process&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Interesting hands-on activity to demonstrate Gillespie algorithm simulation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Substitution_model&quot; title=&quot;http://en.wikipedia.org/wiki/Substitution_model&quot;&gt;&lt;strong&gt;Codon models&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(Note, this wiki entry should be expanded).&lt;/li&gt;
&lt;li&gt;Sequence model, sparse matrices with arbitrary correlations. Approximate pruning via MCMC.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rate variation across sites.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;Approximate the gamma by likelihood catagories, using the mean of a catagory.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;&lt;em&gt;l&lt;/em&gt;&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt; =&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;∑&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;&lt;em&gt;p&lt;/em&gt;(&lt;em&gt;x&lt;/em&gt;&lt;sub&gt;&lt;em&gt;i&lt;/em&gt;&lt;/sub&gt; | &lt;em&gt;x&lt;/em&gt;) / &lt;em&gt;k&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;&lt;em&gt;k&lt;/em&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;Heterotachy – different models on different parts of the tree.&lt;/li&gt;
&lt;li&gt;Nielsen &amp;amp; Yang 1998&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Jeremy Brown, Mr. Bayes&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Using Mr. Bayes&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Can’t calculate the marginal probability. Luckily, in ratio that normalizing constant cancels out: So we can find the ratio of posterior probabilities. This is where MCMC comes in.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/MrBayes_Tutorial_%28Brown%29?sendfile=true&amp;amp;file=Brown_MrBayes_Lecture.pdf&amp;amp;download=true&quot; title=&quot;http://bodegaphylo.wikispot.org/MrBayes_Tutorial_%28Brown%29?sendfile=true&amp;amp;file=Brown_MrBayes_Lecture.pdf&amp;amp;download=true&quot;&gt;See the slides&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;rannala-divergence-times&quot;&gt;Rannala, Divergence Times&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Molecular clock and fossil dating&lt;/li&gt;
&lt;li&gt;branch lengths as estimates&lt;/li&gt;
&lt;li&gt;Bayesian approaches to contain this uncertainty, given sequences times and fossil calibrations:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/e/2/d/e2df7c8faa415cdefa1b5bab5e8f7472.png&quot; alt=&quot;f(\theta, t, u | X) = \frac{f(X|t,u,\theta)f(u|\theta) f(t| \theta) f(\theta) }{f(X)}&quot; /&gt;&lt;figcaption&gt;f(\theta, t, u | X) = \frac{f(X|t,u,\theta)f(u|\theta) f(t| \theta) f(\theta) }{f(X)}&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;substitution rate (clock) &lt;em&gt;u&lt;/em&gt;, branch length &lt;em&gt;v&lt;/em&gt;, age &lt;em&gt;t&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Prior for the divergence times. Priors from fossils. Dangers of hard bounds (will confidently predict the wrong answer).&lt;/p&gt;
&lt;p&gt;When do you have enough DNA sequence that your divergence estimate becomes limited only by fossil age uncertainty? Regress width of posterior distribution for divergence times against the mean. Once that regression is sufficiently tight, more DNA data won’t help.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Irregular Molecular clocks&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Tom Near, Rocks for Gel Jocks&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;(a.k.a) BEAST tutorial&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://bodegaphylo.wikispot.org/BEAST_Tutorial_(Near)&quot; title=&quot;http://bodegaphylo.wikispot.org/BEAST_Tutorial_(Near)&quot;&gt;slides&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Ideas/Topics ————&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Reaching the developers&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Help lists.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://phylogenetics.uservoice.com/&quot; title=&quot;http://phylogenetics.uservoice.com/&quot;&gt;uservoice&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;stackoverflow for phylogenetics?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Managing the literature: &lt;a href=&quot;http://www.mendeley.com&quot; title=&quot;http://www.mendeley.com&quot;&gt;Mendeley&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.mendeley.com/research-papers/collections/1369391/PhylogeneticComparativeMethods/&quot; title=&quot;http://www.mendeley.com/research-papers/collections/1369391/PhylogeneticComparativeMethods/&quot;&gt;Phylogenetic Comparative Methods&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Poll faculty for useful software,tools or tricks. Attempt a talk: &lt;em&gt;5 minutes, 5 tools to change your life.&lt;/em&gt;
&lt;ul&gt;
&lt;li&gt;Mendeley: an itunes for your pdfs, pandora for the literature.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Thoughts/things to investigate or share&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When, if ever, can you actually fit a model with trending rate changes over time. i.e. can we really detect accelerating BM in character evolution?&lt;/li&gt;
&lt;li&gt;Common intuitive mechanisms that generate the familiar distributions. Exponential, Poisson, Gamma, Normal, Log Normal, Binomial, Uniform, Dirchlet.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Meeting</title>
	 <link href="/2010/03/05/Meeting.html"/>
   <updated>2010-03-05T00:00:00+00:00</updated>
   <id>/03/05/Meeting</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Basically I want to apply central limit theorem for stationary processes (accounts for covariances), assuming mean zero&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/1/4/1/141abb117709d04302d240f2cbbf2df6.png&quot; alt=&quot;\frac{X_1 + … + X_n}{\sqrt{\sigma^2 n}} \propto N(0,1)&quot; /&gt;&lt;figcaption&gt;\frac{X_1 + … + X_n}{\sqrt{\sigma^2 n}} \propto N(0,1)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/2/b/7/2b7baf7dc6d72616ccd1a5d72d4323cf.png&quot; alt=&quot;\sigma^2 = E X^2 + 2 \sum_{i,j}^n Cov(X_i, X_j)&quot; /&gt;&lt;figcaption&gt;\sigma^2 = E X^2 + 2 \sum_{i,j}^n Cov(X_i, X_j)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Discussion of &lt;a href=&quot;http://en.wikipedia.org/wiki/Freidlin%E2%80%93Wentzell_theorem&quot; title=&quot;http://en.wikipedia.org/wiki/Freidlin%E2%80%93Wentzell_theorem&quot;&gt;Freidlin-Wentzell&lt;/a&gt; theory in connection to Arrhenius law and the well-defined stochastic tipping point which occurs before the branch point.&lt;/li&gt;
&lt;li&gt;Kurtz results don’t really help in the case of ergodicity, can make statements about the (even non-stationary) ensemble limit.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Friday</title>
	 <link href="/2010/03/05/Friday.html"/>
   <updated>2010-03-05T00:00:00+00:00</updated>
   <id>/03/05/Friday</id>
   <content type="html">&lt;p&gt;11a Sebastian Meeting (see Stochastic Population Dynamics Notebook)&lt;/p&gt;
&lt;p&gt;12p - 1p&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lunch talk in joint lab group (Schreiber Coop Moore Rannala Eisen) on coalescents for wARG. Remember to check out kcachegrind as interface to valgrind and profiler, and also mauve as a dynamic sequence alignment display tool.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;comparative-phylogenetics-discussion-group&quot;&gt;Comparative Phylogenetics Discussion group&lt;/h2&gt;
&lt;p&gt;4-5p. Discussing:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=20133569&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Van Bocxlaer I, Loader SP, Roelants K, Biju SD, Menegon M, and Bossuyt F. .&lt;/a&gt; pmid:20133569. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=20133569&quot; title=&quot;PMID 20133569&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=20133569&quot; title=&quot;PMID 20133569&quot;&gt;HubMed&lt;/a&gt; [VanBocxlaer2010]&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Big Picture Comparative Phylogenetics</title>
	 <link href="/2010/03/04/Big-Picture-Comparative-Phylogenetics.html"/>
   <updated>2010-03-04T00:00:00+00:00</updated>
   <id>/03/04/Big-Picture-Comparative-Phylogenetics</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;A &lt;a href=&quot;http://www.bio.unc.edu/faculty/vision/lab/CPM_taskview.html&quot; title=&quot;http://www.bio.unc.edu/faculty/vision/lab/CPM_taskview.html&quot;&gt;Task View&lt;/a&gt; on Phylogenetic Comparative Methods (in R on CRAN) has been released today, maintained by Brian O’Meara. Quite thorough and concise.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Follow-up discussion on:
&lt;ul&gt;
&lt;li&gt;List is useful, but would be nice to be able to expand / collapse the list to see more / less details about the functions available. More detail makes it harder to maintain, perhaps get the developers involved?&lt;/li&gt;
&lt;li&gt;List is also quite provocative source to realize what’s missing (there’s no way to estimate ancestral states under OU using existing software?) I’m interested in exploring a way users could both suggest and then rank / vote for certain requests to be implemented, in the style of &lt;a href=&quot;http://www.uservoice.com&quot; title=&quot;http://www.uservoice.com&quot;&gt;uservoice&lt;/a&gt; or &lt;a href=&quot;http://www.stackoverflow.com&quot; title=&quot;http://www.stackoverflow.com&quot;&gt;stackoverflow&lt;/a&gt;. Piloting an &lt;a href=&quot;http://phylogenetics.uservoice.com&quot; title=&quot;http://phylogenetics.uservoice.com&quot;&gt;example of this&lt;/a&gt; during the phylogenetics workshop at Bodega.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;1:30 pm Meeting with &lt;a href=&quot;http://www.yale.edu/eeb/near&quot; title=&quot;http://www.yale.edu/eeb/near&quot;&gt;Tom Near&lt;/a&gt;, visiting from Yale. Chance to discuss both projects in this notebook:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Inferring multistate optima and transitions.&lt;/li&gt;
&lt;li&gt;Assessing power in trees; bootstrapping model fits.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;2pm 4pm Installing software for &lt;a href=&quot;http://bodegaphylo.wikispot.org/2010_Workshop&quot; title=&quot;http://bodegaphylo.wikispot.org/2010_Workshop&quot;&gt;Bodega Phylogenetics Workshop next week&lt;/a&gt;. Some packages are Linux friendly, others less so. Java packages are particularly useful/reliable as cross-platform apps.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;BEAST – Java&lt;/li&gt;
&lt;li&gt;BEST – C compiles fine with make.&lt;/li&gt;
&lt;li&gt;Brownie – C++ won’t compile (no configure script)&lt;/li&gt;
&lt;li&gt;FigTree - Java&lt;/li&gt;
&lt;li&gt;Garli – C++, requires Nexus Class Library installed (C++ library which installs fine with configure, make, make install). However Garli still refuses to compile with enough errors to make me feel a header file is missing (things undefined, stdio.h undeclared, etc).&lt;/li&gt;
&lt;li&gt;Mesquite – Java&lt;/li&gt;
&lt;li&gt;Phylocom – R, src (in C, which compiles fine with make), directory also contains Win and Mac binaries&lt;/li&gt;
&lt;li&gt;MrBayes – Is in the Ubuntu repositories, just apt-get it. Rock on!&lt;/li&gt;
&lt;li&gt;RaxML – C, just run the gcc version of the makefile. Haven’t tried the MPI version&lt;/li&gt;
&lt;li&gt;Tracer – Java&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; * * * * *&lt;/p&gt;
&lt;p&gt;4pm EVE Seminar: Tom Near&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Antarctic fishes as an example of an adaptive radiation. Fossil record shows cosmopolitian mix of species: skates, labrids, sharks, cods. At the time the continent was farther north and warmer (geological record and δO&lt;sub&gt;18&lt;/sub&gt; isotope describes temperature.) Mass extinction, followed by invasion of this antarctic group with protein for antifreeze that rapidly radiates into dominant fish diversity form in the region. Strong result for much faster speciation relative to nearby groups.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Solution to the strange behavior in ouch</title>
	 <link href="/2010/03/03/Solution-to-the-strange-behavior-in-ouch.html"/>
   <updated>2010-03-03T00:00:00+00:00</updated>
   <id>/03/03/Solution-to-the-strange-behavior-in-ouch</id>
   <content type="html">&lt;p&gt;Looks like my troubles actually stem from a bug in the code. I summarize the problem here, just as I posted in my query to R sig phylo. Essentially the program erroneously squares alpha at the moment, explaining the pattern I found yesterday. Giving it root alpha preemptively should be a good work around.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ~&lt;sub&gt;~&lt;/sub&gt; {.de1} data(bimac) tree &amp;lt;- with(bimac,ouchtree(node,ancestor,time/max(time),species)) print(h2 &amp;lt;- hansen(log(bimac[‘size’]),tree,bimac[‘OU.1’],alpha=1,sigma=1)) ~&lt;sub&gt;~&lt;/sub&gt;&lt;/p&gt;
&lt;p&gt;The print command says alpha = 0.1921554 The call h2@alpha says alpha = .4383554&lt;/p&gt;
&lt;p&gt;which is the sqrt of the other. Certainly these should all agree. The summary command agrees with the print command:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;smry = summary(h2)
smry$alpha&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A little exploration seems to show that the print command is the correct one. If we want to simulate a model with a particular alpha value, we first have to generate a fitted model as above, then update the alpha value and call simulate on the fitted model. I believe ouch is accidentally squaring the value of alpha we give it before running the simulation. For example:&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; h2@alpha = 5
&amp;gt; replicates &amp;lt;- as.data.frame(simulate(h2, 1000))
&amp;lt;/syntax&amp;gt;
 
I find the expected variance by averaging the variance across the replicates,
 
&amp;lt;syntaxhighlight&amp;gt;
&amp;gt; mean(sapply(1:1000, function(i){var(replicates[i], na.rm=T)} ) )
[1] 0.0009774488&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So did it use 5 or 25 as the alpha value? Since either value is large compared to the length of the tree, the tip variance should be stationary independent of tree structure so we can check it against the analytic predicted variance (sigma^2/2 alpha):&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; (h2@sigma)^2/(2*h2@alpha)
[1] 0.004836469
&amp;gt; (h2@sigma)^2/(2*(h2@alpha)^2)
[1] 0.0009672938&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As the second equation agrees with the simulation, it believe that ouch has erroneously squared the value of alpha in the simulation.&lt;/p&gt;
&lt;h2 id=&quot;limits-to-power-in-trees&quot;&gt;Limits to Power in Trees&lt;/h2&gt;
&lt;p&gt;Now that I’m sure I can compare apples to apples (matching stationary distributions), I can finally perform my intended comparison.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;First, confirm that the distributions generated by the models on the star tree are indistinguishable:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/2/2e/Star_tree_likelihoods.png&quot; alt=&quot;Image:Star_tree_likelihoods.png&quot; /&gt;&lt;figcaption&gt;Image:Star_tree_likelihoods.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Next, the same models are distinguishable on the Felsenstein Tree:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/1/18/Fels_tree_likelihoods.png&quot; alt=&quot;Image:Fels_tree_likelihoods.png&quot; /&gt;&lt;figcaption&gt;Image:Fels_tree_likelihoods.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Here α = 1 and σ = 3&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Intuition at the moment:&lt;/strong&gt; The longer the two branches before the polytome in the Felsenstein tree, the more powerful the tree will be. More precisely, we can ask what is the smallest value of alpha that can be reliably distinguished from BM on this particular tree? That answer should be proportional to how close the variances of two branches can get to their stationary values, 1 − &lt;em&gt;e&lt;/em&gt;^−\ 2α&lt;em&gt;s&lt;/em&gt;^ where &lt;em&gt;s&lt;/em&gt; is the branch length, 0.9 in this case, giving us 83% of the way to the equilibrium.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Compare moving the branch points from t=0.9 to t=0.45 vs halving alpha:&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/3/3a/Weaker.png&quot; alt=&quot;Image:Weaker.png&quot; /&gt;&lt;figcaption&gt;Image:Weaker.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Both show an roughly equal reduction on the discriminatory power, and the ability to discriminate between models is lost.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; - On the flip size, we can increase the power by doubling alpha from 1 to 2,&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/4/4c/Stronger.png&quot; alt=&quot;Image:Stronger.png&quot; /&gt;&lt;figcaption&gt;Image:Stronger.png&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;br /&gt; - Still need to explore the effect of simply increasing the length of time in the entire tree, doesn’t match doubling alpha. Increasing alpha also tightens the distribution, so reaching the stationary distribution along the branch isn’t enough.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; Computational Comments ———————-&lt;/p&gt;
&lt;p&gt;Have started using &lt;a href=&quot;http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html&quot; title=&quot;http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html&quot;&gt;google style guidelines for R&lt;/a&gt; code. Will also be implementing &lt;a href=&quot;http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml&quot; title=&quot;http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml&quot;&gt;google style for C&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;svn-log&quot;&gt;SVN log&lt;/h3&gt;
&lt;hr /&gt;
&lt;p&gt;r214 | cboettig | 2010-03-03 18:43:28 -0800 (Wed, 03 Mar 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;final version of the day. continues tomorrow…&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r213 | cboettig | 2010-03-03 17:48:33 -0800 (Wed, 03 Mar 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;figure three: weaker&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r212 | cboettig | 2010-03-03 17:29:29 -0800 (Wed, 03 Mar 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;code for felsenstein_tree.R as produced the first two plots in today’s entry, about to modify for plots 3 and 4&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r211 | cboettig | 2010-03-03 15:52:37 -0800 (Wed, 03 Mar 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;resolved problem discussed in yesterday’s entry, see todays entry&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r210 | cboettig | 2010-03-03 01:23:14 -0800 (Wed, 03 Mar 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;Commiting version that appears in March 2nd notes&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Power in trees</title>
	 <link href="/2010/03/02/Power-in-trees.html"/>
   <updated>2010-03-02T00:00:00+00:00</updated>
   <id>/03/02/Power-in-trees</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Back to Phylogenetics after a week with only population dynamics.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;exploration&quot;&gt;Exploration&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;data created by brown simulation on the star tree in ouch matches the expected variance, σ&lt;sup&gt;2&lt;/sup&gt;&lt;em&gt;t&lt;/em&gt;. This variance is slightly reduced when simulated on the Felsenstein tree, as might be intuitively expected due to the increased correlations. The degree of decrease should be analytically attainable, but isn’t obvious to me at the moment. Example using functions in felsenstein_tree.R, revision 210:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; bm &amp;lt;- init_brown_model(star_tree, 5)
&amp;gt; E_trait_var(bm)
[1] 24.52429 
&amp;gt; bm &amp;lt;- init_brown_model(fels_tree, 5)
&amp;gt; E_trait_var(bm)
[1] 17.47615 
&amp;gt; E_trait_var(bm, reps=1000)
[1]  18.65548&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;E_trait_var simulates reps replicates under the given model and computes the variance across the tips of each dataset generated, and averages this variance across the replicates.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Meanwhile, data created by the hansen simulation on the star tree falls significantly short of σ&lt;sup&gt;2&lt;/sup&gt; / 2α even when rates are certainly high enough to have reached the stationary distribution.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; ou &amp;lt;- init_hansen_model(star_tree, alpha=50, sigma=20)
&amp;gt; E_trait_var(ou)
[1] 0.0779675277 
&amp;gt; E_trait_var(ou, 1000)
[1] 0.0800359241 
&amp;gt; # whereas theory would predict
&amp;gt; 20^2/(2*50)
[1] 4&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;not sure why this is. The simulations seems to think the steadystate variances is σ&lt;sup&gt;2&lt;/sup&gt; / 2α&lt;sup&gt;2&lt;/sup&gt; instead. Using the deprecated function hansen.dev, I seem to recover the expected variance (averaging variance over 100 replicates):&lt;/p&gt;
&lt;pre class=&quot;de1&quot;&gt;&lt;code&gt;&amp;gt; deviates &amp;lt;- as.data.frame(hansen.dev(100, star_tree@nodes, star_tree@ancestors, star_tree@times, regimes= NULL, alpha=5,sigma=3, theta=0))
Warning messages:
1: &amp;#39;hansen.dev&amp;#39; is deprecated.
Use &amp;#39;simulate&amp;#39; instead.
See help(&amp;quot;Deprecated&amp;quot;) and help(&amp;quot;ouch-deprecated&amp;quot;). 
2: &amp;#39;is.valid.ouch.tree&amp;#39; is deprecated.
Use &amp;#39;ouchtree&amp;#39; instead.
See help(&amp;quot;Deprecated&amp;quot;) and help(&amp;quot;ouch-deprecated&amp;quot;). 
&amp;gt; out = sapply(1:100, function(i){var(deviates[i], na.rm=T)} )
&amp;gt; mean(out)
[1] 0.905187
&amp;gt; #which agrees with theory; 3^2/(2*5)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt; - ouch has a convenient function to bootstrap a model&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ouch hansen trees give false impressions of accuracy around star (and hence nearly star) trees, where result is actually very sensitive to the original initialized search parameters for alpha and sigma.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;brainstorming&quot;&gt;Brainstorming&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Current methods don’t permit divergent selection models, for instance of parts of the tree. Again probably an information-limited arena, but interesting to think what one would do or do differently if you had geographic information or range overlaps along the tree (or at least for the tips).&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/03/01/Teaching.html"/>
   <updated>2010-03-01T00:00:00+00:00</updated>
   <id>/03/01/Teaching</id>
   <content type="html">&lt;h2 id=&quot;evolution-of-mimicry-levels-of-selection&quot;&gt;Evolution of Mimicry &amp;amp; Levels of Selection&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Today my turn to help facilitate in Begun’s Monte Carlo on designing a course on evolution for non-majors. Worked with Elizabeth on an interactive case study teaching levels of selection through the example of mimicry in butterflies.&lt;/li&gt;
&lt;li&gt;Following a brief introduction, we gave a pilot run of a hands-on activity to explore population dynamics in a predator-control-model-mimic (jay-cabbage-monarch-viceroy) system. Here’s the &lt;a href=&quot;http://docs.google.com/Doc?docid=0AR6sK_1tc7DZZGdmYnQyZzVfODE0NGs3ODRmeA&amp;amp;hl=en&quot; title=&quot;http://docs.google.com/Doc?docid=0AR6sK_1tc7DZZGdmYnQyZzVfODE0NGs3ODRmeA&amp;amp;hl=en&quot;&gt;description&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;The game activity went pretty quickly, we were able to do seven iterations in about 15 minutes, with the later iterations going much faster than the beginning ones. Our group was only nine people, hence the cups allowing people to play multiple prey at once, but this could easily scale to a very large classroom (though probably making iterations take longer). The group did seem to find the activity becoming repetitive by round seven.&lt;/li&gt;
&lt;li&gt;One modification I’d make to the rules after this is that the reproduction rate must be per capita up to the carrying capacity, with set reproductive rates for each species (i.e. 1 for model, 2 for mimic and control).&lt;/li&gt;
&lt;li&gt;We discussed but didn’t try following up the interactive simulation with a computer-based netlogo simulation. Ideally, the students could write the simulation from a netlogo template, implementing the rules of the game and adding sliding bars for the parameters. This would allow them to explore the model with more statistically meaningful sample sizes, but also be a good introduction to programming for modeling. Learning the specific rules of the game hopefully serves as a concrete example of what a model and simulation involve. Having to write the model one’s self should help empower students to ask and then explore questions about what if this rule or that rule were different.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;response&quot;&gt;Response&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Overall the feedback seemed quite positive. People found the activity engaging and thought the netlogo exercise sounded like a promising extension.&lt;/li&gt;
&lt;li&gt;I’m wondering what aspects of active group activity make them most effective. One idea we discussed before presenting was the chance for students to engage in trying out strategies vs simply iterating the rules. The current structure doesn’t involve many decisions – the predators have a simple decision to make and the prey have none. Adding decisions without making the activity too complicated is challenging; the prisoner’s dilemma is a good a example of a game with simple rules but a non-trivial decision for all players. Another idea I’m thinking about is the collaborative aspect of the game. Without prompting, predators today tended to chat about strategy and try to guess what would happen next, which gets them more engaged into the activity. Seeding the activity with questions to answer might also help (such as trying to predict the long-term outcome).&lt;/li&gt;
&lt;li&gt;Julia suggested trying this module in the Sacramento Teachers workshop this May. Might have to actually develop the netlogo module.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;comments&quot;&gt;Comments?&lt;/h3&gt;
&lt;p&gt;Testing an html plugin for leaving comments in the notebook directly. If you’re reading this feel free to give the comments script a try.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parallel at last</title>
	 <link href="/2010/03/01/Parallel-at-last.html"/>
   <updated>2010-03-01T00:00:00+00:00</updated>
   <id>/03/01/Parallel-at-last</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;svn revision 27 should have functional parallel code! Certainly I’ve gotten much better at openmp in the past few days. Difficult to maintain a general API that is agnostic to the model details and still knows enough about the data formats to declare them appropriately for each thread. My lesson for my future coding: by writing with parallelization concepts in mind from the start I should be able to significantly reduce the overhead time when I go back and add openmp directives. Gillespie API still needs perfecting but should be able to push ahead with the science now.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;still need to add const qualifiers and expand documentation.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;science-goals&quot;&gt;Science Goals&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Next steps are the analytic approximations for the expected variance about the warning signals (variance of the variance estimate essentially). This also should be implemented in the code, which is more straight forward.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; * * * * *&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.htmlcommentbox.com&quot;&gt;HTML Comment Box&lt;/a&gt; is loading comments…&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parallelizing Code</title>
	 <link href="/2010/02/28/Parallelizing-Code.html"/>
   <updated>2010-02-28T00:00:00+00:00</updated>
   <id>/02/28/Parallelizing-Code</id>
   <content type="html">&lt;h3 id=&quot;a-solution&quot;&gt;A solution!&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;After a good bit more exploring permutations of openmp commands and experimenting with code (should have been done in a branch version so would be in the version management, instead done in my local experimental sandbox so will have to implement and merge into real code still!) was able to understand the root of my problem and pose a coherent question.&lt;/li&gt;
&lt;li&gt;Posting that question on stack overflow &lt;a href=&quot;http://stackoverflow.com/questions/2352895/how-to-ensure-a-dynamically-allocated-array-is-private-in-openmp&quot; title=&quot;http://stackoverflow.com/questions/2352895/how-to-ensure-a-dynamically-allocated-array-is-private-in-openmp&quot;&gt;solved my problem&lt;/a&gt; in under an hour. Two for two on fast and thorough solutions there, a fantastic resource.&lt;/li&gt;
&lt;li&gt;As I understand it, the += strategy still risks collisions, perhaps these can be avoided by dynamically allocating the shared variable my_report in the same fashion (i.e. after it is declared shared), but not ideal..&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;to-do&quot;&gt;To Do&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Merge changes into actual code.&lt;/li&gt;
&lt;li&gt;Add use of const (and possibly restrict) as often as possible, and start implementing these regularly when writing functions. Also more literate programming.&lt;/li&gt;
&lt;li&gt;Illustrations of the ensemble variance vs time-averaged variance and it’s expected deviations.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a href=&quot;http://www.htmlcommentbox.com&quot;&gt;HTML Comment Box&lt;/a&gt; is loading comments…&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Friday</title>
	 <link href="/2010/02/26/Friday.html"/>
   <updated>2010-02-26T00:00:00+00:00</updated>
   <id>/02/26/Friday</id>
   <content type="html">&lt;p&gt;Not much chance for progress.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;11-noon (I was interviewed by Science Careers reporter).&lt;/li&gt;
&lt;li&gt;noon-1 Lunch w/ John Huelsenbeck. Good perspective on having formula representation of models rather than on/off switch for parameters! Will have to implement eventually in the phylogenetics project.&lt;/li&gt;
&lt;li&gt;1-1:30 Wainwrighters lunch meeting.&lt;/li&gt;
&lt;li&gt;1:30-3:30 prep Monte Carlo for teaching non-majors evolution course – case study on mimicry and levels of selection. Presenting Monday, we’ll see how it goes in [User:Carl_Boettiger/Notebook/Teaching]&lt;/li&gt;
&lt;li&gt;4-6 Phylogenetics discussion group (followed by CPB happy hour = more phylogenetics discussion). Working out correlated trait evolution model for suction index?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Thursday</title>
	 <link href="/2010/02/25/Thursday.html"/>
   <updated>2010-02-25T00:00:00+00:00</updated>
   <id>/02/25/Thursday</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Some exploration with felsenstein_tree.R, see svn log.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>The Ergodicity Question- Time averaging vs Ensemble averaging</title>
	 <link href="/2010/02/25/The-Ergodicity-Question--Time-averaging-vs-Ensemble-averaging.html"/>
   <updated>2010-02-25T00:00:00+00:00</updated>
   <id>/02/25/The-Ergodicity-Question--Time-averaging-vs-Ensemble-averaging</id>
   <content type="html">&lt;p&gt;11am – 3pm&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tried time averaging over the entire time window (set sample_size to 1 less than max time); in close agreement with the ensemble predictions (getting around 1355).&lt;/li&gt;
&lt;li&gt;Mystery doesn’t seem to actually be a problem in the method, but just innate variability! Even over reasonable time-averages and ensemble averages there’s significant deviation from the expected variance! This variation around the warning signal/leading indicator is exactly what might frustrate the warning signal. So within a run, the observed variance averaged over a given window may fluctuate significantly.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/c/ca/Falsealarmpng.png/400px-Falsealarmpng.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img src=&quot;/skins/common/images/magnify-clip.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Note that variance almost doubles just by chance, and the average looks pretty close to the analytic calculation for these parameters (1352). This samples every unit time on a window of 149 time units (single replicate).&lt;/li&gt;
&lt;li&gt;Code that produces this found in version 26 (run warning_signals and then plot data with that version of plot.py). &lt;strong&gt;Note:&lt;/strong&gt; seed was randomized in this compile.&lt;/li&gt;
&lt;li&gt;Gillespie header file has a flag to turn on random seed!&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;next-steps&quot;&gt;Next Steps&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Parallelization – restructure my_pars and record classes.&lt;/li&gt;
&lt;li&gt;Compute variance in variance (and in other warning signals) across ensembles. Shows not just the expected signal, but the collection of possible signals. Think about analytic version of this calculation.&lt;/li&gt;
&lt;li&gt;Update records class for these kinds of ensemble averaging. Ensemble Variance in temporal mean with windowsize 1 will then give the variance across ensembles alone, rather than calculating separately (which I’m currently using the ar1 and arN blocks to compute).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### Parallelizing Code&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Large ensemble averaging can benefit from relatively trivial parallelization. Parallelizing other sections of the code will be more demanding and less obviously an efficiency boost. I have been doing basic parallelization for multicore, shared memory machines using OpenMP, allowing me to take advantage of the up to eight cores we have on the server (&lt;code&gt;one&lt;/code&gt;.)&lt;/li&gt;
&lt;li&gt;Makefile now has a make parallel option to call the compiler with the openmp flag, &lt;code&gt;-f openmp&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;My first try added an OpenMP command to the Gillespie code to parallelize the for loop over ensembles:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;syntax type=&quot;c&quot;\&gt;&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;pragma omp parallel for default(none) shared(rng, rate_fn, outcome) private(lambda, t, tmp, i, check) firstprivate(rates_data, my_pars)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;for(l = 0; l &amp;lt; ensembles; l++){ &lt;/syntax\&gt;&lt;/p&gt;
&lt;p&gt;I haven’t worked with firstprivate before, but seems necessary for dynamically allocated private variables. This isn’t going to work, as my_pars contains information that must be shared (like where the global data is collected) and private (like the state variables). A successful parallelization of this algorithm will require being more explicit. Basically everything in &lt;code&gt;record&lt;/code&gt; needs to be shared and the rest of &lt;code&gt;my_pars&lt;/code&gt; needs to be private…&lt;/p&gt;
&lt;p&gt;As the random number generator is called in a different order in parallel and serial runs I don’t think I can compare values simply by keeping constant seed, but I can compare convergent values.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Will need to separate my parameters data structure into global recording data and private state variable data&lt;/strong&gt; before the Gillespie code can be effectively parallelized. Will need to consider checks to prevent user from mismatching these.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;edit on Fri 26th&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Anything declared private in openmp must be initialized in the loop or declared firstprivate instead. If it’s dynamically allocated compiler will complain about private but not firstprivate. Making a copy of a constant pointer (as in promotions from void pointers) lets you change the values of things it points to.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Parallel code not very compatible with GSL’s creative use of void pointers as agnostic ways to pass parameters to functions. Fine for shared parameters, creates a problem for private parameters. Using restrict declaration might help with this, will need to investigate further. Meanwhile, experimental directory has simplified code for exploring the parallel error. currently cannot get time series to cumulatively sum results from different replicates rather than overwrite.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;edits Sun Feb 28&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Parallel code works if I can avoid firstprivate. this means specifying predetermined size arrays for checkpts and my_pars explicitly. Will have to figure out how to get openmp to work with dynamically allocated variables. Time to actually spend some time in openmp tutorials…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Derin And Alan Meeting</title>
	 <link href="/2010/02/24/Derin-and-Alan-Meeting.html"/>
   <updated>2010-02-24T00:00:00+00:00</updated>
   <id>/02/24/Derin-and-Alan-Meeting</id>
   <content type="html">&lt;p&gt;1-2pm&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Discussion of reasons early warning signals fail&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Insufficient signal-to-noise ratio for early warning&lt;/li&gt;
&lt;li&gt;Ensemble vs time average – satisfying ergodicity assumption?&lt;/li&gt;
&lt;li&gt;Role of bifurcation type. existing literature focuses mostly on 1D saddle node.&lt;/li&gt;
&lt;li&gt;Role of chaos (certainly frustrates warning signals, but not required).&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;How general are warning signals? Normal forms of bifurcations. Fitting a good model vs. general warning signals. Problem of extrapolation.&lt;/li&gt;
&lt;li&gt;Classification scheme of warning signals – TREE paper(?)&lt;/li&gt;
&lt;li&gt;Mean First passage time from potential&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;analytic-calculations-continued&quot;&gt;Analytic calculations continued&lt;/h2&gt;
&lt;h3 id=&quot;expected-variance-across-ensembles&quot;&gt;Expected Variance across Ensembles&lt;/h3&gt;
&lt;p&gt;The expected variance across ensembles can be calculated from the Fokker-Planck Equation derived from the linear noise approximation. This should agree with the variance computed over a time window when the system has reached stationarity. I do these calculations and compare:&lt;/p&gt;
&lt;p&gt;Equilibrium population size solves&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ e n - a = \frac{e K n^2}{n^2+h^2}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Equilibrium variance should be given by&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math&quot;&gt;\[ \hat \sigma^2 = \frac{d(\hat n)}{b&amp;#39;(\hat n)-d&amp;#39;(\hat n)} =
\frac{e \hat n - a}{ 2 e K \hat n (1 - \frac{\hat n}{\hat n^2 +
h^2}) - e} \]&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;time-averaging-from-simulation-doesnt-match-analytic-prediction&quot;&gt;Time averaging from simulation doesn’t match analytic prediction!&lt;/h3&gt;
&lt;p&gt;The analytic solution to &lt;span class=&quot;math&quot;&gt;\(\hat n\)&lt;/span&gt; is the general solution to a cubic so not very pretty, but easy to calculate numerically in order to give the variance estimate; using the values below I confirm that ODE solver and analytic solution above agree $ ^2 = 1352$, which is &lt;em&gt;only about half that computed over the time window (approx 2360)!&lt;/em&gt; Parameter values and solutions from analytics are:&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;e&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;0.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;K&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;1000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;h&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;a&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;160&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;n&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;570.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;&lt;span class=&quot;math&quot;&gt;\(\hat \sigma^2\)&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;1352&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;test-of-higher-order-corrections&quot;&gt;Test of higher order corrections&lt;/h3&gt;
&lt;p&gt;I try the higher order correction to the mean dynamics (accounts for inflation effect of the variance):&lt;/p&gt;
&lt;p&gt; E(n) = _1(n) +  ^2 _1’’(n)&lt;/p&gt;
&lt;p&gt;Though not surprisingly, the effect is negligible. In this case the average is slightly higher (572.5) and variance slightly lower (1349), so the curvature at equilibrium must be positive (in contrast to the deflation example with logistic or Levins model). Perhaps this is a consequence of the ergodicity assumption failing; I’ll check against simply computing ensemble variance rather than the (mean-over-ensembles) time-averaged variance.&lt;/p&gt;
&lt;h3 id=&quot;ensemble-averaging-simulation-does-match-theory-though-time-averaging-doesnt&quot;&gt;Ensemble averaging simulation does match theory, though time averaging doesn’t&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Okay, variance computed over ensembles only matches the theory (averaging over all time over an ensemble of 1000 I’m getting 1362 ensemble variance, while the time averaged (over a sampletime of 100, sample interval of .1, and max time 500) variance averaged over ensembles comes out a steady 2339. So much for ergodicity? &lt;strong&gt;Note:&lt;/strong&gt; these conditions should match the code found in subversion revision
&lt;ol start=&quot;25&quot; type=&quot;1&quot;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;reflections-on-warning-signals-literature&quot;&gt;Reflections on Warning Signals literature&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Created a separate &lt;a href=&quot;http://www.mendeley.com/collections/1374711/EarlyWarningSigns/&quot; title=&quot;http://www.mendeley.com/collections/1374711/EarlyWarningSigns/&quot;&gt;Mendeley collection&lt;/a&gt; for literature on Early Warning Signals, still very underpopulated. Note that my Mendeley library wasn’t available online for a couple days due to some stupid syncing mistakes I made, but the Mendeley support team was fantastic in getting things back in working order (Let’s just say I may be responsible for the release of 0.9.6.1). Note that one can subscribe to this collection as an &lt;a href=&quot;http://www.mendeley.com/collections/rss/1374711/&quot; title=&quot;http://www.mendeley.com/collections/rss/1374711/&quot;&gt;rss feed&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I’m bothered to see the phrase “tipping point” used synonymously with bifurcation – they invoke very different ideas. A tipping point such as the maximum angle you can push a canoe before it flips is not a bifurcation, it is a perturbation to the state directly large enough to push it over the seperatrix, and directly related to the first passage time problem in the stochastic models. The bifurcations under consideration are changes in a parameter, not the state of interest, which destroys a stable point. Phase transitions are examples, though often lacking hysteresis.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Another annoying quality is the lack of distinguishing bifurcation from rare event. If alternate stable states are present, what is the probability we would simply jump into them by chance?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Detrending before fitting AR(1) model to data is also unjustified. Trends influence variance as well!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Taking a sliding window size equal to half the size of the available time series is arbitrary and unjustified, as it is neither the most promising way to detect the trend nor should the window size choice depend on such things as knowing the time the crash occurs.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;current-library&quot;&gt;Current Library&lt;/h3&gt;
&lt;p&gt;(Also a chance to test Mendeley library embedding)&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mendeley.com&quot;&gt;Research&lt;/a&gt; collected using Mendeley&lt;/p&gt;
&lt;h2 id=&quot;subversion-log&quot;&gt;Subversion Log&lt;/h2&gt;
&lt;p&gt;r25 | cboettig | 2010-02-25 00:12:09 -0800 (Thu, 25 Feb 2010) | 1 line&lt;/p&gt;
&lt;p&gt;made samplefreq into a double instead of size_t, still co-opting the autocorrelations, seems to show successfully a different ensemble vs time-averaged variance&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r24 | cboettig | 2010-02-24 23:46:07 -0800 (Wed, 24 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;co-opted the autoregressive data for the moment to explore direct ensemble mean and variance (without any time-averaging)&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r23 | cboettig | 2010-02-24 21:53:12 -0800 (Wed, 24 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;ode integrator seems to accurately compute mean and variance dynamics, though the time-averaged variance doesn’t seem to agree with the analytic ensemble variance; will have to compute that directly from simulation to compare. Runge-Kutta solver on adaptive mesh seems significantly slower than my simple Euler scheme; particularly with the (nearly irrelevant) higher order correction to the mean dynamics.&lt;/p&gt;
&lt;hr /&gt;
</content>
 </entry>
 
 <entry>
   <title>Comparing to Analytic Dynamics</title>
	 <link href="/2010/02/23/Comparing-to-Analytic-Dynamics.html"/>
   <updated>2010-02-23T00:00:00+00:00</updated>
   <id>/02/23/Comparing-to-Analytic-Dynamics</id>
   <content type="html">&lt;p&gt;Goal for today: implement analytic calculations for warning signals.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;10am-12pm&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Abstraction/functionalizing code.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;4pm-7pm&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Implement GSL ode solvers for linear noise approximation:&lt;/p&gt;
&lt;p&gt;Recall our dynamics are &lt;img src=&quot;http://openwetware.org/images/math/b/0/f/b0f86bdecd1ecc1882bcbc4a61d7b2e7.png&quot; alt=&quot;b(n) = \frac{e K n^2}{h^2+n^2}&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;d&lt;/em&gt;(&lt;em&gt;n&lt;/em&gt;) = *e**n* + &lt;em&gt;a&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;and defining the jump moments (van Kampen) α&lt;sub&gt;1&lt;/sub&gt;(&lt;em&gt;n&lt;/em&gt;) = &lt;em&gt;b&lt;/em&gt;(&lt;em&gt;n&lt;/em&gt;) − &lt;em&gt;d&lt;/em&gt;(&lt;em&gt;n&lt;/em&gt;)&lt;/p&gt;
&lt;p&gt;α&lt;sub&gt;2&lt;/sub&gt;(&lt;em&gt;n&lt;/em&gt;) = &lt;em&gt;b&lt;/em&gt;(&lt;em&gt;n&lt;/em&gt;) + &lt;em&gt;d&lt;/em&gt;(&lt;em&gt;n&lt;/em&gt;)&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; recall that we have a linear Fokker-Planck equation whose solution is Gaussian and specified by the first two moments: &lt;img src=&quot;http://openwetware.org/images/math/7/c/f/7cf6568c3252fa68c7b4c28acf3025e0.png&quot; alt=&quot;\frac{d}{dt} E(n) = \alpha_1(n)&quot; /&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/math/f/4/1/f4149089d99a43125c9d91ceca4d8ea5.png&quot; alt=&quot;\frac{d}{dt} \sigma^2_n = 2 \sigma_2(n) \frac{d}{dn} \alpha_1(n) + \alpha_2(n)&quot; /&gt;&lt;figcaption&gt;\frac{d}{dt} \sigma^2_n = 2 \sigma_2(n) \frac{d}{dn} \alpha_1(n) + \alpha_2(n)&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;These are implemented in code using GSL ode library.&lt;/li&gt;
&lt;li&gt;The variance calculation seems not to agree with the simulated results, though no obvious bug. Perhaps I’ve been too cavalier about the scaling above?&lt;/li&gt;
&lt;li&gt;Will try implementing simpler functions I’ve tested before to confirm.&lt;/li&gt;
&lt;li&gt;Need to repeat this analysis for the multivariate case where parameter &lt;em&gt;a&lt;/em&gt; changes dynamically at specified rate.&lt;/li&gt;
&lt;li&gt;Will also consider making &lt;em&gt;a&lt;/em&gt; change according to stochastic rules, adding environmental variability.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt; ### svn log&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r22 | cboettig | 2010-02-23 23:45:12 -0800 (Tue, 23 Feb 2010) | 1 line&lt;/p&gt;
&lt;p&gt;Implemented ode functions solving the linear noise approximation equations. Mean agrees well, variance calculation seems off.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r21 | cboettig | 2010-02-23 11:39:25 -0800 (Tue, 23 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;gillespie.h and gillespie.c abstraction completed. Documentation should still explain how to create the necessary functions to run a gillespie simulation, but is otherwise complete.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r20 | cboettig | 2010-02-23 10:30:03 -0800 (Tue, 23 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;Functionalizing code into seperate files. The main gillespie code has been broken off into its own file, gillespie.c along with its own header. To keep the function calls agnostic to the details of the parameters structure, all the gillespie functions my_pars is passed as a void pointer and promoted to a pars pointer inside the function defs.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/02/22/Teaching.html"/>
   <updated>2010-02-22T00:00:00+00:00</updated>
   <id>/02/22/Teaching</id>
   <content type="html">&lt;h2 id=&quot;gtc-session-student-centered-learning-successes-failures-and-strategies&quot;&gt;GTC Session: Student Centered Learning: Successes, Failures and Strategies&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Gabrielle and I facilitated a GTC section on Student-Centered learning. Details in the &lt;a href=&quot;http://gtc-blog.blogspot.com/2010/02/student-centered-learning-successes.html&quot; title=&quot;http://gtc-blog.blogspot.com/2010/02/student-centered-learning-successes.html&quot;&gt;GTC blog post&lt;/a&gt;. Small group of about a dozen of us, still worked to break into four groups for the discussion section. Overall went very well, don’t have a lot of comments to add about the experience or things I’d do differently. Did get some positive feedback and comments that we could have used much more time to explore these ideas! Certainly the hour seems to fly by rather than drag on in this style. I was impressed by one group’s method of summarizing there discussion by having each member share a point; very organized and egalitarian.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Will try and add a Mendeley library link to the Student Centered Learning literature here when I get a chance. Maybe should add one to the GTC blog too. Should add notes from the group sections also.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Monday</title>
	 <link href="/2010/02/22/Monday.html"/>
   <updated>2010-02-22T00:00:00+00:00</updated>
   <id>/02/22/Monday</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Not a very successful day research-wise. Begun’s Monte Carlo and then my facilitation at GTC seminar went well though.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Implementing an example of low and high power trees</title>
	 <link href="/2010/02/20/Implementing-an-example-of-low-and-high-power-trees.html"/>
   <updated>2010-02-20T00:00:00+00:00</updated>
   <id>/02/20/Implementing-an-example-of-low-and-high-power-trees</id>
   <content type="html">&lt;p&gt;Code implementation in felsenstein_tree.R&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I consider a star tree and a Felsenstein tree each of N nodes; M = (N+1)/2 tips.&lt;/li&gt;
&lt;li&gt;I consider an uncorrelated data set of M normal random variables, such as would be generated by either BM or OU models on the star tree.&lt;/li&gt;
&lt;li&gt;I produce a correlated data set such as would be generated by Brownian motion on the felsenstein tree.&lt;/li&gt;
&lt;li&gt;I generate 8 model fits – fitting BM and OU to each tree under each data set.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;results&quot;&gt;Results&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;For the four fits on the star tree, the likelihood of BM and OU are identical within each dataset, as required. The likelihood of OU/BM fit is higher on the uncorrelated data set (since it is normal, not bimodal), as expected.&lt;/li&gt;
&lt;li&gt;On the Felsenstein tree, the OU model does better than the BM on the uncorrelated data (as expected, since the OU model produces something asymptotically normal on that tree (i.e. at least if branch lengths are long enough relative to alpha), while the BM does better than OU on the correlated data (by the same logic).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Output of these results found in revision 209 in the subversion repository.&lt;/p&gt;
&lt;h3 id=&quot;discussion-and-future-goals&quot;&gt;Discussion and Future Goals&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;branch lengths probably not long enough relative to alpha to allow a more powerful discrimination, or does that simply scale out? Also level of heterogeniety in the original data (i.e. are the two peaks in the correlated model far enough apart?&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/02/19/Teaching.html"/>
   <updated>2010-02-19T00:00:00+00:00</updated>
   <id>/02/19/Teaching</id>
   <content type="html">&lt;h2 id=&quot;faculty-mentoring-faculty-presentation&quot;&gt;Faculty Mentoring Faculty Presentation&lt;/h2&gt;
&lt;h3 id=&quot;short-cuts-to-excellent-teaching-a-primer&quot;&gt;“Short Cuts to Excellent Teaching: A Primer”&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;by James Shaffrath,&lt;/li&gt;
&lt;li&gt;from Exercise Biology, The Department of Neurobiology, Physiology and Behavior&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Just saw this presentation in the Faculty Mentoring Faculty program. Good program, though pretty basic, not really touching on peer learning but focusing on lecture content and style. Things like rolling lexicon (using both jargon and simple phrases), being present, being engaging. The broad introduction was definitely the best part, and an inspiring view about the role of education. What I took away most, though, was the paradigm of &lt;strong&gt;Teachers as heroes, teachers as friends.&lt;/strong&gt; The human element dominates the teaching experience, it’s captured in the photograph of the girl’s expression on finding the word “brilliant” in her first dictionary, and in James’ penetrating assertion that there’s someone else in the room seeing that expression. His highest goal was lighting the spark of education, the W.B. Yeats quote I’ve had to add to the notebook cover. A bit on my reaction follows.&lt;/p&gt;
&lt;h3 id=&quot;reflection-on-the-talk&quot;&gt;Reflection on the talk&lt;/h3&gt;
&lt;p&gt;Some of my favorite professors would walk into the classroom with nothing but a piece of chalk, offer no more introduction than to kick off his shoes to some corner and begin lecturing, scrawling away on the blackboard regardless of whether half the class hadn’t yet arrived or sat down. We’d all copy notes furiously in that class, understand very little of it; everyone trying to keep up with the logic of the formulae for as many minutes as possible before falling back into scribe mode; but it didn’t matter. We’d been given the spark, the professor knew something we wanted to know, and we worked like hell to learn it. The learning always came after though, from each other and the TAs in all those night-long problem sessions. I’ve focused on that element more in my thoughts on teaching, and how it can be facilitated and improved – the actual learning itself. But I think I must remember the role of the teacher as that spark as well, as a hero. After all, the will to learn comes first.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Power in trees continues</title>
	 <link href="/2010/02/19/Power-in-trees-continues.html"/>
   <updated>2010-02-19T00:00:00+00:00</updated>
   <id>/02/19/Power-in-trees-continues</id>
   <content type="html">&lt;p&gt;Discussion of power in trees need a counterpoint to the example of the star tree as being devoid of information content. The best example here is probably the example tree used in the introduction of Felsenstein 1985: two star trees sharing a common ancestor. Implemented the basic creation of a balanced tree of arbitrary depth having this structure. The balanced tree has 2&lt;sup&gt;&lt;em&gt;h&lt;/em&gt;&lt;/sup&gt; − 1 nodes, all internal nodes occuring at time = 1/2 and all tips at time = 1. This sets many branch lengths to zero, which effectively turns a binary tree in an unresolved star. Setting the time of all internal nodes to zero, the age of the root, turns this into a star tree.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt; ### From the subversion log&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r208 | cboettig | 2010-02-20 14:44:25 -0800 (Sat, 20 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;Implemented the creation of Felstein-style tree and a star syle tree as examples of information-rich and information-poor structure in the code felsenstein_tree.R&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r207 | cboettig | 2010-02-19 11:18:01 -0800 (Fri, 19 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;removing old R code&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Power in Trees</title>
	 <link href="/2010/02/18/Power-in-Trees.html"/>
   <updated>2010-02-18T00:00:00+00:00</updated>
   <id>/02/18/Power-in-Trees</id>
   <content type="html">&lt;p&gt;Following up after yesterday’s meeting, I am working on implementing the confidence interval analysis and quantifying information in trees. This second point I will develop by comparing the Felsenstein example tree (information-rich) to the star tree (uninformative), and develop this discussion in the context of assessing the importance of phylogenetic corrections and phylogenetic intertia (my original theme again: noise or data??).&lt;/p&gt;
&lt;h2 id=&quot;primate-brain-morphometry&quot;&gt;Primate Brain Morphometry&lt;/h2&gt;
&lt;p&gt;Daniel Mietchen contacted me through openwetware 11 days ago with interest in applying phylogenetic comparative methods to Primate Brain Morphometry data. The initial &lt;a href=&quot;/images/2/23/Primate_brain_comparisons.xls&quot; title=&quot;Primate brain comparisons.xls&quot;&gt;data spreadsheet&lt;/a&gt; includes 2 continuous traits for 61 Primate species. To get rolling on this in the comparative methods framework, I’ll first need to create or find a decent ultrametric tree and then will be up and running. This should both help Dan and be a good experimental dataset for me, which I’ll be exploring more during my time at the &lt;a href=&quot;http://bodegaphylo.wikispot.org/&quot; title=&quot;http://bodegaphylo.wikispot.org/&quot;&gt;Bodega Phylogenetics Workshop&lt;/a&gt; March 6-13.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Meeting Goals</title>
	 <link href="/2010/02/17/Meeting-Goals.html"/>
   <updated>2010-02-17T00:00:00+00:00</updated>
   <id>/02/17/Meeting-Goals</id>
   <content type="html">&lt;h3 id=&quot;discussion-of-information-in-phyologenetic-trees-analysis&quot;&gt;Discussion of information in phyologenetic trees analysis&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Review manuscript outline. More examples of comparisons? Sequence of presentation?&lt;/li&gt;
&lt;li&gt;Parametric bootstrapping approach; see this entry.&lt;/li&gt;
&lt;li&gt;Quantifying information in a tree a priori to any trait data&lt;/li&gt;
&lt;li&gt;Stationary distribution fits vs full model fits as measure of phylogenetic signal&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;discussion-of-regimes-model&quot;&gt;Discussion of Regimes model&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Review project status of implementing the more complicated regimes model, discussed here&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Hastings Meeting</title>
	 <link href="/2010/02/17/Hastings-Meeting.html"/>
   <updated>2010-02-17T00:00:00+00:00</updated>
   <id>/02/17/Hastings-Meeting</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Discussion of cases where variance decreases before crash – misleading warning signals. Schreiber 2003&lt;/li&gt;
&lt;li&gt;Aaron King and Bill Schaffer JMB Hamiltonian vs Dissipative/gradient systems. Are Hamiltonian systems non-biological?&lt;/li&gt;
&lt;li&gt;Follow up with Darren&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;reasons-warning-signals-fail&quot;&gt;Reasons Warning Signals fail&lt;/h3&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Present (saddle-node model) but insufficient sensitivity to detect (lack ensembles, lack sampling frequency)&lt;/li&gt;
&lt;li&gt;dissipative but warning signals are backwards (other higher dimensional bifurcations, limit cycles –&amp;gt; no potential)&lt;/li&gt;
&lt;li&gt;Hamiltonian instead of dissipative (centers, stochastically become random walks)&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;code-updates&quot;&gt;Code Updates&lt;/h2&gt;
&lt;p&gt;Early warning signals code now does ensemble averaging, which works! The next step is to compute variance around the ensemble average to determine significance of a signal.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/e/ef/Ensemble_warning.png/600px-Ensemble_warning.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The red line shows the environmental change, which begins around t = 200. The black line shows when the environmental variable hits the bifurcation point. Hence a reliable warning signal should occur between these two points. Looks like these work! Note that expected variance appears the least noisy. Dynamics of the model are &lt;img src=&quot;http://openwetware.org/images/math/1/1/d/11dec717f8992ae05dde012fe7cd0aee.png&quot; alt=&quot;\dot N = \frac{eKN^2}{h^2+N^2} - e N - a&quot; /&gt;&lt;/p&gt;
&lt;p&gt;With&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;e&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;0.5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;even&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;K&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;1000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&quot;odd&quot;&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;h&lt;/td&gt;
&lt;td style=&quot;text-align: left;&quot;&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;and the bifurcation occurs near a = 200.&lt;/p&gt;
&lt;h2 id=&quot;progress-on-code&quot;&gt;Progress on Code&lt;/h2&gt;
&lt;hr /&gt;
&lt;p&gt;r19 | cboettig | 2010-02-18 00:58:00 -0800 (Thu, 18 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;early warning works with ensemble averaging. This commit is paired with the figure in the Feb 17 2010 entry in the openwetware notebook&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r18 | cboettig | 2010-02-17 23:16:20 -0800 (Wed, 17 Feb 2010) | 2 lines&lt;/p&gt;
&lt;p&gt;minor fixes to warning_signals&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r17 | cboettig | 2010-02-17 23:06:41 -0800 (Wed, 17 Feb 2010) | 1 line&lt;/p&gt;
&lt;p&gt;Completed implementation of ensemble averaging&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;r16 | cboettig | 2010-02-17 21:04:23 -0800 (Wed, 17 Feb 2010) | 1 line&lt;/p&gt;
&lt;p&gt;src directory uncessary, moved code up&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Updating manuscript</title>
	 <link href="/2010/02/16/Updating-manuscript.html"/>
   <updated>2010-02-16T00:00:00+00:00</updated>
   <id>/02/16/Updating-manuscript</id>
   <content type="html">&lt;p&gt;The progress of the past few days has lead to substantial revision proposals in my manuscript draft. Rewriting for discussion with Brian tomorrow. Currently revised outline:&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;Intro&lt;/strong&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Biological Motivation&lt;/li&gt;
&lt;li&gt;Comparative Methods and Comparing Models&lt;/li&gt;
&lt;li&gt;Model choice paradigm: the right direction, but incomplete&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Simple Example&lt;/strong&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;The Star Tree&lt;/li&gt;
&lt;li&gt;Two hypotheses: stabilizing vs disruptive selection&lt;/li&gt;
&lt;li&gt;Information Criteria approach is insufficient&lt;/li&gt;
&lt;li&gt;Likelihood surfaces&lt;/li&gt;
&lt;li&gt;Likelihood ratio distribution&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Anoles Example&lt;/strong&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Background to example and models&lt;/li&gt;
&lt;li&gt;Initial conclusions from Butler &amp;amp; King&lt;/li&gt;
&lt;li&gt;Raising skepticism – simulated data sets&lt;/li&gt;
&lt;li&gt;A robust approach: parametric bootstrap&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Power of a Tree&lt;/strong&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Quantifying information content of a tree a priori&lt;/li&gt;
&lt;li&gt;independent of data&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Discussion&lt;/strong&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Model choice paradigm&lt;/li&gt;
&lt;li&gt;Need for power analysis&lt;/li&gt;
&lt;li&gt;Future of model comparisons in comparative methods&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Original draft is in phylotrees/writeups/note_on_aic.tex preserved in revision 205 of the svn repository (in case I’m trying to refer to some of that draft text later). Also have copies with comments from Chris, Matt, and Roi.&lt;/p&gt;
&lt;h3 id=&quot;repository-updates&quot;&gt;Repository Updates&lt;/h3&gt;
&lt;p&gt;Reorganized the svn repository for the project. Trying to keep a standard structure and version manage all contents. Current structure is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;project
&lt;ul&gt;
&lt;li&gt;articles&lt;/li&gt;
&lt;li&gt;writeups&lt;/li&gt;
&lt;li&gt;code&lt;/li&gt;
&lt;li&gt;images&lt;/li&gt;
&lt;li&gt;data&lt;/li&gt;
&lt;li&gt;presentations&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;articles are imported into My Mendeley Library, which keeps its own master copies so the articles section here is no longer needed. Writeups are drafts of papers, relevant images are in the images directory which may need an image database manager such as picasa as it gets large. Images I’m unlikely to need can be deleted and the whole directory can be kept under version management. Similarly the data folder can also be version managed, even though not getting regular updates. Having the entire project under svn makes the working directory for a project expendable, and easy to keep only active projects. Can always look into the svn repository to checkout a copy of an old project or part of one.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Parametric bootstrapping</title>
	 <link href="/2010/02/15/Parametric-bootstrapping.html"/>
   <updated>2010-02-15T00:00:00+00:00</updated>
   <id>/02/15/Parametric-bootstrapping</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;There are several ways we can frame the bootstrapping question. What is the probability that we see a given likelihood ratio statistic (that the log likelihoods differ by a certain spread) just by chance? We have two versions of chance – the chance we see this ratio when model a is correct and the chance we see this ratio when model b is correct. We simulate 2000 data sets under each model, generating a distribution of likelihood ratio scores for each data set. These distributions we can plot together with the likelihood ratio score observed for the real data:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/e/eb/Fig1.png/200px-Fig1.png&quot; alt=&quot;image&quot; /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/c/cd/Fig2.png/200px-Fig2.png&quot; alt=&quot;image&quot; /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/c/cd/Fig3.png/200px-Fig3.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;This shows the pattern we have been observing before. If the data is generated by OU(LP), the observed outcome (vertical line) can be quite confidently ascribed to the OU(LP) model (blue curves on the left and right panels are signficantly higher at this point). The best-fit OU and BM models are quite similar to eachother (center panel) in likelihood ratio scores they assign to all parameters, making it quite impossible to distinguish.&lt;/li&gt;
&lt;li&gt;This style of comparison closes the explanation quite convincingly in favor of OU(LP). While if we assume that BM or OU(1) were the correct models (unlikely as the observed likelihood ratio comes from the tails of those distributions, red line hits red curve; left and right panels) then the false positive rate would be quite higher.&lt;/li&gt;
&lt;li&gt;It remains to see how this depends on different values of possible data – particularly for what data the OU(1) and BM models (center) can be reliably teased apart under this tree.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Implementing warning signals metrics</title>
	 <link href="/2010/02/15/Implementing-warning-signals-metrics.html"/>
   <updated>2010-02-15T00:00:00+00:00</updated>
   <id>/02/15/Implementing-warning-signals-metrics</id>
   <content type="html">&lt;p&gt;The &lt;a href=&quot;http://code.google.com/p/popdyn/source/checkout&quot; title=&quot;http://code.google.com/p/popdyn/source/checkout&quot;&gt;code&lt;/a&gt; now contains implementation of the basic warning signals metrics computed over a given window size into the past.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;mean&lt;/li&gt;
&lt;li&gt;variance&lt;/li&gt;
&lt;li&gt;skew&lt;/li&gt;
&lt;li&gt;lag-1 autocorrelation&lt;/li&gt;
&lt;li&gt;lag-n autocorrelation&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These are implemented through the fixed interval sampler function. Recall that the Gillespie simulation API permits two kinds of events, random events occurring with exponential time distribution and events occurring at fixed (scheduled) times, which can be used for discretizations of deterministic continuous time dynamics (i.e. Forward/Backward Euler, Runge-Kutta), as well as scheduled events such as sampling. Just as each random event can have its own rate, fixed events can occur at different frequencies.&lt;/p&gt;
&lt;p&gt;A sample run provided below. Note that the simulation terminates when it hits extinction, even though this zero point is not necessarily sampled on the fixed interval. Created using the parameter values and settings as found in the commit to the svn repository revision 14. The environmental degradation starts at t=5000, marked by the red line.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&quot;http://openwetware.org/images/thumb/3/32/Earlywarning.png/400px-Earlywarning.png&quot; alt=&quot;image&quot; /&gt;&lt;figcaption&gt;image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A python script in the code repository produces this plot. The script in the original form used to create the plot can also always be found in revision 14; meanwhile the plotting script can continue to evolve for later exploration. (Definitely one of the great strengths of version management!)&lt;/p&gt;
&lt;h3 id=&quot;notes&quot;&gt;Notes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Currently the user sets the size of the window by number of samples to store and frequency of sampling, rather than directly entering the length of time the window should average over (and the sampling frequency). This should be changed and will mean dynamically allocating the window block.&lt;/li&gt;
&lt;li&gt;Many of the metrics can be handed the mean after it is computed, currently they recompute the mean. (all metrics are implemented through the use of the GSL stats library).&lt;/li&gt;
&lt;li&gt;We will want to be able to average the metrics over ensembles to demonstrate convergence to the theory.&lt;/li&gt;
&lt;li&gt;API is still embedded in the single file, will need to be functionalized further and made into its own library. Need more documentation, particularly on the fixed interval sampler.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Speciation</title>
	 <link href="/2010/02/14/speciation.html"/>
   <updated>2010-02-14T00:00:00+00:00</updated>
   <id>/02/14/speciation</id>
   <content type="html">&lt;p&gt;&lt;strong&gt;editorial note&lt;/strong&gt;: These notes pre-date the formal start of my online laboratory notebook, &lt;a href=&quot;http://carlboettiger.info/2010/02/02/The-Lab-Notebook-Goes-Open-.html&quot;&gt;Feb 2 2010: The Lab Notebook Goes Open&lt;/a&gt; and were adapted from a LaTeX document in which I kept notes on this topic during my summer at &lt;a href=&quot;http://www.iiasa.ac.at/&quot;&gt;IIASA&lt;/a&gt;. Lacking a proper notebook then, documents like this one were updated periodically and occassionally branched into new ones. The post date represents the last time the LaTeX document was edited in the course of that research.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;abstract&quot;&gt;Abstract&lt;/h2&gt;
&lt;p&gt;We show stochastic effects due to finite population sizes can pose a significant impediment to evolutionary branching. We investigate these effects by exploring the waiting time until evolutionary branching occurs using both individual-based simulationand analytic approximations. The accuracy of our approximation demonstrates that adaptive branching can be thought of as occurring in four phases: (1) (2) (3) (4). Different ranges of parameters will make different phases become rate-limiting. We find that the delicate balance of coexistence early in evolutionary branching is most often rate-limiting, and provide a convenient approximation to the waiting time based on this limit.&lt;/p&gt;
&lt;p&gt;Evolution demographic stochasticity branching adaptive dynamics&lt;/p&gt;
&lt;h1 id=&quot;introduction&quot;&gt;Introduction&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Sympatric speciation and the adaptive dynamics of evolutionary branching&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Previous work on stochasticity in branching &lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Summarize results and outline paper&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;theory-and-methods&quot;&gt;Theory and methods&lt;/h1&gt;
&lt;h2 id=&quot;model-formulation&quot;&gt;Model Formulation&lt;/h2&gt;
&lt;p&gt;Paragraph reviewing basics of evolutionary branching, , .&lt;/p&gt;
&lt;h3 id=&quot;rosenzweig-model-of-competition-for-a-limiting-resource&quot;&gt;Rosenzweig model of competition for a limiting resource&lt;/h3&gt;
&lt;p&gt;Paragraph reviewing the competition model&lt;/p&gt;
&lt;h3 id=&quot;individual-based-simulation&quot;&gt;Individual-based simulation&lt;/h3&gt;
&lt;p&gt;Paragraph reviewing the individual based model implementation&lt;/p&gt;
&lt;h2 id=&quot;four-phases-of-evolutionary-branching&quot;&gt;Four phases of evolutionary branching&lt;/h2&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;Convergence the branching point&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Invasion of the coexistence region&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Coexistence until next invasion&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Divergence from the branching point.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Figure 1: with two panels: (a) shows eachs of these phases on the Pairwise Invasibility Plot. (b) Histograms for each showing the absolute population abundance at each trait value during each of the phases.&lt;/p&gt;
&lt;h1 id=&quot;results&quot;&gt;Results&lt;/h1&gt;
&lt;h2 id=&quot;full-approximation&quot;&gt;Full Approximation&lt;/h2&gt;
&lt;p&gt;Figure 2: Distribution of waiting times from simulation, with full approximation fit, with rate-limiting approximation from phase 3.&lt;/p&gt;
&lt;h2 id=&quot;rate-limiting-coexistence-until-next-invasion&quot;&gt;Rate-limiting coexistence until next invasion&lt;/h2&gt;
&lt;p&gt;Figure 3: Escape from potential energy well approach used to calculate the coexistence time&lt;/p&gt;
&lt;h2 id=&quot;other-rate-limiting-steps&quot;&gt;Other rate-limiting steps&lt;/h2&gt;
&lt;p&gt;Figure 4: Conceptual figure showing biological scenario corresponding to each limit, the resultant approximation, and simulation from that limiting case.&lt;/p&gt;
&lt;h1 id=&quot;discussion&quot;&gt;Discussion&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;What understanding waiting times tells us about the evolutionary branching process&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;How quantifying rate limiting steps helps identify the most relevant parameters to measure in determining rates of evolutionary branching.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Extensions of the approach, such as the inclusion of environmental variation&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;acknowledgements&quot;&gt;Acknowledgements&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;IIASA&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;NAS, DoE funding&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;other?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/02/11/Teaching.html"/>
   <updated>2010-02-11T00:00:00+00:00</updated>
   <id>/02/11/Teaching</id>
   <content type="html">&lt;h2 id=&quot;regime-shifts-seminar-take-two&quot;&gt;Regime Shifts Seminar take two&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Today I was again up for the regime shifts class to cover the details Alan’s Ecology Letters paper. Board lecture style on content I’m comfortable with, so enjoyable for me but hardly much of an experiment in effective teaching. Still, something that can be done well or poorly, so I think today went well.&lt;/li&gt;
&lt;li&gt;Began with individuals at the board to review the four principle figures from the previous class – birth rates and death rates, difference in rates, the bifurcation diagram and the potential landscape. Proceeded in traditional board lecture style without prepared notes, which worked better than I expected from my point of view though probably with the same low uptake efficiency of even good or entertaining lectures. One of the key exercises was in demonstrating how the potential landscape emerges from integrating the rate (force) equation using the visual boxes of Riemann sums on the board. I think this helps demystify the landscapes. The worst thing about the landscapes is that the bifurcations are much harder to visualize than in any of the former graphs, as the whole landscape contorts. Going in the reverse from the non-smooth landscape to the discontinuous birth and death rules was also illustrative.&lt;/li&gt;
&lt;li&gt;It would be interesting to explore if plotting by hand the functions and integrals was significantly more or less effective than plotting them in a computer. It’s good to be reminded that the integrals can be qualitatively visualized by hand without rigorous math or a computer. Learning computer tools and getting the more accurate picture has advantages too, and leaves a record of what you did. In either case, having others do this by hand would probably have been more useful.&lt;/li&gt;
&lt;li&gt;Lastly, learning to wait long enough for questions, go slow enough to keep people following without condescending, asking more questions and knowing when to sit back are some good general goals.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Meeting w- Alan</title>
	 <link href="/2010/02/10/Meeting-w--Alan.html"/>
   <updated>2010-02-10T00:00:00+00:00</updated>
   <id>/02/10/Meeting-w--Alan</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Weekly check-in, following up on last week’s meeting.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;goals-for-meeting&quot;&gt;Goals for meeting&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Discuss goals for regime shifts seminar tomorrow&lt;/li&gt;
&lt;li&gt;Discuss my manuscript outline on detection limits for early warning signals&lt;/li&gt;
&lt;li&gt;Discuss energy model formulation for analytic approximations to &lt;em&gt;Tribolium&lt;/em&gt; model.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;meeting-notes&quot;&gt;Meeting Notes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Early warning signals&lt;/strong&gt; - starting in simple models, proof of principle. Discuss three challenges to detection:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;ergodicity&lt;/li&gt;
&lt;li&gt;sensitivity&lt;/li&gt;
&lt;li&gt;complexity&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Eventually develop robust tools to give confidence estimates (parametric bootstrap) on potential early warning signals. Tool could be implemented as an R package.
&lt;ul&gt;
&lt;li&gt;Follow up with Darren&lt;/li&gt;
&lt;li&gt;General model testing principles: see Noel Cressie (spatial statistics). Durrett.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Structured Populations&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;I’m now using energy tracking to make the system Markov.&lt;/li&gt;
&lt;li&gt;Implemented in the analytics, need to add to energy accounting to simulation.&lt;/li&gt;
&lt;li&gt;Suggested further background reading, including some of the work of S.A.S. Kooijman, and&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;a href=&quot;http://www.jstor.org/page/termsConfirm.jsp?redirectUri=/stable/pdfplus/4567.pdf&quot; title=&quot;http://www.jstor.org/page/termsConfirm.jsp?redirectUri=/stable/pdfplus/4567.pdf&quot;&gt;Systematic formulation of tractable single species population models incorporating age structure&lt;/a&gt;, Gurney, Nisbet, Lawton 1983, [Gurney1983]&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?cmd=prlinks&amp;amp;dbfrom=pubmed&amp;amp;retmode=ref&amp;amp;id=7434253&quot; title=&quot;View or buy article from publisher (if available)&quot;&gt;Gurney WS and Nisbet RM. .&lt;/a&gt; pmid:7434253. &lt;a href=&quot;http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&amp;amp;rettype=abstract&amp;amp;id=7434253&quot; title=&quot;PMID 7434253&quot;&gt;PubMed&lt;/a&gt; &lt;a href=&quot;http://www.hubmed.org/display.cgi?uids=7434253&quot; title=&quot;PMID 7434253&quot;&gt;HubMed&lt;/a&gt; [Gurney1980]&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;conferences&quot;&gt;Conferences&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Also touched on possible conferences to attend this summer. Discussed &lt;strong&gt;&lt;a href=&quot;http://www.sm.u-bordeaux2.fr/CMPD3/index.html&quot; title=&quot;http://www.sm.u-bordeaux2.fr/CMPD3/index.html&quot;&gt;Conference&lt;/a&gt;&lt;/strong&gt; on Computational and Mathematical Population Dynamics. Should I go? Probably.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;targets-for-next-week&quot;&gt;Targets for Next Week&lt;/h3&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Early warning signals examples of three challenges&lt;/li&gt;
&lt;li&gt;Add the various warning signal metrics to the regime shifts simulation&lt;/li&gt;
&lt;li&gt;Add energy accounting to the beetles.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Follow-up on Parametric Bootstrapping</title>
	 <link href="/2010/02/10/Follow-up-on-Parametric-Bootstrapping.html"/>
   <updated>2010-02-10T00:00:00+00:00</updated>
   <id>/02/10/Follow-up-on-Parametric-Bootstrapping</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Continuing on yesterday’s discussion of parametric boostrapping implementation. Peter sent some very helpful comments and agreed to having them here for reference; I’ve added some links.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;“I’ve read up a bit on the bootstrap just now. First off, although parametric and nonparametric bootstrapping has always seemed very different to me, they fit in the same natural framework. The general idea is that in reality, there’s some real parameters x and some probability distribution P that’s given us some data. We get an estimate x’ from that data. To estimate confidence (or what-have-you) in x’, we get some estimate P’ of *the probability distribution*, and use P’ to make a bunch more fake data, to which we apply the estimation procedures, etcetera. We could get P’ by assuming a parametric model and plugging in x’. Or, we could resample from the data, or permute it, etcetera.&lt;/p&gt;
&lt;p&gt;I suppose that you’ve seen the &lt;a href=&quot;http://cran.r-project.org/web/packages/boot/index.html&quot; title=&quot;http://cran.r-project.org/web/packages/boot/index.html&quot;&gt;‘boot’&lt;/a&gt; package in R? It does both parametric and nonparametric bootstrapping, and its function boot.ci() computes confidence intervals in some sophisticated ways. Sophisticated ways? Why do we need to be more sophisticated? Well, the simple, straightforward method that we were using in the discussion is fine, really, but there’s some corrections to it that make it better. Briefly, the bootstrap introduces (small) biases. Some references are:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;Bootstrap confidence intervals&amp;quot;, a review,
  http://www.jstor.org/stable/2246110
&amp;quot;Better bootstrap confidence intervals&amp;quot;, describing the method BCa,
  http://www.jstor.org/stable/2289144&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(and which does *not* come after the above article, btw) both by Bradley Efron. Note that here ABC refers to “approximate bootstrap”, not “approximate bayesian”.&lt;/p&gt;
&lt;p&gt;One message is that one needs about 1,000 bootstrap replicates to get good confidence intervals.&lt;/p&gt;
&lt;p&gt;One interesting note from the first article: the “standard” confidence intervals are not transformation invariant: often it is advisable to apply some transformation (e.g. tanh^{-1}) to the data to get the intervals. The BCa bootstrap intervals are, by contrast, transformation invariant.&amp;quot;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The boot() function from the R package looks like a straight-forward way to implement these methods, though I will probably rely mostly on the standard method discussed yesterday which is basically a direct implementation of the Confidence Interval definition and hence a more transparent statistic for the user than the fancy methods. If I implement it with the boot() function, it will be easy for the user to obtain which-so-ever they want and for me to explore how they differ in practice in any case.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Meeting with Graham and Peter</title>
	 <link href="/2010/02/09/Meeting-with-Graham-and-Peter.html"/>
   <updated>2010-02-09T00:00:00+00:00</updated>
   <id>/02/09/Meeting-with-Graham-and-Peter</id>
   <content type="html">&lt;h3 id=&quot;discussion-of-model-comparisons&quot;&gt;Discussion of Model Comparisons&lt;/h3&gt;
&lt;p&gt;Primary focus of today’s discussion was rooted in Sunday’s entry&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;On &lt;strong&gt;plotting quirks,&lt;/strong&gt; haven’t figured out lattice but here’s yet another &lt;a href=&quot;http://had.co.nz&quot; title=&quot;http://had.co.nz&quot;&gt;newer plotting engine for R&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;I need to revisit how OUCH computes likelihood ratios and P values. Since some parameters are bounded to the positive real line (and may be small) the standard chi square isn’t correct. I should repeat the AIC-style analysis for likelihood ratios, though this is just a shift of where I put the zero line. The correct thing to do would be to ask what is the probability the observed difference in likelihood ratio (or AIC, etc) would have occurred by chance using the distributions I have calculated,&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/4/43/Aic_panels.png/60px-Aic_panels.png&quot; alt=&quot;image&quot; /&gt; (click for larger)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The approach I am advocating for goes by the name &lt;strong&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Bootstrapping_(statistics)#Parametric_bootstrap&quot; title=&quot;http://en.wikipedia.org/wiki/Bootstrapping_(statistics)#Parametric_bootstrap&quot;&gt;Parametric Bootstrapping&lt;/a&gt;&lt;/strong&gt; (that link isn’t that helpful actually, could improve the wiki entry). I should implement this as above, comparing to the observed differences in the model scores of the real data, rather than the measure of slightly greater which I report.&lt;/li&gt;
&lt;li&gt;Using this approach I can also &lt;strong&gt;evaluate the power&lt;/strong&gt; to detect any OU model by overlap in distributions. For instance, if the tree is the starburst, even strong selection OU will have no power, while on another tree it might. This can be done by testing a variety of OU models, rather than the one that best fits the data, and will be a great way to start quantifying the &lt;em&gt;information contained in the tree&lt;/em&gt; relative to the model choice question. This is a &lt;em&gt;crucial step&lt;/em&gt; before I try more complicated models, giving some measure of whether a tree contains enough taxa with enough covariance to tease out temporal information accurately.&lt;/li&gt;
&lt;li&gt;Discussed my concern that the &lt;strong&gt;BM model and OU model aren’t really embedded,&lt;/strong&gt; since the OU model likelihood cannot be computed accurately for small α. Of course it works in the limit, but is something to be cautious about. It has been suggested that model comparison should fit OU alone, and wait and see if α comes out small. There are two reasons to be skeptical of this&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;the star burst tree demonstrates that α and σ aren’t independent; then the tip variance is &lt;img src=&quot;http://openwetware.org/images/math/0/8/e/08e417731492414f9f1c6aaf090ad471.png&quot; alt=&quot;\frac{\sigma^2}{2\alpha}(1-e^{-2\alpha t})&quot; /&gt;&lt;/li&gt;
&lt;li&gt;The likelihood calculation may be numerically inaccurate for small α&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;speed-of-computing-probabilities-for-the-regimes-model&quot;&gt;Speed of computing probabilities for the Regimes model&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;So I can compute the joint probability for an arbitrary model rather quickly using my discretized matrix approach; if I’m given the transition matrices along each branch. Unfortunately, I spend all the computational time computing these matrices in the first place. We discussed several strategies to speed this up.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;strong&gt;Look-up tables.&lt;/strong&gt; For instance, rather than calculating &lt;img src=&quot;http://openwetware.org/images/math/d/a/e/daead000f739dd5aa84fd9f58b511b67.png&quot; alt=&quot;e^{-(x_1-x_2)^2/2\sigma^2t}&quot; /&gt; I could use the look-up of &lt;img src=&quot;http://openwetware.org/images/math/4/3/7/437ccc3edf32ee596e40ed14de1e3259.png&quot; alt=&quot;e^{-\beta^2}&quot; /&gt; There’s a variety of places this kind of trick can help with. Also, judicious use of logs – never exponentiate when I can multiply, or multiply when I can add.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MCMC approaches.&lt;/strong&gt; The general version of this just does MCMC over all the internal nodes. The key here is that if I know the values of all the internal nodes, the joint probability is just a product of all the transitions – no non-independence. Alternately, I could rely on the fact that I can solve this analytically if I were only told the regimes of the internal nodes, so I just have to MCMC over the handful of possible regimes at each node, and not the traits as well. This seems quite promising.&lt;/li&gt;
&lt;li&gt;Going from &lt;strong&gt;the generator&lt;/strong&gt; – this could be done for the truly nonlinear models, as it completely ignores the ability to get analytic solutions. The generator could be raised to the power of the branch length. Doing so for the largest branch would allow all other branches to be calculated in the process. This will probably be slow but easy to implement.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;so-what-to-target-next&quot;&gt;So what to target next&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;First: the the parametric bootstrap extension and paper.
&lt;ul&gt;
&lt;li&gt;modification of the code I currently have to do likelihood ratio and compare to the true data.&lt;/li&gt;
&lt;li&gt;Also add a function to give scores to trees regarding ability to distinguish OU and BM models as a measure of the temporal information they contain.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Lookup tables – means that giant data structure I wrote for the regimes model will be useful, (yay and yikes). More memory and probably more time with valgrind debugging, but could be promising.&lt;/li&gt;
&lt;li&gt;After that I think I’ll try MCMC over regimes and possibly the generator approach. An effective regimes calculation is probably a ways off yet, but plenty of things to try!&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Code Development for Exploring Regimes Shifts</title>
	 <link href="/2010/02/09/Code-Development-for-Exploring-Regimes-Shifts.html"/>
   <updated>2010-02-09T00:00:00+00:00</updated>
   <id>/02/09/Code-Development-for-Exploring-Regimes-Shifts</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Just &lt;a href=&quot;http://code.google.com/p/popdyn/source/list&quot; title=&quot;http://code.google.com/p/popdyn/source/list&quot;&gt;committed changes&lt;/a&gt; to the google project. &lt;code&gt;warning_signals.c&lt;/code&gt; now provides a fully functional, ensemble enabled simulation written with functional API for general Gillespie simulations (at last! I’ve come quite a way in my C coding from those early Gillespie simulations for adaptive dynamics two years ago). Still need to pull the API out of the single file. Doxygen-compatible literate programming included, but needs significant expansion before it can really be used effectively as an API for other users. Getting there… Meanwhile, on the science side:&lt;/li&gt;
&lt;li&gt;Simulation represents demographic stochasticity in a population following dynamics that are capable of the saddle node bifurcation. Can add environmental noise, remove demographic stochasticity, and allow a slow parameter change that will force the saddle node bifurcation either deterministically or stochastically.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;next-steps&quot;&gt;Next steps&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;add reporter functions to monitor the classic warning signals, based a single replicate (using time-averaging) and on the ensemble.
&lt;ul&gt;
&lt;li&gt;Variance is the easiest warning signal to implement for both cases.&lt;/li&gt;
&lt;li&gt;Autocorrelation over a specified window-size&lt;/li&gt;
&lt;li&gt;Power spectrum over time window (chance to become familiar with GSL’s fft, though I have this analysis implemented in some old Python all ready.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Observer function will need to be able to pass its data up to a higher-level language like R. Might be time to learn .Call over .C interface…&lt;/li&gt;
&lt;li&gt;Would be nice to have an R (command-line) and a Python based GUI, slider-bar, real-time graphing interface to the simulation to make it easy for users to explore how slow changes needed to be, how big the autocorrelation window, etc, to detect a warning signal.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;notebook-reflections&quot;&gt;Notebook Reflections&lt;/h3&gt;
&lt;p&gt;Ok, so that’s part vague list of accomplishments, part dense list of goals. Code development stage doesn’t really have simulations to chronicle with all there parameters and results to plot and show, but I’ll get there. Still figuring out what kind of notes are most useful for this stage, will be more obvious once things are coded and I can start exploring preliminary results. &lt;script type=&quot;text/javascript&quot;&gt;
&lt;!--
h=&#39;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&#39;;a=&#39;&amp;#64;&#39;;n=&#39;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&#39;;e=n+a+h;
document.write(&#39;&lt;a h&#39;+&#39;ref&#39;+&#39;=&quot;ma&#39;+&#39;ilto&#39;+&#39;:&#39;+e+&#39;&quot; clas&#39;+&#39;s=&quot;em&#39; + &#39;ail&quot;&gt;&#39;+&#39;Comments&#39;+&#39;&lt;\/&#39;+&#39;a&#39;+&#39;&gt;&#39;);
// --&gt;
&lt;/script&gt;&lt;noscript&gt;&amp;#x43;&amp;#x6f;&amp;#x6d;&amp;#x6d;&amp;#x65;&amp;#110;&amp;#116;&amp;#x73;&amp;#32;&amp;#40;&amp;#x63;&amp;#98;&amp;#x6f;&amp;#x65;&amp;#116;&amp;#116;&amp;#x69;&amp;#x67;&amp;#32;&amp;#x61;&amp;#116;&amp;#32;&amp;#x67;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#32;&amp;#100;&amp;#x6f;&amp;#116;&amp;#32;&amp;#x63;&amp;#x6f;&amp;#x6d;&amp;#x29;&lt;/noscript&gt; welcome; they can also be added to the talk page or directly to this notebook. Hope to figure out how to get a comment form bubble to appear so viewers can leave in-notebook comments without wiki-editing (possibly without logging in to OWW?). Thoughts on how to do that also appreciated.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Updates to Code</title>
	 <link href="/2010/02/08/Updates-to-Code.html"/>
   <updated>2010-02-08T00:00:00+00:00</updated>
   <id>/02/08/Updates-to-Code</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Mostly organizational updates at the moment. Restructured the directory tree, and added proper &lt;a href=&quot;http://en.wikipedia.org/wiki/Literate_programming&quot; title=&quot;http://en.wikipedia.org/wiki/Literate_programming&quot;&gt;literate programming&lt;/a&gt; headers to the code using &lt;a href=&quot;http://en.wikipedia.org/wiki/Doxygen&quot; title=&quot;http://en.wikipedia.org/wiki/Doxygen&quot;&gt;Doxygen&lt;/a&gt; markup.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://code.google.com/p/popdyn/&quot; title=&quot;http://code.google.com/p/popdyn/&quot;&gt;code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Exploring Difficulties with Existing Methods continued</title>
	 <link href="/2010/02/08/Exploring-Difficulties-with-Existing-Methods-continued.html"/>
   <updated>2010-02-08T00:00:00+00:00</updated>
   <id>/02/08/Exploring-Difficulties-with-Existing-Methods-continued</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Working on manuscript for this today, hope to have a draft soon.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Just added a basic example using a star-burst tree to illustrate the challenges associated with this kind of model choice inference.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sent draft to Brian and Peter, and Wainwright lab.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Still needs a figure explaining the BM, OU(1) and OU(LP) models for those not familiar with Butler and King 2004 paper, general polishing.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;further-revisions-based-on-feedback&quot;&gt;Further Revisions based on feedback&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Need to explain the simulation approach much more clearly as a model testing alternative to AIC/SIC. Need to explain how this can be done independent of AIC/SIC. Need proper discussion section.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Exploring Difficulties with Existing Methods</title>
	 <link href="/2010/02/07/Exploring-Difficulties-with-Existing-Methods.html"/>
   <updated>2010-02-07T00:00:00+00:00</updated>
   <id>/02/07/Exploring-Difficulties-with-Existing-Methods</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Model choice plays an increasingly dominant role in comparative phylogenetics. The software OUCH of Butler and King (2004) is built around the model comparison framework and returns a variety of information criteria for choosing between different models fitted to the tree.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I’ve written a short R script to explore how robust these inferences are, and the results are rather surprising. None of the inferences holds up to the classical P value standard of 95% probability of being right, and the inference can be wrong more often than it is right – a coin flip out-performs the model choice method based on these information criteria in certain cases. This provides good motivation for my proposed new methods and should also provide material for a note to Evolution.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;http://openwetware.org/images/thumb/4/43/Aic_panels.png/400px-Aic_panels.png&quot; alt=&quot;image&quot; /&gt; &lt;img src=&quot;http://openwetware.org/images/thumb/8/8c/Sic_panels.png/400px-Sic_panels.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Histogram in the difference between AIC (or SIC) score of the model used to produce the data and the alternative model. Values falling to the left of the dotted line choose the model actually used to create the simulated data on the tree. In the first row, the data is created under the OU(LP) model and the model choice always selects OU(LP), without error. But when the data is created under BM (last row) the OU(1) and OU(LP) models often outperform the BM model. When the data is created under OU(1), middle row, the model inference chooses the other models most of the time. While stricter criteria of SIC make fewer errors relative to AIC when the data is created under the simpler BM model, SIC performs even worse when OU(1) generates the data.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Uses the Anoles tree of the Northern Lesser Antilles and trait of log body size as in the example in OUCH and in Bulter and King paper.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;challenges-with-figures&quot;&gt;Challenges with Figures&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The figure doesn’t appear exactly as I’d like it to, still mastering R lattice graphics. It fills the rows from left to right but from bottom to top. Also, I’d like to leave off the diagonal (self-comparisons, here appearing as the cross diagonal), since differences between scores is of course zero for these cases. They could be replaced with the labels for those row/columns (BM, OU(1), OU(LP) ).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;code-notes&quot;&gt;Code Notes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Code is implemented in the robust_model_choice.R file in codebranches directory. Uses sapply instead of for loop, but the evaluation of the true and test models for each of the simulated data sets is quite slow still. Not sure if it can be accelerated using OUCH, will try in my own C code implementation. I’ll need to extend the C code to handle OUCH-style painting for this.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Lunch with Wainwright Lab</title>
	 <link href="/2010/02/05/Lunch-with-Wainwright-Lab.html"/>
   <updated>2010-02-05T00:00:00+00:00</updated>
   <id>/02/05/Lunch-with-Wainwright-Lab</id>
   <content type="html">&lt;p&gt;Friday lunch with Wainwright lab continues to be a very useful chance to bounce ideas off of lab members with an excellent grasp of both the models involved and the real biology, morphology and evolution in question. Today’s discussion hit several topics.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Should regime transitions be restricted to nodes?&lt;/strong&gt; The general consensus was &lt;strong&gt;No.&lt;/strong&gt; On one hand, the position of nodes may contain information about the timing of an actual environmental change responsible for a regime shift. On the other hand: (1) the exact temporal position of the node is uncertain anyway, as it comes from inference of the tree, (2) the evolutionary response may occur immediately after or before the actual position of the node, and indeed it may be interesting to say which it is, (3) this ignores information about the branch lengths, and that transitions are more likely to occur on longer branches (4) this ignores the fact that many more nodes exist than are inferred, but are absent from the phylogeny because the lineage subsequently goes extinct. That said, restricting transitions to nodes seems like a reasonable place to start.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;log transforming data.&lt;/strong&gt; This is a minor comment, which we might submit as a note to Evolution. While nondimensionalizing data is good, this makes interpreting the Brownian motion model more challenging, as the average size continues to increase. The problem is slightly remedied by the OU process, in which the average size increases only until the stationary distribution is reached. Discussion seemed encouraging and now I need to think of how to usefully illustrate the concern in four or fewer figures…&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Model choice and AIC scores&lt;/strong&gt; This is another note I’m preparing to submit. The correct way to choose between BM and OU models may not be as simple as AIC, as any simulation can explore. Accurately characterizing false-positive rates may be more informative and is easily done using existing methods and software. The degree of error will be particular to the tree topology, but this kind of analysis could be performed for each data set automatically.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/02/04/Teaching.html"/>
   <updated>2010-02-04T00:00:00+00:00</updated>
   <id>/02/04/Teaching</id>
   <content type="html">&lt;h2 id=&quot;early-warning-signals-to-regime-shifts-seminar&quot;&gt;Early Warning Signals to Regime Shifts Seminar&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;I was just responsible for covering a relatively technical paper on the idea of detecting early warning signals to regime shifts. This is a class of about 10 people. First half we took turns on the board, relying entirely on graphical analysis, and going from a birth death model through stability analysis to illustrate bi-stability to the bifurcation diagram and the energy landscape representation. In the second half we explored an individual-based stochastic simulation module in netlogo in which we could move slider bars for parameters and observe the bifurcation and population crash.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The board work went very well with people taking turns getting us to the next step. I believe it was clear that (a) not everyone understood this analysis at the beginning and (b) were able to figure it out at the board with a little bit of guidance and (c) seemed very engaged in the process. The netlogo activity ended up being done predominately on my machine connected to the projector rather than in pairs at individual computers in front of everyone. Getting groups started on an activity seems to be a challenge to me, and transitioning between little groups and whole class discussion remains something I really need to figure out. In this case the whole-group exploration of the netlogo simulation guided by me was probably best anyway, as I didn’t have clear directions or time for people to work in groups.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;evaluation&quot;&gt;Evaluation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;I was also pleased by the prepwork required to do this. Initially it took me about 3 hrs (while stuck on a train) to learn how to get a population model into netlogo. Realizing that I can only do individual-based birth and death rates (so divide the population rates by population size), and learning the &lt;code&gt;count sheep&lt;/code&gt; command were key steps. I debated coding the dynamics in R, or in C and writing a python interface for slider bars, but the netlogo approach was much easier. Still, I was frustrated by not knowing how to make netlogo do graphs that don’t have time on the x axis, or the rather cumbersome way I have to calculate warning signals such as variance. Once I figured out the basics, I was able to write the actual netlogo code we used in about an hour this morning, and guide the board discussion without more than a sketch of my plan.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I still debate whether interactive learning must involve slower pace and less coverage than traditional approaches. Overall I was happy with how much we covered today and think it successfully facilitated an accelerated discovery process relative to what would happen in normal lecture + homework exercise. The fact that we hardly talked about the article I was supposed to cover notwithstanding…&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;On the science side, the simulation did a good job of illustrating a case where there was a mathematical warning signal, in terms of a weakening eigenvalue, (despite the model having the stochasticity built in intrinsically and not just added to the landscape picture), but at the same time it was hard to detect without long-time averages, slow changes, or replicates.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;going-forward&quot;&gt;Going Forward&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Thinking about writing up a little manuscript with the examples and discussion of the theory we covered.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Trying to figure out what makes this post useful and what just wastes time. Thinking about adding the netlogo code up here, and/or figures covering the examples. Might be better placed in my lab notebook on stochastic population dynamics.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Hastings Meeting</title>
	 <link href="/2010/02/03/Hastings-Meeting.html"/>
   <updated>2010-02-03T00:00:00+00:00</updated>
   <id>/02/03/Hastings-Meeting</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;Meeting with Dr. Alan Hastings soon to discuss progress on this project. We’ll also see what he thinks of the open lab notebook. There’s a lot I want to cover in this meeting.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;warning-signals&quot;&gt;Warning Signals&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Tomorrow I’m leading a discussion in seminar on regime shift literature, so I need to review major ideas of the paper with Alan. Particularly need to be clear on the role of dimensionality and if/when the population dynamics lack an appropriate Hamiltonian and whether that’s an important part of the argument.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;beetle-dynamics&quot;&gt;Beetle Dynamics&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Summary of where we are / what I’ve done and the primary goals for the project. I’m hoping the intro to the lab notebook will help facilitate this.&lt;/li&gt;
&lt;li&gt;Finish discussion of Denis et al Eco Monographs (2001) paper. Discuss alternate approaches that use model comparison.&lt;/li&gt;
&lt;li&gt;Dealing with the age classes in continuous time when rates are time dependent remains a source of frustration. There are several possible approaches here, so might be good to compare how each performs against the data:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;assume constant rates of transition between age classes, restoring temporal homogeneity.&lt;/li&gt;
&lt;li&gt;add an energy function that explicitly models energy uptake and make transition rates between age classes dependent upon this&lt;/li&gt;
&lt;li&gt;see how far I can get with the straight-forward / correct approach of integrating directly. Certainly fine for the ODE but less familiar with the theory for temporally heterogeneous stochastic process, since it loses the Markov property (rate depends on how long you’ve been in a state).&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;post-meeting-eval&quot;&gt;Post Meeting Eval&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Goals for next time: Feb 10th&lt;/li&gt;
&lt;/ul&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;Implement the analytic energy-based model for transitions between states, solve for fluctuation dynamics&lt;/li&gt;
&lt;li&gt;Review &lt;a href=&quot;http://www.eeb.cornell.edu/Ellner/pubs/EasterlingIntegral00.pdf&quot; title=&quot;http://www.eeb.cornell.edu/Ellner/pubs/EasterlingIntegral00.pdf&quot;&gt;integral projection models&lt;/a&gt; of Steve Ellner as an approach to handling age / stage structure&lt;/li&gt;
&lt;li&gt;Experiment with adding individual heterogeneity and environmental variation to the continuous time simulation&lt;/li&gt;
&lt;li&gt;Explore implementation strategies for likelihood evaluation of the various models to simulated and real data&lt;/li&gt;
&lt;li&gt;Continue &lt;a href=&quot;http://www.mendeley.com/collections/972151/StochasticPopulationDynamics/&quot; title=&quot;http://www.mendeley.com/collections/972151/StochasticPopulationDynamics/&quot;&gt;background reading&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>The Lab Notebook Goes Open</title>
	 <link href="/2010/02/02/The-Lab-Notebook-Goes-Open-.html"/>
   <updated>2010-02-02T00:00:00+00:00</updated>
   <id>/02/02/The-Lab-Notebook-Goes-Open-</id>
   <content type="html">&lt;p&gt;(Originally posted on OpenWetWare)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;This is the first entry in my lab notebook, but not the beginning of the project. I have been exploring demographic and colored environmental noise since beginning my graduate program at UC Davis. Much of that time has been spent in building the appropriate tool set though, so now it’s time to dive in.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A good starting point is Denis et. al. (2001) &lt;em&gt;Ecological Monographs&lt;/em&gt; 71.2. In this paper they reconsider the LPA model for &lt;em&gt;Tribolium&lt;/em&gt; and determine that most of the variation can be attributed to demographic noise rather than chaos, limit cycles or environmental noise, contrary to their earlier work.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Thus far I’ve implemented a continuous time individual-based stochastic population model with four age classes. Currently demographic stochasticity is the only source of variation, though the age structure creates large shocks. Analytic treatment is difficult in a continuous time framework since having fixed ages of maturity makes the model time heterogeneous.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Code for the project is hosted open source through &lt;a href=&quot;http://code.google.com/p/popdyn/&quot; title=&quot;http://code.google.com/p/popdyn/&quot;&gt;Google code&lt;/a&gt; and managed with subversion.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;early-warning-signals&quot;&gt;Early Warning Signals&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;I’ve also done some work towards the early warning signal modeling. I’ve implemented a simple population individual-based model with saddle-node bifurcation in both C and netlogo. The netlogo implementation allows for a better visualization with slider-bars that change the parameters and dynamic plotting, the C code allows larger numbers, longer times, and replicates (ensemble) simulation. The C code is also in continuous time (via Gillespie method), while netlogo is in discrete time. Both need some modification.&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Teaching</title>
	 <link href="/2010/01/25/Teaching.html"/>
   <updated>2010-01-25T00:00:00+00:00</updated>
   <id>/01/25/Teaching</id>
   <content type="html">&lt;h2 id=&quot;clash-of-old-and-new&quot;&gt;Clash of Old and New&lt;/h2&gt;
&lt;p&gt;Today was my day to facilitate for a graduate student discussion seminar. The seminar is well attended by quite a handful of faculty and post-docs, some thirty people. The discussion is almost always dominated by a few faculty, which is a great source of information but offers little opportunity for students to ask questions or wrestle with ideas themselves. To get at this, I tried breaking the class into small groups for the first half and passing out different sets of discussion questions. Things didn’t go as planned…&lt;/p&gt;
&lt;p&gt;The faculty organizer of the course left the room during the discussion, apologizing that he was busy and would return when the small-group part was finished. I introduced the concept poorly and without discussing the idea with these professors before hand. Senior faculty present informed me that that it was inappropriate to treat this like an “undergraduate lab.” Some small groups had excellent discussions, others had more trouble getting going. The questions I had chosen tended to be too specific and the time for group discussion considered too long, despite that fact that no group covered both questions they had been given.&lt;/p&gt;
&lt;p&gt;I underestimated the resistance and discomfort people would experience in being asked to form groups and talk to each other about that day’s reading. My tone and manner of introduction was probably too energetic and directive, which heightened the sense of “undergraduate lab.” The obvious opposition to the proposal from the faculty involved when the idea was introduced also seemed to set an expectation that being in small groups would accomplish nothing, setting a tone that I found stifling towards active group discussion.&lt;/p&gt;
&lt;p&gt;I asked many people involved for feedback afterwards. While this feedback was not anonymous, many still gave direct critiques, particularly of the time allowed, the questions, and some of the approach as a whole. Overall, I found many of the quieter students, post-docs, and faculty supportive to very positive about the experience, while those speaking more frequently tended to be more negative.&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Progresschallenges</title>
	 <link href="/2010/01/18/ProgressChallenges.html"/>
   <updated>2010-01-18T00:00:00+00:00</updated>
   <id>/01/18/ProgressChallenges</id>
   <content type="html">&lt;p&gt;&lt;strong&gt;editorial note&lt;/strong&gt;: These notes pre-date the formal start of my online laboratory notebook, &lt;a href=&quot;http://carlboettiger.info/2010/02/02/The-Lab-Notebook-Goes-Open-.html&quot;&gt;Feb 2 2010: The Lab Notebook Goes Open&lt;/a&gt; and were adapted from a LaTeX document in which I kept notes on this topic during my summer at &lt;a href=&quot;http://www.iiasa.ac.at/&quot;&gt;IIASA&lt;/a&gt;. Lacking a proper notebook then, documents like this one were updated periodically and occassionally branched into new ones. The post date represents the last time the LaTeX document was edited in the course of that research.&lt;/p&gt;
&lt;h1 id=&quot;summary&quot;&gt;Summary&lt;/h1&gt;
&lt;p&gt;The process of adaptive branching can be divided into four phases. Depending on the parameter regime, different phases would be limiting.&lt;/p&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;&lt;p&gt;Approaching branching point&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Invading Coexistence regime (&lt;span class=&quot;math&quot;&gt;\(P_2\)&lt;/span&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Coexistence until next successful invader&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Subsequent divergence until stable&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A forward and backwards transition rate can be calculated between each phase, based on my analytical work this summer. The shape of the waiting-time distribution between each phase can be determined, and when this rate is limiting this dominates the overall shape. This allows four analytic approximations, one for each parameter regime where one of the above steps is limiting, even though such an analytic solution is not possible over the entire process. This is biologically interesting, as it identifies not only the waiting-time distribution but the mechanism responsible, and highlights the role of the 4 different mechanisms whereby stochasticity frustrates branching.&lt;/p&gt;
&lt;h1 id=&quot;steps&quot;&gt;Steps&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Write down the four analytic distribution predictions&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;create numerical simulations to compare to each regime&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;compare to intermediate parameter regimes (these are actually rare, for my simulations with O(1000) individuals step three is usually limiting.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;write the paper describing four mechanisms whereby stochasticity frustrates evolutionary branching&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>CPB thesis proposal</title>
	 <link href="/2010/01/10/cpb-thesis-proposal.html"/>
   <updated>2010-01-10T14:07:20+00:00</updated>
   <id>/01/10/cpb-thesis-proposal</id>
   <content type="html">&lt;p&gt;In the spirit of archiving work in the lab notebook, this was my PhD dissertation proposal, a requirement to advance to candidacy submitted before our oral defense in the second or third year. Following some excellent advice, this is focused more narrowly than my actual dissertation. As a historical note, I started keeping an open lab notebook the month following this, on OpenWetWare (so work leading up to this isn’t archived, though admittedly first two years were largely coursework). I’ve back-dated the post to the date on the proposal.&lt;/p&gt;
&lt;embed src=&quot;http://www.carlboettiger.info/assets/files/thesis_proposal.pdf&quot; width=700 height=500&gt;
</content>
 </entry>
 
 
